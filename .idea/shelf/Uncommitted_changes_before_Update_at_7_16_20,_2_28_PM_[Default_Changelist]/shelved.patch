Index: src/main/java/org/ohnlp/util/demo/WebServiceController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.ohnlp.util.demo;\n\nimport org.apache.uima.UIMAException;\nimport org.apache.uima.UIMAFramework;\nimport org.apache.uima.analysis_engine.AnalysisEngine;\nimport org.apache.uima.analysis_engine.AnalysisEngineDescription;\nimport org.apache.uima.analysis_engine.metadata.AnalysisEngineMetaData;\nimport org.apache.uima.fit.factory.AggregateBuilder;\nimport org.apache.uima.fit.factory.TypeSystemDescriptionFactory;\nimport org.apache.uima.fit.internal.ResourceManagerFactory;\nimport org.apache.uima.fit.util.JCasUtil;\nimport org.apache.uima.jcas.JCas;\nimport org.apache.uima.jcas.tcas.Annotation;\nimport org.apache.uima.resource.ResourceInitializationException;\nimport org.apache.uima.resource.ResourceManager;\nimport org.apache.uima.resource.metadata.ConfigurationParameterSettings;\nimport org.apache.uima.resource.metadata.TypeSystemDescription;\nimport org.apache.uima.util.InvalidXMLException;\nimport org.json.simple.JSONArray;\nimport org.json.simple.JSONObject;\nimport org.ohnlp.medtagger.type.ConceptMention;\nimport org.ohnlp.medxn.type.Drug;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.ModelAttribute;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.servlet.ModelAndView;\n\nimport java.io.IOException;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport java.util.Collection;\nimport java.util.HashMap;\n\nimport static org.apache.uima.fit.factory.AnalysisEngineFactory.createEngineDescription;\nimport static org.apache.uima.fit.factory.JCasFactory.createJCas;\n\n@RestController\npublic class WebServiceController {\n\n    private final Logger logger = LoggerFactory.getLogger(this.getClass());\n\n    private static TypeSystemDescription tsd;\n    private AnalysisEngine cmAae;\n\n\n    /**\n     * Trigger UIMA pipeline from the given texts and return only the concept mentions\n     *\n     * @param docText\n     * @return\n     */\n    HashMap<String, Collection> runPipeline(String docText) {\n\n        HashMap<String, Collection> annotMap = new HashMap<>();\n\n        try {\n            JCas cmCas = createJCas(tsd);\n            cmCas.setDocumentText(docText);\n            cmAae.process(cmCas);\n            annotMap.put(\"cm\", JCasUtil.select(cmCas, ConceptMention.class));\n            annotMap.put(\"drug\", JCasUtil.select(cmCas, Drug.class));\n\n            cmAae.collectionProcessComplete();\n\n        } catch (UIMAException e) {\n            e.printStackTrace();\n        }\n\n        return annotMap;\n    }\n\n    /**\n     * Wrap list of concept mentions into json list to feed into the \"entity\" js field.\n     * @param cms List of Annotation from UIMA\n     * @return list of JSON array for Brat to display in the html template\n     */\n    static JSONAnnotation generateConceptMentionBratJson(Collection<ConceptMention> cms) {\n        JSONArray cmList = new JSONArray();\n        JSONArray attribList = new JSONArray();\n\n        int entityIdInt = 1;\n        int attribIdInt = 1;\n\n        if(cms == null){\n            return new JSONAnnotation(cmList, attribList);\n        }\n\n        for (ConceptMention cm : cms) {\n\n            // Format: [${ID}, ${TYPE}, [[${START}, ${END}]]]\n            // note that range of the offsets are [${START},${END})\n            // ref: https://github.com/arne-cl/brat-embedded-visualization-examples/blob/master/minimal-brat-embedded.htm\n\n            JSONArray entityProperties = new JSONArray();\n            String bratEntityId = String.format(\"T%d\", entityIdInt++);\n            entityProperties.add(bratEntityId);\n            entityProperties.add(\"Condition\");\n            JSONArray spans = new JSONArray();\n            JSONArray tokenBeginEnd = new JSONArray();\n            tokenBeginEnd.add(cm.getBegin());\n            tokenBeginEnd.add(cm.getEnd());\n            spans.add(tokenBeginEnd);\n            entityProperties.add(spans);\n            cmList.add(entityProperties);\n\n                /**\n                 * ConceptMention\n                 *    begin: 9\n                 *    end: 18\n                 *    detectionMethod: \"Matched\"\n                 *    normTarget: \"DRY_COUGH\"\n                 *    Certainty: \"Positive\"\n                 *    semGroup: <null>\n                 *    status: \"Present\"\n                 *    sentence: Sentence\n                 *    experiencer: \"Patient\"\n                 */\n\n                JSONArray attribProperties = new JSONArray();\n                attribProperties.add(String.format(\"A%d\", attribIdInt++));\n                attribProperties.add(\"norm\");\n                attribProperties.add(bratEntityId);\n                attribProperties.add(cm.getNormTarget());\n                attribList.add(attribProperties);\n\n                JSONArray certaintyProperties = new JSONArray();\n                certaintyProperties.add(String.format(\"A%d\", attribIdInt++));\n                certaintyProperties.add(\"certainty\");\n                certaintyProperties.add(bratEntityId);\n                certaintyProperties.add(cm.getCertainty());\n                attribList.add(certaintyProperties);\n\n\n                JSONArray statusProperties = new JSONArray();\n                statusProperties.add(String.format(\"A%d\", attribIdInt++));\n                statusProperties.add(\"status\");\n                statusProperties.add(bratEntityId);\n                statusProperties.add(cm.getStatus());\n                attribList.add(statusProperties);\n\n                JSONArray experiencerProperties = new JSONArray();\n                experiencerProperties.add(String.format(\"A%d\", attribIdInt++));\n                experiencerProperties.add(\"experiencer\");\n                experiencerProperties.add(bratEntityId);\n                experiencerProperties.add(cm.getExperiencer());\n                attribList.add(experiencerProperties);\n            }\n\n\n        return new JSONAnnotation(cmList, attribList);\n    }\n\n    /**\n     * Wrap list of concept mentions into json list to feed into the \"entity\" js field.\n     * @param drugs List of Drugs\n     * @return list of JSON array for Brat to display in the html template\n     */\n    static JSONAnnotation generateDrugBratJson(Collection<Drug> drugs, int entityIdInt, int attribIdInt) {\n        JSONArray drugList = new JSONArray();\n        JSONArray attribList = new JSONArray();\n\n\n        if(drugs == null){\n            return new JSONAnnotation(drugList, attribList);\n        }\n\n        for (Drug drug : drugs) {\n\n            // Format: [${ID}, ${TYPE}, [[${START}, ${END}]]]\n            // note that range of the offsets are [${START},${END})\n            // ref: https://github.com/arne-cl/brat-embedded-visualization-examples/blob/master/minimal-brat-embedded.htm\n\n            JSONArray entityProperties = new JSONArray();\n            String bratEntityId = String.format(\"T%d\", entityIdInt++);\n            entityProperties.add(bratEntityId);\n            entityProperties.add(\"Condition\");\n            JSONArray spans = new JSONArray();\n            JSONArray tokenBeginEnd = new JSONArray();\n            tokenBeginEnd.add(drug.getBegin());\n            tokenBeginEnd.add(drug.getEnd());\n            spans.add(tokenBeginEnd);\n            entityProperties.add(spans);\n            drugList.add(entityProperties);\n\n            JSONArray attribProperties = new JSONArray();\n            attribProperties.add(String.format(\"A%d\", attribIdInt++));\n            attribProperties.add(\"norm\");\n            attribProperties.add(bratEntityId);\n            attribProperties.add(drug.getName());\n            attribList.add(attribProperties);\n        }\n\n        return new JSONAnnotation(drugList, attribList);\n    }\n\n    /**\n     *  To initialize UIMA resources and type systesms\n     */\n    public WebServiceController() {\n\n        // TODO: Change hard code path from the file system into resource reference\n        Path ruleDirPath = Paths.get(\"covid19\");\n        System.out.println(\"IE Rules:\\t\" + ruleDirPath.toAbsolutePath().toString());\n\n        try {\n            ResourceManager resMgr = ResourceManagerFactory.newResourceManager();\n            AnalysisEngineDescription descN3cTAE = createEngineDescription(\n                    \"desc.medtaggerdesc.aggregate_analysis_engine.N3CAggregateTAE\");\n            AnalysisEngineMetaData metadata = descN3cTAE.getAnalysisEngineMetaData();\n\n            ConfigurationParameterSettings settings = metadata.getConfigurationParameterSettings();\n            settings.setParameterValue(\"Resource_dir\", ruleDirPath.toString());\n            metadata.setConfigurationParameterSettings(settings);\n\n            // modified MedXNTypes now importing MedTaggerIE types\n            tsd = TypeSystemDescriptionFactory.\n                    createTypeSystemDescription(\"org.ohnlp.medxn.types.MedXNTypes\");\n            tsd.resolveImports(resMgr);\n\n            cmAae = UIMAFramework.produceAnalysisEngine(descN3cTAE, resMgr, null);\n\n        } catch (InvalidXMLException e) {\n            e.printStackTrace();\n        } catch (IOException e) {\n            e.printStackTrace();\n        } catch (ResourceInitializationException e) {\n            e.printStackTrace();\n        }\n    }\n\n    /**\n     * The index page. Display a default sentence to start.\n     * @return the initial view out of index-template\n     */\n    @GetMapping(\"/\")\n    public ModelAndView index() {\n        ModelAndView indexView = new ModelAndView();\n        indexView.setViewName(\"index-template\");\n        indexView.addObject(\"input_text\", \"The patient had dry cough and took Aspirin yesterday.\");\n        return indexView;\n    }\n\n    /**\n     * How to display NLP results .\n     * @return the updated view out of index-template\n     */\n\n    @PostMapping(\"/\")\n    public ModelAndView submit(@ModelAttribute WebInputText webInputText) {\n        // To get a list of concept mentions\n\n        HashMap<String, Collection> annotMap = runPipeline(webInputText.getDocText());\n\n        // render template for the fields in index-template\n        ModelAndView indexView = new ModelAndView();\n        indexView.setViewName(\"index-template\");\n        indexView.addObject(\"input_text\", webInputText.getDocText());\n        logger.info(webInputText.getDocText());\n\n        // get a list of concepts as JSON list to feed into the template\n\n        JSONAnnotation jsAnnot = generateConceptMentionBratJson(annotMap.get(\"cm\"));\n//        int drugIdStart = jsAnnot.getCmList().size() + 1;\n//        int drugAttribIdStart = jsAnnot.getAttribList().size() + 1;\n//\n//        jsAnnot.add(generateDrugBratJson(annotMap.get(\"drug\"), drugIdStart, drugAttribIdStart));\n\n        indexView.addObject(\"cmList\", jsAnnot.getCmList());\n        indexView.addObject(\"attribList\", jsAnnot.getAttribList());\n        indexView.addObject(\"isResult\", true);\n\n        return indexView;\n\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/java/org/ohnlp/util/demo/WebServiceController.java	(revision 4dfebf7ad61a5cee7cbd51a3cffca99b77cd5371)
+++ src/main/java/org/ohnlp/util/demo/WebServiceController.java	(date 1594837449252)
@@ -5,12 +5,10 @@
 import org.apache.uima.analysis_engine.AnalysisEngine;
 import org.apache.uima.analysis_engine.AnalysisEngineDescription;
 import org.apache.uima.analysis_engine.metadata.AnalysisEngineMetaData;
-import org.apache.uima.fit.factory.AggregateBuilder;
 import org.apache.uima.fit.factory.TypeSystemDescriptionFactory;
 import org.apache.uima.fit.internal.ResourceManagerFactory;
 import org.apache.uima.fit.util.JCasUtil;
 import org.apache.uima.jcas.JCas;
-import org.apache.uima.jcas.tcas.Annotation;
 import org.apache.uima.resource.ResourceInitializationException;
 import org.apache.uima.resource.ResourceManager;
 import org.apache.uima.resource.metadata.ConfigurationParameterSettings;
@@ -19,20 +17,16 @@
 import org.json.simple.JSONArray;
 import org.json.simple.JSONObject;
 import org.ohnlp.medtagger.type.ConceptMention;
-import org.ohnlp.medxn.type.Drug;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
-import org.springframework.web.bind.annotation.GetMapping;
-import org.springframework.web.bind.annotation.ModelAttribute;
-import org.springframework.web.bind.annotation.PostMapping;
-import org.springframework.web.bind.annotation.RestController;
+import org.springframework.beans.factory.annotation.Value;
+import org.springframework.web.bind.annotation.*;
 import org.springframework.web.servlet.ModelAndView;
 
 import java.io.IOException;
 import java.nio.file.Path;
 import java.nio.file.Paths;
 import java.util.Collection;
-import java.util.HashMap;
 
 import static org.apache.uima.fit.factory.AnalysisEngineFactory.createEngineDescription;
 import static org.apache.uima.fit.factory.JCasFactory.createJCas;
@@ -42,8 +36,12 @@
 
     private final Logger logger = LoggerFactory.getLogger(this.getClass());
 
+    private static AnalysisEngineDescription descMedTaggerTAE;
     private static TypeSystemDescription tsd;
-    private AnalysisEngine cmAae;
+    private AnalysisEngine aae;
+
+    @Value("${bioportal.apikey}")
+    private String bioportalAPIKey;
 
 
     /**
@@ -52,48 +50,40 @@
      * @param docText
      * @return
      */
-    HashMap<String, Collection> runPipeline(String docText) {
-
-        HashMap<String, Collection> annotMap = new HashMap<>();
-
+    private Collection<ConceptMention> runPipeline(String docText) {
+        Collection<ConceptMention> cms = null;
         try {
-            JCas cmCas = createJCas(tsd);
-            cmCas.setDocumentText(docText);
-            cmAae.process(cmCas);
-            annotMap.put("cm", JCasUtil.select(cmCas, ConceptMention.class));
-            annotMap.put("drug", JCasUtil.select(cmCas, Drug.class));
-
-            cmAae.collectionProcessComplete();
-
+            JCas sourceCas = createJCas(tsd);
+            sourceCas.setDocumentText(docText);
+            aae.process(sourceCas);
+            cms = JCasUtil.select(sourceCas, ConceptMention.class);
+            aae.collectionProcessComplete();
         } catch (UIMAException e) {
             e.printStackTrace();
         }
-
-        return annotMap;
+        return cms;
     }
 
     /**
      * Wrap list of concept mentions into json list to feed into the "entity" js field.
-     * @param cms List of Annotation from UIMA
+     * @param cms List of ConceptMentions from UIMA
      * @return list of JSON array for Brat to display in the html template
      */
-    static JSONAnnotation generateConceptMentionBratJson(Collection<ConceptMention> cms) {
+    private JSONAnnotation generateBratJson(Collection<ConceptMention> cms) {
         JSONArray cmList = new JSONArray();
         JSONArray attribList = new JSONArray();
 
         int entityIdInt = 1;
         int attribIdInt = 1;
-
-        if(cms == null){
-            return new JSONAnnotation(cmList, attribList);
-        }
-
+        try{
         for (ConceptMention cm : cms) {
+            JSONObject cmj = new JSONObject();
 
             // Format: [${ID}, ${TYPE}, [[${START}, ${END}]]]
             // note that range of the offsets are [${START},${END})
             // ref: https://github.com/arne-cl/brat-embedded-visualization-examples/blob/master/minimal-brat-embedded.htm
 
+            // TODO: Add properties to show normalized concepts
             JSONArray entityProperties = new JSONArray();
             String bratEntityId = String.format("T%d", entityIdInt++);
             entityProperties.add(bratEntityId);
@@ -106,96 +96,60 @@
             entityProperties.add(spans);
             cmList.add(entityProperties);
 
-                /**
-                 * ConceptMention
-                 *    begin: 9
-                 *    end: 18
-                 *    detectionMethod: "Matched"
-                 *    normTarget: "DRY_COUGH"
-                 *    Certainty: "Positive"
-                 *    semGroup: <null>
-                 *    status: "Present"
-                 *    sentence: Sentence
-                 *    experiencer: "Patient"
-                 */
+
+            /**
+             * ConceptMention
+             *    begin: 9
+             *    end: 18
+             *    detectionMethod: "Matched"
+             *    normTarget: "DRY_COUGH"
+             *    Certainty: "Positive"
+             *    semGroup: <null>
+             *    status: "Present"
+             *    sentence: Sentence
+             *    experiencer: "Patient"
+             */
 
-                JSONArray attribProperties = new JSONArray();
-                attribProperties.add(String.format("A%d", attribIdInt++));
-                attribProperties.add("norm");
-                attribProperties.add(bratEntityId);
-                attribProperties.add(cm.getNormTarget());
-                attribList.add(attribProperties);
+            JSONArray attribProperties = new JSONArray();
+            attribProperties.add(String.format("A%d", attribIdInt++));
+            attribProperties.add("norm");
+            attribProperties.add(bratEntityId);
+            attribProperties.add(cm.getNormTarget());
+            attribList.add(attribProperties);
 
-                JSONArray certaintyProperties = new JSONArray();
-                certaintyProperties.add(String.format("A%d", attribIdInt++));
-                certaintyProperties.add("certainty");
-                certaintyProperties.add(bratEntityId);
-                certaintyProperties.add(cm.getCertainty());
-                attribList.add(certaintyProperties);
+            JSONArray certaintyProperties = new JSONArray();
+            certaintyProperties.add(String.format("A%d", attribIdInt++));
+            certaintyProperties.add("certainty");
+            certaintyProperties.add(bratEntityId);
+            certaintyProperties.add(cm.getCertainty());
+            attribList.add(certaintyProperties);
 
 
-                JSONArray statusProperties = new JSONArray();
-                statusProperties.add(String.format("A%d", attribIdInt++));
-                statusProperties.add("status");
-                statusProperties.add(bratEntityId);
-                statusProperties.add(cm.getStatus());
-                attribList.add(statusProperties);
+            JSONArray statusProperties = new JSONArray();
+            statusProperties.add(String.format("A%d", attribIdInt++));
+            statusProperties.add("status");
+            statusProperties.add(bratEntityId);
+            statusProperties.add(cm.getStatus());
+            attribList.add(statusProperties);
 
-                JSONArray experiencerProperties = new JSONArray();
-                experiencerProperties.add(String.format("A%d", attribIdInt++));
-                experiencerProperties.add("experiencer");
-                experiencerProperties.add(bratEntityId);
-                experiencerProperties.add(cm.getExperiencer());
-                attribList.add(experiencerProperties);
+            JSONArray experiencerProperties = new JSONArray();
+            experiencerProperties.add(String.format("A%d", attribIdInt++));
+            experiencerProperties.add("experiencer");
+            experiencerProperties.add(bratEntityId);
+            experiencerProperties.add(cm.getExperiencer());
+            attribList.add(experiencerProperties);
+
+        }
+        }catch (ClassCastException ex) {
+            logger.info("Object classloader: " + cms.getClass().getClassLoader());
+            logger.info("Target class classloader: " + WebServiceController.class.getClassLoader());
+            if(cms.getClass().getClassLoader() != WebServiceController.class.getClassLoader()) {
+                logger.warn("Different classloaders detected!");
             }
-
-
+        }
         return new JSONAnnotation(cmList, attribList);
     }
 
-    /**
-     * Wrap list of concept mentions into json list to feed into the "entity" js field.
-     * @param drugs List of Drugs
-     * @return list of JSON array for Brat to display in the html template
-     */
-    static JSONAnnotation generateDrugBratJson(Collection<Drug> drugs, int entityIdInt, int attribIdInt) {
-        JSONArray drugList = new JSONArray();
-        JSONArray attribList = new JSONArray();
-
-
-        if(drugs == null){
-            return new JSONAnnotation(drugList, attribList);
-        }
-
-        for (Drug drug : drugs) {
-
-            // Format: [${ID}, ${TYPE}, [[${START}, ${END}]]]
-            // note that range of the offsets are [${START},${END})
-            // ref: https://github.com/arne-cl/brat-embedded-visualization-examples/blob/master/minimal-brat-embedded.htm
-
-            JSONArray entityProperties = new JSONArray();
-            String bratEntityId = String.format("T%d", entityIdInt++);
-            entityProperties.add(bratEntityId);
-            entityProperties.add("Condition");
-            JSONArray spans = new JSONArray();
-            JSONArray tokenBeginEnd = new JSONArray();
-            tokenBeginEnd.add(drug.getBegin());
-            tokenBeginEnd.add(drug.getEnd());
-            spans.add(tokenBeginEnd);
-            entityProperties.add(spans);
-            drugList.add(entityProperties);
-
-            JSONArray attribProperties = new JSONArray();
-            attribProperties.add(String.format("A%d", attribIdInt++));
-            attribProperties.add("norm");
-            attribProperties.add(bratEntityId);
-            attribProperties.add(drug.getName());
-            attribList.add(attribProperties);
-        }
-
-        return new JSONAnnotation(drugList, attribList);
-    }
-
     /**
      *  To initialize UIMA resources and type systesms
      */
@@ -207,21 +161,21 @@
 
         try {
             ResourceManager resMgr = ResourceManagerFactory.newResourceManager();
-            AnalysisEngineDescription descN3cTAE = createEngineDescription(
-                    "desc.medtaggerdesc.aggregate_analysis_engine.N3CAggregateTAE");
-            AnalysisEngineMetaData metadata = descN3cTAE.getAnalysisEngineMetaData();
+
+            descMedTaggerTAE = createEngineDescription(
+                    "desc.medtaggeriedesc.aggregate_analysis_engine.MedTaggerIEAggregateTAE");
+            AnalysisEngineMetaData metadata = descMedTaggerTAE.getAnalysisEngineMetaData();
 
             ConfigurationParameterSettings settings = metadata.getConfigurationParameterSettings();
             settings.setParameterValue("Resource_dir", ruleDirPath.toString());
             metadata.setConfigurationParameterSettings(settings);
 
-            // modified MedXNTypes now importing MedTaggerIE types
+            aae = UIMAFramework.produceAnalysisEngine(descMedTaggerTAE, resMgr, null);
+
             tsd = TypeSystemDescriptionFactory.
-                    createTypeSystemDescription("org.ohnlp.medxn.types.MedXNTypes");
+                    createTypeSystemDescription("org.ohnlp.medtagger.ie.types.MedTaggerIETypes");
             tsd.resolveImports(resMgr);
 
-            cmAae = UIMAFramework.produceAnalysisEngine(descN3cTAE, resMgr, null);
-
         } catch (InvalidXMLException e) {
             e.printStackTrace();
         } catch (IOException e) {
@@ -237,9 +191,8 @@
      */
     @GetMapping("/")
     public ModelAndView index() {
-        ModelAndView indexView = new ModelAndView();
-        indexView.setViewName("index-template");
-        indexView.addObject("input_text", "The patient had dry cough and took Aspirin yesterday.");
+        final ModelAndView indexView = new ModelAndView();
+        indexView.setViewName("index.v2");
         return indexView;
     }
 
@@ -248,31 +201,80 @@
      * @return the updated view out of index-template
      */
 
-    @PostMapping("/")
-    public ModelAndView submit(@ModelAttribute WebInputText webInputText) {
+    @PostMapping("/parse")
+    public ModelAndView parse(@ModelAttribute final WebInputText webInputText) {
         // To get a list of concept mentions
-
-        HashMap<String, Collection> annotMap = runPipeline(webInputText.getDocText());
+        final Collection<ConceptMention> cms = runPipeline(webInputText.getDocText());
 
         // render template for the fields in index-template
-        ModelAndView indexView = new ModelAndView();
-        indexView.setViewName("index-template");
+        final ModelAndView indexView = new ModelAndView();
+        indexView.setViewName("parse");
         indexView.addObject("input_text", webInputText.getDocText());
         logger.info(webInputText.getDocText());
-
         // get a list of concepts as JSON list to feed into the template
-
-        JSONAnnotation jsAnnot = generateConceptMentionBratJson(annotMap.get("cm"));
-//        int drugIdStart = jsAnnot.getCmList().size() + 1;
-//        int drugAttribIdStart = jsAnnot.getAttribList().size() + 1;
-//
-//        jsAnnot.add(generateDrugBratJson(annotMap.get("drug"), drugIdStart, drugAttribIdStart));
-
+        final JSONAnnotation jsAnnot = generateBratJson(cms);
         indexView.addObject("cmList", jsAnnot.getCmList());
         indexView.addObject("attribList", jsAnnot.getAttribList());
         indexView.addObject("isResult", true);
 
         return indexView;
-
+    }
+
+    /**
+     * The covid 19 demo page.
+     * @return the demo view
+     */
+    @GetMapping("/demo")
+    public ModelAndView demo() {
+        final ModelAndView indexView = new ModelAndView();
+        indexView.setViewName("demo");
+        return indexView;
+    }
+
+    /**
+     * The dictionary builder page.
+     * @return the dictionary builder view
+     */
+    @GetMapping("/dict_builder")
+    public ModelAndView dict_builder() {
+        final ModelAndView indexView = new ModelAndView();
+        indexView.setViewName("dict_builder");
+        return indexView;
+    }
+
+    @CrossOrigin
+    @GetMapping("/get_ontology_root")
+    public String get_ontology_root(@RequestParam(name="acronym") String acronym) throws Exception {
+        String ret = org.ohnlp.medtagger.fit.demo.util.BioPortalAPI.getOntologyRoot(acronym, bioportalAPIKey);
+        return ret;
+    }
+
+    @CrossOrigin
+    @GetMapping("/get_ontology_children")
+    public String get_ontology_children(
+            @RequestParam(name="acronym") String acronym,
+            @RequestParam(name="classid") String classid) throws Exception {
+        String ret = org.ohnlp.medtagger.fit.demo.util.BioPortalAPI.getOntologyChildren(acronym, classid, bioportalAPIKey);
+        return ret;
+    }
+
+    @CrossOrigin
+    @GetMapping("/get_ontology_csv")
+    public String get_ontology_csv(
+            @RequestParam(name="acronym") String acronym) throws Exception {
+        String ret = org.ohnlp.medtagger.fit.demo.util.BioPortalAPI.downloadAndExtractOntology(acronym, bioportalAPIKey);
+        return ret;
+    }
+
+    /**
+     * The IE rule editor page.
+     * @return the dictionary builder view
+     */
+    @GetMapping("/ie_editor")
+    public ModelAndView ie_editor() {
+        final ModelAndView indexView = new ModelAndView();
+        indexView.setViewName("ie_editor");
+        return indexView;
     }
+
 }
Index: src/test/java/org/ohnlp/n3c/PipelineMergeTests.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.ohnlp.n3c;\n\nimport org.apache.uima.UIMAFramework;\nimport org.apache.uima.analysis_engine.AnalysisEngine;\nimport org.apache.uima.analysis_engine.AnalysisEngineDescription;\nimport org.apache.uima.analysis_engine.AnalysisEngineProcessException;\nimport org.apache.uima.analysis_engine.metadata.AnalysisEngineMetaData;\nimport org.apache.uima.cas.CAS;\nimport org.apache.uima.cas.CASException;\nimport org.apache.uima.fit.factory.TypeSystemDescriptionFactory;\nimport org.apache.uima.fit.internal.ResourceManagerFactory;\nimport org.apache.uima.fit.util.JCasUtil;\nimport org.apache.uima.resource.ResourceInitializationException;\nimport org.apache.uima.resource.ResourceManager;\nimport org.apache.uima.resource.metadata.ConfigurationParameterSettings;\nimport org.apache.uima.resource.metadata.TypeSystemDescription;\nimport org.apache.uima.util.CasCreationUtils;\nimport org.apache.uima.util.InvalidXMLException;\nimport org.junit.BeforeClass;\nimport org.junit.Test;\nimport org.ohnlp.medtagger.type.ConceptMention;\nimport org.ohnlp.medxn.MedXNStringBuildTests;\n\nimport java.io.IOException;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport java.util.Arrays;\nimport java.util.Collection;\n\nimport static org.apache.uima.fit.factory.AnalysisEngineFactory.createEngineDescription;\nimport static org.junit.Assert.assertNotEquals;\n\npublic class PipelineMergeTests {\n    static AnalysisEngine cmAae;\n    static ResourceManager resMgr;\n    static CAS cas;\n    static ClassLoader clsLoader;\n\n\n    @BeforeClass\n    public static void initPipeline() throws ResourceInitializationException, IOException, InvalidXMLException {\n        clsLoader = MedXNStringBuildTests.class.getClassLoader();\n\n        resMgr = ResourceManagerFactory.newResourceManager();\n        AnalysisEngineDescription descN3cTAE = createEngineDescription(\n                \"desc.medtaggerdesc.aggregate_analysis_engine.N3CAggregateTAE\");\n        AnalysisEngineMetaData metadata = descN3cTAE.getAnalysisEngineMetaData();\n\n        ConfigurationParameterSettings settings = metadata.getConfigurationParameterSettings();\n        Path ruleDirPath = Paths.get(\"covid19\");\n        System.out.println(\"IE Rules:\\t\" + ruleDirPath.toAbsolutePath().toString());\n\n        settings.setParameterValue(\"Resource_dir\", ruleDirPath.toString());\n        metadata.setConfigurationParameterSettings(settings);\n\n\n        cmAae = UIMAFramework.produceAnalysisEngine(descN3cTAE, resMgr, null);\n\n        cas = CasCreationUtils.createCas(Arrays.asList(cmAae.getMetaData()), null, resMgr);\n\n    }\n\n    @Test\n    public void processString() throws AnalysisEngineProcessException, CASException {\n        String text = \"The patient had dry cough and took Aspirin yesterday.\";\n        cas.setDocumentText(text);\n        cmAae.process(cas);\n        Collection<ConceptMention> results = JCasUtil.select(cas.getJCas(), ConceptMention.class);\n        System.out.println(results);\n        assertNotEquals(0, results.size());\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/test/java/org/ohnlp/n3c/PipelineMergeTests.java	(revision 4dfebf7ad61a5cee7cbd51a3cffca99b77cd5371)
+++ src/test/java/org/ohnlp/n3c/PipelineMergeTests.java	(date 1594777992519)
@@ -34,12 +34,10 @@
     static AnalysisEngine cmAae;
     static ResourceManager resMgr;
     static CAS cas;
-    static ClassLoader clsLoader;
 
 
     @BeforeClass
     public static void initPipeline() throws ResourceInitializationException, IOException, InvalidXMLException {
-        clsLoader = MedXNStringBuildTests.class.getClassLoader();
 
         resMgr = ResourceManagerFactory.newResourceManager();
         AnalysisEngineDescription descN3cTAE = createEngineDescription(
Index: MedTaggerWeb.iml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<module org.jetbrains.idea.maven.project.MavenProjectsManager.isMavenModule=\"true\" type=\"JAVA_MODULE\" version=\"4\">\n  <component name=\"NewModuleRootManager\" LANGUAGE_LEVEL=\"JDK_1_8\">\n    <output url=\"file://$MODULE_DIR$/target/classes\" />\n    <output-test url=\"file://$MODULE_DIR$/target/test-classes\" />\n    <content url=\"file://$MODULE_DIR$\">\n      <sourceFolder url=\"file://$MODULE_DIR$/src/main/java\" isTestSource=\"false\" />\n      <sourceFolder url=\"file://$MODULE_DIR$/src/main/resources\" type=\"java-resource\" />\n      <sourceFolder url=\"file://$MODULE_DIR$/src/test/java\" isTestSource=\"true\" />\n      <sourceFolder url=\"file://$MODULE_DIR$/src/test/resources\" type=\"java-test-resource\" />\n      <excludeFolder url=\"file://$MODULE_DIR$/target\" />\n    </content>\n    <orderEntry type=\"inheritedJdk\" />\n    <orderEntry type=\"sourceFolder\" forTests=\"false\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-web:2.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter:2.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot:2.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-autoconfigure:2.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-logging:2.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: ch.qos.logback:logback-classic:1.2.3\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: ch.qos.logback:logback-core:1.2.3\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.logging.log4j:log4j-to-slf4j:2.12.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.logging.log4j:log4j-api:2.12.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.slf4j:jul-to-slf4j:1.7.29\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: jakarta.annotation:jakarta.annotation-api:1.3.5\" level=\"project\" />\n    <orderEntry type=\"library\" scope=\"RUNTIME\" name=\"Maven: org.yaml:snakeyaml:1.25\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-json:2.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-databind:2.10.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-annotations:2.10.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-core:2.10.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.datatype:jackson-datatype-jdk8:2.10.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.10.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.module:jackson-module-parameter-names:2.10.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-tomcat:2.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.tomcat.embed:tomcat-embed-core:9.0.29\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.tomcat.embed:tomcat-embed-el:9.0.29\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.tomcat.embed:tomcat-embed-websocket:9.0.29\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-validation:2.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: jakarta.validation:jakarta.validation-api:2.0.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.hibernate.validator:hibernate-validator:6.0.18.Final\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.jboss.logging:jboss-logging:3.4.1.Final\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: com.fasterxml:classmate:1.5.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-web:5.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-webmvc:5.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-aop:5.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-expression:5.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: commons-io:commons-io:2.5\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.commons:commons-lang3:3.9\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: commons-lang:commons-lang:2.6\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: commons-logging:commons-logging:1.2\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: net.sf.jwordnet:jwnl:1.3.3\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: log4j:log4j:1.2.17\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: com.googlecode.json-simple:json-simple:1.1.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: junit:junit:4.12\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.hamcrest:hamcrest-core:2.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.hamcrest:hamcrest:2.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.thymeleaf:thymeleaf-spring5:3.0.10.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.thymeleaf:thymeleaf:3.0.11.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.attoparser:attoparser:2.0.5.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.unbescape:unbescape:1.1.6.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.slf4j:slf4j-api:1.7.29\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework.boot:spring-boot-starter-thymeleaf:1.5.6.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.thymeleaf:thymeleaf-spring4:2.1.5.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: nz.net.ultraq.thymeleaf:thymeleaf-layout-dialect:2.4.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: nz.net.ultraq.thymeleaf:thymeleaf-expression-processor:1.1.3\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.codehaus.groovy:groovy:2.5.8\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.opennlp:opennlp-maxent:3.0.3\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.opennlp:opennlp-tools:1.9.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.opennlp:opennlp-uima:1.9.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.uima:uimaj-adapter-vinci:2.10.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.uima:jVinci:2.10.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.uima:uimaj-core:2.10.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.uima:uimafit-core:2.4.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: commons-logging:commons-logging-api:1.1\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-core:5.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-jcl:5.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-context:5.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.springframework:spring-beans:5.2.2.RELEASE\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.uima:uimaj-cpe:2.10.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.uima:uimaj-document-annotation:2.10.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.apache.uima:uimaj-tools:2.10.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.ahocorasick:ahocorasick:0.4.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: me.tongfei:progressbar:0.7.4\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.jline:jline:3.11.0\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.fusesource.jansi:jansi:1.18\" level=\"project\" />\n    <orderEntry type=\"library\" name=\"Maven: org.jetbrains:annotations:13.0\" level=\"project\" />\n  </component>\n</module>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- MedTaggerWeb.iml	(revision 4dfebf7ad61a5cee7cbd51a3cffca99b77cd5371)
+++ MedTaggerWeb.iml	(date 1594749401052)
@@ -14,8 +14,6 @@
     <orderEntry type="sourceFolder" forTests="false" />
     <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot-starter-web:2.2.2.RELEASE" level="project" />
     <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot-starter:2.2.2.RELEASE" level="project" />
-    <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot:2.2.2.RELEASE" level="project" />
-    <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot-autoconfigure:2.2.2.RELEASE" level="project" />
     <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot-starter-logging:2.2.2.RELEASE" level="project" />
     <orderEntry type="library" name="Maven: ch.qos.logback:logback-classic:1.2.3" level="project" />
     <orderEntry type="library" name="Maven: ch.qos.logback:logback-core:1.2.3" level="project" />
@@ -45,6 +43,10 @@
     <orderEntry type="library" name="Maven: org.springframework:spring-aop:5.2.2.RELEASE" level="project" />
     <orderEntry type="library" name="Maven: org.springframework:spring-expression:5.2.2.RELEASE" level="project" />
     <orderEntry type="library" name="Maven: commons-io:commons-io:2.5" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.httpcomponents:httpclient:4.5.3" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.httpcomponents:httpcore:4.4.12" level="project" />
+    <orderEntry type="library" name="Maven: commons-codec:commons-codec:1.13" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.commons:commons-csv:1.8" level="project" />
     <orderEntry type="library" name="Maven: org.apache.commons:commons-lang3:3.9" level="project" />
     <orderEntry type="library" name="Maven: commons-lang:commons-lang:2.6" level="project" />
     <orderEntry type="library" name="Maven: commons-logging:commons-logging:1.2" level="project" />
@@ -64,6 +66,9 @@
     <orderEntry type="library" name="Maven: nz.net.ultraq.thymeleaf:thymeleaf-layout-dialect:2.4.1" level="project" />
     <orderEntry type="library" name="Maven: nz.net.ultraq.thymeleaf:thymeleaf-expression-processor:1.1.3" level="project" />
     <orderEntry type="library" name="Maven: org.codehaus.groovy:groovy:2.5.8" level="project" />
+    <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot-devtools:2.2.2.RELEASE" level="project" />
+    <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot:2.2.2.RELEASE" level="project" />
+    <orderEntry type="library" name="Maven: org.springframework.boot:spring-boot-autoconfigure:2.2.2.RELEASE" level="project" />
     <orderEntry type="library" name="Maven: org.apache.opennlp:opennlp-maxent:3.0.3" level="project" />
     <orderEntry type="library" name="Maven: org.apache.opennlp:opennlp-tools:1.9.0" level="project" />
     <orderEntry type="library" name="Maven: org.apache.opennlp:opennlp-uima:1.9.0" level="project" />
Index: .gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+># Compiled class file\n*.class\n\n# Log file\n*.log\n\n# BlueJ files\n*.ctxt\n\n# Mobile Tools for Java (J2ME)\n.mtj.tmp/\n\n# Package Files #\n*.jar\n*.war\n*.nar\n*.ear\n*.zip\n*.tar.gz\n*.rar\n\n# virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml\nhs_err_pid*\n\ntarget/\n\n**/.DS_Store\n.DS_Store
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .gitignore	(revision 4dfebf7ad61a5cee7cbd51a3cffca99b77cd5371)
+++ .gitignore	(date 1594778886539)
@@ -22,7 +22,4 @@
 # virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml
 hs_err_pid*
 
-target/
-
-**/.DS_Store
-.DS_Store
\ No newline at end of file
+target/
\ No newline at end of file
Index: src/main/resources/static/static/data/sample_pack.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/data/sample_pack.json	(date 1594749336036)
+++ src/main/resources/static/static/data/sample_pack.json	(date 1594749336036)
@@ -0,0 +1,87 @@
+{
+    "name": "Sample_PAD",
+    "matchrules": [
+      {
+        "rule_name": "cm_r0a",
+        "regexp": "\\b(%reANATdesc )?(%reANAT )(artery|arteries|systems?|origin|trunks?|veins?)?\\b",
+        "location": "NA",
+        "norm": "ANAT:group(4)"
+      },
+      {
+        "rule_name": "cm_r1a",
+        "regexp": "\\b(%reDISOdesc )?(%reDISO)\\b",
+        "location": "NA",
+        "norm": "DISO:%normDISOdesc(group(2))_group(4)"
+      },
+      {
+        "rule_name": "cm_r2a",
+        "regexp": "\\b(one[ -]vessel run-?off|single vessel run-?off)\\b",
+        "location": "NA",
+        "norm": "DISO:ALONE_group(1)"
+      },
+      {
+        "rule_name": "cm_r4a",
+        "regexp": "\\b(no flow|not demonstrate flow|severe narrowing|moderate narrowing)\\b",
+        "location": "NA",
+        "norm": "DISO:POSITIVE_group(1)"
+      },
+      {
+        "rule_name": "cm_r5a",
+        "regexp": "\\b(near|extensive|complete)?(%reANATdesc )?(%reANAT )?(occluded|occludes|occlusion|occlusive)\\b",
+        "location": "NA",
+        "norm": "DISO:ALONE_Occlusion"
+      },
+      {
+        "rule_name": "cm_r6a",
+        "regexp": "\\b%reDISOAbbr\\b\",LOCATION=\"UC",
+        "location": "UC",
+        "norm": "DISO:group(1)"
+      },
+      {
+        "rule_name": "cm_r7a",
+        "regexp": "\\b%reANATAbbr\\b",
+        "location": "UC",
+        "norm": "ANAT:group(1)"
+      },
+      {
+        "rule_name": "cm_r8a",
+        "regexp": "\\b%reDISOAlone\\b",
+        "location": "NA",
+        "norm": "DISO:ALONE_group(1)"
+      }
+    ],
+    "rsregexps": [
+      {
+        "name": "resources_regexp_reANAT",
+        "text": "aorto-?bi-?iliac\naorto-?bi-?fem(oral)?\naxillo-?bi-?fem(oral)?\ncardiod\ncalf\nfemoral\nfemoral-femoral\nfem(oro)?-?pop(liteal)?\nfemoral-to-peroneal\niliac\nfem-pop\nfem-fem\nleg\nextremity\nperoneal\npopliteal \ntibial\ntibio-?peroneal\n"
+      },
+      {
+        "name": "resources_regexp_reANATAbbr",
+        "text": "sfa\ncfa\nifa\npt\nat"
+      },
+      {
+        "name": "resources_regexp_reANATdesc",
+        "text": "left\nright\nlower\nupper\nanterior\nposterior\nexternal\ninternal\ncommon\ndistal\nproximal"
+      },
+      {
+        "name": "resources_regexp_reDISO",
+        "text": "angioplasty\nbypass\nartery bypass\ncross-?over \nendarterectomy\ndiseases?\nplaques?\nrecanalization\nstenos[ie]s\ngraft"
+      },
+      {
+        "name": "resources_regexp_reDISOAbbr",
+        "text": "aso\npta"
+      },
+      {
+        "name": "resources_regexp_reDISOAlone",
+        "text": "atherosclerotic\natheroscleros[ie]s\natheromatous\nballoon angioplasty\n"
+      },
+      {
+        "name": "resources_regexp_reDISOdesc",
+        "text": "extensive\ncomplete\nlarge\nmoderate\nmoderate focal\nmulti-?focus\nsevere\nsignificant\nhigh[ -]?grade\ndiffuse\nsmall amount of\nsome\nminimal\nmild"
+      }
+    ],
+    "fns": {
+      "used_resources": "used_resources.txt",
+      "resources_rules_matchrules": "resources_rules_matchrules.txt"
+    }
+  }
\ No newline at end of file
Index: src/main/resources/static/static/lib/jszip/FileSaver.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/jszip/FileSaver.js	(date 1594749336109)
+++ src/main/resources/static/static/lib/jszip/FileSaver.js	(date 1594749336109)
@@ -0,0 +1,247 @@
+/*! FileSaver.js
+ *  A saveAs() FileSaver implementation.
+ *  2014-01-24
+ *
+ *  By Eli Grey, http://eligrey.com
+ *  License: X11/MIT
+ *    See LICENSE.md
+ */
+
+/*global self */
+/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */
+
+/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
+
+var saveAs = saveAs
+  // IE 10+ (native saveAs)
+  || (typeof navigator !== "undefined" &&
+      navigator.msSaveOrOpenBlob && navigator.msSaveOrOpenBlob.bind(navigator))
+  // Everyone else
+  || (function(view) {
+	"use strict";
+	// IE <10 is explicitly unsupported
+	if (typeof navigator !== "undefined" &&
+	    /MSIE [1-9]\./.test(navigator.userAgent)) {
+		return;
+	}
+	var
+		  doc = view.document
+		  // only get URL when necessary in case BlobBuilder.js hasn't overridden it yet
+		, get_URL = function() {
+			return view.URL || view.webkitURL || view;
+		}
+		, URL = view.URL || view.webkitURL || view
+		, save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a")
+		, can_use_save_link = !view.externalHost && "download" in save_link
+		, click = function(node) {
+			var event = doc.createEvent("MouseEvents");
+			event.initMouseEvent(
+				"click", true, false, view, 0, 0, 0, 0, 0
+				, false, false, false, false, 0, null
+			);
+			node.dispatchEvent(event);
+		}
+		, webkit_req_fs = view.webkitRequestFileSystem
+		, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem
+		, throw_outside = function(ex) {
+			(view.setImmediate || view.setTimeout)(function() {
+				throw ex;
+			}, 0);
+		}
+		, force_saveable_type = "application/octet-stream"
+		, fs_min_size = 0
+		, deletion_queue = []
+		, process_deletion_queue = function() {
+			var i = deletion_queue.length;
+			while (i--) {
+				var file = deletion_queue[i];
+				if (typeof file === "string") { // file is an object URL
+					URL.revokeObjectURL(file);
+				} else { // file is a File
+					file.remove();
+				}
+			}
+			deletion_queue.length = 0; // clear queue
+		}
+		, dispatch = function(filesaver, event_types, event) {
+			event_types = [].concat(event_types);
+			var i = event_types.length;
+			while (i--) {
+				var listener = filesaver["on" + event_types[i]];
+				if (typeof listener === "function") {
+					try {
+						listener.call(filesaver, event || filesaver);
+					} catch (ex) {
+						throw_outside(ex);
+					}
+				}
+			}
+		}
+		, FileSaver = function(blob, name) {
+			// First try a.download, then web filesystem, then object URLs
+			var
+				  filesaver = this
+				, type = blob.type
+				, blob_changed = false
+				, object_url
+				, target_view
+				, get_object_url = function() {
+					var object_url = get_URL().createObjectURL(blob);
+					deletion_queue.push(object_url);
+					return object_url;
+				}
+				, dispatch_all = function() {
+					dispatch(filesaver, "writestart progress write writeend".split(" "));
+				}
+				// on any filesys errors revert to saving with object URLs
+				, fs_error = function() {
+					// don't create more object URLs than needed
+					if (blob_changed || !object_url) {
+						object_url = get_object_url(blob);
+					}
+					if (target_view) {
+						target_view.location.href = object_url;
+					} else {
+						window.open(object_url, "_blank");
+					}
+					filesaver.readyState = filesaver.DONE;
+					dispatch_all();
+				}
+				, abortable = function(func) {
+					return function() {
+						if (filesaver.readyState !== filesaver.DONE) {
+							return func.apply(this, arguments);
+						}
+					};
+				}
+				, create_if_not_found = {create: true, exclusive: false}
+				, slice
+			;
+			filesaver.readyState = filesaver.INIT;
+			if (!name) {
+				name = "download";
+			}
+			if (can_use_save_link) {
+				object_url = get_object_url(blob);
+				// FF for Android has a nasty garbage collection mechanism
+				// that turns all objects that are not pure javascript into 'deadObject'
+				// this means `doc` and `save_link` are unusable and need to be recreated
+				// `view` is usable though:
+				doc = view.document;
+				save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a");
+				save_link.href = object_url;
+				save_link.download = name;
+				var event = doc.createEvent("MouseEvents");
+				event.initMouseEvent(
+					"click", true, false, view, 0, 0, 0, 0, 0
+					, false, false, false, false, 0, null
+				);
+				save_link.dispatchEvent(event);
+				filesaver.readyState = filesaver.DONE;
+				dispatch_all();
+				return;
+			}
+			// Object and web filesystem URLs have a problem saving in Google Chrome when
+			// viewed in a tab, so I force save with application/octet-stream
+			// http://code.google.com/p/chromium/issues/detail?id=91158
+			if (view.chrome && type && type !== force_saveable_type) {
+				slice = blob.slice || blob.webkitSlice;
+				blob = slice.call(blob, 0, blob.size, force_saveable_type);
+				blob_changed = true;
+			}
+			// Since I can't be sure that the guessed media type will trigger a download
+			// in WebKit, I append .download to the filename.
+			// https://bugs.webkit.org/show_bug.cgi?id=65440
+			if (webkit_req_fs && name !== "download") {
+				name += ".download";
+			}
+			if (type === force_saveable_type || webkit_req_fs) {
+				target_view = view;
+			}
+			if (!req_fs) {
+				fs_error();
+				return;
+			}
+			fs_min_size += blob.size;
+			req_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {
+				fs.root.getDirectory("saved", create_if_not_found, abortable(function(dir) {
+					var save = function() {
+						dir.getFile(name, create_if_not_found, abortable(function(file) {
+							file.createWriter(abortable(function(writer) {
+								writer.onwriteend = function(event) {
+									target_view.location.href = file.toURL();
+									deletion_queue.push(file);
+									filesaver.readyState = filesaver.DONE;
+									dispatch(filesaver, "writeend", event);
+								};
+								writer.onerror = function() {
+									var error = writer.error;
+									if (error.code !== error.ABORT_ERR) {
+										fs_error();
+									}
+								};
+								"writestart progress write abort".split(" ").forEach(function(event) {
+									writer["on" + event] = filesaver["on" + event];
+								});
+								writer.write(blob);
+								filesaver.abort = function() {
+									writer.abort();
+									filesaver.readyState = filesaver.DONE;
+								};
+								filesaver.readyState = filesaver.WRITING;
+							}), fs_error);
+						}), fs_error);
+					};
+					dir.getFile(name, {create: false}, abortable(function(file) {
+						// delete file if it already exists
+						file.remove();
+						save();
+					}), abortable(function(ex) {
+						if (ex.code === ex.NOT_FOUND_ERR) {
+							save();
+						} else {
+							fs_error();
+						}
+					}));
+				}), fs_error);
+			}), fs_error);
+		}
+		, FS_proto = FileSaver.prototype
+		, saveAs = function(blob, name) {
+			return new FileSaver(blob, name);
+		}
+	;
+	FS_proto.abort = function() {
+		var filesaver = this;
+		filesaver.readyState = filesaver.DONE;
+		dispatch(filesaver, "abort");
+	};
+	FS_proto.readyState = FS_proto.INIT = 0;
+	FS_proto.WRITING = 1;
+	FS_proto.DONE = 2;
+
+	FS_proto.error =
+	FS_proto.onwritestart =
+	FS_proto.onprogress =
+	FS_proto.onwrite =
+	FS_proto.onabort =
+	FS_proto.onerror =
+	FS_proto.onwriteend =
+		null;
+
+	view.addEventListener("unload", process_deletion_queue, false);
+	saveAs.unload = function() {
+		process_deletion_queue();
+		view.removeEventListener("unload", process_deletion_queue, false);
+	};
+	return saveAs;
+}(
+	   typeof self !== "undefined" && self
+	|| typeof window !== "undefined" && window
+	|| this.content
+));
+// `self` is undefined in Firefox for Android content script context
+// while `this` is nsIContentFrameMessageManager
+// with an attribute `content` that corresponds to the window
+
+if (typeof module !== "undefined") module.exports = saveAs;
Index: src/main/resources/static/static/lib/jszip/jszip-3.1.5.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/jszip/jszip-3.1.5.min.js	(date 1594749336110)
+++ src/main/resources/static/static/lib/jszip/jszip-3.1.5.min.js	(date 1594749336110)
@@ -0,0 +1,13 @@
+/*!
+
+JSZip v3.2.1 - A JavaScript class for generating and reading zip files
+<http://stuartk.com/jszip>
+
+(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
+Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.
+
+JSZip uses the library pako released under the MIT license :
+https://github.com/nodeca/pako/blob/master/LICENSE
+*/
+
+!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=t()}}(function(){return function s(a,o,h){function u(r,t){if(!o[r]){if(!a[r]){var e="function"==typeof require&&require;if(!t&&e)return e(r,!0);if(l)return l(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var n=o[r]={exports:{}};a[r][0].call(n.exports,function(t){var e=a[r][1][t];return u(e||t)},n,n.exports,s,a,o,h)}return o[r].exports}for(var l="function"==typeof require&&require,t=0;t<h.length;t++)u(h[t]);return u}({1:[function(t,e,r){"use strict";var c=t("./utils"),d=t("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(t){for(var e,r,i,n,s,a,o,h=[],u=0,l=t.length,f=l,d="string"!==c.getTypeOf(t);u<t.length;)f=l-u,i=d?(e=t[u++],r=u<l?t[u++]:0,u<l?t[u++]:0):(e=t.charCodeAt(u++),r=u<l?t.charCodeAt(u++):0,u<l?t.charCodeAt(u++):0),n=e>>2,s=(3&e)<<4|r>>4,a=1<f?(15&r)<<2|i>>6:64,o=2<f?63&i:64,h.push(p.charAt(n)+p.charAt(s)+p.charAt(a)+p.charAt(o));return h.join("")},r.decode=function(t){var e,r,i,n,s,a,o=0,h=0,u="data:";if(t.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var l,f=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===p.charAt(64)&&f--,t.charAt(t.length-2)===p.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(l=d.uint8array?new Uint8Array(0|f):new Array(0|f);o<t.length;)e=p.indexOf(t.charAt(o++))<<2|(n=p.indexOf(t.charAt(o++)))>>4,r=(15&n)<<4|(s=p.indexOf(t.charAt(o++)))>>2,i=(3&s)<<6|(a=p.indexOf(t.charAt(o++))),l[h++]=e,64!==s&&(l[h++]=r),64!==a&&(l[h++]=i);return l}},{"./support":30,"./utils":32}],2:[function(t,e,r){"use strict";var i=t("./external"),n=t("./stream/DataWorker"),s=t("./stream/DataLengthProbe"),a=t("./stream/Crc32Probe");s=t("./stream/DataLengthProbe");function o(t,e,r,i,n){this.compressedSize=t,this.uncompressedSize=e,this.crc32=r,this.compression=i,this.compressedContent=n}o.prototype={getContentWorker:function(){var t=new n(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),e=this;return t.on("end",function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),t},getCompressedWorker:function(){return new n(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(t,e,r){return t.pipe(new a).pipe(new s("uncompressedSize")).pipe(e.compressWorker(r)).pipe(new s("compressedSize")).withStreamInfo("compression",e)},e.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,r){"use strict";var i=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(t){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,r){"use strict";var i=t("./utils");var o=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==i.getTypeOf(t)?function(t,e,r,i){var n=o,s=i+r;t^=-1;for(var a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return-1^t}(0|e,t,t.length,0):function(t,e,r,i){var n=o,s=i+r;t^=-1;for(var a=i;a<s;a++)t=t>>>8^n[255&(t^e.charCodeAt(a))];return-1^t}(0|e,t,t.length,0):0}},{"./utils":32}],5:[function(t,e,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,e,r){"use strict";var i=null;i="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:i}},{lie:37}],7:[function(t,e,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=t("pako"),s=t("./utils"),a=t("./stream/GenericWorker"),o=i?"uint8array":"array";function h(t,e){a.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}r.magic="\b\0",s.inherits(h,a),h.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,t.data),!1)},h.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(t){return new h("Deflate",t)},r.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,r){"use strict";function A(t,e){var r,i="";for(r=0;r<e;r++)i+=String.fromCharCode(255&t),t>>>=8;return i}function i(t,e,r,i,n,s){var a,o,h=t.file,u=t.compression,l=s!==O.utf8encode,f=I.transformTo("string",s(h.name)),d=I.transformTo("string",O.utf8encode(h.name)),c=h.comment,p=I.transformTo("string",s(c)),m=I.transformTo("string",O.utf8encode(c)),_=d.length!==h.name.length,g=m.length!==c.length,b="",v="",y="",w=h.dir,k=h.date,x={crc32:0,compressedSize:0,uncompressedSize:0};e&&!r||(x.crc32=t.crc32,x.compressedSize=t.compressedSize,x.uncompressedSize=t.uncompressedSize);var S=0;e&&(S|=8),l||!_&&!g||(S|=2048);var z=0,C=0;w&&(z|=16),"UNIX"===n?(C=798,z|=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16}(h.unixPermissions,w)):(C=20,z|=function(t){return 63&(t||0)}(h.dosPermissions)),a=k.getUTCHours(),a<<=6,a|=k.getUTCMinutes(),a<<=5,a|=k.getUTCSeconds()/2,o=k.getUTCFullYear()-1980,o<<=4,o|=k.getUTCMonth()+1,o<<=5,o|=k.getUTCDate(),_&&(v=A(1,1)+A(B(f),4)+d,b+="up"+A(v.length,2)+v),g&&(y=A(1,1)+A(B(p),4)+m,b+="uc"+A(y.length,2)+y);var E="";return E+="\n\0",E+=A(S,2),E+=u.magic,E+=A(a,2),E+=A(o,2),E+=A(x.crc32,4),E+=A(x.compressedSize,4),E+=A(x.uncompressedSize,4),E+=A(f.length,2),E+=A(b.length,2),{fileRecord:R.LOCAL_FILE_HEADER+E+f+b,dirRecord:R.CENTRAL_FILE_HEADER+A(C,2)+E+A(p.length,2)+"\0\0\0\0"+A(z,4)+A(i,4)+f+b+p}}var I=t("../utils"),n=t("../stream/GenericWorker"),O=t("../utf8"),B=t("../crc32"),R=t("../signature");function s(t,e,r,i){n.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}I.inherits(s,n),s.prototype.push=function(t){var e=t.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,n.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(e+100*(r-i-1))/r:100}}))},s.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var r=i(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},s.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,r=i(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),e)this.push({data:function(t){return R.DATA_DESCRIPTOR+A(t.crc32,4)+A(t.compressedSize,4)+A(t.uncompressedSize,4)}(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},s.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var r=this.bytesWritten-t,i=function(t,e,r,i,n){var s=I.transformTo("string",n(i));return R.CENTRAL_DIRECTORY_END+"\0\0\0\0"+A(t,2)+A(t,2)+A(e,4)+A(r,4)+A(s.length,2)+s}(this.dirRecords.length,r,t,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},s.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},s.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",function(t){e.processChunk(t)}),t.on("end",function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()}),t.on("error",function(t){e.error(t)}),this},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},s.prototype.error=function(t){var e=this._sources;if(!n.prototype.error.call(this,t))return!1;for(var r=0;r<e.length;r++)try{e[r].error(t)}catch(t){}return!0},s.prototype.lock=function(){n.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=s},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,r){"use strict";var u=t("../compressions"),i=t("./ZipFileWorker");r.generateWorker=function(t,a,e){var o=new i(a.streamFiles,e,a.platform,a.encodeFileName),h=0;try{t.forEach(function(t,e){h++;var r=function(t,e){var r=t||e,i=u[r];if(!i)throw new Error(r+" is not a valid compression method !");return i}(e.options.compression,a.compression),i=e.options.compressionOptions||a.compressionOptions||{},n=e.dir,s=e.date;e._compressWorker(r,i).withStreamInfo("file",{name:t,dir:n,date:s,comment:e.comment||"",unixPermissions:e.unixPermissions,dosPermissions:e.dosPermissions}).pipe(o)}),o.entriesCount=h}catch(t){o.error(t)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,r){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.2.0",i.loadAsync=function(t,e){return(new i).loadAsync(t,e)},i.external=t("./external"),e.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,r){"use strict";var i=t("./utils"),n=t("./external"),o=t("./utf8"),h=(i=t("./utils"),t("./zipEntries")),s=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function l(i){return new n.Promise(function(t,e){var r=i.decompressed.getContentWorker().pipe(new s);r.on("error",function(t){e(t)}).on("end",function(){r.streamInfo.crc32!==i.decompressed.crc32?e(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}e.exports=function(t,s){var a=this;return s=i.extend(s||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(t)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",t,!0,s.optimizedBinaryString,s.base64).then(function(t){var e=new h(s);return e.load(t),e}).then(function(t){var e=[n.Promise.resolve(t)],r=t.files;if(s.checkCRC32)for(var i=0;i<r.length;i++)e.push(l(r[i]));return n.Promise.all(e)}).then(function(t){for(var e=t.shift(),r=e.files,i=0;i<r.length;i++){var n=r[i];a.file(n.fileNameStr,n.decompressed,{binary:!0,optimizedBinaryString:!0,date:n.date,dir:n.dir,comment:n.fileCommentStr.length?n.fileCommentStr:null,unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions,createFolders:s.createFolders})}return e.zipComment.length&&(a.comment=e.zipComment),a})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,r){"use strict";var i=t("../utils"),n=t("../stream/GenericWorker");function s(t,e){n.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}i.inherits(s,n),s.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",function(t){e.push({data:t,meta:{percent:0}})}).on("error",function(t){e.isPaused?this.generatedError=t:e.error(t)}).on("end",function(){e.isPaused?e._upstreamEnded=!0:e.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,r){"use strict";var n=t("readable-stream").Readable;function i(t,e,r){n.call(this,e),this._helper=t;var i=this;t.on("data",function(t,e){i.push(t)||i._helper.pause(),r&&r(e)}).on("error",function(t){i.emit("error",t)}).on("end",function(){i.push(null)})}t("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},e.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,e,r){"use strict";e.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(t,e){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new Buffer(t,e)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var e=new Buffer(t);return e.fill(0),e},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,r){"use strict";function s(t,e,r){var i,n=u.getTypeOf(e),s=u.extend(r||{},f);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(t=g(t)),s.createFolders&&(i=_(t))&&b.call(this,i,!0);var a="string"===n&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!a),(e instanceof d&&0===e.uncompressedSize||s.dir||!e||0===e.length)&&(s.base64=!1,s.binary=!0,e="",s.compression="STORE",n="string");var o=null;o=e instanceof d||e instanceof l?e:p.isNode&&p.isStream(e)?new m(t,e):u.prepareContent(t,e,s.binary,s.optimizedBinaryString,s.base64);var h=new c(t,o,s);this.files[t]=h}var n=t("./utf8"),u=t("./utils"),l=t("./stream/GenericWorker"),a=t("./stream/StreamHelper"),f=t("./defaults"),d=t("./compressedObject"),c=t("./zipObject"),o=t("./generate"),p=t("./nodejsUtils"),m=t("./nodejs/NodejsStreamInputAdapter"),_=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return 0<e?t.substring(0,e):""},g=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},b=function(t,e){return e=void 0!==e?e:f.createFolders,t=g(t),this.files[t]||s.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function h(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var i={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,r,i;for(e in this.files)this.files.hasOwnProperty(e)&&(i=this.files[e],(r=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(r,i))},filter:function(r){var i=[];return this.forEach(function(t,e){r(t,e)&&i.push(e)}),i},file:function(t,e,r){if(1!==arguments.length)return t=this.root+t,s.call(this,t,e,r),this;if(h(t)){var i=t;return this.filter(function(t,e){return!e.dir&&i.test(t)})}var n=this.files[this.root+t];return n&&!n.dir?n:null},folder:function(r){if(!r)return this;if(h(r))return this.filter(function(t,e){return e.dir&&r.test(t)});var t=this.root+r,e=b.call(this,t),i=this.clone();return i.root=e.name,i},remove:function(r){r=this.root+r;var t=this.files[r];if(t||("/"!==r.slice(-1)&&(r+="/"),t=this.files[r]),t&&!t.dir)delete this.files[r];else for(var e=this.filter(function(t,e){return e.name.slice(0,r.length)===r}),i=0;i<e.length;i++)delete this.files[e[i].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,r={};try{if((r=u.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");u.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var i=r.comment||this.comment||"";e=o.generateWorker(this,r,i)}catch(t){(e=new l("error")).error(t)}return new a(e,r.type||"string",r.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=i},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,r){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,r){"use strict";var i=t("./DataReader");function n(t){i.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(n,i),n.prototype.byteAt=function(t){return this.data[this.zero+t]},n.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===e&&this.data[s+1]===r&&this.data[s+2]===i&&this.data[s+3]===n)return s-this.zero;return-1},n.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),s=this.readData(4);return e===s[0]&&r===s[1]&&i===s[2]&&n===s[3]},n.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./DataReader":18}],18:[function(t,e,r){"use strict";var i=t("../utils");function n(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return i.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=n},{"../utils":32}],19:[function(t,e,r){"use strict";var i=t("./Uint8ArrayReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,r){"use strict";var i=t("./DataReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},n.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},n.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},n.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./DataReader":18}],21:[function(t,e,r){"use strict";var i=t("./ArrayReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,r){"use strict";var i=t("../utils"),n=t("../support"),s=t("./ArrayReader"),a=t("./StringReader"),o=t("./NodeBufferReader"),h=t("./Uint8ArrayReader");e.exports=function(t){var e=i.getTypeOf(t);return i.checkSupport(e),"string"!==e||n.uint8array?"nodebuffer"===e?new o(t):n.uint8array?new h(i.transformTo("uint8array",t)):new s(i.transformTo("array",t)):new a(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,r){"use strict";var i=t("./GenericWorker"),n=t("../utils");function s(t){i.call(this,"ConvertWorker to "+t),this.destType=t}n.inherits(s,i),s.prototype.processChunk=function(t){this.push({data:n.transformTo(this.destType,t.data),meta:t.meta})},e.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,r){"use strict";var i=t("./GenericWorker"),n=t("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,i),s.prototype.processChunk=function(t){this.streamInfo.crc32=n(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,r){"use strict";var i=t("../utils"),n=t("./GenericWorker");function s(t){n.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}i.inherits(s,n),s.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}n.prototype.processChunk.call(this,t)},e.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,r){"use strict";var i=t("../utils"),n=t("./GenericWorker");function s(t){n.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then(function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=i.getTypeOf(t),e.isPaused||e._tickAndRepeat()},function(t){e.error(t)})}i.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,r){"use strict";function i(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",function(t){e.processChunk(t)}),t.on("end",function(){e.end()}),t.on("error",function(t){e.error(t)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=i},{}],29:[function(t,e,r){"use strict";var h=t("../utils"),n=t("./ConvertWorker"),s=t("./GenericWorker"),u=t("../base64"),i=t("../support"),a=t("../external"),o=null;if(i.nodestream)try{o=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function l(t,o){return new a.Promise(function(e,r){var i=[],n=t._internalType,s=t._outputType,a=t._mimeType;t.on("data",function(t,e){i.push(t),o&&o(e)}).on("error",function(t){i=[],r(t)}).on("end",function(){try{var t=function(t,e,r){switch(t){case"blob":return h.newBlob(h.transformTo("arraybuffer",e),r);case"base64":return u.encode(e);default:return h.transformTo(t,e)}}(s,function(t,e){var r,i=0,n=null,s=0;for(r=0;r<e.length;r++)s+=e[r].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(n=new Uint8Array(s),r=0;r<e.length;r++)n.set(e[r],i),i+=e[r].length;return n;case"nodebuffer":return Buffer.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(n,i),a);e(t)}catch(t){r(t)}i=[]}).resume()})}function f(t,e,r){var i=e;switch(e){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=e,this._mimeType=r,h.checkSupport(i),this._worker=t.pipe(new n(i)),t.lock()}catch(t){this._worker=new s("error"),this._worker.error(t)}}f.prototype={accumulate:function(t){return l(this,t)},on:function(t,e){var r=this;return"data"===t?this._worker.on(t,function(t){e.call(r,t.data,t.meta)}):this._worker.on(t,function(){h.delay(e,arguments,r)}),this},resume:function(){return h.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(h.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new o(this,{objectMode:"nodebuffer"!==this._outputType},t)}},e.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var i=new ArrayBuffer(0);try{r.blob=0===new Blob([i],{type:"application/zip"}).size}catch(t){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(i),r.blob=0===n.getBlob("application/zip").size}catch(t){r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch(t){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,s){"use strict";for(var o=t("./utils"),h=t("./support"),r=t("./nodejsUtils"),i=t("./stream/GenericWorker"),u=new Array(256),n=0;n<256;n++)u[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;u[254]=u[254]=1;function a(){i.call(this,"utf-8 decode"),this.leftOver=null}function l(){i.call(this,"utf-8 encode")}s.utf8encode=function(t){return h.nodebuffer?r.newBufferFrom(t,"utf-8"):function(t){var e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)55296==(64512&(r=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=h.uint8array?new Uint8Array(o):new Array(o),n=s=0;s<o;n++)55296==(64512&(r=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),r<128?e[s++]=r:(r<2048?e[s++]=192|r>>>6:(r<65536?e[s++]=224|r>>>12:(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63),e[s++]=128|r>>>6&63),e[s++]=128|63&r);return e}(t)},s.utf8decode=function(t){return h.nodebuffer?o.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,r,i,n,s=t.length,a=new Array(2*s);for(e=r=0;e<s;)if((i=t[e++])<128)a[r++]=i;else if(4<(n=u[i]))a[r++]=65533,e+=n-1;else{for(i&=2===n?31:3===n?15:7;1<n&&e<s;)i=i<<6|63&t[e++],n--;1<n?a[r++]=65533:i<65536?a[r++]=i:(i-=65536,a[r++]=55296|i>>10&1023,a[r++]=56320|1023&i)}return a.length!==r&&(a.subarray?a=a.subarray(0,r):a.length=r),o.applyFromCharCode(a)}(t=o.transformTo(h.uint8array?"uint8array":"array",t))},o.inherits(a,i),a.prototype.processChunk=function(t){var e=o.transformTo(h.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(h.uint8array){var r=e;(e=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),e.set(r,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var i=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;0<=r&&128==(192&t[r]);)r--;return r<0?e:0===r?e:r+u[t[r]]>e?r:e}(e),n=e;i!==e.length&&(h.uint8array?(n=e.subarray(0,i),this.leftOver=e.subarray(i,e.length)):(n=e.slice(0,i),this.leftOver=e.slice(i,e.length))),this.push({data:s.utf8decode(n),meta:t.meta})},a.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=a,o.inherits(l,i),l.prototype.processChunk=function(t){this.push({data:s.utf8encode(t.data),meta:t.meta})},s.Utf8EncodeWorker=l},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,a){"use strict";var o=t("./support"),h=t("./base64"),r=t("./nodejsUtils"),i=t("set-immediate-shim"),u=t("./external");function n(t){return t}function l(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}a.newBlob=function(e,r){a.checkSupport("blob");try{return new Blob([e],{type:r})}catch(t){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(r)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var s={stringifyByChunk:function(t,e,r){var i=[],n=0,s=t.length;if(s<=r)return String.fromCharCode.apply(null,t);for(;n<s;)"array"===e||"nodebuffer"===e?i.push(String.fromCharCode.apply(null,t.slice(n,Math.min(n+r,s)))):i.push(String.fromCharCode.apply(null,t.subarray(n,Math.min(n+r,s)))),n+=r;return i.join("")},stringifyByChar:function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(t){return!1}}()}};function f(t){var e=65536,r=a.getTypeOf(t),i=!0;if("uint8array"===r?i=s.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=s.applyCanBeUsed.nodebuffer),i)for(;1<e;)try{return s.stringifyByChunk(t,r,e)}catch(t){e=Math.floor(e/2)}return s.stringifyByChar(t)}function d(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}a.applyFromCharCode=f;var c={};c.string={string:n,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return c.string.uint8array(t).buffer},uint8array:function(t){return l(t,new Uint8Array(t.length))},nodebuffer:function(t){return l(t,r.allocBuffer(t.length))}},c.array={string:f,array:n,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return r.newBufferFrom(t)}},c.arraybuffer={string:function(t){return f(new Uint8Array(t))},array:function(t){return d(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:n,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return r.newBufferFrom(new Uint8Array(t))}},c.uint8array={string:f,array:function(t){return d(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:n,nodebuffer:function(t){return r.newBufferFrom(t)}},c.nodebuffer={string:f,array:function(t){return d(t,new Array(t.length))},arraybuffer:function(t){return c.nodebuffer.uint8array(t).buffer},uint8array:function(t){return d(t,new Uint8Array(t.length))},nodebuffer:n},a.transformTo=function(t,e){if(e=e||"",!t)return e;a.checkSupport(t);var r=a.getTypeOf(e);return c[r][t](e)},a.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":o.nodebuffer&&r.isBuffer(t)?"nodebuffer":o.uint8array&&t instanceof Uint8Array?"uint8array":o.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(t){if(!o[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(t){var e,r,i="";for(r=0;r<(t||"").length;r++)i+="\\x"+((e=t.charCodeAt(r))<16?"0":"")+e.toString(16).toUpperCase();return i},a.delay=function(t,e,r){i(function(){t.apply(r||null,e||[])})},a.inherits=function(t,e){function r(){}r.prototype=e.prototype,t.prototype=new r},a.extend=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===r[e]&&(r[e]=arguments[t][e]);return r},a.prepareContent=function(r,t,i,n,s){return u.Promise.resolve(t).then(function(i){return o.blob&&(i instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(i)))&&"undefined"!=typeof FileReader?new u.Promise(function(e,r){var t=new FileReader;t.onload=function(t){e(t.target.result)},t.onerror=function(t){r(t.target.error)},t.readAsArrayBuffer(i)}):i}).then(function(t){var e=a.getTypeOf(t);return e?("arraybuffer"===e?t=a.transformTo("uint8array",t):"string"===e&&(s?t=h.decode(t):i&&!0!==n&&(t=function(t){return l(t,o.uint8array?new Uint8Array(t.length):new Array(t.length))}(t))),t):u.Promise.reject(new Error("Can't read the data of '"+r+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,r){"use strict";var i=t("./reader/readerFor"),n=t("./utils"),s=t("./signature"),a=t("./zipEntry"),o=(t("./utf8"),t("./support"));function h(t){this.files=[],this.loadOptions=t}h.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(e)+", expected "+n.pretty(t)+")")}},isSignature:function(t,e){var r=this.reader.index;this.reader.setIndex(t);var i=this.reader.readString(4)===e;return this.reader.setIndex(r),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=o.uint8array?"uint8array":"array",r=n.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,i=this.zip64EndOfCentralSize-44;0<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(t=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(t<0)throw!this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(t);var e=t;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var i=e-r;if(0<i)this.isSignature(e,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(t){this.reader=i(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,r){"use strict";var i=t("./reader/readerFor"),s=t("./utils"),n=t("./compressedObject"),a=t("./crc32"),o=t("./utf8"),h=t("./compressions"),u=t("./support");function l(t,e){this.options=t,this.loadOptions=e}l.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in h)if(h.hasOwnProperty(e)&&h[e].magic===t)return h[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,r,i,n=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index<n;)e=t.readInt(2),r=t.readInt(2),i=t.readData(r),this.extraFields[e]={id:e,length:r,value:i}},handleUTF8:function(){var t=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var r=s.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var n=s.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(n)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=i(t.value);return 1!==e.readInt(1)?null:a(this.fileName)!==e.readInt(4)?null:o.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=i(t.value);return 1!==e.readInt(1)?null:a(this.fileComment)!==e.readInt(4)?null:o.utf8decode(e.readData(t.length-5))}return null}},e.exports=l},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,r){"use strict";function i(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var s=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),a=t("./utf8"),o=t("./compressedObject"),h=t("./stream/GenericWorker");i.prototype={internalStream:function(t){var e=null,r="string";try{if(!t)throw new Error("No output type specified.");var i="string"===(r=t.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),e=this._decompressWorker();var n=!this._dataBinary;n&&!i&&(e=e.pipe(new a.Utf8EncodeWorker)),!n&&i&&(e=e.pipe(new a.Utf8DecodeWorker))}catch(t){(e=new h("error")).error(t)}return new s(e,r,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof o&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(r,t,e)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof h?this._data:new n(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],l=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<u.length;f++)i.prototype[u[f]]=l;e.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,l,e){(function(e){"use strict";var r,i,t=e.MutationObserver||e.WebKitMutationObserver;if(t){var n=0,s=new t(u),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),r=function(){a.data=n=++n%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var o=new e.MessageChannel;o.port1.onmessage=u,r=function(){o.port2.postMessage(0)}}var h=[];function u(){var t,e;i=!0;for(var r=h.length;r;){for(e=h,h=[],t=-1;++t<r;)e[t]();r=h.length}i=!1}l.exports=function(t){1!==h.push(t)||i||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,r){"use strict";var n=t("immediate");function u(){}var l={},s=["REJECTED"],a=["FULFILLED"],i=["PENDING"];function o(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=i,this.queue=[],this.outcome=void 0,t!==u&&c(this,t)}function h(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(e,r,i){n(function(){var t;try{t=r(i)}catch(t){return l.reject(e,t)}t===e?l.reject(e,new TypeError("Cannot resolve promise with itself")):l.resolve(e,t)})}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function c(e,t){var r=!1;function i(t){r||(r=!0,l.reject(e,t))}function n(t){r||(r=!0,l.resolve(e,t))}var s=p(function(){t(n,i)});"error"===s.status&&i(s.value)}function p(t,e){var r={};try{r.value=t(e),r.status="success"}catch(t){r.status="error",r.value=t}return r}(e.exports=o).prototype.finally=function(e){if("function"!=typeof e)return this;var r=this.constructor;return this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})})},o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===s)return this;var r=new this.constructor(u);this.state!==i?f(r,this.state===a?t:e,this.outcome):this.queue.push(new h(r,t,e));return r},h.prototype.callFulfilled=function(t){l.resolve(this.promise,t)},h.prototype.otherCallFulfilled=function(t){f(this.promise,this.onFulfilled,t)},h.prototype.callRejected=function(t){l.reject(this.promise,t)},h.prototype.otherCallRejected=function(t){f(this.promise,this.onRejected,t)},l.resolve=function(t,e){var r=p(d,e);if("error"===r.status)return l.reject(t,r.value);var i=r.value;if(i)c(t,i);else{t.state=a,t.outcome=e;for(var n=-1,s=t.queue.length;++n<s;)t.queue[n].callFulfilled(e)}return t},l.reject=function(t,e){t.state=s,t.outcome=e;for(var r=-1,i=t.queue.length;++r<i;)t.queue[r].callRejected(e);return t},o.resolve=function(t){if(t instanceof this)return t;return l.resolve(new this(u),t)},o.reject=function(t){var e=new this(u);return l.reject(e,t)},o.all=function(t){var r=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);var s=new Array(i),a=0,e=-1,o=new this(u);for(;++e<i;)h(t[e],e);return o;function h(t,e){r.resolve(t).then(function(t){s[e]=t,++a!==i||n||(n=!0,l.resolve(o,s))},function(t){n||(n=!0,l.reject(o,t))})}},o.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);var n=-1,s=new this(u);for(;++n<r;)a=t[n],e.resolve(a).then(function(t){i||(i=!0,l.resolve(s,t))},function(t){i||(i=!0,l.reject(s,t))});var a;return s}},{immediate:36}],38:[function(t,e,r){"use strict";var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,r){"use strict";var a=t("./zlib/deflate"),o=t("./utils/common"),h=t("./utils/strings"),n=t("./zlib/messages"),s=t("./zlib/zstream"),u=Object.prototype.toString,l=0,f=-1,d=0,c=8;function p(t){if(!(this instanceof p))return new p(t);this.options=o.assign({level:f,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=a.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==l)throw new Error(n[r]);if(e.header&&a.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(i="string"==typeof e.dictionary?h.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(r=a.deflateSetDictionary(this.strm,i))!==l)throw new Error(n[r]);this._dict_set=!0}}function i(t,e){var r=new p(e);if(r.push(t,!0),r.err)throw r.msg||n[r.err];return r.result}p.prototype.push=function(t,e){var r,i,n=this.strm,s=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:!0===e?4:0,"string"==typeof t?n.input=h.string2buf(t):"[object ArrayBuffer]"===u.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new o.Buf8(s),n.next_out=0,n.avail_out=s),1!==(r=a.deflate(n,i))&&r!==l)return this.onEnd(r),!(this.ended=!0);0!==n.avail_out&&(0!==n.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(h.buf2binstring(o.shrinkBuf(n.output,n.next_out))):this.onData(o.shrinkBuf(n.output,n.next_out)))}while((0<n.avail_in||0===n.avail_out)&&1!==r);return 4===i?(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l):2!==i||(this.onEnd(l),!(n.avail_out=0))},p.prototype.onData=function(t){this.chunks.push(t)},p.prototype.onEnd=function(t){t===l&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=p,r.deflate=i,r.deflateRaw=function(t,e){return(e=e||{}).raw=!0,i(t,e)},r.gzip=function(t,e){return(e=e||{}).gzip=!0,i(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,r){"use strict";var d=t("./zlib/inflate"),c=t("./utils/common"),p=t("./utils/strings"),m=t("./zlib/constants"),i=t("./zlib/messages"),n=t("./zlib/zstream"),s=t("./zlib/gzheader"),_=Object.prototype.toString;function a(t){if(!(this instanceof a))return new a(t);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new n,this.strm.avail_out=0;var r=d.inflateInit2(this.strm,e.windowBits);if(r!==m.Z_OK)throw new Error(i[r]);this.header=new s,d.inflateGetHeader(this.strm,this.header)}function o(t,e){var r=new a(e);if(r.push(t,!0),r.err)throw r.msg||i[r.err];return r.result}a.prototype.push=function(t,e){var r,i,n,s,a,o,h=this.strm,u=this.options.chunkSize,l=this.options.dictionary,f=!1;if(this.ended)return!1;i=e===~~e?e:!0===e?m.Z_FINISH:m.Z_NO_FLUSH,"string"==typeof t?h.input=p.binstring2buf(t):"[object ArrayBuffer]"===_.call(t)?h.input=new Uint8Array(t):h.input=t,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new c.Buf8(u),h.next_out=0,h.avail_out=u),(r=d.inflate(h,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&l&&(o="string"==typeof l?p.string2buf(l):"[object ArrayBuffer]"===_.call(l)?new Uint8Array(l):l,r=d.inflateSetDictionary(this.strm,o)),r===m.Z_BUF_ERROR&&!0===f&&(r=m.Z_OK,f=!1),r!==m.Z_STREAM_END&&r!==m.Z_OK)return this.onEnd(r),!(this.ended=!0);h.next_out&&(0!==h.avail_out&&r!==m.Z_STREAM_END&&(0!==h.avail_in||i!==m.Z_FINISH&&i!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(n=p.utf8border(h.output,h.next_out),s=h.next_out-n,a=p.buf2string(h.output,n),h.next_out=s,h.avail_out=u-s,s&&c.arraySet(h.output,h.output,n,s,0),this.onData(a)):this.onData(c.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(f=!0)}while((0<h.avail_in||0===h.avail_out)&&r!==m.Z_STREAM_END);return r===m.Z_STREAM_END&&(i=m.Z_FINISH),i===m.Z_FINISH?(r=d.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m.Z_OK):i!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(h.avail_out=0))},a.prototype.onData=function(t){this.chunks.push(t)},a.prototype.onEnd=function(t){t===m.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Inflate=a,r.inflate=o,r.inflateRaw=function(t,e){return(e=e||{}).raw=!0,o(t,e)},r.ungzip=o},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}}return t},r.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var n={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray)t.set(e.subarray(r,r+i),n);else for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){var e,r,i,n,s,a;for(e=i=0,r=t.length;e<r;e++)i+=t[e].length;for(a=new Uint8Array(i),e=n=0,r=t.length;e<r;e++)s=t[e],a.set(s,n),n+=s.length;return a}},s={arraySet:function(t,e,r,i,n){for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(i)},{}],42:[function(t,e,r){"use strict";var h=t("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var u=new h.Buf8(256),i=0;i<256;i++)u[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;function l(t,e){if(e<65537&&(t.subarray&&s||!t.subarray&&n))return String.fromCharCode.apply(null,h.shrinkBuf(t,e));for(var r="",i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r}u[254]=u[254]=1,r.string2buf=function(t){var e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)55296==(64512&(r=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new h.Buf8(o),n=s=0;s<o;n++)55296==(64512&(r=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(r=65536+(r-55296<<10)+(i-56320),n++),r<128?e[s++]=r:(r<2048?e[s++]=192|r>>>6:(r<65536?e[s++]=224|r>>>12:(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63),e[s++]=128|r>>>6&63),e[s++]=128|63&r);return e},r.buf2binstring=function(t){return l(t,t.length)},r.binstring2buf=function(t){for(var e=new h.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e},r.buf2string=function(t,e){var r,i,n,s,a=e||t.length,o=new Array(2*a);for(r=i=0;r<a;)if((n=t[r++])<128)o[i++]=n;else if(4<(s=u[n]))o[i++]=65533,r+=s-1;else{for(n&=2===s?31:3===s?15:7;1<s&&r<a;)n=n<<6|63&t[r++],s--;1<s?o[i++]=65533:n<65536?o[i++]=n:(n-=65536,o[i++]=55296|n>>10&1023,o[i++]=56320|1023&n)}return l(o,i)},r.utf8border=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;0<=r&&128==(192&t[r]);)r--;return r<0?e:0===r?e:r+u[t[r]]>e?r:e}},{"./common":41}],43:[function(t,e,r){"use strict";e.exports=function(t,e,r,i){for(var n=65535&t|0,s=t>>>16&65535|0,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;s=s+(n=n+e[i++]|0)|0,--a;);n%=65521,s%=65521}return n|s<<16|0}},{}],44:[function(t,e,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,r){"use strict";var o=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e,r,i){var n=o,s=i+r;t^=-1;for(var a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return-1^t}},{}],46:[function(t,e,r){"use strict";var h,d=t("../utils/common"),u=t("./trees"),c=t("./adler32"),p=t("./crc32"),i=t("./messages"),l=0,f=4,m=0,_=-2,g=-1,b=4,n=2,v=8,y=9,s=286,a=30,o=19,w=2*s+1,k=15,x=3,S=258,z=S+x+1,C=42,E=113,A=1,I=2,O=3,B=4;function R(t,e){return t.msg=i[e],e}function T(t){return(t<<1)-(4<t?9:0)}function D(t){for(var e=t.length;0<=--e;)t[e]=0}function F(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(d.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function N(t,e){u._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,F(t.strm)}function U(t,e){t.pending_buf[t.pending++]=e}function P(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function L(t,e){var r,i,n=t.max_chain_length,s=t.strstart,a=t.prev_length,o=t.nice_match,h=t.strstart>t.w_size-z?t.strstart-(t.w_size-z):0,u=t.window,l=t.w_mask,f=t.prev,d=t.strstart+S,c=u[s+a-1],p=u[s+a];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(u[(r=e)+a]===p&&u[r+a-1]===c&&u[r]===u[s]&&u[++r]===u[s+1]){s+=2,r++;do{}while(u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&s<d);if(i=S-(d-s),s=d-S,a<i){if(t.match_start=e,o<=(a=i))break;c=u[s+a-1],p=u[s+a]}}}while((e=f[e&l])>h&&0!=--n);return a<=t.lookahead?a:t.lookahead}function j(t){var e,r,i,n,s,a,o,h,u,l,f=t.w_size;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=f+(f-z)){for(d.arraySet(t.window,t.window,f,f,0),t.match_start-=f,t.strstart-=f,t.block_start-=f,e=r=t.hash_size;i=t.head[--e],t.head[e]=f<=i?i-f:0,--r;);for(e=r=f;i=t.prev[--e],t.prev[e]=f<=i?i-f:0,--r;);n+=f}if(0===t.strm.avail_in)break;if(a=t.strm,o=t.window,h=t.strstart+t.lookahead,u=n,l=void 0,l=a.avail_in,u<l&&(l=u),r=0===l?0:(a.avail_in-=l,d.arraySet(o,a.input,a.next_in,l,h),1===a.state.wrap?a.adler=c(a.adler,o,l,h):2===a.state.wrap&&(a.adler=p(a.adler,o,l,h)),a.next_in+=l,a.total_in+=l,l),t.lookahead+=r,t.lookahead+t.insert>=x)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+x-1])&t.hash_mask,t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<x)););}while(t.lookahead<z&&0!==t.strm.avail_in)}function Z(t,e){for(var r,i;;){if(t.lookahead<z){if(j(t),t.lookahead<z&&e===l)return A;if(0===t.lookahead)break}if(r=0,t.lookahead>=x&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+x-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-z&&(t.match_length=L(t,r)),t.match_length>=x)if(i=u._tr_tally(t,t.strstart-t.match_start,t.match_length-x),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=x){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+x-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=u._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(N(t,!1),0===t.strm.avail_out))return A}return t.insert=t.strstart<x-1?t.strstart:x-1,e===f?(N(t,!0),0===t.strm.avail_out?O:B):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?A:I}function W(t,e){for(var r,i,n;;){if(t.lookahead<z){if(j(t),t.lookahead<z&&e===l)return A;if(0===t.lookahead)break}if(r=0,t.lookahead>=x&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+x-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=x-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-z&&(t.match_length=L(t,r),t.match_length<=5&&(1===t.strategy||t.match_length===x&&4096<t.strstart-t.match_start)&&(t.match_length=x-1)),t.prev_length>=x&&t.match_length<=t.prev_length){for(n=t.strstart+t.lookahead-x,i=u._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-x),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+x-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=x-1,t.strstart++,i&&(N(t,!1),0===t.strm.avail_out))return A}else if(t.match_available){if((i=u._tr_tally(t,0,t.window[t.strstart-1]))&&N(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return A}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=u._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<x-1?t.strstart:x-1,e===f?(N(t,!0),0===t.strm.avail_out?O:B):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?A:I}function M(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*w),this.dyn_dtree=new d.Buf16(2*(2*a+1)),this.bl_tree=new d.Buf16(2*(2*o+1)),D(this.dyn_ltree),D(this.dyn_dtree),D(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(k+1),this.heap=new d.Buf16(2*s+1),D(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*s+1),D(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=n,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?C:E,t.adler=2===e.wrap?0:1,e.last_flush=l,u._tr_init(e),m):R(t,_)}function K(t){var e=G(t);return e===m&&function(t){t.window_size=2*t.w_size,D(t.head),t.max_lazy_match=h[t.level].max_lazy,t.good_match=h[t.level].good_length,t.nice_match=h[t.level].nice_length,t.max_chain_length=h[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=x-1,t.match_available=0,t.ins_h=0}(t.state),e}function Y(t,e,r,i,n,s){if(!t)return _;var a=1;if(e===g&&(e=6),i<0?(a=0,i=-i):15<i&&(a=2,i-=16),n<1||y<n||r!==v||i<8||15<i||e<0||9<e||s<0||b<s)return R(t,_);8===i&&(i=9);var o=new H;return(t.state=o).strm=t,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+x-1)/x),o.window=new d.Buf8(2*o.w_size),o.head=new d.Buf16(o.hash_size),o.prev=new d.Buf16(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new d.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=e,o.strategy=s,o.method=r,K(t)}h=[new M(0,0,0,0,function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(j(t),0===t.lookahead&&e===l)return A;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,N(t,!1),0===t.strm.avail_out))return A;if(t.strstart-t.block_start>=t.w_size-z&&(N(t,!1),0===t.strm.avail_out))return A}return t.insert=0,e===f?(N(t,!0),0===t.strm.avail_out?O:B):(t.strstart>t.block_start&&(N(t,!1),t.strm.avail_out),A)}),new M(4,4,8,4,Z),new M(4,5,16,8,Z),new M(4,6,32,32,Z),new M(4,4,16,16,W),new M(8,16,32,32,W),new M(8,16,128,128,W),new M(8,32,128,256,W),new M(32,128,258,1024,W),new M(32,258,258,4096,W)],r.deflateInit=function(t,e){return Y(t,e,v,15,8,0)},r.deflateInit2=Y,r.deflateReset=K,r.deflateResetKeep=G,r.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?_:(t.state.gzhead=e,m):_},r.deflate=function(t,e){var r,i,n,s;if(!t||!t.state||5<e||e<0)return t?R(t,_):_;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||666===i.status&&e!==f)return R(t,0===t.avail_out?-5:_);if(i.strm=t,r=i.last_flush,i.last_flush=e,i.status===C)if(2===i.wrap)t.adler=0,U(i,31),U(i,139),U(i,8),i.gzhead?(U(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),U(i,255&i.gzhead.time),U(i,i.gzhead.time>>8&255),U(i,i.gzhead.time>>16&255),U(i,i.gzhead.time>>24&255),U(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),U(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(U(i,255&i.gzhead.extra.length),U(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=p(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(U(i,0),U(i,0),U(i,0),U(i,0),U(i,0),U(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),U(i,3),i.status=E);else{var a=v+(i.w_bits-8<<4)<<8;a|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(a|=32),a+=31-a%31,i.status=E,P(i,a),0!==i.strstart&&(P(i,t.adler>>>16),P(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),F(t),n=i.pending,i.pending!==i.pending_buf_size));)U(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),F(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}s=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,U(i,s)}while(0!==s);i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),0===s&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),F(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}s=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,U(i,s)}while(0!==s);i.gzhead.hcrc&&i.pending>n&&(t.adler=p(t.adler,i.pending_buf,i.pending-n,n)),0===s&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&F(t),i.pending+2<=i.pending_buf_size&&(U(i,255&t.adler),U(i,t.adler>>8&255),t.adler=0,i.status=E)):i.status=E),0!==i.pending){if(F(t),0===t.avail_out)return i.last_flush=-1,m}else if(0===t.avail_in&&T(e)<=T(r)&&e!==f)return R(t,-5);if(666===i.status&&0!==t.avail_in)return R(t,-5);if(0!==t.avail_in||0!==i.lookahead||e!==l&&666!==i.status){var o=2===i.strategy?function(t,e){for(var r;;){if(0===t.lookahead&&(j(t),0===t.lookahead)){if(e===l)return A;break}if(t.match_length=0,r=u._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(N(t,!1),0===t.strm.avail_out))return A}return t.insert=0,e===f?(N(t,!0),0===t.strm.avail_out?O:B):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?A:I}(i,e):3===i.strategy?function(t,e){for(var r,i,n,s,a=t.window;;){if(t.lookahead<=S){if(j(t),t.lookahead<=S&&e===l)return A;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=x&&0<t.strstart&&(i=a[n=t.strstart-1])===a[++n]&&i===a[++n]&&i===a[++n]){s=t.strstart+S;do{}while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<s);t.match_length=S-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=x?(r=u._tr_tally(t,1,t.match_length-x),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=u._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(N(t,!1),0===t.strm.avail_out))return A}return t.insert=0,e===f?(N(t,!0),0===t.strm.avail_out?O:B):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?A:I}(i,e):h[i.level].func(i,e);if(o!==O&&o!==B||(i.status=666),o===A||o===O)return 0===t.avail_out&&(i.last_flush=-1),m;if(o===I&&(1===e?u._tr_align(i):5!==e&&(u._tr_stored_block(i,0,0,!1),3===e&&(D(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),F(t),0===t.avail_out))return i.last_flush=-1,m}return e!==f?m:i.wrap<=0?1:(2===i.wrap?(U(i,255&t.adler),U(i,t.adler>>8&255),U(i,t.adler>>16&255),U(i,t.adler>>24&255),U(i,255&t.total_in),U(i,t.total_in>>8&255),U(i,t.total_in>>16&255),U(i,t.total_in>>24&255)):(P(i,t.adler>>>16),P(i,65535&t.adler)),F(t),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?m:1)},r.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==C&&69!==e&&73!==e&&91!==e&&103!==e&&e!==E&&666!==e?R(t,_):(t.state=null,e===E?R(t,-3):m):_},r.deflateSetDictionary=function(t,e){var r,i,n,s,a,o,h,u,l=e.length;if(!t||!t.state)return _;if(2===(s=(r=t.state).wrap)||1===s&&r.status!==C||r.lookahead)return _;for(1===s&&(t.adler=c(t.adler,e,l,0)),r.wrap=0,l>=r.w_size&&(0===s&&(D(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new d.Buf8(r.w_size),d.arraySet(u,e,l-r.w_size,r.w_size,0),e=u,l=r.w_size),a=t.avail_in,o=t.next_in,h=t.input,t.avail_in=l,t.next_in=0,t.input=e,j(r);r.lookahead>=x;){for(i=r.strstart,n=r.lookahead-(x-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+x-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++,--n;);r.strstart=i,r.lookahead=x-1,j(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=x-1,r.match_available=0,t.next_in=o,t.input=h,t.avail_in=a,r.wrap=s,m},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,r){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,r){"use strict";e.exports=function(t,e){var r,i,n,s,a,o,h,u,l,f,d,c,p,m,_,g,b,v,y,w,k,x,S,z,C;r=t.state,i=t.next_in,z=t.input,n=i+(t.avail_in-5),s=t.next_out,C=t.output,a=s-(e-t.avail_out),o=s+(t.avail_out-257),h=r.dmax,u=r.wsize,l=r.whave,f=r.wnext,d=r.window,c=r.hold,p=r.bits,m=r.lencode,_=r.distcode,g=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;t:do{p<15&&(c+=z[i++]<<p,p+=8,c+=z[i++]<<p,p+=8),v=m[c&g];e:for(;;){if(c>>>=y=v>>>24,p-=y,0===(y=v>>>16&255))C[s++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=m[(65535&v)+(c&(1<<y)-1)];continue e}if(32&y){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}w=65535&v,(y&=15)&&(p<y&&(c+=z[i++]<<p,p+=8),w+=c&(1<<y)-1,c>>>=y,p-=y),p<15&&(c+=z[i++]<<p,p+=8,c+=z[i++]<<p,p+=8),v=_[c&b];r:for(;;){if(c>>>=y=v>>>24,p-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=_[(65535&v)+(c&(1<<y)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(k=65535&v,p<(y&=15)&&(c+=z[i++]<<p,(p+=8)<y&&(c+=z[i++]<<p,p+=8)),h<(k+=c&(1<<y)-1)){t.msg="invalid distance too far back",r.mode=30;break t}if(c>>>=y,p-=y,(y=s-a)<k){if(l<(y=k-y)&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(S=d,(x=0)===f){if(x+=u-y,y<w){for(w-=y;C[s++]=d[x++],--y;);x=s-k,S=C}}else if(f<y){if(x+=u+f-y,(y-=f)<w){for(w-=y;C[s++]=d[x++],--y;);if(x=0,f<w){for(w-=y=f;C[s++]=d[x++],--y;);x=s-k,S=C}}}else if(x+=f-y,y<w){for(w-=y;C[s++]=d[x++],--y;);x=s-k,S=C}for(;2<w;)C[s++]=S[x++],C[s++]=S[x++],C[s++]=S[x++],w-=3;w&&(C[s++]=S[x++],1<w&&(C[s++]=S[x++]))}else{for(x=s-k;C[s++]=C[x++],C[s++]=C[x++],C[s++]=C[x++],2<(w-=3););w&&(C[s++]=C[x++],1<w&&(C[s++]=C[x++]))}break}}break}}while(i<n&&s<o);i-=w=p>>3,c&=(1<<(p-=w<<3))-1,t.next_in=i,t.next_out=s,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=s<o?o-s+257:257-(s-o),r.hold=c,r.bits=p}},{}],49:[function(t,e,r){"use strict";var I=t("../utils/common"),O=t("./adler32"),B=t("./crc32"),R=t("./inffast"),T=t("./inftrees"),D=1,F=2,N=0,U=-2,P=1,i=852,n=592;function L(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function s(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new I.Buf16(320),this.work=new I.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=P,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new I.Buf32(i),e.distcode=e.distdyn=new I.Buf32(n),e.sane=1,e.back=-1,N):U}function o(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,a(t)):U}function h(t,e){var r,i;return t&&t.state?(i=t.state,e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?U:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,o(t))):U}function u(t,e){var r,i;return t?(i=new s,(t.state=i).window=null,(r=h(t,e))!==N&&(t.state=null),r):U}var l,f,d=!0;function j(t){if(d){var e;for(l=new I.Buf32(512),f=new I.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(T(D,t.lens,0,288,l,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;T(F,t.lens,0,32,f,0,t.work,{bits:5}),d=!1}t.lencode=l,t.lenbits=9,t.distcode=f,t.distbits=5}function Z(t,e,r,i){var n,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new I.Buf8(s.wsize)),i>=s.wsize?(I.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(i<(n=s.wsize-s.wnext)&&(n=i),I.arraySet(s.window,e,r-i,n,s.wnext),(i-=n)?(I.arraySet(s.window,e,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}r.inflateReset=o,r.inflateReset2=h,r.inflateResetKeep=a,r.inflateInit=function(t){return u(t,15)},r.inflateInit2=u,r.inflate=function(t,e){var r,i,n,s,a,o,h,u,l,f,d,c,p,m,_,g,b,v,y,w,k,x,S,z,C=0,E=new I.Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return U;12===(r=t.state).mode&&(r.mode=13),a=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,u=r.hold,l=r.bits,f=o,d=h,x=N;t:for(;;)switch(r.mode){case P:if(0===r.wrap){r.mode=13;break}for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(2&r.wrap&&35615===u){E[r.check=0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0),l=u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=30;break}if(8!=(15&u)){t.msg="unknown compression method",r.mode=30;break}if(l-=4,k=8+(15&(u>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){t.msg="invalid window size",r.mode=30;break}r.dmax=1<<k,t.adler=r.check=1,r.mode=512&u?10:12,l=u=0;break;case 2:for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(r.flags=u,8!=(255&r.flags)){t.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0,r.mode=3;case 3:for(;l<32;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.head&&(r.head.time=u),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=B(r.check,E,4,0)),l=u=0,r.mode=4;case 4:for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0,r.mode=5;case 5:if(1024&r.flags){for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(o<(c=r.length)&&(c=o),c&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),I.arraySet(r.head.extra,i,s,c,k)),512&r.flags&&(r.check=B(r.check,i,c,s)),o-=c,s+=c,r.length-=c),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break t;for(c=0;k=i[s+c++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k)),k&&c<o;);if(512&r.flags&&(r.check=B(r.check,i,c,s)),o-=c,s+=c,k)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break t;for(c=0;k=i[s+c++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k)),k&&c<o;);if(512&r.flags&&(r.check=B(r.check,i,c,s)),o-=c,s+=c,k)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;l<16;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(u!==(65535&r.check)){t.msg="header crc mismatch",r.mode=30;break}l=u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=12;break;case 10:for(;l<32;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}t.adler=r.check=L(u),l=u=0,r.mode=11;case 11:if(0===r.havedict)return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=u,r.bits=l,2;t.adler=r.check=1,r.mode=12;case 12:if(5===e||6===e)break t;case 13:if(r.last){u>>>=7&l,l-=7&l,r.mode=27;break}for(;l<3;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}switch(r.last=1&u,l-=1,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if(j(r),r.mode=20,6!==e)break;u>>>=2,l-=2;break t;case 2:r.mode=17;break;case 3:t.msg="invalid block type",r.mode=30}u>>>=2,l-=2;break;case 14:for(u>>>=7&l,l-=7&l;l<32;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&u,l=u=0,r.mode=15,6===e)break t;case 15:r.mode=16;case 16:if(c=r.length){if(o<c&&(c=o),h<c&&(c=h),0===c)break t;I.arraySet(n,i,s,c,a),o-=c,s+=c,h-=c,a+=c,r.length-=c;break}r.mode=12;break;case 17:for(;l<14;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(r.nlen=257+(31&u),u>>>=5,l-=5,r.ndist=1+(31&u),u>>>=5,l-=5,r.ncode=4+(15&u),u>>>=4,l-=4,286<r.nlen||30<r.ndist){t.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;l<3;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.lens[A[r.have++]]=7&u,u>>>=3,l-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},x=T(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,x){t.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(C=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(b<16)u>>>=_,l-=_,r.lens[r.have++]=b;else{if(16===b){for(z=_+2;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(u>>>=_,l-=_,0===r.have){t.msg="invalid bit length repeat",r.mode=30;break}k=r.lens[r.have-1],c=3+(3&u),u>>>=2,l-=2}else if(17===b){for(z=_+3;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}l-=_,k=0,c=3+(7&(u>>>=_)),u>>>=3,l-=3}else{for(z=_+7;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}l-=_,k=0,c=11+(127&(u>>>=_)),u>>>=7,l-=7}if(r.have+c>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=30;break}for(;c--;)r.lens[r.have++]=k}}if(30===r.mode)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,S={bits:r.lenbits},x=T(D,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,x){t.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},x=T(F,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,x){t.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===e)break t;case 20:r.mode=21;case 21:if(6<=o&&258<=h){t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=u,r.bits=l,R(t,d),a=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,u=r.hold,l=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;g=(C=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(g&&0==(240&g)){for(v=_,y=g,w=b;g=(C=r.lencode[w+((u&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,r.back+=v}if(u>>>=_,l-=_,r.back+=_,r.length=b,0===g){r.mode=26;break}if(32&g){r.back=-1,r.mode=12;break}if(64&g){t.msg="invalid literal/length code",r.mode=30;break}r.extra=15&g,r.mode=22;case 22:if(r.extra){for(z=r.extra;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(C=r.distcode[u&(1<<r.distbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(0==(240&g)){for(v=_,y=g,w=b;g=(C=r.distcode[w+((u&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,r.back+=v}if(u>>>=_,l-=_,r.back+=_,64&g){t.msg="invalid distance code",r.mode=30;break}r.offset=b,r.extra=15&g,r.mode=24;case 24:if(r.extra){for(z=r.extra;l<z;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===h)break t;if(c=d-h,r.offset>c){if((c=r.offset-c)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=30;break}p=c>r.wnext?(c-=r.wnext,r.wsize-c):r.wnext-c,c>r.length&&(c=r.length),m=r.window}else m=n,p=a-r.offset,c=r.length;for(h<c&&(c=h),h-=c,r.length-=c;n[a++]=m[p++],--c;);0===r.length&&(r.mode=21);break;case 26:if(0===h)break t;n[a++]=r.length,h--,r.mode=21;break;case 27:if(r.wrap){for(;l<32;){if(0===o)break t;o--,u|=i[s++]<<l,l+=8}if(d-=h,t.total_out+=d,r.total+=d,d&&(t.adler=r.check=r.flags?B(r.check,n,d,a-d):O(r.check,n,d,a-d)),d=h,(r.flags?u:L(u))!==r.check){t.msg="incorrect data check",r.mode=30;break}l=u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;l<32;){if(0===o)break t;o--,u+=i[s++]<<l,l+=8}if(u!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=30;break}l=u=0}r.mode=29;case 29:x=1;break t;case 30:x=-3;break t;case 31:return-4;case 32:default:return U}return t.next_out=a,t.avail_out=h,t.next_in=s,t.avail_in=o,r.hold=u,r.bits=l,(r.wsize||d!==t.avail_out&&r.mode<30&&(r.mode<27||4!==e))&&Z(t,t.output,t.next_out,d-t.avail_out)?(r.mode=31,-4):(f-=t.avail_in,d-=t.avail_out,t.total_in+=f,t.total_out+=d,r.total+=d,r.wrap&&d&&(t.adler=r.check=r.flags?B(r.check,n,d,t.next_out-d):O(r.check,n,d,t.next_out-d)),t.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==f&&0===d||4===e)&&x===N&&(x=-5),x)},r.inflateEnd=function(t){if(!t||!t.state)return U;var e=t.state;return e.window&&(e.window=null),t.state=null,N},r.inflateGetHeader=function(t,e){var r;return t&&t.state?0==(2&(r=t.state).wrap)?U:((r.head=e).done=!1,N):U},r.inflateSetDictionary=function(t,e){var r,i=e.length;return t&&t.state?0!==(r=t.state).wrap&&11!==r.mode?U:11===r.mode&&O(1,e,i,0)!==r.check?-3:Z(t,e,i,i)?(r.mode=31,-4):(r.havedict=1,N):U},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,r){"use strict";var D=t("../utils/common"),F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],N=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,r,i,n,s,a,o){var h,u,l,f,d,c,p,m,_,g=o.bits,b=0,v=0,y=0,w=0,k=0,x=0,S=0,z=0,C=0,E=0,A=null,I=0,O=new D.Buf16(16),B=new D.Buf16(16),R=null,T=0;for(b=0;b<=15;b++)O[b]=0;for(v=0;v<i;v++)O[e[r+v]]++;for(k=g,w=15;1<=w&&0===O[w];w--);if(w<k&&(k=w),0===w)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(y=1;y<w&&0===O[y];y++);for(k<y&&(k=y),b=z=1;b<=15;b++)if(z<<=1,(z-=O[b])<0)return-1;if(0<z&&(0===t||1!==w))return-1;for(B[1]=0,b=1;b<15;b++)B[b+1]=B[b]+O[b];for(v=0;v<i;v++)0!==e[r+v]&&(a[B[e[r+v]]++]=v);if(c=0===t?(A=R=a,19):1===t?(A=F,I-=257,R=N,T-=257,256):(A=U,R=P,-1),b=y,d=s,S=v=E=0,l=-1,f=(C=1<<(x=k))-1,1===t&&852<C||2===t&&592<C)return 1;for(;;){for(p=b-S,_=a[v]<c?(m=0,a[v]):a[v]>c?(m=R[T+a[v]],A[I+a[v]]):(m=96,0),h=1<<b-S,y=u=1<<x;n[d+(E>>S)+(u-=h)]=p<<24|m<<16|_|0,0!==u;);for(h=1<<b-1;E&h;)h>>=1;if(0!==h?(E&=h-1,E+=h):E=0,v++,0==--O[b]){if(b===w)break;b=e[r+a[v]]}if(k<b&&(E&f)!==l){for(0===S&&(S=k),d+=y,z=1<<(x=b-S);x+S<w&&!((z-=O[x+S])<=0);)x++,z<<=1;if(C+=1<<x,1===t&&852<C||2===t&&592<C)return 1;n[l=E&f]=k<<24|x<<16|d-s|0}}return 0!==E&&(n[d+E]=b-S<<24|64<<16|0),o.bits=k,0}},{"../utils/common":41}],51:[function(t,e,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,r){"use strict";var n=t("../utils/common"),o=0,h=1;function i(t){for(var e=t.length;0<=--e;)t[e]=0}var s=0,a=29,u=256,l=u+1+a,f=30,d=19,_=2*l+1,g=15,c=16,p=7,m=256,b=16,v=17,y=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(l+2));i(z);var C=new Array(2*f);i(C);var E=new Array(512);i(E);var A=new Array(256);i(A);var I=new Array(a);i(I);var O,B,R,T=new Array(f);function D(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}function F(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function N(t){return t<256?E[t]:E[256+(t>>>7)]}function U(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function P(t,e,r){t.bi_valid>c-r?(t.bi_buf|=e<<t.bi_valid&65535,U(t,t.bi_buf),t.bi_buf=e>>c-t.bi_valid,t.bi_valid+=r-c):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function L(t,e,r){P(t,r[2*e],r[2*e+1])}function j(t,e){for(var r=0;r|=1&t,t>>>=1,r<<=1,0<--e;);return r>>>1}function Z(t,e,r){var i,n,s=new Array(g+1),a=0;for(i=1;i<=g;i++)s[i]=a=a+r[i-1]<<1;for(n=0;n<=e;n++){var o=t[2*n+1];0!==o&&(t[2*n]=j(s[o]++,o))}}function W(t){var e;for(e=0;e<l;e++)t.dyn_ltree[2*e]=0;for(e=0;e<f;e++)t.dyn_dtree[2*e]=0;for(e=0;e<d;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*m]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function M(t){8<t.bi_valid?U(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function H(t,e,r,i){var n=2*e,s=2*r;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]}function G(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&H(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!H(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function K(t,e,r){var i,n,s,a,o=0;if(0!==t.last_lit)for(;i=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],n=t.pending_buf[t.l_buf+o],o++,0===i?L(t,n,e):(L(t,(s=A[n])+u+1,e),0!==(a=w[s])&&P(t,n-=I[s],a),L(t,s=N(--i),r),0!==(a=k[s])&&P(t,i-=T[s],a)),o<t.last_lit;);L(t,m,e)}function Y(t,e){var r,i,n,s=e.dyn_tree,a=e.stat_desc.static_tree,o=e.stat_desc.has_stree,h=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=_,r=0;r<h;r++)0!==s[2*r]?(t.heap[++t.heap_len]=u=r,t.depth[r]=0):s[2*r+1]=0;for(;t.heap_len<2;)s[2*(n=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[n]=0,t.opt_len--,o&&(t.static_len-=a[2*n+1]);for(e.max_code=u,r=t.heap_len>>1;1<=r;r--)G(t,s,r);for(n=h;r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],G(t,s,1),i=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=i,s[2*n]=s[2*r]+s[2*i],t.depth[n]=(t.depth[r]>=t.depth[i]?t.depth[r]:t.depth[i])+1,s[2*r+1]=s[2*i+1]=n,t.heap[1]=n++,G(t,s,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,i,n,s,a,o,h=e.dyn_tree,u=e.max_code,l=e.stat_desc.static_tree,f=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,c=e.stat_desc.extra_base,p=e.stat_desc.max_length,m=0;for(s=0;s<=g;s++)t.bl_count[s]=0;for(h[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<_;r++)p<(s=h[2*h[2*(i=t.heap[r])+1]+1]+1)&&(s=p,m++),h[2*i+1]=s,u<i||(t.bl_count[s]++,a=0,c<=i&&(a=d[i-c]),o=h[2*i],t.opt_len+=o*(s+a),f&&(t.static_len+=o*(l[2*i+1]+a)));if(0!==m){do{for(s=p-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[p]--,m-=2}while(0<m);for(s=p;0!==s;s--)for(i=t.bl_count[s];0!==i;)u<(n=t.heap[--r])||(h[2*n+1]!==s&&(t.opt_len+=(s-h[2*n+1])*h[2*n],h[2*n+1]=s),i--)}}(t,e),Z(s,u,t.bl_count)}function X(t,e,r){var i,n,s=-1,a=e[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),e[2*(r+1)+1]=65535,i=0;i<=r;i++)n=a,a=e[2*(i+1)+1],++o<h&&n===a||(o<u?t.bl_tree[2*n]+=o:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[2*b]++):o<=10?t.bl_tree[2*v]++:t.bl_tree[2*y]++,s=n,u=(o=0)===a?(h=138,3):n===a?(h=6,3):(h=7,4))}function V(t,e,r){var i,n,s=-1,a=e[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),i=0;i<=r;i++)if(n=a,a=e[2*(i+1)+1],!(++o<h&&n===a)){if(o<u)for(;L(t,n,t.bl_tree),0!=--o;);else 0!==n?(n!==s&&(L(t,n,t.bl_tree),o--),L(t,b,t.bl_tree),P(t,o-3,2)):o<=10?(L(t,v,t.bl_tree),P(t,o-3,3)):(L(t,y,t.bl_tree),P(t,o-11,7));s=n,u=(o=0)===a?(h=138,3):n===a?(h=6,3):(h=7,4)}}i(T);var q=!1;function J(t,e,r,i){P(t,(s<<1)+(i?1:0),3),function(t,e,r,i){M(t),i&&(U(t,r),U(t,~r)),n.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}(t,e,r,!0)}r._tr_init=function(t){q||(function(){var t,e,r,i,n,s=new Array(g+1);for(i=r=0;i<a-1;i++)for(I[i]=r,t=0;t<1<<w[i];t++)A[r++]=i;for(A[r-1]=i,i=n=0;i<16;i++)for(T[i]=n,t=0;t<1<<k[i];t++)E[n++]=i;for(n>>=7;i<f;i++)for(T[i]=n<<7,t=0;t<1<<k[i]-7;t++)E[256+n++]=i;for(e=0;e<=g;e++)s[e]=0;for(t=0;t<=143;)z[2*t+1]=8,t++,s[8]++;for(;t<=255;)z[2*t+1]=9,t++,s[9]++;for(;t<=279;)z[2*t+1]=7,t++,s[7]++;for(;t<=287;)z[2*t+1]=8,t++,s[8]++;for(Z(z,l+1,s),t=0;t<f;t++)C[2*t+1]=5,C[2*t]=j(t,5);O=new D(z,w,u+1,l,g),B=new D(C,k,0,f,g),R=new D(new Array(0),x,0,d,p)}(),q=!0),t.l_desc=new F(t.dyn_ltree,O),t.d_desc=new F(t.dyn_dtree,B),t.bl_desc=new F(t.bl_tree,R),t.bi_buf=0,t.bi_valid=0,W(t)},r._tr_stored_block=J,r._tr_flush_block=function(t,e,r,i){var n,s,a=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return o;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return h;for(e=32;e<u;e++)if(0!==t.dyn_ltree[2*e])return h;return o}(t)),Y(t,t.l_desc),Y(t,t.d_desc),a=function(t){var e;for(X(t,t.dyn_ltree,t.l_desc.max_code),X(t,t.dyn_dtree,t.d_desc.max_code),Y(t,t.bl_desc),e=d-1;3<=e&&0===t.bl_tree[2*S[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),n=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==e?J(t,e,r,i):4===t.strategy||s===n?(P(t,2+(i?1:0),3),K(t,z,C)):(P(t,4+(i?1:0),3),function(t,e,r,i){var n;for(P(t,e-257,5),P(t,r-1,5),P(t,i-4,4),n=0;n<i;n++)P(t,t.bl_tree[2*S[n]+1],3);V(t,t.dyn_ltree,e-1),V(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),K(t,t.dyn_ltree,t.dyn_dtree)),W(t),i&&M(t)},r._tr_tally=function(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(A[r]+u+1)]++,t.dyn_dtree[2*N(e)]++),t.last_lit===t.lit_bufsize-1},r._tr_align=function(t){P(t,2,3),L(t,m,z),function(t){16===t.bi_valid?(U(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,r){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,r){"use strict";e.exports="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)});
\ No newline at end of file
Index: src/main/resources/static/static/lib/file-saver/FileSaver.min.js.map
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/file-saver/FileSaver.min.js.map	(date 1594749336108)
+++ src/main/resources/static/static/lib/file-saver/FileSaver.min.js.map	(date 1594749336108)
@@ -0,0 +1,1 @@
+{"version":3,"sources":["../src/FileSaver.js"],"names":[],"mappings":"uLAkBA,QAAS,CAAA,CAAT,CAAc,CAAd,CAAoB,CAApB,CAA0B,OACJ,WAAhB,QAAO,CAAA,CADa,CACS,CAAI,CAAG,CAAE,OAAO,GAAT,CADhB,CAEC,QAAhB,QAAO,CAAA,CAFQ,GAGtB,OAAO,CAAC,IAAR,CAAa,oDAAb,CAHsB,CAItB,CAAI,CAAG,CAAE,OAAO,CAAE,CAAC,CAAZ,CAJe,EASpB,CAAI,CAAC,OAAL,EAAgB,6EAA6E,IAA7E,CAAkF,CAAI,CAAC,IAAvF,CATI,CAUf,GAAI,CAAA,IAAJ,CAAS,UAA8B,CAA9B,CAAT,CAA8C,CAAE,IAAI,CAAE,CAAI,CAAC,IAAb,CAA9C,CAVe,CAYjB,CACR,CAED,QAAS,CAAA,CAAT,CAAmB,CAAnB,CAAwB,CAAxB,CAA8B,CAA9B,CAAoC,CAClC,GAAI,CAAA,CAAG,CAAG,GAAI,CAAA,cAAd,CACA,CAAG,CAAC,IAAJ,CAAS,KAAT,CAAgB,CAAhB,CAFkC,CAGlC,CAAG,CAAC,YAAJ,CAAmB,MAHe,CAIlC,CAAG,CAAC,MAAJ,CAAa,UAAY,CACvB,CAAM,CAAC,CAAG,CAAC,QAAL,CAAe,CAAf,CAAqB,CAArB,CACP,CANiC,CAOlC,CAAG,CAAC,OAAJ,CAAc,UAAY,CACxB,OAAO,CAAC,KAAR,CAAc,yBAAd,CACD,CATiC,CAUlC,CAAG,CAAC,IAAJ,EACD,CAED,QAAS,CAAA,CAAT,CAAsB,CAAtB,CAA2B,CACzB,GAAI,CAAA,CAAG,CAAG,GAAI,CAAA,cAAd,CAEA,CAAG,CAAC,IAAJ,CAAS,MAAT,CAAiB,CAAjB,IAHyB,CAIzB,GAAI,CACF,CAAG,CAAC,IAAJ,EACD,CAAC,MAAO,CAAP,CAAU,CAAE,CACd,MAAqB,IAAd,EAAA,CAAG,CAAC,MAAJ,EAAmC,GAAd,EAAA,CAAG,CAAC,MACjC,CAGD,QAAS,CAAA,CAAT,CAAgB,CAAhB,CAAsB,CACpB,GAAI,CACF,CAAI,CAAC,aAAL,CAAmB,GAAI,CAAA,UAAJ,CAAe,OAAf,CAAnB,CACD,CAAC,MAAO,CAAP,CAAU,CACV,GAAI,CAAA,CAAG,CAAG,QAAQ,CAAC,WAAT,CAAqB,aAArB,CAAV,CACA,CAAG,CAAC,cAAJ,CAAmB,OAAnB,OAAwC,MAAxC,CAAgD,CAAhD,CAAmD,CAAnD,CAAsD,CAAtD,CAAyD,EAAzD,CACsB,EADtB,aACsD,CADtD,CACyD,IADzD,CAFU,CAIV,CAAI,CAAC,aAAL,CAAmB,CAAnB,CACD,CACF,C,GAtDG,CAAA,CAAO,CAAqB,QAAlB,QAAO,CAAA,MAAP,EAA8B,MAAM,CAAC,MAAP,GAAkB,MAAhD,CACV,MADU,CACe,QAAhB,QAAO,CAAA,IAAP,EAA4B,IAAI,CAAC,IAAL,GAAc,IAA1C,CACT,IADS,CACgB,QAAlB,QAAO,CAAA,MAAP,EAA8B,MAAM,CAAC,MAAP,GAAkB,MAAhD,CACP,MADO,O,CAuDP,CAAQ,CAAG,cAAc,IAAd,CAAmB,SAAS,CAAC,SAA7B,C,CAEX,CAAM,CAAG,CAAO,CAAC,MAAR,GAEQ,QAAlB,QAAO,CAAA,MAAP,EAA8B,MAAM,GAAK,CAA1C,CACI,UAAmB,CAAc,CADrC,CAIG,YAAc,CAAA,iBAAiB,CAAC,SAAhC,EAA6C,CAAC,CAA/C,CACA,SAAiB,CAAjB,CAAuB,CAAvB,CAA6B,CAA7B,CAAmC,IAC/B,CAAA,CAAG,CAAG,CAAO,CAAC,GAAR,EAAe,CAAO,CAAC,SADE,CAE/B,CAAC,CAAG,QAAQ,CAAC,aAAT,CAAuB,GAAvB,CAF2B,CAGnC,CAAI,CAAG,CAAI,EAAI,CAAI,CAAC,IAAb,EAAqB,UAHO,CAKnC,CAAC,CAAC,QAAF,CAAa,CALsB,CAMnC,CAAC,CAAC,GAAF,CAAQ,UAN2B,CAWf,QAAhB,QAAO,CAAA,CAXwB,EAajC,CAAC,CAAC,IAAF,CAAS,CAbwB,CAc7B,CAAC,CAAC,MAAF,GAAa,QAAQ,CAAC,MAdO,CAmB/B,CAAK,CAAC,CAAD,CAnB0B,CAe/B,CAAW,CAAC,CAAC,CAAC,IAAH,CAAX,CACI,CAAQ,CAAC,CAAD,CAAO,CAAP,CAAa,CAAb,CADZ,CAEI,CAAK,CAAC,CAAD,CAAI,CAAC,CAAC,MAAF,CAAW,QAAf,CAjBsB,GAuBjC,CAAC,CAAC,IAAF,CAAS,CAAG,CAAC,eAAJ,CAAoB,CAApB,CAvBwB,CAwBjC,UAAU,CAAC,UAAY,CAAE,CAAG,CAAC,eAAJ,CAAoB,CAAC,CAAC,IAAtB,CAA6B,CAA5C,CAA8C,GAA9C,CAxBuB,CAyBjC,UAAU,CAAC,UAAY,CAAE,CAAK,CAAC,CAAD,CAAK,CAAzB,CAA2B,CAA3B,CAzBuB,CA2BpC,CA5BC,CA+BA,oBAAsB,CAAA,SAAtB,CACA,SAAiB,CAAjB,CAAuB,CAAvB,CAA6B,CAA7B,CAAmC,CAGnC,GAFA,CAAI,CAAG,CAAI,EAAI,CAAI,CAAC,IAAb,EAAqB,UAE5B,CAAoB,QAAhB,QAAO,CAAA,CAAX,CAUE,SAAS,CAAC,gBAAV,CAA2B,CAAG,CAAC,CAAD,CAAO,CAAP,CAA9B,CAA4C,CAA5C,CAVF,KACE,IAAI,CAAW,CAAC,CAAD,CAAf,CACE,CAAQ,CAAC,CAAD,CAAO,CAAP,CAAa,CAAb,CADV,KAEO,CACL,GAAI,CAAA,CAAC,CAAG,QAAQ,CAAC,aAAT,CAAuB,GAAvB,CAAR,CACA,CAAC,CAAC,IAAF,CAAS,CAFJ,CAGL,CAAC,CAAC,MAAF,CAAW,QAHN,CAIL,UAAU,CAAC,UAAY,CAAE,CAAK,CAAC,CAAD,CAAK,CAAzB,CACX,CAIJ,CAhBC,CAmBA,SAAiB,CAAjB,CAAuB,CAAvB,CAA6B,CAA7B,CAAmC,CAAnC,CAA0C,CAS1C,GANA,CAAK,CAAG,CAAK,EAAI,IAAI,CAAC,EAAD,CAAK,QAAL,CAMrB,CALI,CAKJ,GAJE,CAAK,CAAC,QAAN,CAAe,KAAf,CACA,CAAK,CAAC,QAAN,CAAe,IAAf,CAAoB,SAApB,CAAgC,gBAGlC,EAAoB,QAAhB,QAAO,CAAA,CAAX,CAA8B,MAAO,CAAA,CAAQ,CAAC,CAAD,CAAO,CAAP,CAAa,CAAb,CAAf,CATY,GAWtC,CAAA,CAAK,CAAiB,0BAAd,GAAA,CAAI,CAAC,IAXyB,CAYtC,CAAQ,CAAG,eAAe,IAAf,CAAoB,CAAO,CAAC,WAA5B,GAA4C,CAAO,CAAC,MAZzB,CAatC,CAAW,CAAG,eAAe,IAAf,CAAoB,SAAS,CAAC,SAA9B,CAbwB,CAe1C,GAAI,CAAC,CAAW,EAAK,CAAK,EAAI,CAAzB,EAAsC,CAAvC,GAA0E,WAAtB,QAAO,CAAA,UAA/D,CAA2F,CAEzF,GAAI,CAAA,CAAM,CAAG,GAAI,CAAA,UAAjB,CACA,CAAM,CAAC,SAAP,CAAmB,UAAY,CAC7B,GAAI,CAAA,CAAG,CAAG,CAAM,CAAC,MAAjB,CACA,CAAG,CAAG,CAAW,CAAG,CAAH,CAAS,CAAG,CAAC,OAAJ,CAAY,cAAZ,CAA4B,uBAA5B,CAFG,CAGzB,CAHyB,CAGlB,CAAK,CAAC,QAAN,CAAe,IAAf,CAAsB,CAHJ,CAIxB,QAAQ,CAAG,CAJa,CAK7B,CAAK,CAAG,IACT,CATwF,CAUzF,CAAM,CAAC,aAAP,CAAqB,CAArB,CACD,CAXD,IAWO,IACD,CAAA,CAAG,CAAG,CAAO,CAAC,GAAR,EAAe,CAAO,CAAC,SAD5B,CAED,CAAG,CAAG,CAAG,CAAC,eAAJ,CAAoB,CAApB,CAFL,CAGD,CAHC,CAGM,CAAK,CAAC,QAAN,CAAiB,CAHvB,CAIA,QAAQ,CAAC,IAAT,CAAgB,CAJhB,CAKL,CAAK,CAAG,IALH,CAML,UAAU,CAAC,UAAY,CAAE,CAAG,CAAC,eAAJ,CAAoB,CAApB,CAA0B,CAAzC,CAA2C,GAA3C,CACX,CACF,CA1FU,C,CA6Fb,CAAO,CAAC,MAAR,CAAiB,CAAM,CAAC,MAAP,CAAgB,C,CAEX,WAAlB,QAAO,CAAA,M,GACT,MAAM,CAAC,OAAP,CAAiB,C","file":"FileSaver.min.js","sourcesContent":["/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebKit inside a native macOS app\nvar isWebKit = /AppleWebKit/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a native macOS app\n  : ('download' in HTMLAnchorElement.prototype && !isWebKit)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isWebKit) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n"]}
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/css/style.css
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/css/style.css	(date 1594749336086)
+++ src/main/resources/static/static/lib/brat/css/style.css	(date 1594749336086)
@@ -0,0 +1,576 @@
+/* -*- Mode: CSS; tab-width: 2; indent-tabs-mode: nil; -*- */
+/* vim:set ft=css ts=2 sw=2 sts=2 autoindent: */
+
+/* Styling for annotations */
+
+/* alternative font test */
+/*
+text {
+  font-size: 13px;
+  font-family: helvetica,arial,freesans,clean,sans-serif;
+}
+*/
+
+#svg {
+  margin: 34px auto 100px;
+  padding-top: 15px;
+}
+
+.center_wrapper {
+  display: table;
+  position: absolute;
+  top: 0;
+  left: 0;
+  height: 100%;
+  width: 100%;
+}
+
+.center_wrapper > div {
+  display: table-cell;
+  vertical-align: middle;
+}
+
+.center_wrapper > div > div {
+  /* match jQuery UI .ui-widget-content color */
+  color: #2e6e9e;
+  margin-left: auto;
+  margin-right: auto;
+  width: 30em;
+  font-size: 12px;
+  font-family: 'Liberation Sans', Verdana, Arial, Helvetica, sans-serif;
+}
+
+.center_wrapper > div > div h1 {
+  text-align: center;
+  font-size: 14px;
+}
+
+#no_svg_wrapper {
+  display: none;
+}
+
+svg {
+  width: 100%;
+  height: 1px;
+  border: 1px solid #7fa2ff;
+  font-size: 15px;
+  /* font-size: 14px; */
+}
+
+svg.reselect {
+  border: 1px solid #ff3333;
+}
+
+/* "basic" font */
+text {
+  font-size: 13px;
+  font-family: 'Liberation Sans', Verdana, Arial, Helvetica, sans-serif;
+}
+
+@-webkit-keyframes pulse {
+  0% {
+      color: #9999ff;
+      margin-top: 0;
+  }
+  50% {
+      color: #ffffff;
+      margin-top: 7px;
+  }
+  100% {
+      color: #9999ff;
+      margin-top: 0;
+  }
+}
+
+path {
+  pointer-events: none;
+}
+
+/* "basic" font */
+.span text {
+  /*  font-size: 10.5px; */
+  font-size: 10px;
+  text-anchor: middle;
+  font-family: 'PT Sans Caption', sans-serif;
+  pointer-events: none;
+}
+
+/* this should likely match span font */
+.span_type_label {
+  font-size: 11px;
+  font-family: 'PT Sans Caption', sans-serif;
+}
+
+/* this should likely match arc font */
+.arc_type_label {
+  font-size: 11px;
+  font-family: 'PT Sans Caption', sans-serif;
+}
+
+.attribute_type_label .ui-button-text {
+  font-size: 11px;
+  font-family: 'PT Sans Caption', sans-serif;
+}
+
+.span rect {
+  stroke-width: 0.75;
+}
+
+.glyph {
+  fill: #444444;
+  font-family: sans-serif;
+  font-weight: bold;
+}
+
+.attribute_warning {
+  stroke: red;
+}
+
+.span rect.False_positive {
+  stroke: #ff4141;
+  stroke-width: 2;
+}
+
+.shadow_True_positive {
+  fill: #00ff00;
+}
+
+.shadow_False_positive {
+  fill: #ff4141;
+}
+
+#commentpopup.comment_False_positive {
+  background-color: #ff4141;
+}
+
+.span rect.False_negative {
+  stroke: #c20000;
+  fill: #ffffff;
+  stroke-width: 2;
+}
+
+.shadow_False_negative {
+  fill: #c20000;
+}
+
+#commentpopup.comment_False_negative {
+  background-color: #c20000;
+}
+
+.span rect.AnnotationError {
+  stroke-width: 1;
+}
+
+.shadow_AnnotationError {
+  fill: #ff0000;
+}
+
+#commentpopup.comment_AnnotationError {
+  background-color: #ff7777;
+}
+
+.span rect.AnnotationWarning {
+  stroke-width: 1;
+}
+
+.shadow_AnnotationWarning {
+  fill: #ff8800;
+}
+
+#commentpopup.comment_AnnotationWarning {
+  background-color: #ff9900;
+}
+
+.shadow_AnnotatorNotes {
+  /* fill: #00cc00; */
+  fill: #3ab7ee;
+}
+
+#commentpopup.comment_AnnotatorNotes {
+  /* background-color: #00cc00; */
+  /* background-color: #DAF7DC; */
+  background-color: #d7e7ee;
+}
+
+.shadow_Normalized {
+  /* fill: #00cc00; */
+  fill: #3aee37;
+}
+
+#commentpopup.comment_Normalized {
+  /* background-color: #00cc00; */
+  /* background-color: #DAF7DC; */
+  background-color: #d7eee7;
+}
+
+rect.Normalized {
+  stroke-width: 1.5;
+}
+
+.shadow_AnnotationIncomplete {
+  fill: #aaaaaa;
+}
+
+.span rect.AnnotationIncomplete {
+  stroke: #002200;
+  stroke-width: 0.5;
+  fill: #ffffff;
+}
+
+#commentpopup.comment_AnnotationIncomplete {
+  background-color: #ffff77;
+}
+
+.shadow_AnnotationUnconfirmed {
+  fill: #eeeeee;
+}
+
+.span rect.AnnotationUnconfirmed {
+  stroke: #002200;
+  stroke-width: 0.5;
+  opacity: 0.5;
+}
+
+#commentpopup.comment_AnnotationUnconfirmed {
+  background-color: #ddddff;
+}
+
+.span rect.True_positive {
+  /* stroke: #007700; */
+}
+
+rect.shadow_EditHighlight {
+  fill: #ffff99;
+}
+
+.shadow_EditHighlight_arc {
+  stroke: #ffff99;
+}
+
+.span path {
+  fill: none;
+}
+
+.span path.curly {
+  /* 'stroke' def here blocks 'stroke' set in JS..? */
+  /* stroke: grey; */
+  stroke-width: 0.5;
+}
+
+.span path.boxcross {
+  stroke: black;
+  opacity: 0.5;
+}
+
+.arcs path {
+  stroke: #989898;
+  fill: none;
+  stroke-width: 1;
+}
+
+.arcs .highlight path {
+  stroke: #000000;
+  stroke-width: 1.5;
+  opacity: 1;
+}
+
+.arcs .highlight text {
+  stroke: black;
+  fill: black;
+  stroke-width: 0.5;
+}
+
+.span.highlight rect {
+  stroke-width: 2px;
+}
+
+.span rect.reselect {
+  stroke-width: 2px;
+}
+
+.span rect.reselectTarget {
+  stroke-width: 2px;
+}
+
+.arcs .reselect path {
+  stroke-width: 2px;
+  stroke: #ff0000 !important;
+}
+
+.arcs .reselect text {
+  fill: #ff0000 !important;
+}
+
+.span rect.badTarget {
+  stroke: #f00;
+}
+
+.arcs text {
+  font-size: 9px;
+  text-anchor: middle;
+  font-family: 'PT Sans Caption', sans-serif;
+  /* dominant-baseline: central; */
+  cursor: default;
+}
+
+.background0 {
+  stroke: none;
+  fill: #ffffff;
+}
+
+.background1 {
+  stroke: none;
+  fill: #eeeeee;
+}
+
+.backgroundHighlight {
+  stroke: none;
+  fill: #ffff99;
+}
+
+.sentnum text {
+  fill: #999999;
+  text-anchor: end;
+}
+
+.sentnum path {
+  stroke: #999999;
+  stroke-width: 1px;
+}
+
+.span_cue {
+  fill: #eeeeee !important;
+}
+
+.drag_stroke {
+  stroke: black;
+}
+
+.drag_fill {
+  fill: black;
+}
+
+
+.dialog {
+  display: none;
+}
+
+#span_free_div, #arc_free_div {
+  float: left;
+}
+
+fieldset {
+  /* match relevant parts of jQuery UI .ui-widget-content */
+  border: 1px solid #a6c9e2;
+  /* round corners, same as jQuery UI .ui-corner-all */
+  -moz-border-radius: 5px;
+  -webkit-border-radius: 5px;
+  border-radius: 5px;
+  /* to prevent border from running into legend */
+  margin-top: 5px;
+}
+
+fieldset legend {
+  font-weight: bold;
+  font-size: 90%;
+  -moz-border-radius: 3px;
+  -webkit-border-radius: 3px;
+  border-radius: 3px;
+  background-color: #70a8d2;
+  color: white;
+  padding-left: 0.5em;
+  padding-right: 0.5em;
+}
+
+.label-like {
+  /* for UI consistency, this should match the "fieldset legend" style;
+     sorry about the duplication. */
+  font-family: monospace;
+  font-weight: bold;
+  font-size: 90%;
+  /* match jQuery UI .ui-widget-content color */
+  color: #2e6e9e;
+}
+
+.accesskey {
+  text-decoration: underline;
+}
+
+
+.shadow {
+  -moz-box-shadow: 5px 5px 5px #444444;
+  -webkit-box-shadow: 5px 5px 5px #444444;
+  box-shadow: 5px 5px 5px #444444;
+}
+
+#span_selected, #arc_origin, #arc_target {
+  font-weight: bold;
+}
+
+#commentpopup {
+  font-family: 'Liberation Sans', Verdana, Arial, Helvetica, sans-serif;
+  position: fixed;
+  top: 0;
+  left: 0;
+  opacity: 0.95;
+  padding: 10px;
+  display: none;
+  border: 1px outset #000000;
+  background-color: #f5f5f9;
+  /* background-color: #d7e7ee; */
+  /* background-color: #eeeeee; */
+  color: #000000;
+  z-index: 20;
+  -moz-box-shadow: 5px 5px 5px #aaaaaa;
+  -webkit-box-shadow: 5px 5px 5px #aaaaaa;
+  box-shadow: 5px 5px 5px #aaaaaa;
+  -moz-border-radius: 3px;
+  -webkit-border-radius: 3px;
+  border-radius: 3px;
+  max-width: 80%;
+}
+
+#more_info_readme {
+  height: 350px;
+}
+
+#readme_container {
+  position: relative;
+}
+
+#more_readme_button {
+  padding: 2px 5px;
+  position: absolute;
+  top: -2px;
+  right: -2px;
+}
+
+.comment_id {
+  vertical-align: top;
+  float: right;
+  font-size: 75%;
+  font-family: monospace;
+  color: #333333;
+}
+
+.comment_type {
+  /* font-weight: bold; */
+}
+
+.comment_text {
+  font-weight: bold;
+}
+
+.comment_type_id_wrapper {
+  /* padding for floating ID */
+  padding-right: 2em;
+}
+
+.norm_info_label {
+  font-weight: bold;
+  font-size: 80%;
+}
+
+.norm_info_value {
+  font-size: 80%;
+}
+
+.norm_info_img {
+  float: right;
+  margin-left: 1em;
+}
+
+#search_form select {
+  width: 100%; /* deal with overflowing selectboxes */
+}
+
+.scroll_fset {
+  height: 200px;
+}
+
+.scroll_fset fieldset {
+  height: 100%;
+  overflow-x: hidden;
+  overflow-y: hidden;
+}
+
+/* HACK to display <legend> properly */
+.scroll_fset {
+  margin-bottom: 2.5em;
+}
+
+.scroll_fset fieldset {
+  padding-bottom: 2em;
+}
+
+/* end HACK */
+.scroll_fset div.scroller {
+  overflow: auto;
+  width: 100%;
+  height: 100%;
+}
+
+#span_highlight_link, #arc_highlight_link, #viewspan_highlight_link {
+  float: right;
+}
+
+.unselectable {
+  -moz-user-select: -moz-none;
+  -khtml-user-select: none;
+  -webkit-user-select: none;
+  -o-user-select: none;
+  user-select: none;
+  cursor: default;
+}
+
+/* Apple iPad, iPhone, iPod */
+
+* {
+  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
+  -webkit-text-size-adjust: none;
+  select: none;
+}
+
+.span rect.AddedAnnotation {
+  stroke: #ff4141;
+  stroke-width: 2;
+}
+
+.shadow_AddedAnnotation {
+  fill: #ff4141;
+}
+
+#commentpopup.comment_AddedAnnotation {
+  background-color: #ffcccc;
+}
+
+.span rect.MissingAnnotation {
+  stroke: #ffffff;
+  stroke-width: 2;
+}
+
+.shadow_MissingAnnotation {
+  fill: #ff4141;
+  opacity: 0.3;
+}
+
+#commentpopup.comment_MissingAnnotation {
+  background-color: #ffcccc;
+}
+
+.span rect.MissingAnnotation + text {
+  opacity: 0.5;
+}
+
+.span rect.ChangedAnnotation {
+  stroke: #ffff99;
+  stroke-width: 2;
+}
+
+.shadow_ChangedAnnotation {
+  fill: #ff4141;
+}
+
+#commentpopup.comment_ChangedAnnotation {
+  background-color: #ffcccc;
+}
\ No newline at end of file
Index: src/main/resources/static/static/lib/papaparse/papaparse-5.0.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/papaparse/papaparse-5.0.min.js	(date 1594749336112)
+++ src/main/resources/static/static/lib/papaparse/papaparse-5.0.min.js	(date 1594749336112)
@@ -0,0 +1,7 @@
+/* @license
+Papa Parse
+v5.1.1
+https://github.com/mholt/PapaParse
+License: MIT
+*/
+!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"undefined"!=typeof exports?module.exports=t():e.Papa=t()}(this,function s(){"use strict";var f="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==f?f:{};var n=!f.document&&!!f.postMessage,o=n&&/blob:/i.test((f.location||{}).protocol),a={},h=0,b={parse:function(e,t){var i=(t=t||{}).dynamicTyping||!1;q(i)&&(t.dynamicTypingFunction=i,i={});if(t.dynamicTyping=i,t.transform=!!q(t.transform)&&t.transform,t.worker&&b.WORKERS_SUPPORTED){var r=function(){if(!b.WORKERS_SUPPORTED)return!1;var e=(i=f.URL||f.webkitURL||null,r=s.toString(),b.BLOB_URL||(b.BLOB_URL=i.createObjectURL(new Blob(["(",r,")();"],{type:"text/javascript"})))),t=new f.Worker(e);var i,r;return t.onmessage=m,t.id=h++,a[t.id]=t}();return r.userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=q(t.step),t.chunk=q(t.chunk),t.complete=q(t.complete),t.error=q(t.error),delete t.worker,void r.postMessage({input:e,config:t,workerId:r.id})}var n=null;b.NODE_STREAM_INPUT,"string"==typeof e?n=t.download?new l(t):new p(t):!0===e.readable&&q(e.read)&&q(e.on)?n=new g(t):(f.File&&e instanceof File||e instanceof Object)&&(n=new c(t));return n.stream(e)},unparse:function(e,t){var n=!1,m=!0,_=",",v="\r\n",s='"',a=s+s,i=!1,r=null;!function(){if("object"!=typeof t)return;"string"!=typeof t.delimiter||b.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(_=t.delimiter);("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes);"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(i=t.skipEmptyLines);"string"==typeof t.newline&&(v=t.newline);"string"==typeof t.quoteChar&&(s=t.quoteChar);"boolean"==typeof t.header&&(m=t.header);if(Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");r=t.columns}void 0!==t.escapeChar&&(a=t.escapeChar+s)}();var o=new RegExp(U(s),"g");"string"==typeof e&&(e=JSON.parse(e));if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return u(null,e,i);if("object"==typeof e[0])return u(r||h(e[0]),e,i)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:h(e.data[0])),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),u(e.fields||[],e.data||[],i);throw new Error("Unable to serialize unrecognized input");function h(e){if("object"!=typeof e)return[];var t=[];for(var i in e)t.push(i);return t}function u(e,t,i){var r="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var n=Array.isArray(e)&&0<e.length,s=!Array.isArray(t[0]);if(n&&m){for(var a=0;a<e.length;a++)0<a&&(r+=_),r+=y(e[a],a);0<t.length&&(r+=v)}for(var o=0;o<t.length;o++){var h=n?e.length:t[o].length,u=!1,f=n?0===Object.keys(t[o]).length:0===t[o].length;if(i&&!n&&(u="greedy"===i?""===t[o].join("").trim():1===t[o].length&&0===t[o][0].length),"greedy"===i&&n){for(var d=[],l=0;l<h;l++){var c=s?e[l]:l;d.push(t[o][c])}u=""===d.join("").trim()}if(!u){for(var p=0;p<h;p++){0<p&&!f&&(r+=_);var g=n&&s?e[p]:p;r+=y(t[o][g],p)}o<t.length-1&&(!i||0<h&&!f)&&(r+=v)}}return r}function y(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var i=e.toString().replace(o,a),r="boolean"==typeof n&&n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var i=0;i<t.length;i++)if(-1<e.indexOf(t[i]))return!0;return!1}(i,b.BAD_DELIMITERS)||-1<i.indexOf(_)||" "===i.charAt(0)||" "===i.charAt(i.length-1);return r?s+i+s:i}}};if(b.RECORD_SEP=String.fromCharCode(30),b.UNIT_SEP=String.fromCharCode(31),b.BYTE_ORDER_MARK="\ufeff",b.BAD_DELIMITERS=["\r","\n",'"',b.BYTE_ORDER_MARK],b.WORKERS_SUPPORTED=!n&&!!f.Worker,b.NODE_STREAM_INPUT=1,b.LocalChunkSize=10485760,b.RemoteChunkSize=5242880,b.DefaultDelimiter=",",b.Parser=E,b.ParserHandle=i,b.NetworkStreamer=l,b.FileStreamer=c,b.StringStreamer=p,b.ReadableStreamStreamer=g,f.jQuery){var d=f.jQuery;d.fn.parse=function(o){var i=o.config||{},h=[];return this.each(function(e){if(!("INPUT"===d(this).prop("tagName").toUpperCase()&&"file"===d(this).attr("type").toLowerCase()&&f.FileReader)||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)h.push({file:this.files[t],inputElem:this,instanceConfig:d.extend({},i)})}),e(),this;function e(){if(0!==h.length){var e,t,i,r,n=h[0];if(q(o.before)){var s=o.before(n.file,n.inputElem);if("object"==typeof s){if("abort"===s.action)return e="AbortError",t=n.file,i=n.inputElem,r=s.reason,void(q(o.error)&&o.error({name:e},t,i,r));if("skip"===s.action)return void u();"object"==typeof s.config&&(n.instanceConfig=d.extend(n.instanceConfig,s.config))}else if("skip"===s)return void u()}var a=n.instanceConfig.complete;n.instanceConfig.complete=function(e){q(a)&&a(e,n.file,n.inputElem),u()},b.parse(n.file,n.instanceConfig)}else q(o.complete)&&o.complete()}function u(){h.splice(0,1),e()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=w(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null);this._handle=new i(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&q(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var r=this._partialLine+e;this._partialLine="";var n=this._handle.parse(r,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=n.meta.cursor;this._finished||(this._partialLine=r.substring(s-this._baseIndex),this._baseIndex=s),n&&n.data&&(this._rowCount+=n.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)f.postMessage({results:n,workerId:b.WORKER_ID,finished:a});else if(q(this._config.chunk)&&!t){if(this._config.chunk(n,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);n=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),this._completed||!a||!q(this._config.complete)||n&&n.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),a||n&&n.meta.paused||this._nextChunk(),n}this._halted=!0},this._sendError=function(e){q(this._config.error)?this._config.error(e):o&&this._config.error&&f.postMessage({workerId:b.WORKER_ID,error:e,finished:!1})}}function l(e){var r;(e=e||{}).chunkSize||(e.chunkSize=b.RemoteChunkSize),u.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),n||(r.onload=y(this._chunkLoaded,this),r.onerror=y(this._chunkError,this)),r.open("GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var t in e)r.setRequestHeader(t,e[t])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;r.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{r.send()}catch(e){this._chunkError(e.message)}n&&0===r.status&&this._chunkError()}},this._chunkLoaded=function(){4===r.readyState&&(r.status<200||400<=r.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:r.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");if(null===t)return-1;return parseInt(t.substring(t.lastIndexOf("/")+1))}(r),this.parseChunk(r.responseText)))},this._chunkError=function(e){var t=r.statusText||e;this._sendError(new Error(t))}}function c(e){var r,n;(e=e||{}).chunkSize||(e.chunkSize=b.LocalChunkSize),u.call(this,e);var s="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,s?((r=new FileReader).onload=y(this._chunkLoaded,this),r.onerror=y(this._chunkError,this)):r=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var t=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,t)}var i=r.readAsText(e,this._config.encoding);s||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(r.error)}}function p(e){var i;u.call(this,e=e||{}),this.stream=function(e){return i=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,t=this._config.chunkSize;return t?(e=i.substring(0,t),i=i.substring(t)):(e=i,i=""),this._finished=!i,this.parseChunk(e)}}}function g(e){u.call(this,e=e||{});var t=[],i=!0,r=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=y(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=y(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=y(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=y(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function i(_){var a,o,h,r=Math.pow(2,53),n=-r,s=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,u=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,t=this,i=0,f=0,d=!1,e=!1,l=[],c={data:[],errors:[],meta:{}};if(q(_.step)){var p=_.step;_.step=function(e){if(c=e,m())g();else{if(g(),0===c.data.length)return;i+=e.data.length,_.preview&&i>_.preview?o.abort():(c.data=c.data[0],p(c,t))}}}function v(e){return"greedy"===_.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function g(){if(c&&h&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+b.DefaultDelimiter+"'"),h=!1),_.skipEmptyLines)for(var e=0;e<c.data.length;e++)v(c.data[e])&&c.data.splice(e--,1);return m()&&function(){if(!c)return;function e(e){q(_.transformHeader)&&(e=_.transformHeader(e)),l.push(e)}if(Array.isArray(c.data[0])){for(var t=0;m()&&t<c.data.length;t++)c.data[t].forEach(e);c.data.splice(0,1)}else c.data.forEach(e)}(),function(){if(!c||!_.header&&!_.dynamicTyping&&!_.transform)return c;function e(e,t){var i,r=_.header?{}:[];for(i=0;i<e.length;i++){var n=i,s=e[i];_.header&&(n=i>=l.length?"__parsed_extra":l[i]),_.transform&&(s=_.transform(s,n)),s=y(n,s),"__parsed_extra"===n?(r[n]=r[n]||[],r[n].push(s)):r[n]=s}return _.header&&(i>l.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+l.length+" fields but parsed "+i,f+t):i<l.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+l.length+" fields but parsed "+i,f+t)),r}var t=1;!c.data.length||Array.isArray(c.data[0])?(c.data=c.data.map(e),t=c.data.length):c.data=e(c.data,0);_.header&&c.meta&&(c.meta.fields=l);return f+=t,c}()}function m(){return _.header&&0===l.length}function y(e,t){return i=e,_.dynamicTypingFunction&&void 0===_.dynamicTyping[i]&&(_.dynamicTyping[i]=_.dynamicTypingFunction(i)),!0===(_.dynamicTyping[i]||_.dynamicTyping)?"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&(function(e){if(s.test(e)){var t=parseFloat(e);if(n<t&&t<r)return!0}return!1}(t)?parseFloat(t):u.test(t)?new Date(t):""===t?null:t):t;var i}function k(e,t,i,r){var n={type:e,code:t,message:i};void 0!==r&&(n.row=r),c.errors.push(n)}this.parse=function(e,t,i){var r=_.quoteChar||'"';if(_.newline||(_.newline=function(e,t){e=e.substring(0,1048576);var i=new RegExp(U(t)+"([^]*?)"+U(t),"gm"),r=(e=e.replace(i,"")).split("\r"),n=e.split("\n"),s=1<n.length&&n[0].length<r[0].length;if(1===r.length||s)return"\n";for(var a=0,o=0;o<r.length;o++)"\n"===r[o][0]&&a++;return a>=r.length/2?"\r\n":"\r"}(e,r)),h=!1,_.delimiter)q(_.delimiter)&&(_.delimiter=_.delimiter(e),c.meta.delimiter=_.delimiter);else{var n=function(e,t,i,r,n){var s,a,o,h;n=n||[",","\t","|",";",b.RECORD_SEP,b.UNIT_SEP];for(var u=0;u<n.length;u++){var f=n[u],d=0,l=0,c=0;o=void 0;for(var p=new E({comments:r,delimiter:f,newline:t,preview:10}).parse(e),g=0;g<p.data.length;g++)if(i&&v(p.data[g]))c++;else{var m=p.data[g].length;l+=m,void 0!==o?0<m&&(d+=Math.abs(m-o),o=m):o=m}0<p.data.length&&(l/=p.data.length-c),(void 0===a||d<=a)&&(void 0===h||h<l)&&1.99<l&&(a=d,s=f,h=l)}return{successful:!!(_.delimiter=s),bestDelimiter:s}}(e,_.newline,_.skipEmptyLines,_.comments,_.delimitersToGuess);n.successful?_.delimiter=n.bestDelimiter:(h=!0,_.delimiter=b.DefaultDelimiter),c.meta.delimiter=_.delimiter}var s=w(_);return _.preview&&_.header&&s.preview++,a=e,o=new E(s),c=o.parse(a,t,i),g(),d?{meta:{paused:!0}}:c||{meta:{paused:!1}}},this.paused=function(){return d},this.pause=function(){d=!0,o.abort(),a=q(_.chunk)?"":a.substring(o.getCharIndex())},this.resume=function(){t.streamer._halted?(d=!1,t.streamer.parseChunk(a,!0)):setTimeout(this.resume,3)},this.aborted=function(){return e},this.abort=function(){e=!0,o.abort(),c.meta.aborted=!0,q(_.complete)&&_.complete(c),a=""}}function U(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function E(e){var O,D=(e=e||{}).delimiter,I=e.newline,T=e.comments,A=e.step,L=e.preview,F=e.fastMode,z=O=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(z=e.escapeChar),("string"!=typeof D||-1<b.BAD_DELIMITERS.indexOf(D))&&(D=","),T===D)throw new Error("Comment character same as delimiter");!0===T?T="#":("string"!=typeof T||-1<b.BAD_DELIMITERS.indexOf(T))&&(T=!1),"\n"!==I&&"\r"!==I&&"\r\n"!==I&&(I="\n");var M=0,j=!1;this.parse=function(a,t,i){if("string"!=typeof a)throw new Error("Input must be a string");var r=a.length,e=D.length,n=I.length,s=T.length,o=q(A),h=[],u=[],f=[],d=M=0;if(!a)return R();if(F||!1!==F&&-1===a.indexOf(O)){for(var l=a.split(I),c=0;c<l.length;c++){if(f=l[c],M+=f.length,c!==l.length-1)M+=I.length;else if(i)return R();if(!T||f.substring(0,s)!==T){if(o){if(h=[],b(f.split(D)),S(),j)return R()}else b(f.split(D));if(L&&L<=c)return h=h.slice(0,L),R(!0)}}return R()}for(var p=a.indexOf(D,M),g=a.indexOf(I,M),m=new RegExp(U(z)+U(O),"g"),_=a.indexOf(O,M);;)if(a[M]!==O)if(T&&0===f.length&&a.substring(M,M+s)===T){if(-1===g)return R();M=g+n,g=a.indexOf(I,M),p=a.indexOf(D,M)}else{if(-1!==p&&(p<g||-1===g)){if(!(p<_)){f.push(a.substring(M,p)),M=p+e,p=a.indexOf(D,M);continue}var v=x(p,_,g);if(v&&void 0!==v.nextDelim){p=v.nextDelim,_=v.quoteSearch,f.push(a.substring(M,p)),M=p+e,p=a.indexOf(D,M);continue}}if(-1===g)break;if(f.push(a.substring(M,g)),C(g+n),o&&(S(),j))return R();if(L&&h.length>=L)return R(!0)}else for(_=M,M++;;){if(-1===(_=a.indexOf(O,_+1)))return i||u.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:h.length,index:M}),w();if(_===r-1)return w(a.substring(M,_).replace(m,O));if(O!==z||a[_+1]!==z){if(O===z||0===_||a[_-1]!==z){-1!==p&&p<_+1&&(p=a.indexOf(D,_+1)),-1!==g&&g<_+1&&(g=a.indexOf(I,_+1));var y=E(-1===g?p:Math.min(p,g));if(a[_+1+y]===D){f.push(a.substring(M,_).replace(m,O)),a[M=_+1+y+e]!==O&&(_=a.indexOf(O,M)),p=a.indexOf(D,M),g=a.indexOf(I,M);break}var k=E(g);if(a.substring(_+1+k,_+1+k+n)===I){if(f.push(a.substring(M,_).replace(m,O)),C(_+1+k+n),p=a.indexOf(D,M),_=a.indexOf(O,M),o&&(S(),j))return R();if(L&&h.length>=L)return R(!0);break}u.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:h.length,index:M}),_++}}else _++}return w();function b(e){h.push(e),d=M}function E(e){var t=0;if(-1!==e){var i=a.substring(_+1,e);i&&""===i.trim()&&(t=i.length)}return t}function w(e){return i||(void 0===e&&(e=a.substring(M)),f.push(e),M=r,b(f),o&&S()),R()}function C(e){M=e,b(f),f=[],g=a.indexOf(I,M)}function R(e){return{data:h,errors:u,meta:{delimiter:D,linebreak:I,aborted:j,truncated:!!e,cursor:d+(t||0)}}}function S(){A(R()),h=[],u=[]}function x(e,t,i){var r={nextDelim:void 0,quoteSearch:void 0},n=a.indexOf(O,t+1);if(t<e&&e<n&&(n<i||-1===i)){var s=a.indexOf(D,n);if(-1===s)return r;n<s&&(n=a.indexOf(O,n+1)),r=x(s,n,i)}else r={nextDelim:e,quoteSearch:t};return r}},this.abort=function(){j=!0},this.getCharIndex=function(){return M}}function m(e){var t=e.data,i=a[t.workerId],r=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var n={abort:function(){r=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(q(i.userStep)){for(var s=0;s<t.results.data.length&&(i.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},n),!r);s++);delete t.results}else q(i.userChunk)&&(i.userChunk(t.results,n,t.file),delete t.results)}t.finished&&!r&&_(t.workerId,t.results)}function _(e,t){var i=a[e];q(i.userComplete)&&i.userComplete(t),i.terminate(),delete a[e]}function v(){throw new Error("Not implemented.")}function w(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var i in e)t[i]=w(e[i]);return t}function y(e,t){return function(){e.apply(t,arguments)}}function q(e){return"function"==typeof e}return o&&(f.onmessage=function(e){var t=e.data;void 0===b.WORKER_ID&&t&&(b.WORKER_ID=t.workerId);if("string"==typeof t.input)f.postMessage({workerId:b.WORKER_ID,results:b.parse(t.input,t.config),finished:!0});else if(f.File&&t.input instanceof File||t.input instanceof Object){var i=b.parse(t.input,t.config);i&&f.postMessage({workerId:b.WORKER_ID,results:i,finished:!0})}}),(l.prototype=Object.create(u.prototype)).constructor=l,(c.prototype=Object.create(u.prototype)).constructor=c,(p.prototype=Object.create(p.prototype)).constructor=p,(g.prototype=Object.create(u.prototype)).constructor=g,b});
\ No newline at end of file
Index: src/main/resources/static/static/lib/file-saver/FileSaver.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/file-saver/FileSaver.min.js	(date 1594749336107)
+++ src/main/resources/static/static/lib/file-saver/FileSaver.min.js	(date 1594749336107)
@@ -0,0 +1,3 @@
+(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=/AppleWebKit/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof module&&(module.exports=g)});
+
+//# sourceMappingURL=FileSaver.min.js.map
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/lib/jquery.sprintf.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/jquery.sprintf.js	(date 1594749336094)
+++ src/main/resources/static/static/lib/brat/lib/jquery.sprintf.js	(date 1594749336094)
@@ -0,0 +1,67 @@
+/**
+ * sprintf and vsprintf for jQuery
+ * somewhat based on http://jan.moesen.nu/code/javascript/sprintf-and-printf-in-javascript/
+ * 
+ * Copyright (c) 2008 Sabin Iacob (m0n5t3r) <iacobs@m0n5t3r.info>
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details. 
+ *
+ * @license http://www.gnu.org/licenses/gpl.html 
+ * @project jquery.sprintf
+ */
+(function($){
+	var formats = {
+		'b': function(val) {return parseInt(val, 10).toString(2);},
+		'c': function(val) {return String.fromCharCode(parseInt(val, 10));},
+		'd': function(val) {return parseInt(val, 10);},
+		'u': function(val) {return Math.abs(val);},
+		'f': function(val, p) {
+			p = parseInt(p, 10); 
+			val = parseFloat(val);
+			if(isNaN(p && val)) {
+				return NaN;
+			}
+			return p && val.toFixed(p) || val;
+		},
+		'o': function(val) {return parseInt(val, 10).toString(8);},
+		's': function(val) {return val;},
+		'x': function(val) {return ('' + parseInt(val, 10).toString(16)).toLowerCase();},
+		'X': function(val) {return ('' + parseInt(val, 10).toString(16)).toUpperCase();}
+	};
+
+	var re = /%(?:(\d+)?(?:\.(\d+))?|\(([^)]+)\))([%bcdufosxX])/g;
+
+	var dispatch = function(data){
+		if(data.length == 1 && typeof data[0] == 'object') { //python-style printf
+			data = data[0];
+			return function(match, w, p, lbl, fmt, off, str) {
+				return formats[fmt](data[lbl]);
+			};
+		} else { // regular, somewhat incomplete, printf
+			var idx = 0; 
+			return function(match, w, p, lbl, fmt, off, str) {
+				if(fmt == '%') {
+					return '%';
+				}
+				return formats[fmt](data[idx++], p);
+			};
+		}
+	};
+
+	$.extend({
+		sprintf: function(format) {
+			var argv = Array.apply(null, arguments).slice(1);
+			return format.replace(re, dispatch(argv));
+		},
+		vsprintf: function(format, data) {
+			return format.replace(re, dispatch(data));
+		}
+	});
+})(jQuery);
Index: src/main/resources/static/static/lib/brat/lib/jquery-ui.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/jquery-ui.min.js	(date 1594749336091)
+++ src/main/resources/static/static/lib/brat/lib/jquery-ui.min.js	(date 1594749336091)
@@ -0,0 +1,791 @@
+/*!
+ * jQuery UI 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI
+ */
+(function(c,j){function k(a,b){var d=a.nodeName.toLowerCase();if("area"===d){b=a.parentNode;d=b.name;if(!a.href||!d||b.nodeName.toLowerCase()!=="map")return false;a=c("img[usemap=#"+d+"]")[0];return!!a&&l(a)}return(/input|select|textarea|button|object/.test(d)?!a.disabled:"a"==d?a.href||b:b)&&l(a)}function l(a){return!c(a).parents().andSelf().filter(function(){return c.curCSS(this,"visibility")==="hidden"||c.expr.filters.hidden(this)}).length}c.ui=c.ui||{};if(!c.ui.version){c.extend(c.ui,{version:"1.8.16",
+keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});c.fn.extend({propAttr:c.fn.prop||c.fn.attr,_focus:c.fn.focus,focus:function(a,b){return typeof a==="number"?this.each(function(){var d=
+this;setTimeout(function(){c(d).focus();b&&b.call(d)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=c.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(c.curCSS(this,"position",1))&&/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(c.curCSS(this,
+"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?c(document):a},zIndex:function(a){if(a!==j)return this.css("zIndex",a);if(this.length){a=c(this[0]);for(var b;a.length&&a[0]!==document;){b=a.css("position");if(b==="absolute"||b==="relative"||b==="fixed"){b=parseInt(a.css("zIndex"),10);if(!isNaN(b)&&b!==0)return b}a=a.parent()}}return 0},disableSelection:function(){return this.bind((c.support.selectstart?"selectstart":
+"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});c.each(["Width","Height"],function(a,b){function d(f,g,m,n){c.each(e,function(){g-=parseFloat(c.curCSS(f,"padding"+this,true))||0;if(m)g-=parseFloat(c.curCSS(f,"border"+this+"Width",true))||0;if(n)g-=parseFloat(c.curCSS(f,"margin"+this,true))||0});return g}var e=b==="Width"?["Left","Right"]:["Top","Bottom"],h=b.toLowerCase(),i={innerWidth:c.fn.innerWidth,innerHeight:c.fn.innerHeight,
+outerWidth:c.fn.outerWidth,outerHeight:c.fn.outerHeight};c.fn["inner"+b]=function(f){if(f===j)return i["inner"+b].call(this);return this.each(function(){c(this).css(h,d(this,f)+"px")})};c.fn["outer"+b]=function(f,g){if(typeof f!=="number")return i["outer"+b].call(this,f);return this.each(function(){c(this).css(h,d(this,f,true,g)+"px")})}});c.extend(c.expr[":"],{data:function(a,b,d){return!!c.data(a,d[3])},focusable:function(a){return k(a,!isNaN(c.attr(a,"tabindex")))},tabbable:function(a){var b=c.attr(a,
+"tabindex"),d=isNaN(b);return(d||b>=0)&&k(a,!d)}});c(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));c.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});c.support.minHeight=b.offsetHeight===100;c.support.selectstart="onselectstart"in b;a.removeChild(b).style.display="none"});c.extend(c.ui,{plugin:{add:function(a,b,d){a=c.ui[a].prototype;for(var e in d){a.plugins[e]=a.plugins[e]||[];a.plugins[e].push([b,d[e]])}},call:function(a,b,d){if((b=a.plugins[b])&&
+a.element[0].parentNode)for(var e=0;e<b.length;e++)a.options[b[e][0]]&&b[e][1].apply(a.element,d)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(a,b){if(c(a).css("overflow")==="hidden")return false;b=b&&b==="left"?"scrollLeft":"scrollTop";var d=false;if(a[b]>0)return true;a[b]=1;d=a[b]>0;a[b]=0;return d},isOverAxis:function(a,b,d){return a>b&&a<b+d},isOver:function(a,b,d,e,h,i){return c.ui.isOverAxis(a,d,h)&&
+c.ui.isOverAxis(b,e,i)}})}})(jQuery);
+;/*!
+ * jQuery UI Widget 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Widget
+ */
+(function(b,j){if(b.cleanData){var k=b.cleanData;b.cleanData=function(a){for(var c=0,d;(d=a[c])!=null;c++)try{b(d).triggerHandler("remove")}catch(e){}k(a)}}else{var l=b.fn.remove;b.fn.remove=function(a,c){return this.each(function(){if(!c)if(!a||b.filter(a,[this]).length)b("*",this).add([this]).each(function(){try{b(this).triggerHandler("remove")}catch(d){}});return l.call(b(this),a,c)})}}b.widget=function(a,c,d){var e=a.split(".")[0],f;a=a.split(".")[1];f=e+"-"+a;if(!d){d=c;c=b.Widget}b.expr[":"][f]=
+function(h){return!!b.data(h,a)};b[e]=b[e]||{};b[e][a]=function(h,g){arguments.length&&this._createWidget(h,g)};c=new c;c.options=b.extend(true,{},c.options);b[e][a].prototype=b.extend(true,c,{namespace:e,widgetName:a,widgetEventPrefix:b[e][a].prototype.widgetEventPrefix||a,widgetBaseClass:f},d);b.widget.bridge(a,b[e][a])};b.widget.bridge=function(a,c){b.fn[a]=function(d){var e=typeof d==="string",f=Array.prototype.slice.call(arguments,1),h=this;d=!e&&f.length?b.extend.apply(null,[true,d].concat(f)):
+d;if(e&&d.charAt(0)==="_")return h;e?this.each(function(){var g=b.data(this,a),i=g&&b.isFunction(g[d])?g[d].apply(g,f):g;if(i!==g&&i!==j){h=i;return false}}):this.each(function(){var g=b.data(this,a);g?g.option(d||{})._init():b.data(this,a,new c(d,this))});return h}};b.Widget=function(a,c){arguments.length&&this._createWidget(a,c)};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(a,c){b.data(c,this.widgetName,this);this.element=b(c);this.options=
+b.extend(true,{},this.options,this._getCreateOptions(),a);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(a,c){var d=a;if(arguments.length===0)return b.extend({},this.options);if(typeof a==="string"){if(c===j)return this.options[a];d={};d[a]=c}this._setOptions(d);return this},_setOptions:function(a){var c=this;b.each(a,function(d,e){c._setOption(d,e)});return this},_setOption:function(a,c){this.options[a]=c;if(a==="disabled")this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
+c);return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(a,c,d){var e=this.options[a];c=b.Event(c);c.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();d=d||{};if(c.originalEvent){a=b.event.props.length;for(var f;a;){f=b.event.props[--a];c[f]=c.originalEvent[f]}}this.element.trigger(c,d);return!(b.isFunction(e)&&e.call(this.element[0],c,d)===false||c.isDefaultPrevented())}}})(jQuery);
+;/*!
+ * jQuery UI Mouse 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Mouse
+ *
+ * Depends:
+ *	jquery.ui.widget.js
+ */
+(function(b){var d=false;b(document).mouseup(function(){d=false});b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(c){return a._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(true===b.data(c.target,a.widgetName+".preventClickEvent")){b.removeData(c.target,a.widgetName+".preventClickEvent");c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+
+this.widgetName)},_mouseDown:function(a){if(!d){this._mouseStarted&&this._mouseUp(a);this._mouseDownEvent=a;var c=this,f=a.which==1,g=typeof this.options.cancel=="string"&&a.target.nodeName?b(a.target).closest(this.options.cancel).length:false;if(!f||g||!this._mouseCapture(a))return true;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay);if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=
+this._mouseStart(a)!==false;if(!this._mouseStarted){a.preventDefault();return true}}true===b.data(a.target,this.widgetName+".preventClickEvent")&&b.removeData(a.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(e){return c._mouseMove(e)};this._mouseUpDelegate=function(e){return c._mouseUp(e)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.preventDefault();return d=true}},_mouseMove:function(a){if(b.browser.msie&&
+!(document.documentMode>=9)&&!a.button)return this._mouseUp(a);if(this._mouseStarted){this._mouseDrag(a);return a.preventDefault()}if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a))(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==false)?this._mouseDrag(a):this._mouseUp(a);return!this._mouseStarted},_mouseUp:function(a){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=
+false;a.target==this._mouseDownEvent.target&&b.data(a.target,this.widgetName+".preventClickEvent",true);this._mouseStop(a)}return false},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
+;/*
+ * jQuery UI Position 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Position
+ */
+(function(c){c.ui=c.ui||{};var n=/left|center|right/,o=/top|center|bottom/,t=c.fn.position,u=c.fn.offset;c.fn.position=function(b){if(!b||!b.of)return t.apply(this,arguments);b=c.extend({},b);var a=c(b.of),d=a[0],g=(b.collision||"flip").split(" "),e=b.offset?b.offset.split(" "):[0,0],h,k,j;if(d.nodeType===9){h=a.width();k=a.height();j={top:0,left:0}}else if(d.setTimeout){h=a.width();k=a.height();j={top:a.scrollTop(),left:a.scrollLeft()}}else if(d.preventDefault){b.at="left top";h=k=0;j={top:b.of.pageY,
+left:b.of.pageX}}else{h=a.outerWidth();k=a.outerHeight();j=a.offset()}c.each(["my","at"],function(){var f=(b[this]||"").split(" ");if(f.length===1)f=n.test(f[0])?f.concat(["center"]):o.test(f[0])?["center"].concat(f):["center","center"];f[0]=n.test(f[0])?f[0]:"center";f[1]=o.test(f[1])?f[1]:"center";b[this]=f});if(g.length===1)g[1]=g[0];e[0]=parseInt(e[0],10)||0;if(e.length===1)e[1]=e[0];e[1]=parseInt(e[1],10)||0;if(b.at[0]==="right")j.left+=h;else if(b.at[0]==="center")j.left+=h/2;if(b.at[1]==="bottom")j.top+=
+k;else if(b.at[1]==="center")j.top+=k/2;j.left+=e[0];j.top+=e[1];return this.each(function(){var f=c(this),l=f.outerWidth(),m=f.outerHeight(),p=parseInt(c.curCSS(this,"marginLeft",true))||0,q=parseInt(c.curCSS(this,"marginTop",true))||0,v=l+p+(parseInt(c.curCSS(this,"marginRight",true))||0),w=m+q+(parseInt(c.curCSS(this,"marginBottom",true))||0),i=c.extend({},j),r;if(b.my[0]==="right")i.left-=l;else if(b.my[0]==="center")i.left-=l/2;if(b.my[1]==="bottom")i.top-=m;else if(b.my[1]==="center")i.top-=
+m/2;i.left=Math.round(i.left);i.top=Math.round(i.top);r={left:i.left-p,top:i.top-q};c.each(["left","top"],function(s,x){c.ui.position[g[s]]&&c.ui.position[g[s]][x](i,{targetWidth:h,targetHeight:k,elemWidth:l,elemHeight:m,collisionPosition:r,collisionWidth:v,collisionHeight:w,offset:e,my:b.my,at:b.at})});c.fn.bgiframe&&f.bgiframe();f.offset(c.extend(i,{using:b.using}))})};c.ui.position={fit:{left:function(b,a){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();b.left=
+d>0?b.left-d:Math.max(b.left-a.collisionPosition.left,b.left)},top:function(b,a){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();b.top=d>0?b.top-d:Math.max(b.top-a.collisionPosition.top,b.top)}},flip:{left:function(b,a){if(a.at[0]!=="center"){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();var g=a.my[0]==="left"?-a.elemWidth:a.my[0]==="right"?a.elemWidth:0,e=a.at[0]==="left"?a.targetWidth:-a.targetWidth,h=-2*a.offset[0];b.left+=
+a.collisionPosition.left<0?g+e+h:d>0?g+e+h:0}},top:function(b,a){if(a.at[1]!=="center"){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();var g=a.my[1]==="top"?-a.elemHeight:a.my[1]==="bottom"?a.elemHeight:0,e=a.at[1]==="top"?a.targetHeight:-a.targetHeight,h=-2*a.offset[1];b.top+=a.collisionPosition.top<0?g+e+h:d>0?g+e+h:0}}}};if(!c.offset.setOffset){c.offset.setOffset=function(b,a){if(/static/.test(c.curCSS(b,"position")))b.style.position="relative";var d=c(b),
+g=d.offset(),e=parseInt(c.curCSS(b,"top",true),10)||0,h=parseInt(c.curCSS(b,"left",true),10)||0;g={top:a.top-g.top+e,left:a.left-g.left+h};"using"in a?a.using.call(b,g):d.css(g)};c.fn.offset=function(b){var a=this[0];if(!a||!a.ownerDocument)return null;if(b)return this.each(function(){c.offset.setOffset(this,b)});return u.call(this)}}})(jQuery);
+;/*
+ * jQuery UI Draggable 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Draggables
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.mouse.js
+ *	jquery.ui.widget.js
+ */
+(function(d){d.widget("ui.draggable",d.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper==
+"original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(a){var b=
+this.options;if(this.helper||b.disabled||d(a.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(a);if(!this.handle)return false;if(b.iframeFix)d(b.iframeFix===true?"iframe":b.iframeFix).each(function(){d('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(d(this).offset()).appendTo("body")});return true},_mouseStart:function(a){var b=this.options;
+this.helper=this._createHelper(a);this._cacheHelperProportions();if(d.ui.ddmanager)d.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};d.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
+this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);b.containment&&this._setContainment();if(this._trigger("start",a)===false){this._clear();return false}this._cacheHelperProportions();d.ui.ddmanager&&!b.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,a);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(a,true);d.ui.ddmanager&&d.ui.ddmanager.dragStart(this,a);return true},
+_mouseDrag:function(a,b){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!b){b=this._uiHash();if(this._trigger("drag",a,b)===false){this._mouseUp({});return false}this.position=b.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";d.ui.ddmanager&&d.ui.ddmanager.drag(this,a);return false},_mouseStop:function(a){var b=
+false;if(d.ui.ddmanager&&!this.options.dropBehaviour)b=d.ui.ddmanager.drop(this,a);if(this.dropped){b=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!b||this.options.revert=="valid"&&b||this.options.revert===true||d.isFunction(this.options.revert)&&this.options.revert.call(this.element,b)){var c=this;d(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,
+10),function(){c._trigger("stop",a)!==false&&c._clear()})}else this._trigger("stop",a)!==false&&this._clear();return false},_mouseUp:function(a){this.options.iframeFix===true&&d("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});d.ui.ddmanager&&d.ui.ddmanager.dragStop(this,a);return d.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(a){var b=!this.options.handle||
+!d(this.options.handle,this.element).length?true:false;d(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==a.target)b=true});return b},_createHelper:function(a){var b=this.options;a=d.isFunction(b.helper)?d(b.helper.apply(this.element[0],[a])):b.helper=="clone"?this.element.clone().removeAttr("id"):this.element;a.parents("body").length||a.appendTo(b.appendTo=="parent"?this.element[0].parentNode:b.appendTo);a[0]!=this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&
+a.css("position","absolute");return a},_adjustOffsetFromHelper:function(a){if(typeof a=="string")a=a.split(" ");if(d.isArray(a))a={left:+a[0],top:+a[1]||0};if("left"in a)this.offset.click.left=a.left+this.margins.left;if("right"in a)this.offset.click.left=this.helperProportions.width-a.right+this.margins.left;if("top"in a)this.offset.click.top=a.top+this.margins.top;if("bottom"in a)this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=
+this.helper.offsetParent();var a=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0])){a.left+=this.scrollParent.scrollLeft();a.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&d.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
+10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),
+10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;if(a.containment=="parent")a.containment=this.helper[0].parentNode;if(a.containment=="document"||a.containment=="window")this.containment=[a.containment=="document"?0:d(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a.containment=="document"?0:d(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,
+(a.containment=="document"?0:d(window).scrollLeft())+d(a.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a.containment=="document"?0:d(window).scrollTop())+(d(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){a=d(a.containment);var b=a[0];if(b){a.offset();var c=d(b).css("overflow")!=
+"hidden";this.containment=[(parseInt(d(b).css("borderLeftWidth"),10)||0)+(parseInt(d(b).css("paddingLeft"),10)||0),(parseInt(d(b).css("borderTopWidth"),10)||0)+(parseInt(d(b).css("paddingTop"),10)||0),(c?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(d(b).css("borderLeftWidth"),10)||0)-(parseInt(d(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(c?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(d(b).css("borderTopWidth"),
+10)||0)-(parseInt(d(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=a}}else if(a.containment.constructor==Array)this.containment=a.containment},_convertPositionTo:function(a,b){if(!b)b=this.position;a=a=="absolute"?1:-1;var c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(c[0].tagName);return{top:b.top+
+this.offset.relative.top*a+this.offset.parent.top*a-(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:c.scrollTop())*a),left:b.left+this.offset.relative.left*a+this.offset.parent.left*a-(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:c.scrollLeft())*a)}},_generatePosition:function(a){var b=this.options,c=this.cssPosition=="absolute"&&
+!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(c[0].tagName),e=a.pageX,h=a.pageY;if(this.originalPosition){var g;if(this.containment){if(this.relative_container){g=this.relative_container.offset();g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]}else g=this.containment;if(a.pageX-this.offset.click.left<g[0])e=g[0]+this.offset.click.left;
+if(a.pageY-this.offset.click.top<g[1])h=g[1]+this.offset.click.top;if(a.pageX-this.offset.click.left>g[2])e=g[2]+this.offset.click.left;if(a.pageY-this.offset.click.top>g[3])h=g[3]+this.offset.click.top}if(b.grid){h=b.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/b.grid[1])*b.grid[1]:this.originalPageY;h=g?!(h-this.offset.click.top<g[1]||h-this.offset.click.top>g[3])?h:!(h-this.offset.click.top<g[1])?h-b.grid[1]:h+b.grid[1]:h;e=b.grid[0]?this.originalPageX+Math.round((e-this.originalPageX)/
+b.grid[0])*b.grid[0]:this.originalPageX;e=g?!(e-this.offset.click.left<g[0]||e-this.offset.click.left>g[2])?e:!(e-this.offset.click.left<g[0])?e-b.grid[0]:e+b.grid[0]:e}}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(d.browser.safari&&d.browser.version<
+526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(a,b,c){c=c||this._uiHash();d.ui.plugin.call(this,a,[b,c]);if(a=="drag")this.positionAbs=this._convertPositionTo("absolute");return d.Widget.prototype._trigger.call(this,a,b,
+c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});d.extend(d.ui.draggable,{version:"1.8.16"});d.ui.plugin.add("draggable","connectToSortable",{start:function(a,b){var c=d(this).data("draggable"),f=c.options,e=d.extend({},b,{item:c.element});c.sortables=[];d(f.connectToSortable).each(function(){var h=d.data(this,"sortable");if(h&&!h.options.disabled){c.sortables.push({instance:h,shouldRevert:h.options.revert});
+h.refreshPositions();h._trigger("activate",a,e)}})},stop:function(a,b){var c=d(this).data("draggable"),f=d.extend({},b,{item:c.element});d.each(c.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;c.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(a);this.instance.options.helper=this.instance.options._helper;c.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=
+false;this.instance._trigger("deactivate",a,f)}})},drag:function(a,b){var c=d(this).data("draggable"),f=this;d.each(c.sortables,function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=d(f).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);
+this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return b.helper[0]};a.target=this.instance.currentItem[0];this.instance._mouseCapture(a,true);this.instance._mouseStart(a,true,true);this.instance.offset.click.top=c.offset.click.top;this.instance.offset.click.left=c.offset.click.left;this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top;
+c._trigger("toSortable",a);c.dropped=this.instance.element;c.currentItem=c.element;this.instance.fromOutside=c}this.instance.currentItem&&this.instance._mouseDrag(a)}else if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",a,this.instance._uiHash(this.instance));this.instance._mouseStop(a,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&
+this.instance.placeholder.remove();c._trigger("fromSortable",a);c.dropped=false}})}});d.ui.plugin.add("draggable","cursor",{start:function(){var a=d("body"),b=d(this).data("draggable").options;if(a.css("cursor"))b._cursor=a.css("cursor");a.css("cursor",b.cursor)},stop:function(){var a=d(this).data("draggable").options;a._cursor&&d("body").css("cursor",a._cursor)}});d.ui.plugin.add("draggable","opacity",{start:function(a,b){a=d(b.helper);b=d(this).data("draggable").options;if(a.css("opacity"))b._opacity=
+a.css("opacity");a.css("opacity",b.opacity)},stop:function(a,b){a=d(this).data("draggable").options;a._opacity&&d(b.helper).css("opacity",a._opacity)}});d.ui.plugin.add("draggable","scroll",{start:function(){var a=d(this).data("draggable");if(a.scrollParent[0]!=document&&a.scrollParent[0].tagName!="HTML")a.overflowOffset=a.scrollParent.offset()},drag:function(a){var b=d(this).data("draggable"),c=b.options,f=false;if(b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML"){if(!c.axis||c.axis!=
+"x")if(b.overflowOffset.top+b.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity)b.scrollParent[0].scrollTop=f=b.scrollParent[0].scrollTop+c.scrollSpeed;else if(a.pageY-b.overflowOffset.top<c.scrollSensitivity)b.scrollParent[0].scrollTop=f=b.scrollParent[0].scrollTop-c.scrollSpeed;if(!c.axis||c.axis!="y")if(b.overflowOffset.left+b.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity)b.scrollParent[0].scrollLeft=f=b.scrollParent[0].scrollLeft+c.scrollSpeed;else if(a.pageX-b.overflowOffset.left<
+c.scrollSensitivity)b.scrollParent[0].scrollLeft=f=b.scrollParent[0].scrollLeft-c.scrollSpeed}else{if(!c.axis||c.axis!="x")if(a.pageY-d(document).scrollTop()<c.scrollSensitivity)f=d(document).scrollTop(d(document).scrollTop()-c.scrollSpeed);else if(d(window).height()-(a.pageY-d(document).scrollTop())<c.scrollSensitivity)f=d(document).scrollTop(d(document).scrollTop()+c.scrollSpeed);if(!c.axis||c.axis!="y")if(a.pageX-d(document).scrollLeft()<c.scrollSensitivity)f=d(document).scrollLeft(d(document).scrollLeft()-
+c.scrollSpeed);else if(d(window).width()-(a.pageX-d(document).scrollLeft())<c.scrollSensitivity)f=d(document).scrollLeft(d(document).scrollLeft()+c.scrollSpeed)}f!==false&&d.ui.ddmanager&&!c.dropBehaviour&&d.ui.ddmanager.prepareOffsets(b,a)}});d.ui.plugin.add("draggable","snap",{start:function(){var a=d(this).data("draggable"),b=a.options;a.snapElements=[];d(b.snap.constructor!=String?b.snap.items||":data(draggable)":b.snap).each(function(){var c=d(this),f=c.offset();this!=a.element[0]&&a.snapElements.push({item:this,
+width:c.outerWidth(),height:c.outerHeight(),top:f.top,left:f.left})})},drag:function(a,b){for(var c=d(this).data("draggable"),f=c.options,e=f.snapTolerance,h=b.offset.left,g=h+c.helperProportions.width,n=b.offset.top,o=n+c.helperProportions.height,i=c.snapElements.length-1;i>=0;i--){var j=c.snapElements[i].left,l=j+c.snapElements[i].width,k=c.snapElements[i].top,m=k+c.snapElements[i].height;if(j-e<h&&h<l+e&&k-e<n&&n<m+e||j-e<h&&h<l+e&&k-e<o&&o<m+e||j-e<g&&g<l+e&&k-e<n&&n<m+e||j-e<g&&g<l+e&&k-e<o&&
+o<m+e){if(f.snapMode!="inner"){var p=Math.abs(k-o)<=e,q=Math.abs(m-n)<=e,r=Math.abs(j-g)<=e,s=Math.abs(l-h)<=e;if(p)b.position.top=c._convertPositionTo("relative",{top:k-c.helperProportions.height,left:0}).top-c.margins.top;if(q)b.position.top=c._convertPositionTo("relative",{top:m,left:0}).top-c.margins.top;if(r)b.position.left=c._convertPositionTo("relative",{top:0,left:j-c.helperProportions.width}).left-c.margins.left;if(s)b.position.left=c._convertPositionTo("relative",{top:0,left:l}).left-c.margins.left}var t=
+p||q||r||s;if(f.snapMode!="outer"){p=Math.abs(k-n)<=e;q=Math.abs(m-o)<=e;r=Math.abs(j-h)<=e;s=Math.abs(l-g)<=e;if(p)b.position.top=c._convertPositionTo("relative",{top:k,left:0}).top-c.margins.top;if(q)b.position.top=c._convertPositionTo("relative",{top:m-c.helperProportions.height,left:0}).top-c.margins.top;if(r)b.position.left=c._convertPositionTo("relative",{top:0,left:j}).left-c.margins.left;if(s)b.position.left=c._convertPositionTo("relative",{top:0,left:l-c.helperProportions.width}).left-c.margins.left}if(!c.snapElements[i].snapping&&
+(p||q||r||s||t))c.options.snap.snap&&c.options.snap.snap.call(c.element,a,d.extend(c._uiHash(),{snapItem:c.snapElements[i].item}));c.snapElements[i].snapping=p||q||r||s||t}else{c.snapElements[i].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,a,d.extend(c._uiHash(),{snapItem:c.snapElements[i].item}));c.snapElements[i].snapping=false}}}});d.ui.plugin.add("draggable","stack",{start:function(){var a=d(this).data("draggable").options;a=d.makeArray(d(a.stack)).sort(function(c,f){return(parseInt(d(c).css("zIndex"),
+10)||0)-(parseInt(d(f).css("zIndex"),10)||0)});if(a.length){var b=parseInt(a[0].style.zIndex)||0;d(a).each(function(c){this.style.zIndex=b+c});this[0].style.zIndex=b+a.length}}});d.ui.plugin.add("draggable","zIndex",{start:function(a,b){a=d(b.helper);b=d(this).data("draggable").options;if(a.css("zIndex"))b._zIndex=a.css("zIndex");a.css("zIndex",b.zIndex)},stop:function(a,b){a=d(this).data("draggable").options;a._zIndex&&d(b.helper).css("zIndex",a._zIndex)}})})(jQuery);
+;/*
+ * jQuery UI Droppable 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Droppables
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.widget.js
+ *	jquery.ui.mouse.js
+ *	jquery.ui.draggable.js
+ */
+(function(d){d.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var a=this.options,b=a.accept;this.isover=0;this.isout=1;this.accept=d.isFunction(b)?b:function(c){return c.is(b)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};d.ui.ddmanager.droppables[a.scope]=d.ui.ddmanager.droppables[a.scope]||[];d.ui.ddmanager.droppables[a.scope].push(this);
+a.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var a=d.ui.ddmanager.droppables[this.options.scope],b=0;b<a.length;b++)a[b]==this&&a.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(a,b){if(a=="accept")this.accept=d.isFunction(b)?b:function(c){return c.is(b)};d.Widget.prototype._setOption.apply(this,arguments)},_activate:function(a){var b=d.ui.ddmanager.current;this.options.activeClass&&
+this.element.addClass(this.options.activeClass);b&&this._trigger("activate",a,this.ui(b))},_deactivate:function(a){var b=d.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);b&&this._trigger("deactivate",a,this.ui(b))},_over:function(a){var b=d.ui.ddmanager.current;if(!(!b||(b.currentItem||b.element)[0]==this.element[0]))if(this.accept.call(this.element[0],b.currentItem||b.element)){this.options.hoverClass&&this.element.addClass(this.options.hoverClass);
+this._trigger("over",a,this.ui(b))}},_out:function(a){var b=d.ui.ddmanager.current;if(!(!b||(b.currentItem||b.element)[0]==this.element[0]))if(this.accept.call(this.element[0],b.currentItem||b.element)){this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("out",a,this.ui(b))}},_drop:function(a,b){var c=b||d.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return false;var e=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var g=
+d.data(this,"droppable");if(g.options.greedy&&!g.options.disabled&&g.options.scope==c.options.scope&&g.accept.call(g.element[0],c.currentItem||c.element)&&d.ui.intersect(c,d.extend(g,{offset:g.element.offset()}),g.options.tolerance)){e=true;return false}});if(e)return false;if(this.accept.call(this.element[0],c.currentItem||c.element)){this.options.activeClass&&this.element.removeClass(this.options.activeClass);this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("drop",
+a,this.ui(c));return this.element}return false},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});d.extend(d.ui.droppable,{version:"1.8.16"});d.ui.intersect=function(a,b,c){if(!b.offset)return false;var e=(a.positionAbs||a.position.absolute).left,g=e+a.helperProportions.width,f=(a.positionAbs||a.position.absolute).top,h=f+a.helperProportions.height,i=b.offset.left,k=i+b.proportions.width,j=b.offset.top,l=j+b.proportions.height;
+switch(c){case "fit":return i<=e&&g<=k&&j<=f&&h<=l;case "intersect":return i<e+a.helperProportions.width/2&&g-a.helperProportions.width/2<k&&j<f+a.helperProportions.height/2&&h-a.helperProportions.height/2<l;case "pointer":return d.ui.isOver((a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,j,i,b.proportions.height,b.proportions.width);case "touch":return(f>=j&&f<=l||h>=j&&h<=l||f<j&&h>l)&&(e>=
+i&&e<=k||g>=i&&g<=k||e<i&&g>k);default:return false}};d.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(a,b){var c=d.ui.ddmanager.droppables[a.options.scope]||[],e=b?b.type:null,g=(a.currentItem||a.element).find(":data(droppable)").andSelf(),f=0;a:for(;f<c.length;f++)if(!(c[f].options.disabled||a&&!c[f].accept.call(c[f].element[0],a.currentItem||a.element))){for(var h=0;h<g.length;h++)if(g[h]==c[f].element[0]){c[f].proportions.height=0;continue a}c[f].visible=c[f].element.css("display")!=
+"none";if(c[f].visible){e=="mousedown"&&c[f]._activate.call(c[f],b);c[f].offset=c[f].element.offset();c[f].proportions={width:c[f].element[0].offsetWidth,height:c[f].element[0].offsetHeight}}}},drop:function(a,b){var c=false;d.each(d.ui.ddmanager.droppables[a.options.scope]||[],function(){if(this.options){if(!this.options.disabled&&this.visible&&d.ui.intersect(a,this,this.options.tolerance))c=c||this._drop.call(this,b);if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],a.currentItem||
+a.element)){this.isout=1;this.isover=0;this._deactivate.call(this,b)}}});return c},dragStart:function(a,b){a.element.parents(":not(body,html)").bind("scroll.droppable",function(){a.options.refreshPositions||d.ui.ddmanager.prepareOffsets(a,b)})},drag:function(a,b){a.options.refreshPositions&&d.ui.ddmanager.prepareOffsets(a,b);d.each(d.ui.ddmanager.droppables[a.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var c=d.ui.intersect(a,this,this.options.tolerance);
+if(c=!c&&this.isover==1?"isout":c&&this.isover==0?"isover":null){var e;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");if(g.length){e=d.data(g[0],"droppable");e.greedyChild=c=="isover"?1:0}}if(e&&c=="isover"){e.isover=0;e.isout=1;e._out.call(e,b)}this[c]=1;this[c=="isout"?"isover":"isout"]=0;this[c=="isover"?"_over":"_out"].call(this,b);if(e&&c=="isout"){e.isout=0;e.isover=1;e._over.call(e,b)}}}})},dragStop:function(a,b){a.element.parents(":not(body,html)").unbind("scroll.droppable");
+a.options.refreshPositions||d.ui.ddmanager.prepareOffsets(a,b)}}})(jQuery);
+;/*
+ * jQuery UI Resizable 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Resizables
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.mouse.js
+ *	jquery.ui.widget.js
+ */
+(function(e){e.widget("ui.resizable",e.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,a=this.options;this.element.addClass("ui-resizable");e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,
+_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){/relative/.test(this.element.css("position"))&&e.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"});this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),
+top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=
+this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=a.handles||(!e(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",
+nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all")this.handles="n,e,s,w,se,sw,ne,nw";var c=this.handles.split(",");this.handles={};for(var d=0;d<c.length;d++){var f=e.trim(c[d]),g=e('<div class="ui-resizable-handle '+("ui-resizable-"+f)+'"></div>');/sw|se|ne|nw/.test(f)&&g.css({zIndex:++a.zIndex});"se"==f&&g.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[f]=".ui-resizable-"+f;this.element.append(g)}}this._renderAxis=function(h){h=h||this.element;for(var i in this.handles){if(this.handles[i].constructor==
+String)this.handles[i]=e(this.handles[i],this.element).show();if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var j=e(this.handles[i],this.element),l=0;l=/sw|ne|nw|se|n|s/.test(i)?j.outerHeight():j.outerWidth();j=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");h.css(j,l);this._proportionallyResize()}e(this.handles[i])}};this._renderAxis(this.element);this._handles=e(".ui-resizable-handle",this.element).disableSelection();
+this._handles.mouseover(function(){if(!b.resizing){if(this.className)var h=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=h&&h[1]?h[1]:"se"}});if(a.autoHide){this._handles.hide();e(this.element).addClass("ui-resizable-autohide").hover(function(){if(!a.disabled){e(this).removeClass("ui-resizable-autohide");b._handles.show()}},function(){if(!a.disabled)if(!b.resizing){e(this).addClass("ui-resizable-autohide");b._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();
+var b=function(c){e(c).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var a=this.element;a.after(this.originalElement.css({position:a.css("position"),width:a.outerWidth(),height:a.outerHeight(),top:a.css("top"),left:a.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);b(this.originalElement);return this},_mouseCapture:function(b){var a=
+false;for(var c in this.handles)if(e(this.handles[c])[0]==b.target)a=true;return!this.options.disabled&&a},_mouseStart:function(b){var a=this.options,c=this.element.position(),d=this.element;this.resizing=true;this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()};if(d.is(".ui-draggable")||/absolute/.test(d.css("position")))d.css({position:"absolute",top:c.top,left:c.left});e.browser.opera&&/relative/.test(d.css("position"))&&d.css({position:"relative",top:"auto",left:"auto"});
+this._renderProxy();c=m(this.helper.css("left"));var f=m(this.helper.css("top"));if(a.containment){c+=e(a.containment).scrollLeft()||0;f+=e(a.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:c,top:f};this.size=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalSize=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalPosition={left:c,top:f};this.sizeDiff=
+{width:d.outerWidth()-d.width(),height:d.outerHeight()-d.height()};this.originalMousePosition={left:b.pageX,top:b.pageY};this.aspectRatio=typeof a.aspectRatio=="number"?a.aspectRatio:this.originalSize.width/this.originalSize.height||1;a=e(".ui-resizable-"+this.axis).css("cursor");e("body").css("cursor",a=="auto"?this.axis+"-resize":a);d.addClass("ui-resizable-resizing");this._propagate("start",b);return true},_mouseDrag:function(b){var a=this.helper,c=this.originalMousePosition,d=this._change[this.axis];
+if(!d)return false;c=d.apply(this,[b,b.pageX-c.left||0,b.pageY-c.top||0]);this._updateVirtualBoundaries(b.shiftKey);if(this._aspectRatio||b.shiftKey)c=this._updateRatio(c,b);c=this._respectSize(c,b);this._propagate("resize",b);a.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(c);this._trigger("resize",b,this.ui());return false},
+_mouseStop:function(b){this.resizing=false;var a=this.options,c=this;if(this._helper){var d=this._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName);d=f&&e.ui.hasScroll(d[0],"left")?0:c.sizeDiff.height;f=f?0:c.sizeDiff.width;f={width:c.helper.width()-f,height:c.helper.height()-d};d=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null;var g=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;a.animate||this.element.css(e.extend(f,
+{top:g,left:d}));c.helper.height(c.size.height);c.helper.width(c.size.width);this._helper&&!a.animate&&this._proportionallyResize()}e("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",b);this._helper&&this.helper.remove();return false},_updateVirtualBoundaries:function(b){var a=this.options,c,d,f;a={minWidth:k(a.minWidth)?a.minWidth:0,maxWidth:k(a.maxWidth)?a.maxWidth:Infinity,minHeight:k(a.minHeight)?a.minHeight:0,maxHeight:k(a.maxHeight)?a.maxHeight:
+Infinity};if(this._aspectRatio||b){b=a.minHeight*this.aspectRatio;d=a.minWidth/this.aspectRatio;c=a.maxHeight*this.aspectRatio;f=a.maxWidth/this.aspectRatio;if(b>a.minWidth)a.minWidth=b;if(d>a.minHeight)a.minHeight=d;if(c<a.maxWidth)a.maxWidth=c;if(f<a.maxHeight)a.maxHeight=f}this._vBoundaries=a},_updateCache:function(b){this.offset=this.helper.offset();if(k(b.left))this.position.left=b.left;if(k(b.top))this.position.top=b.top;if(k(b.height))this.size.height=b.height;if(k(b.width))this.size.width=
+b.width},_updateRatio:function(b){var a=this.position,c=this.size,d=this.axis;if(k(b.height))b.width=b.height*this.aspectRatio;else if(k(b.width))b.height=b.width/this.aspectRatio;if(d=="sw"){b.left=a.left+(c.width-b.width);b.top=null}if(d=="nw"){b.top=a.top+(c.height-b.height);b.left=a.left+(c.width-b.width)}return b},_respectSize:function(b){var a=this._vBoundaries,c=this.axis,d=k(b.width)&&a.maxWidth&&a.maxWidth<b.width,f=k(b.height)&&a.maxHeight&&a.maxHeight<b.height,g=k(b.width)&&a.minWidth&&
+a.minWidth>b.width,h=k(b.height)&&a.minHeight&&a.minHeight>b.height;if(g)b.width=a.minWidth;if(h)b.height=a.minHeight;if(d)b.width=a.maxWidth;if(f)b.height=a.maxHeight;var i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,l=/sw|nw|w/.test(c);c=/nw|ne|n/.test(c);if(g&&l)b.left=i-a.minWidth;if(d&&l)b.left=i-a.maxWidth;if(h&&c)b.top=j-a.minHeight;if(f&&c)b.top=j-a.maxHeight;if((a=!b.width&&!b.height)&&!b.left&&b.top)b.top=null;else if(a&&!b.top&&b.left)b.left=
+null;return b},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,a=0;a<this._proportionallyResizeElements.length;a++){var c=this._proportionallyResizeElements[a];if(!this.borderDif){var d=[c.css("borderTopWidth"),c.css("borderRightWidth"),c.css("borderBottomWidth"),c.css("borderLeftWidth")],f=[c.css("paddingTop"),c.css("paddingRight"),c.css("paddingBottom"),c.css("paddingLeft")];this.borderDif=e.map(d,function(g,h){g=parseInt(g,10)||
+0;h=parseInt(f[h],10)||0;return g+h})}e.browser.msie&&(e(b).is(":hidden")||e(b).parents(":hidden").length)||c.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var a=e.browser.msie&&e.browser.version<7,c=a?1:0;a=a?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+
+a,height:this.element.outerHeight()+a,position:"absolute",left:this.elementOffset.left-c+"px",top:this.elementOffset.top-c+"px",zIndex:++b.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(b,a){return{width:this.originalSize.width+a}},w:function(b,a){return{left:this.originalPosition.left+a,width:this.originalSize.width-a}},n:function(b,a,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(b,a,c){return{height:this.originalSize.height+
+c}},se:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},sw:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,a,c]))},ne:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},nw:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,a,c]))}},_propagate:function(b,a){e.ui.plugin.call(this,b,[a,this.ui()]);
+b!="resize"&&this._trigger(b,a,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});e.extend(e.ui.resizable,{version:"1.8.16"});e.ui.plugin.add("resizable","alsoResize",{start:function(){var b=e(this).data("resizable").options,a=function(c){e(c).each(function(){var d=e(this);d.data("resizable-alsoresize",{width:parseInt(d.width(),
+10),height:parseInt(d.height(),10),left:parseInt(d.css("left"),10),top:parseInt(d.css("top"),10),position:d.css("position")})})};if(typeof b.alsoResize=="object"&&!b.alsoResize.parentNode)if(b.alsoResize.length){b.alsoResize=b.alsoResize[0];a(b.alsoResize)}else e.each(b.alsoResize,function(c){a(c)});else a(b.alsoResize)},resize:function(b,a){var c=e(this).data("resizable");b=c.options;var d=c.originalSize,f=c.originalPosition,g={height:c.size.height-d.height||0,width:c.size.width-d.width||0,top:c.position.top-
+f.top||0,left:c.position.left-f.left||0},h=function(i,j){e(i).each(function(){var l=e(this),q=e(this).data("resizable-alsoresize"),p={},r=j&&j.length?j:l.parents(a.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(r,function(n,o){if((n=(q[o]||0)+(g[o]||0))&&n>=0)p[o]=n||null});if(e.browser.opera&&/relative/.test(l.css("position"))){c._revertToRelativePosition=true;l.css({position:"absolute",top:"auto",left:"auto"})}l.css(p)})};typeof b.alsoResize=="object"&&!b.alsoResize.nodeType?
+e.each(b.alsoResize,function(i,j){h(i,j)}):h(b.alsoResize)},stop:function(){var b=e(this).data("resizable"),a=b.options,c=function(d){e(d).each(function(){var f=e(this);f.css({position:f.data("resizable-alsoresize").position})})};if(b._revertToRelativePosition){b._revertToRelativePosition=false;typeof a.alsoResize=="object"&&!a.alsoResize.nodeType?e.each(a.alsoResize,function(d){c(d)}):c(a.alsoResize)}e(this).removeData("resizable-alsoresize")}});e.ui.plugin.add("resizable","animate",{stop:function(b){var a=
+e(this).data("resizable"),c=a.options,d=a._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName),g=f&&e.ui.hasScroll(d[0],"left")?0:a.sizeDiff.height;f={width:a.size.width-(f?0:a.sizeDiff.width),height:a.size.height-g};g=parseInt(a.element.css("left"),10)+(a.position.left-a.originalPosition.left)||null;var h=parseInt(a.element.css("top"),10)+(a.position.top-a.originalPosition.top)||null;a.element.animate(e.extend(f,h&&g?{top:h,left:g}:{}),{duration:c.animateDuration,easing:c.animateEasing,
+step:function(){var i={width:parseInt(a.element.css("width"),10),height:parseInt(a.element.css("height"),10),top:parseInt(a.element.css("top"),10),left:parseInt(a.element.css("left"),10)};d&&d.length&&e(d[0]).css({width:i.width,height:i.height});a._updateCache(i);a._propagate("resize",b)}})}});e.ui.plugin.add("resizable","containment",{start:function(){var b=e(this).data("resizable"),a=b.element,c=b.options.containment;if(a=c instanceof e?c.get(0):/parent/.test(c)?a.parent().get(0):c){b.containerElement=
+e(a);if(/document/.test(c)||c==document){b.containerOffset={left:0,top:0};b.containerPosition={left:0,top:0};b.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}}else{var d=e(a),f=[];e(["Top","Right","Left","Bottom"]).each(function(i,j){f[i]=m(d.css("padding"+j))});b.containerOffset=d.offset();b.containerPosition=d.position();b.containerSize={height:d.innerHeight()-f[3],width:d.innerWidth()-f[1]};c=b.containerOffset;
+var g=b.containerSize.height,h=b.containerSize.width;h=e.ui.hasScroll(a,"left")?a.scrollWidth:h;g=e.ui.hasScroll(a)?a.scrollHeight:g;b.parentData={element:a,left:c.left,top:c.top,width:h,height:g}}}},resize:function(b){var a=e(this).data("resizable"),c=a.options,d=a.containerOffset,f=a.position;b=a._aspectRatio||b.shiftKey;var g={top:0,left:0},h=a.containerElement;if(h[0]!=document&&/static/.test(h.css("position")))g=d;if(f.left<(a._helper?d.left:0)){a.size.width+=a._helper?a.position.left-d.left:
+a.position.left-g.left;if(b)a.size.height=a.size.width/c.aspectRatio;a.position.left=c.helper?d.left:0}if(f.top<(a._helper?d.top:0)){a.size.height+=a._helper?a.position.top-d.top:a.position.top;if(b)a.size.width=a.size.height*c.aspectRatio;a.position.top=a._helper?d.top:0}a.offset.left=a.parentData.left+a.position.left;a.offset.top=a.parentData.top+a.position.top;c=Math.abs((a._helper?a.offset.left-g.left:a.offset.left-g.left)+a.sizeDiff.width);d=Math.abs((a._helper?a.offset.top-g.top:a.offset.top-
+d.top)+a.sizeDiff.height);f=a.containerElement.get(0)==a.element.parent().get(0);g=/relative|absolute/.test(a.containerElement.css("position"));if(f&&g)c-=a.parentData.left;if(c+a.size.width>=a.parentData.width){a.size.width=a.parentData.width-c;if(b)a.size.height=a.size.width/a.aspectRatio}if(d+a.size.height>=a.parentData.height){a.size.height=a.parentData.height-d;if(b)a.size.width=a.size.height*a.aspectRatio}},stop:function(){var b=e(this).data("resizable"),a=b.options,c=b.containerOffset,d=b.containerPosition,
+f=b.containerElement,g=e(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width;g=g.outerHeight()-b.sizeDiff.height;b._helper&&!a.animate&&/relative/.test(f.css("position"))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g});b._helper&&!a.animate&&/static/.test(f.css("position"))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g})}});e.ui.plugin.add("resizable","ghost",{start:function(){var b=e(this).data("resizable"),a=b.options,c=b.size;b.ghost=b.originalElement.clone();b.ghost.css({opacity:0.25,
+display:"block",position:"relative",height:c.height,width:c.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof a.ghost=="string"?a.ghost:"");b.ghost.appendTo(b.helper)},resize:function(){var b=e(this).data("resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=e(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}});e.ui.plugin.add("resizable","grid",{resize:function(){var b=
+e(this).data("resizable"),a=b.options,c=b.size,d=b.originalSize,f=b.originalPosition,g=b.axis;a.grid=typeof a.grid=="number"?[a.grid,a.grid]:a.grid;var h=Math.round((c.width-d.width)/(a.grid[0]||1))*(a.grid[0]||1);a=Math.round((c.height-d.height)/(a.grid[1]||1))*(a.grid[1]||1);if(/^(se|s|e)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a}else if(/^(ne)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a;b.position.top=f.top-a}else{if(/^(sw)$/.test(g)){b.size.width=d.width+h;b.size.height=
+d.height+a}else{b.size.width=d.width+h;b.size.height=d.height+a;b.position.top=f.top-a}b.position.left=f.left-h}}});var m=function(b){return parseInt(b,10)||0},k=function(b){return!isNaN(parseInt(b,10))}})(jQuery);
+;/*
+ * jQuery UI Selectable 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Selectables
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.mouse.js
+ *	jquery.ui.widget.js
+ */
+(function(e){e.widget("ui.selectable",e.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var c=this;this.element.addClass("ui-selectable");this.dragged=false;var f;this.refresh=function(){f=e(c.options.filter,c.element[0]);f.each(function(){var d=e(this),b=d.offset();e.data(this,"selectable-item",{element:this,$element:d,left:b.left,top:b.top,right:b.left+d.outerWidth(),bottom:b.top+d.outerHeight(),startselected:false,selected:d.hasClass("ui-selected"),
+selecting:d.hasClass("ui-selecting"),unselecting:d.hasClass("ui-unselecting")})})};this.refresh();this.selectees=f.addClass("ui-selectee");this._mouseInit();this.helper=e("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(c){var f=this;this.opos=[c.pageX,
+c.pageY];if(!this.options.disabled){var d=this.options;this.selectees=e(d.filter,this.element[0]);this._trigger("start",c);e(d.appendTo).append(this.helper);this.helper.css({left:c.clientX,top:c.clientY,width:0,height:0});d.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var b=e.data(this,"selectable-item");b.startselected=true;if(!c.metaKey){b.$element.removeClass("ui-selected");b.selected=false;b.$element.addClass("ui-unselecting");b.unselecting=true;f._trigger("unselecting",
+c,{unselecting:b.element})}});e(c.target).parents().andSelf().each(function(){var b=e.data(this,"selectable-item");if(b){var g=!c.metaKey||!b.$element.hasClass("ui-selected");b.$element.removeClass(g?"ui-unselecting":"ui-selected").addClass(g?"ui-selecting":"ui-unselecting");b.unselecting=!g;b.selecting=g;(b.selected=g)?f._trigger("selecting",c,{selecting:b.element}):f._trigger("unselecting",c,{unselecting:b.element});return false}})}},_mouseDrag:function(c){var f=this;this.dragged=true;if(!this.options.disabled){var d=
+this.options,b=this.opos[0],g=this.opos[1],h=c.pageX,i=c.pageY;if(b>h){var j=h;h=b;b=j}if(g>i){j=i;i=g;g=j}this.helper.css({left:b,top:g,width:h-b,height:i-g});this.selectees.each(function(){var a=e.data(this,"selectable-item");if(!(!a||a.element==f.element[0])){var k=false;if(d.tolerance=="touch")k=!(a.left>h||a.right<b||a.top>i||a.bottom<g);else if(d.tolerance=="fit")k=a.left>b&&a.right<h&&a.top>g&&a.bottom<i;if(k){if(a.selected){a.$element.removeClass("ui-selected");a.selected=false}if(a.unselecting){a.$element.removeClass("ui-unselecting");
+a.unselecting=false}if(!a.selecting){a.$element.addClass("ui-selecting");a.selecting=true;f._trigger("selecting",c,{selecting:a.element})}}else{if(a.selecting)if(c.metaKey&&a.startselected){a.$element.removeClass("ui-selecting");a.selecting=false;a.$element.addClass("ui-selected");a.selected=true}else{a.$element.removeClass("ui-selecting");a.selecting=false;if(a.startselected){a.$element.addClass("ui-unselecting");a.unselecting=true}f._trigger("unselecting",c,{unselecting:a.element})}if(a.selected)if(!c.metaKey&&
+!a.startselected){a.$element.removeClass("ui-selected");a.selected=false;a.$element.addClass("ui-unselecting");a.unselecting=true;f._trigger("unselecting",c,{unselecting:a.element})}}}});return false}},_mouseStop:function(c){var f=this;this.dragged=false;e(".ui-unselecting",this.element[0]).each(function(){var d=e.data(this,"selectable-item");d.$element.removeClass("ui-unselecting");d.unselecting=false;d.startselected=false;f._trigger("unselected",c,{unselected:d.element})});e(".ui-selecting",this.element[0]).each(function(){var d=
+e.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected");d.selecting=false;d.selected=true;d.startselected=true;f._trigger("selected",c,{selected:d.element})});this._trigger("stop",c);this.helper.remove();return false}});e.extend(e.ui.selectable,{version:"1.8.16"})})(jQuery);
+;/*
+ * jQuery UI Sortable 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Sortables
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.mouse.js
+ *	jquery.ui.widget.js
+ */
+(function(d){d.widget("ui.sortable",d.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");
+this.refresh();this.floating=this.items.length?a.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData("sortable-item");return this},_setOption:function(a,b){if(a===
+"disabled"){this.options[a]=b;this.widget()[b?"addClass":"removeClass"]("ui-sortable-disabled")}else d.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(a,b){if(this.reverting)return false;if(this.options.disabled||this.options.type=="static")return false;this._refreshItems(a);var c=null,e=this;d(a.target).parents().each(function(){if(d.data(this,"sortable-item")==e){c=d(this);return false}});if(d.data(a.target,"sortable-item")==e)c=d(a.target);if(!c)return false;if(this.options.handle&&
+!b){var f=false;d(this.options.handle,c).find("*").andSelf().each(function(){if(this==a.target)f=true});if(!f)return false}this.currentItem=c;this._removeCurrentsFromItems();return true},_mouseStart:function(a,b,c){b=this.options;var e=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(a);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,
+left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");d.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};
+this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();b.containment&&this._setContainment();if(b.cursor){if(d("body").css("cursor"))this._storedCursor=d("body").css("cursor");d("body").css("cursor",b.cursor)}if(b.opacity){if(this.helper.css("opacity"))this._storedOpacity=this.helper.css("opacity");this.helper.css("opacity",b.opacity)}if(b.zIndex){if(this.helper.css("zIndex"))this._storedZIndex=this.helper.css("zIndex");this.helper.css("zIndex",b.zIndex)}if(this.scrollParent[0]!=
+document&&this.scrollParent[0].tagName!="HTML")this.overflowOffset=this.scrollParent.offset();this._trigger("start",a,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!c)for(c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("activate",a,e._uiHash(this));if(d.ui.ddmanager)d.ui.ddmanager.current=this;d.ui.ddmanager&&!b.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,a);this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(a);
+return true},_mouseDrag:function(a){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs)this.lastPositionAbs=this.positionAbs;if(this.options.scroll){var b=this.options,c=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<b.scrollSensitivity)this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+b.scrollSpeed;else if(a.pageY-this.overflowOffset.top<
+b.scrollSensitivity)this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-b.scrollSpeed;if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-a.pageX<b.scrollSensitivity)this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft+b.scrollSpeed;else if(a.pageX-this.overflowOffset.left<b.scrollSensitivity)this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-b.scrollSpeed}else{if(a.pageY-d(document).scrollTop()<b.scrollSensitivity)c=d(document).scrollTop(d(document).scrollTop()-
+b.scrollSpeed);else if(d(window).height()-(a.pageY-d(document).scrollTop())<b.scrollSensitivity)c=d(document).scrollTop(d(document).scrollTop()+b.scrollSpeed);if(a.pageX-d(document).scrollLeft()<b.scrollSensitivity)c=d(document).scrollLeft(d(document).scrollLeft()-b.scrollSpeed);else if(d(window).width()-(a.pageX-d(document).scrollLeft())<b.scrollSensitivity)c=d(document).scrollLeft(d(document).scrollLeft()+b.scrollSpeed)}c!==false&&d.ui.ddmanager&&!b.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,
+a)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(b=this.items.length-1;b>=0;b--){c=this.items[b];var e=c.item[0],f=this._intersectsWithPointer(c);if(f)if(e!=this.currentItem[0]&&this.placeholder[f==1?"next":"prev"]()[0]!=e&&!d.ui.contains(this.placeholder[0],e)&&(this.options.type=="semi-dynamic"?!d.ui.contains(this.element[0],
+e):true)){this.direction=f==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(c))this._rearrange(a,c);else break;this._trigger("change",a,this._uiHash());break}}this._contactContainers(a);d.ui.ddmanager&&d.ui.ddmanager.drag(this,a);this._trigger("sort",a,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(a,b){if(a){d.ui.ddmanager&&!this.options.dropBehaviour&&d.ui.ddmanager.drop(this,a);if(this.options.revert){var c=this;b=c.placeholder.offset();
+c.reverting=true;d(this.helper).animate({left:b.left-this.offset.parent.left-c.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:b.top-this.offset.parent.top-c.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){c._clear(a)})}else this._clear(a,b);return false}},cancel:function(){var a=this;if(this.dragging){this._mouseUp({target:null});this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):
+this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--){this.containers[b]._trigger("deactivate",null,a._uiHash(this));if(this.containers[b].containerCache.over){this.containers[b]._trigger("out",null,a._uiHash(this));this.containers[b].containerCache.over=0}}}if(this.placeholder){this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove();d.extend(this,{helper:null,
+dragging:false,reverting:false,_noFinalSort:null});this.domPosition.prev?d(this.domPosition.prev).after(this.currentItem):d(this.domPosition.parent).prepend(this.currentItem)}return this},serialize:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];a=a||{};d(b).each(function(){var e=(d(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[-=_](.+)/);if(e)c.push((a.key||e[1]+"[]")+"="+(a.key&&a.expression?e[1]:e[2]))});!c.length&&a.key&&c.push(a.key+"=");return c.join("&")},
+toArray:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];a=a||{};b.each(function(){c.push(d(a.item||this).attr(a.attribute||"id")||"")});return c},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,e=this.positionAbs.top,f=e+this.helperProportions.height,g=a.left,h=g+a.width,i=a.top,k=i+a.height,j=this.offset.click.top,l=this.offset.click.left;j=e+j>i&&e+j<k&&b+l>g&&b+l<h;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||
+this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?j:g<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<h&&i<e+this.helperProportions.height/2&&f-this.helperProportions.height/2<k},_intersectsWithPointer:function(a){var b=d.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height);a=d.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width);b=b&&a;a=this._getDragVerticalDirection();
+var c=this._getDragHorizontalDirection();if(!b)return false;return this.floating?c&&c=="right"||a=="down"?2:1:a&&(a=="down"?2:1)},_intersectsWithSides:function(a){var b=d.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height);a=d.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width);var c=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?e=="right"&&a||e=="left"&&!a:c&&(c=="down"&&b||c=="up"&&!b)},
+_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){this._refreshItems(a);this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(a){var b=[],c=[],e=this._connectWith();
+if(e&&a)for(a=e.length-1;a>=0;a--)for(var f=d(e[a]),g=f.length-1;g>=0;g--){var h=d.data(f[g],"sortable");if(h&&h!=this&&!h.options.disabled)c.push([d.isFunction(h.options.items)?h.options.items.call(h.element):d(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}c.push([d.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):d(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),
+this]);for(a=c.length-1;a>=0;a--)c[a][0].each(function(){b.push(this)});return d(b)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data(sortable-item)"),b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(a){this.items=[];this.containers=[this];var b=this.items,c=[[d.isFunction(this.options.items)?this.options.items.call(this.element[0],a,{item:this.currentItem}):d(this.options.items,this.element),
+this]],e=this._connectWith();if(e)for(var f=e.length-1;f>=0;f--)for(var g=d(e[f]),h=g.length-1;h>=0;h--){var i=d.data(g[h],"sortable");if(i&&i!=this&&!i.options.disabled){c.push([d.isFunction(i.options.items)?i.options.items.call(i.element[0],a,{item:this.currentItem}):d(i.options.items,i.element),i]);this.containers.push(i)}}for(f=c.length-1;f>=0;f--){a=c[f][1];e=c[f][0];h=0;for(g=e.length;h<g;h++){i=d(e[h]);i.data("sortable-item",a);b.push({item:i,instance:a,width:0,height:0,left:0,top:0})}}},refreshPositions:function(a){if(this.offsetParent&&
+this.helper)this.offset.parent=this._getParentOffset();for(var b=this.items.length-1;b>=0;b--){var c=this.items[b];if(!(c.instance!=this.currentContainer&&this.currentContainer&&c.item[0]!=this.currentItem[0])){var e=this.options.toleranceElement?d(this.options.toleranceElement,c.item):c.item;if(!a){c.width=e.outerWidth();c.height=e.outerHeight()}e=e.offset();c.left=e.left;c.top=e.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(b=
+this.containers.length-1;b>=0;b--){e=this.containers[b].element.offset();this.containers[b].containerCache.left=e.left;this.containers[b].containerCache.top=e.top;this.containers[b].containerCache.width=this.containers[b].element.outerWidth();this.containers[b].containerCache.height=this.containers[b].element.outerHeight()}return this},_createPlaceholder:function(a){var b=a||this,c=b.options;if(!c.placeholder||c.placeholder.constructor==String){var e=c.placeholder;c.placeholder={element:function(){var f=
+d(document.createElement(b.currentItem[0].nodeName)).addClass(e||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!e)f.style.visibility="hidden";return f},update:function(f,g){if(!(e&&!c.forcePlaceholderSize)){g.height()||g.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10));g.width()||g.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||
+0,10))}}}}b.placeholder=d(c.placeholder.element.call(b.element,b.currentItem));b.currentItem.after(b.placeholder);c.placeholder.update(b,b.placeholder)},_contactContainers:function(a){for(var b=null,c=null,e=this.containers.length-1;e>=0;e--)if(!d.ui.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(!(b&&d.ui.contains(this.containers[e].element[0],b.element[0]))){b=this.containers[e];c=e}}else if(this.containers[e].containerCache.over){this.containers[e]._trigger("out",
+a,this._uiHash(this));this.containers[e].containerCache.over=0}if(b)if(this.containers.length===1){this.containers[c]._trigger("over",a,this._uiHash(this));this.containers[c].containerCache.over=1}else if(this.currentContainer!=this.containers[c]){b=1E4;e=null;for(var f=this.positionAbs[this.containers[c].floating?"left":"top"],g=this.items.length-1;g>=0;g--)if(d.ui.contains(this.containers[c].element[0],this.items[g].item[0])){var h=this.items[g][this.containers[c].floating?"left":"top"];if(Math.abs(h-
+f)<b){b=Math.abs(h-f);e=this.items[g]}}if(e||this.options.dropOnEmpty){this.currentContainer=this.containers[c];e?this._rearrange(a,e,null,true):this._rearrange(a,null,this.containers[c].element,true);this._trigger("change",a,this._uiHash());this.containers[c]._trigger("change",a,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[c]._trigger("over",a,this._uiHash(this));this.containers[c].containerCache.over=1}}},_createHelper:function(a){var b=
+this.options;a=d.isFunction(b.helper)?d(b.helper.apply(this.element[0],[a,this.currentItem])):b.helper=="clone"?this.currentItem.clone():this.currentItem;a.parents("body").length||d(b.appendTo!="parent"?b.appendTo:this.currentItem[0].parentNode)[0].appendChild(a[0]);if(a[0]==this.currentItem[0])this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};if(a[0].style.width==
+""||b.forceHelperSize)a.width(this.currentItem.width());if(a[0].style.height==""||b.forceHelperSize)a.height(this.currentItem.height());return a},_adjustOffsetFromHelper:function(a){if(typeof a=="string")a=a.split(" ");if(d.isArray(a))a={left:+a[0],top:+a[1]||0};if("left"in a)this.offset.click.left=a.left+this.margins.left;if("right"in a)this.offset.click.left=this.helperProportions.width-a.right+this.margins.left;if("top"in a)this.offset.click.top=a.top+this.margins.top;if("bottom"in a)this.offset.click.top=
+this.helperProportions.height-a.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0])){a.left+=this.scrollParent.scrollLeft();a.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&d.browser.msie)a=
+{top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),
+10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;if(a.containment=="parent")a.containment=this.helper[0].parentNode;if(a.containment=="document"||a.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,d(a.containment=="document"?
+document:window).width()-this.helperProportions.width-this.margins.left,(d(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)){var b=d(a.containment)[0];a=d(a.containment).offset();var c=d(b).css("overflow")!="hidden";this.containment=[a.left+(parseInt(d(b).css("borderLeftWidth"),10)||0)+(parseInt(d(b).css("paddingLeft"),10)||0)-this.margins.left,a.top+(parseInt(d(b).css("borderTopWidth"),
+10)||0)+(parseInt(d(b).css("paddingTop"),10)||0)-this.margins.top,a.left+(c?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(d(b).css("borderLeftWidth"),10)||0)-(parseInt(d(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,a.top+(c?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(d(b).css("borderTopWidth"),10)||0)-(parseInt(d(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(a,b){if(!b)b=
+this.position;a=a=="absolute"?1:-1;var c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(c[0].tagName);return{top:b.top+this.offset.relative.top*a+this.offset.parent.top*a-(d.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:c.scrollTop())*a),left:b.left+this.offset.relative.left*a+this.offset.parent.left*a-(d.browser.safari&&
+this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:c.scrollLeft())*a)}},_generatePosition:function(a){var b=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(c[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]))this.offset.relative=this._getRelativeOffset();
+var f=a.pageX,g=a.pageY;if(this.originalPosition){if(this.containment){if(a.pageX-this.offset.click.left<this.containment[0])f=this.containment[0]+this.offset.click.left;if(a.pageY-this.offset.click.top<this.containment[1])g=this.containment[1]+this.offset.click.top;if(a.pageX-this.offset.click.left>this.containment[2])f=this.containment[2]+this.offset.click.left;if(a.pageY-this.offset.click.top>this.containment[3])g=this.containment[3]+this.offset.click.top}if(b.grid){g=this.originalPageY+Math.round((g-
+this.originalPageY)/b.grid[1])*b.grid[1];g=this.containment?!(g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3])?g:!(g-this.offset.click.top<this.containment[1])?g-b.grid[1]:g+b.grid[1]:g;f=this.originalPageX+Math.round((f-this.originalPageX)/b.grid[0])*b.grid[0];f=this.containment?!(f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2])?f:!(f-this.offset.click.left<this.containment[0])?f-b.grid[0]:f+b.grid[0]:f}}return{top:g-
+this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(d.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:c.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(d.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:c.scrollLeft())}},_rearrange:function(a,b,c,e){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],
+this.direction=="down"?b.item[0]:b.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var f=this,g=this.counter;window.setTimeout(function(){g==f.counter&&f.refreshPositions(!e)},0)},_clear:function(a,b){this.reverting=false;var c=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var e in this._storedCSS)if(this._storedCSS[e]=="auto"||this._storedCSS[e]=="static")this._storedCSS[e]=
+"";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!b&&c.push(function(f){this._trigger("receive",f,this._uiHash(this.fromOutside))});if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!b)c.push(function(f){this._trigger("update",f,this._uiHash())});if(!d.ui.contains(this.element[0],this.currentItem[0])){b||c.push(function(f){this._trigger("remove",
+f,this._uiHash())});for(e=this.containers.length-1;e>=0;e--)if(d.ui.contains(this.containers[e].element[0],this.currentItem[0])&&!b){c.push(function(f){return function(g){f._trigger("receive",g,this._uiHash(this))}}.call(this,this.containers[e]));c.push(function(f){return function(g){f._trigger("update",g,this._uiHash(this))}}.call(this,this.containers[e]))}}for(e=this.containers.length-1;e>=0;e--){b||c.push(function(f){return function(g){f._trigger("deactivate",g,this._uiHash(this))}}.call(this,
+this.containers[e]));if(this.containers[e].containerCache.over){c.push(function(f){return function(g){f._trigger("out",g,this._uiHash(this))}}.call(this,this.containers[e]));this.containers[e].containerCache.over=0}}this._storedCursor&&d("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);if(this._storedZIndex)this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex);this.dragging=false;if(this.cancelHelperRemoval){if(!b){this._trigger("beforeStop",
+a,this._uiHash());for(e=0;e<c.length;e++)c[e].call(this,a);this._trigger("stop",a,this._uiHash())}return false}b||this._trigger("beforeStop",a,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!b){for(e=0;e<c.length;e++)c[e].call(this,a);this._trigger("stop",a,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){d.Widget.prototype._trigger.apply(this,arguments)===false&&this.cancel()},
+_uiHash:function(a){var b=a||this;return{helper:b.helper,placeholder:b.placeholder||d([]),position:b.position,originalPosition:b.originalPosition,offset:b.positionAbs,item:b.currentItem,sender:a?a.element:null}}});d.extend(d.ui.sortable,{version:"1.8.16"})})(jQuery);
+;/*
+ * jQuery UI Accordion 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Accordion
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.widget.js
+ */
+(function(c){c.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var a=this,b=a.options;a.running=0;a.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");
+a.headers=a.element.find(b.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){b.disabled||c(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){b.disabled||c(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){b.disabled||c(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){b.disabled||c(this).removeClass("ui-state-focus")});a.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");
+if(b.navigation){var d=a.element.find("a").filter(b.navigationFilter).eq(0);if(d.length){var h=d.closest(".ui-accordion-header");a.active=h.length?h:d.closest(".ui-accordion-content").prev()}}a.active=a._findActive(a.active||b.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");a.active.next().addClass("ui-accordion-content-active");a._createIcons();a.resize();a.element.attr("role","tablist");a.headers.attr("role","tab").bind("keydown.accordion",
+function(f){return a._keydown(f)}).next().attr("role","tabpanel");a.headers.not(a.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();a.active.length?a.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):a.headers.eq(0).attr("tabIndex",0);c.browser.safari||a.headers.find("a").attr("tabIndex",-1);b.event&&a.headers.bind(b.event.split(" ").join(".accordion ")+".accordion",function(f){a._clickHandler.call(a,f,this);f.preventDefault()})},_createIcons:function(){var a=
+this.options;if(a.icons){c("<span></span>").addClass("ui-icon "+a.icons.header).prependTo(this.headers);this.active.children(".ui-icon").toggleClass(a.icons.header).toggleClass(a.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var a=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex");
+this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var b=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(a.autoHeight||a.fillHeight)b.css("height","");return c.Widget.prototype.destroy.call(this)},_setOption:function(a,b){c.Widget.prototype._setOption.apply(this,arguments);a=="active"&&this.activate(b);if(a=="icons"){this._destroyIcons();
+b&&this._createIcons()}if(a=="disabled")this.headers.add(this.headers.next())[b?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(a){if(!(this.options.disabled||a.altKey||a.ctrlKey)){var b=c.ui.keyCode,d=this.headers.length,h=this.headers.index(a.target),f=false;switch(a.keyCode){case b.RIGHT:case b.DOWN:f=this.headers[(h+1)%d];break;case b.LEFT:case b.UP:f=this.headers[(h-1+d)%d];break;case b.SPACE:case b.ENTER:this._clickHandler({target:a.target},a.target);
+a.preventDefault()}if(f){c(a.target).attr("tabIndex",-1);c(f).attr("tabIndex",0);f.focus();return false}return true}},resize:function(){var a=this.options,b;if(a.fillSpace){if(c.browser.msie){var d=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}b=this.element.parent().height();c.browser.msie&&this.element.parent().css("overflow",d);this.headers.each(function(){b-=c(this).outerHeight(true)});this.headers.next().each(function(){c(this).height(Math.max(0,b-c(this).innerHeight()+
+c(this).height()))}).css("overflow","auto")}else if(a.autoHeight){b=0;this.headers.next().each(function(){b=Math.max(b,c(this).height("").height())}).height(b)}return this},activate:function(a){this.options.active=a;a=this._findActive(a)[0];this._clickHandler({target:a},a);return this},_findActive:function(a){return a?typeof a==="number"?this.headers.filter(":eq("+a+")"):this.headers.not(this.headers.not(a)):a===false?c([]):this.headers.filter(":eq(0)")},_clickHandler:function(a,b){var d=this.options;
+if(!d.disabled)if(a.target){a=c(a.currentTarget||b);b=a[0]===this.active[0];d.active=d.collapsible&&b?false:this.headers.index(a);if(!(this.running||!d.collapsible&&b)){var h=this.active;j=a.next();g=this.active.next();e={options:d,newHeader:b&&d.collapsible?c([]):a,oldHeader:this.active,newContent:b&&d.collapsible?c([]):j,oldContent:g};var f=this.headers.index(this.active[0])>this.headers.index(a[0]);this.active=b?c([]):a;this._toggle(j,g,e,b,f);h.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header);
+if(!b){a.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(d.icons.header).addClass(d.icons.headerSelected);a.next().addClass("ui-accordion-content-active")}}}else if(d.collapsible){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header);this.active.next().addClass("ui-accordion-content-active");var g=this.active.next(),
+e={options:d,newHeader:c([]),oldHeader:d.active,newContent:c([]),oldContent:g},j=this.active=c([]);this._toggle(j,g,e)}},_toggle:function(a,b,d,h,f){var g=this,e=g.options;g.toShow=a;g.toHide=b;g.data=d;var j=function(){if(g)return g._completed.apply(g,arguments)};g._trigger("changestart",null,g.data);g.running=b.size()===0?a.size():b.size();if(e.animated){d={};d=e.collapsible&&h?{toShow:c([]),toHide:b,complete:j,down:f,autoHeight:e.autoHeight||e.fillSpace}:{toShow:a,toHide:b,complete:j,down:f,autoHeight:e.autoHeight||
+e.fillSpace};if(!e.proxied)e.proxied=e.animated;if(!e.proxiedDuration)e.proxiedDuration=e.duration;e.animated=c.isFunction(e.proxied)?e.proxied(d):e.proxied;e.duration=c.isFunction(e.proxiedDuration)?e.proxiedDuration(d):e.proxiedDuration;h=c.ui.accordion.animations;var i=e.duration,k=e.animated;if(k&&!h[k]&&!c.easing[k])k="slide";h[k]||(h[k]=function(l){this.slide(l,{easing:k,duration:i||700})});h[k](d)}else{if(e.collapsible&&h)a.toggle();else{b.hide();a.show()}j(true)}b.prev().attr({"aria-expanded":"false",
+"aria-selected":"false",tabIndex:-1}).blur();a.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(a){this.running=a?0:--this.running;if(!this.running){this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""});this.toHide.removeClass("ui-accordion-content-active");if(this.toHide.length)this.toHide.parent()[0].className=this.toHide.parent()[0].className;this._trigger("change",null,this.data)}}});c.extend(c.ui.accordion,{version:"1.8.16",
+animations:{slide:function(a,b){a=c.extend({easing:"swing",duration:300},a,b);if(a.toHide.size())if(a.toShow.size()){var d=a.toShow.css("overflow"),h=0,f={},g={},e;b=a.toShow;e=b[0].style.width;b.width(parseInt(b.parent().width(),10)-parseInt(b.css("paddingLeft"),10)-parseInt(b.css("paddingRight"),10)-(parseInt(b.css("borderLeftWidth"),10)||0)-(parseInt(b.css("borderRightWidth"),10)||0));c.each(["height","paddingTop","paddingBottom"],function(j,i){g[i]="hide";j=(""+c.css(a.toShow[0],i)).match(/^([\d+-.]+)(.*)$/);
+f[i]={value:j[1],unit:j[2]||"px"}});a.toShow.css({height:0,overflow:"hidden"}).show();a.toHide.filter(":hidden").each(a.complete).end().filter(":visible").animate(g,{step:function(j,i){if(i.prop=="height")h=i.end-i.start===0?0:(i.now-i.start)/(i.end-i.start);a.toShow[0].style[i.prop]=h*f[i.prop].value+f[i.prop].unit},duration:a.duration,easing:a.easing,complete:function(){a.autoHeight||a.toShow.css("height","");a.toShow.css({width:e,overflow:d});a.complete()}})}else a.toHide.animate({height:"hide",
+paddingTop:"hide",paddingBottom:"hide"},a);else a.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},a)},bounceslide:function(a){this.slide(a,{easing:a.down?"easeOutBounce":"swing",duration:a.down?1E3:200})}}})})(jQuery);
+;/*
+ * jQuery UI Autocomplete 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Autocomplete
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.widget.js
+ *	jquery.ui.position.js
+ */
+(function(d){var e=0;d.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var a=this,b=this.element[0].ownerDocument,g;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(!(a.options.disabled||a.element.propAttr("readOnly"))){g=
+false;var f=d.ui.keyCode;switch(c.keyCode){case f.PAGE_UP:a._move("previousPage",c);break;case f.PAGE_DOWN:a._move("nextPage",c);break;case f.UP:a._move("previous",c);c.preventDefault();break;case f.DOWN:a._move("next",c);c.preventDefault();break;case f.ENTER:case f.NUMPAD_ENTER:if(a.menu.active){g=true;c.preventDefault()}case f.TAB:if(!a.menu.active)return;a.menu.select(c);break;case f.ESCAPE:a.element.val(a.term);a.close(c);break;default:clearTimeout(a.searching);a.searching=setTimeout(function(){if(a.term!=
+a.element.val()){a.selectedItem=null;a.search(null,c)}},a.options.delay);break}}}).bind("keypress.autocomplete",function(c){if(g){g=false;c.preventDefault()}}).bind("focus.autocomplete",function(){if(!a.options.disabled){a.selectedItem=null;a.previous=a.element.val()}}).bind("blur.autocomplete",function(c){if(!a.options.disabled){clearTimeout(a.searching);a.closing=setTimeout(function(){a.close(c);a._change(c)},150)}});this._initSource();this.response=function(){return a._response.apply(a,arguments)};
+this.menu=d("<ul></ul>").addClass("ui-autocomplete").appendTo(d(this.options.appendTo||"body",b)[0]).mousedown(function(c){var f=a.menu.element[0];d(c.target).closest(".ui-menu-item").length||setTimeout(function(){d(document).one("mousedown",function(h){h.target!==a.element[0]&&h.target!==f&&!d.ui.contains(f,h.target)&&a.close()})},1);setTimeout(function(){clearTimeout(a.closing)},13)}).menu({focus:function(c,f){f=f.item.data("item.autocomplete");false!==a._trigger("focus",c,{item:f})&&/^key/.test(c.originalEvent.type)&&
+a.element.val(f.value)},selected:function(c,f){var h=f.item.data("item.autocomplete"),i=a.previous;if(a.element[0]!==b.activeElement){a.element.focus();a.previous=i;setTimeout(function(){a.previous=i;a.selectedItem=h},1)}false!==a._trigger("select",c,{item:h})&&a.element.val(h.value);a.term=a.element.val();a.close(c);a.selectedItem=h},blur:function(){a.menu.element.is(":visible")&&a.element.val()!==a.term&&a.element.val(a.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");
+d.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();d.Widget.prototype.destroy.call(this)},_setOption:function(a,b){d.Widget.prototype._setOption.apply(this,arguments);a==="source"&&this._initSource();if(a==="appendTo")this.menu.element.appendTo(d(b||"body",this.element[0].ownerDocument)[0]);a==="disabled"&&
+b&&this.xhr&&this.xhr.abort()},_initSource:function(){var a=this,b,g;if(d.isArray(this.options.source)){b=this.options.source;this.source=function(c,f){f(d.ui.autocomplete.filter(b,c.term))}}else if(typeof this.options.source==="string"){g=this.options.source;this.source=function(c,f){a.xhr&&a.xhr.abort();a.xhr=d.ajax({url:g,data:c,dataType:"json",autocompleteRequest:++e,success:function(h){this.autocompleteRequest===e&&f(h)},error:function(){this.autocompleteRequest===e&&f([])}})}}else this.source=
+this.options.source},search:function(a,b){a=a!=null?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(this._trigger("search",b)!==false)return this._search(a)},_search:function(a){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:a},this.response)},_response:function(a){if(!this.options.disabled&&a&&a.length){a=this._normalize(a);this._suggest(a);this._trigger("open")}else this.close();
+this.pending--;this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",a)}},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(a){if(a.length&&a[0].label&&a[0].value)return a;return d.map(a,function(b){if(typeof b==="string")return{label:b,value:b};return d.extend({label:b.label||
+b.value,value:b.value||b.label},b)})},_suggest:function(a){var b=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(b,a);this.menu.deactivate();this.menu.refresh();b.show();this._resizeMenu();b.position(d.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next(new d.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(a,b){var g=this;
+d.each(b,function(c,f){g._renderItem(a,f)})},_renderItem:function(a,b){return d("<li></li>").data("item.autocomplete",b).append(d("<a></a>").text(b.label)).appendTo(a)},_move:function(a,b){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term);this.menu.deactivate()}else this.menu[a](b);else this.search(null,b)},widget:function(){return this.menu.element}});d.extend(d.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,
+"\\$&")},filter:function(a,b){var g=new RegExp(d.ui.autocomplete.escapeRegex(b),"i");return d.grep(a,function(c){return g.test(c.label||c.value||c)})}})})(jQuery);
+(function(d){d.widget("ui.menu",{_create:function(){var e=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(a){if(d(a.target).closest(".ui-menu-item a").length){a.preventDefault();e.select(a)}});this.refresh()},refresh:function(){var e=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
+-1).mouseenter(function(a){e.activate(a,d(this).parent())}).mouseleave(function(){e.deactivate()})},activate:function(e,a){this.deactivate();if(this.hasScroll()){var b=a.offset().top-this.element.offset().top,g=this.element.scrollTop(),c=this.element.height();if(b<0)this.element.scrollTop(g+b);else b>=c&&this.element.scrollTop(g+b-c+a.height())}this.active=a.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",e,{item:a})},deactivate:function(){if(this.active){this.active.children("a").removeClass("ui-state-hover").removeAttr("id");
+this._trigger("blur");this.active=null}},next:function(e){this.move("next",".ui-menu-item:first",e)},previous:function(e){this.move("prev",".ui-menu-item:last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(e,a,b){if(this.active){e=this.active[e+"All"](".ui-menu-item").eq(0);e.length?this.activate(b,e):this.activate(b,this.element.children(a))}else this.activate(b,
+this.element.children(a))},nextPage:function(e){if(this.hasScroll())if(!this.active||this.last())this.activate(e,this.element.children(".ui-menu-item:first"));else{var a=this.active.offset().top,b=this.element.height(),g=this.element.children(".ui-menu-item").filter(function(){var c=d(this).offset().top-a-b+d(this).height();return c<10&&c>-10});g.length||(g=this.element.children(".ui-menu-item:last"));this.activate(e,g)}else this.activate(e,this.element.children(".ui-menu-item").filter(!this.active||
+this.last()?":first":":last"))},previousPage:function(e){if(this.hasScroll())if(!this.active||this.first())this.activate(e,this.element.children(".ui-menu-item:last"));else{var a=this.active.offset().top,b=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var g=d(this).offset().top-a+b-d(this).height();return g<10&&g>-10});result.length||(result=this.element.children(".ui-menu-item:first"));this.activate(e,result)}else this.activate(e,this.element.children(".ui-menu-item").filter(!this.active||
+this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[d.fn.prop?"prop":"attr"]("scrollHeight")},select:function(e){this._trigger("selected",e,{item:this.active})}})})(jQuery);
+;/*
+ * jQuery UI Button 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Button
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.widget.js
+ */
+(function(b){var h,i,j,g,l=function(){var a=b(this).find(":ui-button");setTimeout(function(){a.button("refresh")},1)},k=function(a){var c=a.name,e=a.form,f=b([]);if(c)f=e?b(e).find("[name='"+c+"']"):b("[name='"+c+"']",a.ownerDocument).filter(function(){return!this.form});return f};b.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",l);if(typeof this.options.disabled!==
+"boolean")this.options.disabled=this.element.propAttr("disabled");this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var a=this,c=this.options,e=this.type==="checkbox"||this.type==="radio",f="ui-state-hover"+(!e?" ui-state-active":"");if(c.label===null)c.label=this.buttonElement.html();if(this.element.is(":disabled"))c.disabled=true;this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",function(){if(!c.disabled){b(this).addClass("ui-state-hover");
+this===h&&b(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){c.disabled||b(this).removeClass(f)}).bind("click.button",function(d){if(c.disabled){d.preventDefault();d.stopImmediatePropagation()}});this.element.bind("focus.button",function(){a.buttonElement.addClass("ui-state-focus")}).bind("blur.button",function(){a.buttonElement.removeClass("ui-state-focus")});if(e){this.element.bind("change.button",function(){g||a.refresh()});this.buttonElement.bind("mousedown.button",function(d){if(!c.disabled){g=
+false;i=d.pageX;j=d.pageY}}).bind("mouseup.button",function(d){if(!c.disabled)if(i!==d.pageX||j!==d.pageY)g=true})}if(this.type==="checkbox")this.buttonElement.bind("click.button",function(){if(c.disabled||g)return false;b(this).toggleClass("ui-state-active");a.buttonElement.attr("aria-pressed",a.element[0].checked)});else if(this.type==="radio")this.buttonElement.bind("click.button",function(){if(c.disabled||g)return false;b(this).addClass("ui-state-active");a.buttonElement.attr("aria-pressed","true");
+var d=a.element[0];k(d).not(d).map(function(){return b(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")});else{this.buttonElement.bind("mousedown.button",function(){if(c.disabled)return false;b(this).addClass("ui-state-active");h=this;b(document).one("mouseup",function(){h=null})}).bind("mouseup.button",function(){if(c.disabled)return false;b(this).removeClass("ui-state-active")}).bind("keydown.button",function(d){if(c.disabled)return false;if(d.keyCode==b.ui.keyCode.SPACE||
+d.keyCode==b.ui.keyCode.ENTER)b(this).addClass("ui-state-active")}).bind("keyup.button",function(){b(this).removeClass("ui-state-active")});this.buttonElement.is("a")&&this.buttonElement.keyup(function(d){d.keyCode===b.ui.keyCode.SPACE&&b(this).click()})}this._setOption("disabled",c.disabled);this._resetButton()},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if(this.type==="checkbox"||this.type===
+"radio"){var a=this.element.parents().filter(":last"),c="label[for='"+this.element.attr("id")+"']";this.buttonElement=a.find(c);if(!this.buttonElement.length){a=a.length?a.siblings():this.element.siblings();this.buttonElement=a.filter(c);if(!this.buttonElement.length)this.buttonElement=a.find(c)}this.element.addClass("ui-helper-hidden-accessible");(a=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",a)}else this.buttonElement=this.element},
+widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());this.hasTitle||this.buttonElement.removeAttr("title");
+b.Widget.prototype.destroy.call(this)},_setOption:function(a,c){b.Widget.prototype._setOption.apply(this,arguments);if(a==="disabled")c?this.element.propAttr("disabled",true):this.element.propAttr("disabled",false);else this._resetButton()},refresh:function(){var a=this.element.is(":disabled");a!==this.options.disabled&&this._setOption("disabled",a);if(this.type==="radio")k(this.element[0]).each(function(){b(this).is(":checked")?b(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
+"true"):b(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")});else if(this.type==="checkbox")this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false")},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var a=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
+c=b("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(a.empty()).text(),e=this.options.icons,f=e.primary&&e.secondary,d=[];if(e.primary||e.secondary){if(this.options.text)d.push("ui-button-text-icon"+(f?"s":e.primary?"-primary":"-secondary"));e.primary&&a.prepend("<span class='ui-button-icon-primary ui-icon "+e.primary+"'></span>");e.secondary&&a.append("<span class='ui-button-icon-secondary ui-icon "+e.secondary+"'></span>");if(!this.options.text){d.push(f?"ui-button-icons-only":
+"ui-button-icon-only");this.hasTitle||a.attr("title",c)}}else d.push("ui-button-text-only");a.addClass(d.join(" "))}}});b.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,c){a==="disabled"&&this.buttons.button("option",a,c);b.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var a=this.element.css("direction")===
+"ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return b(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(a?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(a?"ui-corner-right":"ui-corner-left").end().end()},destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return b(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");
+b.Widget.prototype.destroy.call(this)}})})(jQuery);
+;/*
+ * jQuery UI Dialog 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Dialog
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.widget.js
+ *  jquery.ui.button.js
+ *	jquery.ui.draggable.js
+ *	jquery.ui.mouse.js
+ *	jquery.ui.position.js
+ *	jquery.ui.resizable.js
+ */
+(function(c,l){var m={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},n={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},o=c.attrFn||{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true,click:true};c.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,
+position:{my:"center",at:"center",collision:"fit",using:function(a){var b=c(this).css(a).offset().top;b<0&&c(this).css("top",a.top-b)}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string")this.originalTitle="";this.options.title=this.options.title||this.originalTitle;var a=this,b=a.options,d=b.title||"&#160;",e=c.ui.dialog.getTitleId(a.element),g=(a.uiDialog=c("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+
+b.dialogClass).css({zIndex:b.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(i){if(b.closeOnEscape&&!i.isDefaultPrevented()&&i.keyCode&&i.keyCode===c.ui.keyCode.ESCAPE){a.close(i);i.preventDefault()}}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(i){a.moveToTop(false,i)});a.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(g);var f=(a.uiDialogTitlebar=c("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(g),
+h=c('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){h.addClass("ui-state-hover")},function(){h.removeClass("ui-state-hover")}).focus(function(){h.addClass("ui-state-focus")}).blur(function(){h.removeClass("ui-state-focus")}).click(function(i){a.close(i);return false}).appendTo(f);(a.uiDialogTitlebarCloseText=c("<span></span>")).addClass("ui-icon ui-icon-closethick").text(b.closeText).appendTo(h);c("<span></span>").addClass("ui-dialog-title").attr("id",
+e).html(d).prependTo(f);if(c.isFunction(b.beforeclose)&&!c.isFunction(b.beforeClose))b.beforeClose=b.beforeclose;f.find("*").add(f).disableSelection();b.draggable&&c.fn.draggable&&a._makeDraggable();b.resizable&&c.fn.resizable&&a._makeResizable();a._createButtons(b.buttons);a._isOpen=false;c.fn.bgiframe&&g.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;a.overlay&&a.overlay.destroy();a.uiDialog.hide();a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");
+a.uiDialog.remove();a.originalTitle&&a.element.attr("title",a.originalTitle);return a},widget:function(){return this.uiDialog},close:function(a){var b=this,d,e;if(false!==b._trigger("beforeClose",a)){b.overlay&&b.overlay.destroy();b.uiDialog.unbind("keypress.ui-dialog");b._isOpen=false;if(b.options.hide)b.uiDialog.hide(b.options.hide,function(){b._trigger("close",a)});else{b.uiDialog.hide();b._trigger("close",a)}c.ui.dialog.overlay.resize();if(b.options.modal){d=0;c(".ui-dialog").each(function(){if(this!==
+b.uiDialog[0]){e=c(this).css("z-index");isNaN(e)||(d=Math.max(d,e))}});c.ui.dialog.maxZ=d}return b}},isOpen:function(){return this._isOpen},moveToTop:function(a,b){var d=this,e=d.options;if(e.modal&&!a||!e.stack&&!e.modal)return d._trigger("focus",b);if(e.zIndex>c.ui.dialog.maxZ)c.ui.dialog.maxZ=e.zIndex;if(d.overlay){c.ui.dialog.maxZ+=1;d.overlay.$el.css("z-index",c.ui.dialog.overlay.maxZ=c.ui.dialog.maxZ)}a={scrollTop:d.element.scrollTop(),scrollLeft:d.element.scrollLeft()};c.ui.dialog.maxZ+=1;
+d.uiDialog.css("z-index",c.ui.dialog.maxZ);d.element.attr(a);d._trigger("focus",b);return d},open:function(){if(!this._isOpen){var a=this,b=a.options,d=a.uiDialog;a.overlay=b.modal?new c.ui.dialog.overlay(a):null;a._size();a._position(b.position);d.show(b.show);a.moveToTop(true);b.modal&&d.bind("keypress.ui-dialog",function(e){if(e.keyCode===c.ui.keyCode.TAB){var g=c(":tabbable",this),f=g.filter(":first");g=g.filter(":last");if(e.target===g[0]&&!e.shiftKey){f.focus(1);return false}else if(e.target===
+f[0]&&e.shiftKey){g.focus(1);return false}}});c(a.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus();a._isOpen=true;a._trigger("open");return a}},_createButtons:function(a){var b=this,d=false,e=c("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g=c("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);b.uiDialog.find(".ui-dialog-buttonpane").remove();typeof a==="object"&&a!==null&&c.each(a,
+function(){return!(d=true)});if(d){c.each(a,function(f,h){h=c.isFunction(h)?{click:h,text:f}:h;var i=c('<button type="button"></button>').click(function(){h.click.apply(b.element[0],arguments)}).appendTo(g);c.each(h,function(j,k){if(j!=="click")j in o?i[j](k):i.attr(j,k)});c.fn.button&&i.button()});e.appendTo(b.uiDialog)}},_makeDraggable:function(){function a(f){return{position:f.position,offset:f.offset}}var b=this,d=b.options,e=c(document),g;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",
+handle:".ui-dialog-titlebar",containment:"document",start:function(f,h){g=d.height==="auto"?"auto":c(this).height();c(this).height(c(this).height()).addClass("ui-dialog-dragging");b._trigger("dragStart",f,a(h))},drag:function(f,h){b._trigger("drag",f,a(h))},stop:function(f,h){d.position=[h.position.left-e.scrollLeft(),h.position.top-e.scrollTop()];c(this).removeClass("ui-dialog-dragging").height(g);b._trigger("dragStop",f,a(h));c.ui.dialog.overlay.resize()}})},_makeResizable:function(a){function b(f){return{originalPosition:f.originalPosition,
+originalSize:f.originalSize,position:f.position,size:f.size}}a=a===l?this.options.resizable:a;var d=this,e=d.options,g=d.uiDialog.css("position");a=typeof a==="string"?a:"n,e,s,w,se,sw,ne,nw";d.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:d.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:d._minHeight(),handles:a,start:function(f,h){c(this).addClass("ui-dialog-resizing");d._trigger("resizeStart",f,b(h))},resize:function(f,h){d._trigger("resize",
+f,b(h))},stop:function(f,h){c(this).removeClass("ui-dialog-resizing");e.height=c(this).height();e.width=c(this).width();d._trigger("resizeStop",f,b(h));c.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(a){var b=[],d=[0,0],e;if(a){if(typeof a==="string"||typeof a==="object"&&"0"in a){b=a.split?a.split(" "):
+[a[0],a[1]];if(b.length===1)b[1]=b[0];c.each(["left","top"],function(g,f){if(+b[g]===b[g]){d[g]=b[g];b[g]=f}});a={my:b.join(" "),at:b.join(" "),offset:d.join(" ")}}a=c.extend({},c.ui.dialog.prototype.options.position,a)}else a=c.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(c.extend({of:window},a));e||this.uiDialog.hide()},_setOptions:function(a){var b=this,d={},e=false;c.each(a,function(g,f){b._setOption(g,f);
+if(g in m)e=true;if(g in n)d[g]=f});e&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",d)},_setOption:function(a,b){var d=this,e=d.uiDialog;switch(a){case "beforeclose":a="beforeClose";break;case "buttons":d._createButtons(b);break;case "closeText":d.uiDialogTitlebarCloseText.text(""+b);break;case "dialogClass":e.removeClass(d.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b);break;case "disabled":b?e.addClass("ui-dialog-disabled"):
+e.removeClass("ui-dialog-disabled");break;case "draggable":var g=e.is(":data(draggable)");g&&!b&&e.draggable("destroy");!g&&b&&d._makeDraggable();break;case "position":d._position(b);break;case "resizable":(g=e.is(":data(resizable)"))&&!b&&e.resizable("destroy");g&&typeof b==="string"&&e.resizable("option","handles",b);!g&&b!==false&&d._makeResizable(b);break;case "title":c(".ui-dialog-title",d.uiDialogTitlebar).html(""+(b||"&#160;"));break}c.Widget.prototype._setOption.apply(d,arguments)},_size:function(){var a=
+this.options,b,d,e=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(a.minWidth>a.width)a.width=a.minWidth;b=this.uiDialog.css({height:"auto",width:a.width}).height();d=Math.max(0,a.minHeight-b);if(a.height==="auto")if(c.support.minHeight)this.element.css({minHeight:d,height:"auto"});else{this.uiDialog.show();a=this.element.css("height","auto").height();e||this.uiDialog.hide();this.element.height(Math.max(a,d))}else this.element.height(Math.max(a.height-
+b,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}});c.extend(c.ui.dialog,{version:"1.8.16",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");if(!a){this.uuid+=1;a=this.uuid}return"ui-dialog-title-"+a},overlay:function(a){this.$el=c.ui.dialog.overlay.create(a)}});c.extend(c.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:c.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),
+create:function(a){if(this.instances.length===0){setTimeout(function(){c.ui.dialog.overlay.instances.length&&c(document).bind(c.ui.dialog.overlay.events,function(d){if(c(d.target).zIndex()<c.ui.dialog.overlay.maxZ)return false})},1);c(document).bind("keydown.dialog-overlay",function(d){if(a.options.closeOnEscape&&!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===c.ui.keyCode.ESCAPE){a.close(d);d.preventDefault()}});c(window).bind("resize.dialog-overlay",c.ui.dialog.overlay.resize)}var b=(this.oldInstances.pop()||
+c("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});c.fn.bgiframe&&b.bgiframe();this.instances.push(b);return b},destroy:function(a){var b=c.inArray(a,this.instances);b!=-1&&this.oldInstances.push(this.instances.splice(b,1)[0]);this.instances.length===0&&c([document,window]).unbind(".dialog-overlay");a.remove();var d=0;c.each(this.instances,function(){d=Math.max(d,this.css("z-index"))});this.maxZ=d},height:function(){var a,b;if(c.browser.msie&&
+c.browser.version<7){a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);b=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return a<b?c(window).height()+"px":a+"px"}else return c(document).height()+"px"},width:function(){var a,b;if(c.browser.msie){a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);b=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return a<b?c(window).width()+"px":a+"px"}else return c(document).width()+
+"px"},resize:function(){var a=c([]);c.each(c.ui.dialog.overlay.instances,function(){a=a.add(this)});a.css({width:0,height:0}).css({width:c.ui.dialog.overlay.width(),height:c.ui.dialog.overlay.height()})}});c.extend(c.ui.dialog.overlay.prototype,{destroy:function(){c.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
+;/*
+ * jQuery UI Slider 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Slider
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.mouse.js
+ *	jquery.ui.widget.js
+ */
+(function(d){d.widget("ui.slider",d.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var a=this,b=this.options,c=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=b.values&&b.values.length||1,e=[];this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(b.disabled?" ui-slider-disabled ui-disabled":""));this.range=d([]);if(b.range){if(b.range===true){if(!b.values)b.values=[this._valueMin(),this._valueMin()];if(b.values.length&&b.values.length!==2)b.values=[b.values[0],b.values[0]]}this.range=d("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(b.range==="min"||b.range==="max"?" ui-slider-range-"+b.range:""))}for(var j=c.length;j<f;j+=1)e.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
+this.handles=c.add(d(e.join("")).appendTo(a.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(g){g.preventDefault()}).hover(function(){b.disabled||d(this).addClass("ui-state-hover")},function(){d(this).removeClass("ui-state-hover")}).focus(function(){if(b.disabled)d(this).blur();else{d(".ui-slider .ui-state-focus").removeClass("ui-state-focus");d(this).addClass("ui-state-focus")}}).blur(function(){d(this).removeClass("ui-state-focus")});this.handles.each(function(g){d(this).data("index.ui-slider-handle",
+g)});this.handles.keydown(function(g){var k=true,l=d(this).data("index.ui-slider-handle"),i,h,m;if(!a.options.disabled){switch(g.keyCode){case d.ui.keyCode.HOME:case d.ui.keyCode.END:case d.ui.keyCode.PAGE_UP:case d.ui.keyCode.PAGE_DOWN:case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:k=false;if(!a._keySliding){a._keySliding=true;d(this).addClass("ui-state-active");i=a._start(g,l);if(i===false)return}break}m=a.options.step;i=a.options.values&&a.options.values.length?
+(h=a.values(l)):(h=a.value());switch(g.keyCode){case d.ui.keyCode.HOME:h=a._valueMin();break;case d.ui.keyCode.END:h=a._valueMax();break;case d.ui.keyCode.PAGE_UP:h=a._trimAlignValue(i+(a._valueMax()-a._valueMin())/5);break;case d.ui.keyCode.PAGE_DOWN:h=a._trimAlignValue(i-(a._valueMax()-a._valueMin())/5);break;case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:if(i===a._valueMax())return;h=a._trimAlignValue(i+m);break;case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(i===a._valueMin())return;h=a._trimAlignValue(i-
+m);break}a._slide(g,l,h);return k}}).keyup(function(g){var k=d(this).data("index.ui-slider-handle");if(a._keySliding){a._keySliding=false;a._stop(g,k);a._change(g,k);d(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();
+return this},_mouseCapture:function(a){var b=this.options,c,f,e,j,g;if(b.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:a.pageX,y:a.pageY});f=this._valueMax()-this._valueMin()+1;j=this;this.handles.each(function(k){var l=Math.abs(c-j.values(k));if(f>l){f=l;e=d(this);g=k}});if(b.range===true&&this.values(1)===b.min){g+=1;e=d(this.handles[g])}if(this._start(a,g)===false)return false;
+this._mouseSliding=true;j._handleIndex=g;e.addClass("ui-state-active").focus();b=e.offset();this._clickOffset=!d(a.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:a.pageX-b.left-e.width()/2,top:a.pageY-b.top-e.height()/2-(parseInt(e.css("borderTopWidth"),10)||0)-(parseInt(e.css("borderBottomWidth"),10)||0)+(parseInt(e.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(a,g,c);return this._animateOff=true},_mouseStart:function(){return true},_mouseDrag:function(a){var b=
+this._normValueFromMouse({x:a.pageX,y:a.pageY});this._slide(a,this._handleIndex,b);return false},_mouseStop:function(a){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(a,this._handleIndex);this._change(a,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(a){var b;if(this.orientation==="horizontal"){b=
+this.elementSize.width;a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{b=this.elementSize.height;a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}b=a/b;if(b>1)b=1;if(b<0)b=0;if(this.orientation==="vertical")b=1-b;a=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+b*a)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(b);
+c.values=this.values()}return this._trigger("start",a,c)},_slide:function(a,b,c){var f;if(this.options.values&&this.options.values.length){f=this.values(b?0:1);if(this.options.values.length===2&&this.options.range===true&&(b===0&&c>f||b===1&&c<f))c=f;if(c!==this.values(b)){f=this.values();f[b]=c;a=this._trigger("slide",a,{handle:this.handles[b],value:c,values:f});this.values(b?0:1);a!==false&&this.values(b,c,true)}}else if(c!==this.value()){a=this._trigger("slide",a,{handle:this.handles[b],value:c});
+a!==false&&this.value(c)}},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(b);c.values=this.values()}this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(b);c.values=this.values()}this._trigger("change",a,c)}},value:function(a){if(arguments.length){this.options.value=
+this._trimAlignValue(a);this._refreshValue();this._change(null,0)}else return this._value()},values:function(a,b){var c,f,e;if(arguments.length>1){this.options.values[a]=this._trimAlignValue(b);this._refreshValue();this._change(null,a)}else if(arguments.length)if(d.isArray(arguments[0])){c=this.options.values;f=arguments[0];for(e=0;e<c.length;e+=1){c[e]=this._trimAlignValue(f[e]);this._change(null,e)}this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(a):
+this.value();else return this._values()},_setOption:function(a,b){var c,f=0;if(d.isArray(this.options.values))f=this.options.values.length;d.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":if(b){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.propAttr("disabled",true);this.element.addClass("ui-disabled")}else{this.handles.propAttr("disabled",false);this.element.removeClass("ui-disabled")}break;case "orientation":this._detectOrientation();
+this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(c=0;c<f;c+=1)this._change(null,c);this._animateOff=false;break}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c;if(arguments.length){b=this.options.values[a];
+return b=this._trimAlignValue(b)}else{b=this.options.values.slice();for(c=0;c<b.length;c+=1)b[c]=this._trimAlignValue(b[c]);return b}},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b;a=a-c;if(Math.abs(c)*2>=b)a+=c>0?b:-b;return parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var a=
+this.options.range,b=this.options,c=this,f=!this._animateOff?b.animate:false,e,j={},g,k,l,i;if(this.options.values&&this.options.values.length)this.handles.each(function(h){e=(c.values(h)-c._valueMin())/(c._valueMax()-c._valueMin())*100;j[c.orientation==="horizontal"?"left":"bottom"]=e+"%";d(this).stop(1,1)[f?"animate":"css"](j,b.animate);if(c.options.range===true)if(c.orientation==="horizontal"){if(h===0)c.range.stop(1,1)[f?"animate":"css"]({left:e+"%"},b.animate);if(h===1)c.range[f?"animate":"css"]({width:e-
+g+"%"},{queue:false,duration:b.animate})}else{if(h===0)c.range.stop(1,1)[f?"animate":"css"]({bottom:e+"%"},b.animate);if(h===1)c.range[f?"animate":"css"]({height:e-g+"%"},{queue:false,duration:b.animate})}g=e});else{k=this.value();l=this._valueMin();i=this._valueMax();e=i!==l?(k-l)/(i-l)*100:0;j[c.orientation==="horizontal"?"left":"bottom"]=e+"%";this.handle.stop(1,1)[f?"animate":"css"](j,b.animate);if(a==="min"&&this.orientation==="horizontal")this.range.stop(1,1)[f?"animate":"css"]({width:e+"%"},
+b.animate);if(a==="max"&&this.orientation==="horizontal")this.range[f?"animate":"css"]({width:100-e+"%"},{queue:false,duration:b.animate});if(a==="min"&&this.orientation==="vertical")this.range.stop(1,1)[f?"animate":"css"]({height:e+"%"},b.animate);if(a==="max"&&this.orientation==="vertical")this.range[f?"animate":"css"]({height:100-e+"%"},{queue:false,duration:b.animate})}}});d.extend(d.ui.slider,{version:"1.8.16"})})(jQuery);
+;/*
+ * jQuery UI Tabs 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Tabs
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ *	jquery.ui.widget.js
+ */
+(function(d,p){function u(){return++v}function w(){return++x}var v=0,x=0;d.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(true)},_setOption:function(b,e){if(b=="selected")this.options.collapsible&&
+e==this.options.selected||this.select(e);else{this.options[b]=e;this._tabify()}},_tabId:function(b){return b.title&&b.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+u()},_sanitizeSelector:function(b){return b.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+w());return d.cookie.apply(null,[b].concat(d.makeArray(arguments)))},_ui:function(b,e){return{tab:b,panel:e,index:this.anchors.index(b)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=
+d(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(b){function e(g,f){g.css("display","");!d.support.opacity&&f.opacity&&g[0].style.removeAttribute("filter")}var a=this,c=this.options,h=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=d(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return d("a",this)[0]});this.panels=d([]);this.anchors.each(function(g,f){var i=d(f).attr("href"),l=i.split("#")[0],q;if(l&&(l===location.toString().split("#")[0]||
+(q=d("base")[0])&&l===q.href)){i=f.hash;f.href=i}if(h.test(i))a.panels=a.panels.add(a.element.find(a._sanitizeSelector(i)));else if(i&&i!=="#"){d.data(f,"href.tabs",i);d.data(f,"load.tabs",i.replace(/#.*$/,""));i=a._tabId(f);f.href="#"+i;f=a.element.find("#"+i);if(!f.length){f=d(c.panelTemplate).attr("id",i).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(a.panels[g-1]||a.list);f.data("destroy.tabs",true)}a.panels=a.panels.add(f)}else c.disabled.push(g)});if(b){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");
+this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(c.selected===p){location.hash&&this.anchors.each(function(g,f){if(f.hash==location.hash){c.selected=g;return false}});if(typeof c.selected!=="number"&&c.cookie)c.selected=parseInt(a._cookie(),10);if(typeof c.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length)c.selected=
+this.lis.index(this.lis.filter(".ui-tabs-selected"));c.selected=c.selected||(this.lis.length?0:-1)}else if(c.selected===null)c.selected=-1;c.selected=c.selected>=0&&this.anchors[c.selected]||c.selected<0?c.selected:0;c.disabled=d.unique(c.disabled.concat(d.map(this.lis.filter(".ui-state-disabled"),function(g){return a.lis.index(g)}))).sort();d.inArray(c.selected,c.disabled)!=-1&&c.disabled.splice(d.inArray(c.selected,c.disabled),1);this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");
+if(c.selected>=0&&this.anchors.length){a.element.find(a._sanitizeSelector(a.anchors[c.selected].hash)).removeClass("ui-tabs-hide");this.lis.eq(c.selected).addClass("ui-tabs-selected ui-state-active");a.element.queue("tabs",function(){a._trigger("show",null,a._ui(a.anchors[c.selected],a.element.find(a._sanitizeSelector(a.anchors[c.selected].hash))[0]))});this.load(c.selected)}d(window).bind("unload",function(){a.lis.add(a.anchors).unbind(".tabs");a.lis=a.anchors=a.panels=null})}else c.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));
+this.element[c.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");c.cookie&&this._cookie(c.selected,c.cookie);b=0;for(var j;j=this.lis[b];b++)d(j)[d.inArray(b,c.disabled)!=-1&&!d(j).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");c.cache===false&&this.anchors.removeData("cache.tabs");this.lis.add(this.anchors).unbind(".tabs");if(c.event!=="mouseover"){var k=function(g,f){f.is(":not(.ui-state-disabled)")&&f.addClass("ui-state-"+g)},n=function(g,f){f.removeClass("ui-state-"+
+g)};this.lis.bind("mouseover.tabs",function(){k("hover",d(this))});this.lis.bind("mouseout.tabs",function(){n("hover",d(this))});this.anchors.bind("focus.tabs",function(){k("focus",d(this).closest("li"))});this.anchors.bind("blur.tabs",function(){n("focus",d(this).closest("li"))})}var m,o;if(c.fx)if(d.isArray(c.fx)){m=c.fx[0];o=c.fx[1]}else m=o=c.fx;var r=o?function(g,f){d(g).closest("li").addClass("ui-tabs-selected ui-state-active");f.hide().removeClass("ui-tabs-hide").animate(o,o.duration||"normal",
+function(){e(f,o);a._trigger("show",null,a._ui(g,f[0]))})}:function(g,f){d(g).closest("li").addClass("ui-tabs-selected ui-state-active");f.removeClass("ui-tabs-hide");a._trigger("show",null,a._ui(g,f[0]))},s=m?function(g,f){f.animate(m,m.duration||"normal",function(){a.lis.removeClass("ui-tabs-selected ui-state-active");f.addClass("ui-tabs-hide");e(f,m);a.element.dequeue("tabs")})}:function(g,f){a.lis.removeClass("ui-tabs-selected ui-state-active");f.addClass("ui-tabs-hide");a.element.dequeue("tabs")};
+this.anchors.bind(c.event+".tabs",function(){var g=this,f=d(g).closest("li"),i=a.panels.filter(":not(.ui-tabs-hide)"),l=a.element.find(a._sanitizeSelector(g.hash));if(f.hasClass("ui-tabs-selected")&&!c.collapsible||f.hasClass("ui-state-disabled")||f.hasClass("ui-state-processing")||a.panels.filter(":animated").length||a._trigger("select",null,a._ui(this,l[0]))===false){this.blur();return false}c.selected=a.anchors.index(this);a.abort();if(c.collapsible)if(f.hasClass("ui-tabs-selected")){c.selected=
+-1;c.cookie&&a._cookie(c.selected,c.cookie);a.element.queue("tabs",function(){s(g,i)}).dequeue("tabs");this.blur();return false}else if(!i.length){c.cookie&&a._cookie(c.selected,c.cookie);a.element.queue("tabs",function(){r(g,l)});a.load(a.anchors.index(this));this.blur();return false}c.cookie&&a._cookie(c.selected,c.cookie);if(l.length){i.length&&a.element.queue("tabs",function(){s(g,i)});a.element.queue("tabs",function(){r(g,l)});a.load(a.anchors.index(this))}else throw"jQuery UI Tabs: Mismatching fragment identifier.";
+d.browser.msie&&this.blur()});this.anchors.bind("click.tabs",function(){return false})},_getIndex:function(b){if(typeof b=="string")b=this.anchors.index(this.anchors.filter("[href$="+b+"]"));return b},destroy:function(){var b=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var e=
+d.data(this,"href.tabs");if(e)this.href=e;var a=d(this).unbind(".tabs");d.each(["href","load","cache"],function(c,h){a.removeData(h+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){d.data(this,"destroy.tabs")?d(this).remove():d(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")});b.cookie&&this._cookie(null,b.cookie);return this},add:function(b,
+e,a){if(a===p)a=this.anchors.length;var c=this,h=this.options;e=d(h.tabTemplate.replace(/#\{href\}/g,b).replace(/#\{label\}/g,e));b=!b.indexOf("#")?b.replace("#",""):this._tabId(d("a",e)[0]);e.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var j=c.element.find("#"+b);j.length||(j=d(h.panelTemplate).attr("id",b).data("destroy.tabs",true));j.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(a>=this.lis.length){e.appendTo(this.list);j.appendTo(this.list[0].parentNode)}else{e.insertBefore(this.lis[a]);
+j.insertBefore(this.panels[a])}h.disabled=d.map(h.disabled,function(k){return k>=a?++k:k});this._tabify();if(this.anchors.length==1){h.selected=0;e.addClass("ui-tabs-selected ui-state-active");j.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){c._trigger("show",null,c._ui(c.anchors[0],c.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[a],this.panels[a]));return this},remove:function(b){b=this._getIndex(b);var e=this.options,a=this.lis.eq(b).remove(),c=this.panels.eq(b).remove();
+if(a.hasClass("ui-tabs-selected")&&this.anchors.length>1)this.select(b+(b+1<this.anchors.length?1:-1));e.disabled=d.map(d.grep(e.disabled,function(h){return h!=b}),function(h){return h>=b?--h:h});this._tabify();this._trigger("remove",null,this._ui(a.find("a")[0],c[0]));return this},enable:function(b){b=this._getIndex(b);var e=this.options;if(d.inArray(b,e.disabled)!=-1){this.lis.eq(b).removeClass("ui-state-disabled");e.disabled=d.grep(e.disabled,function(a){return a!=b});this._trigger("enable",null,
+this._ui(this.anchors[b],this.panels[b]));return this}},disable:function(b){b=this._getIndex(b);var e=this.options;if(b!=e.selected){this.lis.eq(b).addClass("ui-state-disabled");e.disabled.push(b);e.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[b],this.panels[b]))}return this},select:function(b){b=this._getIndex(b);if(b==-1)if(this.options.collapsible&&this.options.selected!=-1)b=this.options.selected;else return this;this.anchors.eq(b).trigger(this.options.event+".tabs");return this},
+load:function(b){b=this._getIndex(b);var e=this,a=this.options,c=this.anchors.eq(b)[0],h=d.data(c,"load.tabs");this.abort();if(!h||this.element.queue("tabs").length!==0&&d.data(c,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(b).addClass("ui-state-processing");if(a.spinner){var j=d("span",c);j.data("label.tabs",j.html()).html(a.spinner)}this.xhr=d.ajax(d.extend({},a.ajaxOptions,{url:h,success:function(k,n){e.element.find(e._sanitizeSelector(c.hash)).html(k);e._cleanup();a.cache&&d.data(c,
+"cache.tabs",true);e._trigger("load",null,e._ui(e.anchors[b],e.panels[b]));try{a.ajaxOptions.success(k,n)}catch(m){}},error:function(k,n){e._cleanup();e._trigger("load",null,e._ui(e.anchors[b],e.panels[b]));try{a.ajaxOptions.error(k,n,b,c)}catch(m){}}}));e.element.dequeue("tabs");return this}},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup();return this},
+url:function(b,e){this.anchors.eq(b).removeData("cache.tabs").data("load.tabs",e);return this},length:function(){return this.anchors.length}});d.extend(d.ui.tabs,{version:"1.8.16"});d.extend(d.ui.tabs.prototype,{rotation:null,rotate:function(b,e){var a=this,c=this.options,h=a._rotate||(a._rotate=function(j){clearTimeout(a.rotation);a.rotation=setTimeout(function(){var k=c.selected;a.select(++k<a.anchors.length?k:0)},b);j&&j.stopPropagation()});e=a._unrotate||(a._unrotate=!e?function(j){j.clientX&&
+a.rotate(null)}:function(){t=c.selected;h()});if(b){this.element.bind("tabsshow",h);this.anchors.bind(c.event+".tabs",e);h()}else{clearTimeout(a.rotation);this.element.unbind("tabsshow",h);this.anchors.unbind(c.event+".tabs",e);delete this._rotate;delete this._unrotate}return this}})})(jQuery);
+;/*
+ * jQuery UI Datepicker 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Datepicker
+ *
+ * Depends:
+ *	jquery.ui.core.js
+ */
+(function(d,C){function M(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._inDialog=this._datepickerShowing=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
+"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su",
+"Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",
+minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};d.extend(this._defaults,this.regional[""]);this.dpDiv=N(d('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function N(a){return a.bind("mouseout",
+function(b){b=d(b.target).closest("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a");b.length&&b.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(b){b=d(b.target).closest("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a");if(!(d.datepicker._isDisabledDatepicker(J.inline?a.parent()[0]:J.input[0])||!b.length)){b.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");
+b.addClass("ui-state-hover");b.hasClass("ui-datepicker-prev")&&b.addClass("ui-datepicker-prev-hover");b.hasClass("ui-datepicker-next")&&b.addClass("ui-datepicker-next-hover")}})}function H(a,b){d.extend(a,b);for(var c in b)if(b[c]==null||b[c]==C)a[c]=b[c];return a}d.extend(d.ui,{datepicker:{version:"1.8.16"}});var B=(new Date).getTime(),J;d.extend(M.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},
+setDefaults:function(a){H(this._defaults,a||{});return this},_attachDatepicker:function(a,b){var c=null;for(var e in this._defaults){var f=a.getAttribute("date:"+e);if(f){c=c||{};try{c[e]=eval(f)}catch(h){c[e]=f}}}e=a.nodeName.toLowerCase();f=e=="div"||e=="span";if(!a.id){this.uuid+=1;a.id="dp"+this.uuid}var i=this._newInst(d(a),f);i.settings=d.extend({},b||{},c||{});if(e=="input")this._connectDatepicker(a,i);else f&&this._inlineDatepicker(a,i)},_newInst:function(a,b){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,
+"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:!b?this.dpDiv:N(d('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}},_connectDatepicker:function(a,b){var c=d(a);b.append=d([]);b.trigger=d([]);if(!c.hasClass(this.markerClassName)){this._attachments(c,b);c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
+function(e,f,h){b.settings[f]=h}).bind("getData.datepicker",function(e,f){return this._get(b,f)});this._autoSize(b);d.data(a,"datepicker",b);b.settings.disabled&&this._disableDatepicker(a)}},_attachments:function(a,b){var c=this._get(b,"appendText"),e=this._get(b,"isRTL");b.append&&b.append.remove();if(c){b.append=d('<span class="'+this._appendClass+'">'+c+"</span>");a[e?"before":"after"](b.append)}a.unbind("focus",this._showDatepicker);b.trigger&&b.trigger.remove();c=this._get(b,"showOn");if(c==
+"focus"||c=="both")a.focus(this._showDatepicker);if(c=="button"||c=="both"){c=this._get(b,"buttonText");var f=this._get(b,"buttonImage");b.trigger=d(this._get(b,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:f,alt:c,title:c}):d('<button type="button"></button>').addClass(this._triggerClass).html(f==""?c:d("<img/>").attr({src:f,alt:c,title:c})));a[e?"before":"after"](b.trigger);b.trigger.click(function(){d.datepicker._datepickerShowing&&d.datepicker._lastInput==a[0]?d.datepicker._hideDatepicker():
+d.datepicker._showDatepicker(a[0]);return false})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var e=function(f){for(var h=0,i=0,g=0;g<f.length;g++)if(f[g].length>h){h=f[g].length;i=g}return i};b.setMonth(e(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(e(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,
+b){var c=d(a);if(!c.hasClass(this.markerClassName)){c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(e,f,h){b.settings[f]=h}).bind("getData.datepicker",function(e,f){return this._get(b,f)});d.data(a,"datepicker",b);this._setDate(b,this._getDefaultDate(b),true);this._updateDatepicker(b);this._updateAlternate(b);b.settings.disabled&&this._disableDatepicker(a);b.dpDiv.css("display","block")}},_dialogDatepicker:function(a,b,c,e,f){a=this._dialogInst;if(!a){this.uuid+=
+1;this._dialogInput=d('<input type="text" id="'+("dp"+this.uuid)+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);d("body").append(this._dialogInput);a=this._dialogInst=this._newInst(this._dialogInput,false);a.settings={};d.data(this._dialogInput[0],"datepicker",a)}H(a.settings,e||{});b=b&&b.constructor==Date?this._formatDate(a,b):b;this._dialogInput.val(b);this._pos=f?f.length?f:[f.pageX,f.pageY]:null;if(!this._pos)this._pos=[document.documentElement.clientWidth/
+2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)];this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");a.settings.onSelect=c;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);d.blockUI&&d.blockUI(this.dpDiv);d.data(this._dialogInput[0],"datepicker",a);return this},_destroyDatepicker:function(a){var b=
+d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();d.removeData(a,"datepicker");if(e=="input"){c.append.remove();c.trigger.remove();b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else if(e=="div"||e=="span")b.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=
+a.nodeName.toLowerCase();if(e=="input"){a.disabled=false;c.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(e=="div"||e=="span"){b=b.children("."+this._inlineClass);b.children().removeClass("ui-state-disabled");b.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}this._disabledInputs=d.map(this._disabledInputs,function(f){return f==a?null:f})}},_disableDatepicker:function(a){var b=d(a),c=d.data(a,
+"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input"){a.disabled=true;c.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(e=="div"||e=="span"){b=b.children("."+this._inlineClass);b.children().addClass("ui-state-disabled");b.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}this._disabledInputs=d.map(this._disabledInputs,function(f){return f==
+a?null:f});this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return false;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return true;return false},_getInst:function(a){try{return d.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(a,b,c){var e=this._getInst(a);if(arguments.length==2&&typeof b=="string")return b=="defaults"?d.extend({},d.datepicker._defaults):e?b=="all"?
+d.extend({},e.settings):this._get(e,b):null;var f=b||{};if(typeof b=="string"){f={};f[b]=c}if(e){this._curInst==e&&this._hideDatepicker();var h=this._getDateDatepicker(a,true),i=this._getMinMaxDate(e,"min"),g=this._getMinMaxDate(e,"max");H(e.settings,f);if(i!==null&&f.dateFormat!==C&&f.minDate===C)e.settings.minDate=this._formatDate(e,i);if(g!==null&&f.dateFormat!==C&&f.maxDate===C)e.settings.maxDate=this._formatDate(e,g);this._attachments(d(a),e);this._autoSize(e);this._setDate(e,h);this._updateAlternate(e);
+this._updateDatepicker(e)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){if(a=this._getInst(a)){this._setDate(a,b);this._updateDatepicker(a);this._updateAlternate(a)}},_getDateDatepicker:function(a,b){(a=this._getInst(a))&&!a.inline&&this._setDateFromField(a,b);return a?this._getDate(a):null},_doKeyDown:function(a){var b=d.datepicker._getInst(a.target),c=true,e=b.dpDiv.is(".ui-datepicker-rtl");
+b._keyEvent=true;if(d.datepicker._datepickerShowing)switch(a.keyCode){case 9:d.datepicker._hideDatepicker();c=false;break;case 13:c=d("td."+d.datepicker._dayOverClass+":not(."+d.datepicker._currentClass+")",b.dpDiv);c[0]&&d.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,c[0]);if(a=d.datepicker._get(b,"onSelect")){c=d.datepicker._formatDate(b);a.apply(b.input?b.input[0]:null,[c,b])}else d.datepicker._hideDatepicker();return false;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(a.target,
+a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 34:d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 35:if(a.ctrlKey||a.metaKey)d.datepicker._clearDate(a.target);c=a.ctrlKey||a.metaKey;break;case 36:if(a.ctrlKey||a.metaKey)d.datepicker._gotoToday(a.target);c=a.ctrlKey||a.metaKey;break;case 37:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,e?+1:-1,"D");c=
+a.ctrlKey||a.metaKey;if(a.originalEvent.altKey)d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 38:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,-7,"D");c=a.ctrlKey||a.metaKey;break;case 39:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,e?-1:+1,"D");c=a.ctrlKey||a.metaKey;if(a.originalEvent.altKey)d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,
+"stepMonths"),"M");break;case 40:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,+7,"D");c=a.ctrlKey||a.metaKey;break;default:c=false}else if(a.keyCode==36&&a.ctrlKey)d.datepicker._showDatepicker(this);else c=false;if(c){a.preventDefault();a.stopPropagation()}},_doKeyPress:function(a){var b=d.datepicker._getInst(a.target);if(d.datepicker._get(b,"constrainInput")){b=d.datepicker._possibleChars(d.datepicker._get(b,"dateFormat"));var c=String.fromCharCode(a.charCode==C?a.keyCode:a.charCode);
+return a.ctrlKey||a.metaKey||c<" "||!b||b.indexOf(c)>-1}},_doKeyUp:function(a){a=d.datepicker._getInst(a.target);if(a.input.val()!=a.lastVal)try{if(d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,d.datepicker._getFormatConfig(a))){d.datepicker._setDateFromField(a);d.datepicker._updateAlternate(a);d.datepicker._updateDatepicker(a)}}catch(b){d.datepicker.log(b)}return true},_showDatepicker:function(a){a=a.target||a;if(a.nodeName.toLowerCase()!="input")a=d("input",
+a.parentNode)[0];if(!(d.datepicker._isDisabledDatepicker(a)||d.datepicker._lastInput==a)){var b=d.datepicker._getInst(a);if(d.datepicker._curInst&&d.datepicker._curInst!=b){d.datepicker._datepickerShowing&&d.datepicker._triggerOnClose(d.datepicker._curInst);d.datepicker._curInst.dpDiv.stop(true,true)}var c=d.datepicker._get(b,"beforeShow");c=c?c.apply(a,[a,b]):{};if(c!==false){H(b.settings,c);b.lastVal=null;d.datepicker._lastInput=a;d.datepicker._setDateFromField(b);if(d.datepicker._inDialog)a.value=
+"";if(!d.datepicker._pos){d.datepicker._pos=d.datepicker._findPos(a);d.datepicker._pos[1]+=a.offsetHeight}var e=false;d(a).parents().each(function(){e|=d(this).css("position")=="fixed";return!e});if(e&&d.browser.opera){d.datepicker._pos[0]-=document.documentElement.scrollLeft;d.datepicker._pos[1]-=document.documentElement.scrollTop}c={left:d.datepicker._pos[0],top:d.datepicker._pos[1]};d.datepicker._pos=null;b.dpDiv.empty();b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});d.datepicker._updateDatepicker(b);
+c=d.datepicker._checkOffset(b,c,e);b.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":e?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"});if(!b.inline){c=d.datepicker._get(b,"showAnim");var f=d.datepicker._get(b,"duration"),h=function(){var i=b.dpDiv.find("iframe.ui-datepicker-cover");if(i.length){var g=d.datepicker._getBorders(b.dpDiv);i.css({left:-g[0],top:-g[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex(d(a).zIndex()+1);d.datepicker._datepickerShowing=
+true;d.effects&&d.effects[c]?b.dpDiv.show(c,d.datepicker._get(b,"showOptions"),f,h):b.dpDiv[c||"show"](c?f:null,h);if(!c||!f)h();b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus();d.datepicker._curInst=b}}}},_updateDatepicker:function(a){this.maxRows=4;var b=d.datepicker._getBorders(a.dpDiv);J=a;a.dpDiv.empty().append(this._generateHTML(a));var c=a.dpDiv.find("iframe.ui-datepicker-cover");c.length&&c.css({left:-b[0],top:-b[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()});
+a.dpDiv.find("."+this._dayOverClass+" a").mouseover();b=this._getNumberOfMonths(a);c=b[1];a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");c>1&&a.dpDiv.addClass("ui-datepicker-multi-"+c).css("width",17*c+"em");a.dpDiv[(b[0]!=1||b[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");a==d.datepicker._curInst&&d.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&
+!a.input.is(":disabled")&&a.input[0]!=document.activeElement&&a.input.focus();if(a.yearshtml){var e=a.yearshtml;setTimeout(function(){e===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml);e=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(c){return{thin:1,medium:2,thick:3}[c]||c};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var e=a.dpDiv.outerWidth(),f=a.dpDiv.outerHeight(),
+h=a.input?a.input.outerWidth():0,i=a.input?a.input.outerHeight():0,g=document.documentElement.clientWidth+d(document).scrollLeft(),j=document.documentElement.clientHeight+d(document).scrollTop();b.left-=this._get(a,"isRTL")?e-h:0;b.left-=c&&b.left==a.input.offset().left?d(document).scrollLeft():0;b.top-=c&&b.top==a.input.offset().top+i?d(document).scrollTop():0;b.left-=Math.min(b.left,b.left+e>g&&g>e?Math.abs(b.left+e-g):0);b.top-=Math.min(b.top,b.top+f>j&&j>f?Math.abs(f+i):0);return b},_findPos:function(a){for(var b=
+this._get(this._getInst(a),"isRTL");a&&(a.type=="hidden"||a.nodeType!=1||d.expr.filters.hidden(a));)a=a[b?"previousSibling":"nextSibling"];a=d(a).offset();return[a.left,a.top]},_triggerOnClose:function(a){var b=this._get(a,"onClose");if(b)b.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a])},_hideDatepicker:function(a){var b=this._curInst;if(!(!b||a&&b!=d.data(a,"datepicker")))if(this._datepickerShowing){a=this._get(b,"showAnim");var c=this._get(b,"duration"),e=function(){d.datepicker._tidyDialog(b);
+this._curInst=null};d.effects&&d.effects[a]?b.dpDiv.hide(a,d.datepicker._get(b,"showOptions"),c,e):b.dpDiv[a=="slideDown"?"slideUp":a=="fadeIn"?"fadeOut":"hide"](a?c:null,e);a||e();d.datepicker._triggerOnClose(b);this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(d.blockUI){d.unblockUI();d("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},
+_checkExternalClick:function(a){if(d.datepicker._curInst){a=d(a.target);a[0].id!=d.datepicker._mainDivId&&a.parents("#"+d.datepicker._mainDivId).length==0&&!a.hasClass(d.datepicker.markerClassName)&&!a.hasClass(d.datepicker._triggerClass)&&d.datepicker._datepickerShowing&&!(d.datepicker._inDialog&&d.blockUI)&&d.datepicker._hideDatepicker()}},_adjustDate:function(a,b,c){a=d(a);var e=this._getInst(a[0]);if(!this._isDisabledDatepicker(a[0])){this._adjustInstDate(e,b+(c=="M"?this._get(e,"showCurrentAtPos"):
+0),c);this._updateDatepicker(e)}},_gotoToday:function(a){a=d(a);var b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay){b.selectedDay=b.currentDay;b.drawMonth=b.selectedMonth=b.currentMonth;b.drawYear=b.selectedYear=b.currentYear}else{var c=new Date;b.selectedDay=c.getDate();b.drawMonth=b.selectedMonth=c.getMonth();b.drawYear=b.selectedYear=c.getFullYear()}this._notifyChange(b);this._adjustDate(a)},_selectMonthYear:function(a,b,c){a=d(a);var e=this._getInst(a[0]);e["selected"+(c=="M"?
+"Month":"Year")]=e["draw"+(c=="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10);this._notifyChange(e);this._adjustDate(a)},_selectDay:function(a,b,c,e){var f=d(a);if(!(d(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(f[0]))){f=this._getInst(f[0]);f.selectedDay=f.currentDay=d("a",e).html();f.selectedMonth=f.currentMonth=b;f.selectedYear=f.currentYear=c;this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear))}},_clearDate:function(a){a=d(a);
+this._getInst(a[0]);this._selectDate(a,"")},_selectDate:function(a,b){a=this._getInst(d(a)[0]);b=b!=null?b:this._formatDate(a);a.input&&a.input.val(b);this._updateAlternate(a);var c=this._get(a,"onSelect");if(c)c.apply(a.input?a.input[0]:null,[b,a]);else a.input&&a.input.trigger("change");if(a.inline)this._updateDatepicker(a);else{this._hideDatepicker();this._lastInput=a.input[0];typeof a.input[0]!="object"&&a.input.focus();this._lastInput=null}},_updateAlternate:function(a){var b=this._get(a,"altField");
+if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),e=this._getDate(a),f=this.formatDate(c,e,this._getFormatConfig(a));d(b).each(function(){d(this).val(f)})}},noWeekends:function(a){a=a.getDay();return[a>0&&a<6,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0);a.setDate(1);return Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(a,b,c){if(a==null||b==null)throw"Invalid arguments";b=typeof b=="object"?
+b.toString():b+"";if(b=="")return null;var e=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;e=typeof e!="string"?e:(new Date).getFullYear()%100+parseInt(e,10);for(var f=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,h=(c?c.dayNames:null)||this._defaults.dayNames,i=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?c.monthNames:null)||this._defaults.monthNames,j=c=-1,l=-1,u=-1,k=false,o=function(p){(p=A+1<a.length&&a.charAt(A+1)==p)&&A++;return p},m=function(p){var D=
+o(p);p=new RegExp("^\\d{1,"+(p=="@"?14:p=="!"?20:p=="y"&&D?4:p=="o"?3:2)+"}");p=b.substring(q).match(p);if(!p)throw"Missing number at position "+q;q+=p[0].length;return parseInt(p[0],10)},n=function(p,D,K){p=d.map(o(p)?K:D,function(w,x){return[[x,w]]}).sort(function(w,x){return-(w[1].length-x[1].length)});var E=-1;d.each(p,function(w,x){w=x[1];if(b.substr(q,w.length).toLowerCase()==w.toLowerCase()){E=x[0];q+=w.length;return false}});if(E!=-1)return E+1;else throw"Unknown name at position "+q;},s=
+function(){if(b.charAt(q)!=a.charAt(A))throw"Unexpected literal at position "+q;q++},q=0,A=0;A<a.length;A++)if(k)if(a.charAt(A)=="'"&&!o("'"))k=false;else s();else switch(a.charAt(A)){case "d":l=m("d");break;case "D":n("D",f,h);break;case "o":u=m("o");break;case "m":j=m("m");break;case "M":j=n("M",i,g);break;case "y":c=m("y");break;case "@":var v=new Date(m("@"));c=v.getFullYear();j=v.getMonth()+1;l=v.getDate();break;case "!":v=new Date((m("!")-this._ticksTo1970)/1E4);c=v.getFullYear();j=v.getMonth()+
+1;l=v.getDate();break;case "'":if(o("'"))s();else k=true;break;default:s()}if(q<b.length)throw"Extra/unparsed characters found in date: "+b.substring(q);if(c==-1)c=(new Date).getFullYear();else if(c<100)c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=e?0:-100);if(u>-1){j=1;l=u;do{e=this._getDaysInMonth(c,j-1);if(l<=e)break;j++;l-=e}while(1)}v=this._daylightSavingAdjust(new Date(c,j-1,l));if(v.getFullYear()!=c||v.getMonth()+1!=j||v.getDate()!=l)throw"Invalid date";return v},ATOM:"yy-mm-dd",
+COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1E7,formatDate:function(a,b,c){if(!b)return"";var e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,h=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort;c=(c?c.monthNames:
+null)||this._defaults.monthNames;var i=function(o){(o=k+1<a.length&&a.charAt(k+1)==o)&&k++;return o},g=function(o,m,n){m=""+m;if(i(o))for(;m.length<n;)m="0"+m;return m},j=function(o,m,n,s){return i(o)?s[m]:n[m]},l="",u=false;if(b)for(var k=0;k<a.length;k++)if(u)if(a.charAt(k)=="'"&&!i("'"))u=false;else l+=a.charAt(k);else switch(a.charAt(k)){case "d":l+=g("d",b.getDate(),2);break;case "D":l+=j("D",b.getDay(),e,f);break;case "o":l+=g("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-
+(new Date(b.getFullYear(),0,0)).getTime())/864E5),3);break;case "m":l+=g("m",b.getMonth()+1,2);break;case "M":l+=j("M",b.getMonth(),h,c);break;case "y":l+=i("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case "@":l+=b.getTime();break;case "!":l+=b.getTime()*1E4+this._ticksTo1970;break;case "'":if(i("'"))l+="'";else u=true;break;default:l+=a.charAt(k)}return l},_possibleChars:function(a){for(var b="",c=false,e=function(h){(h=f+1<a.length&&a.charAt(f+1)==h)&&f++;return h},f=
+0;f<a.length;f++)if(c)if(a.charAt(f)=="'"&&!e("'"))c=false;else b+=a.charAt(f);else switch(a.charAt(f)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":if(e("'"))b+="'";else c=true;break;default:b+=a.charAt(f)}return b},_get:function(a,b){return a.settings[b]!==C?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),e=a.lastVal=a.input?a.input.val():null,f,h;f=h=this._getDefaultDate(a);
+var i=this._getFormatConfig(a);try{f=this.parseDate(c,e,i)||h}catch(g){this.log(g);e=b?"":e}a.selectedDay=f.getDate();a.drawMonth=a.selectedMonth=f.getMonth();a.drawYear=a.selectedYear=f.getFullYear();a.currentDay=e?f.getDate():0;a.currentMonth=e?f.getMonth():0;a.currentYear=e?f.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var e=function(h){var i=new Date;
+i.setDate(i.getDate()+h);return i},f=function(h){try{return d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),h,d.datepicker._getFormatConfig(a))}catch(i){}var g=(h.toLowerCase().match(/^c/)?d.datepicker._getDate(a):null)||new Date,j=g.getFullYear(),l=g.getMonth();g=g.getDate();for(var u=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,k=u.exec(h);k;){switch(k[2]||"d"){case "d":case "D":g+=parseInt(k[1],10);break;case "w":case "W":g+=parseInt(k[1],10)*7;break;case "m":case "M":l+=parseInt(k[1],10);g=
+Math.min(g,d.datepicker._getDaysInMonth(j,l));break;case "y":case "Y":j+=parseInt(k[1],10);g=Math.min(g,d.datepicker._getDaysInMonth(j,l));break}k=u.exec(h)}return new Date(j,l,g)};if(b=(b=b==null||b===""?c:typeof b=="string"?f(b):typeof b=="number"?isNaN(b)?c:e(b):new Date(b.getTime()))&&b.toString()=="Invalid Date"?c:b){b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0)}return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(a.getHours()>
+12?a.getHours()+2:0);return a},_setDate:function(a,b,c){var e=!b,f=a.selectedMonth,h=a.selectedYear;b=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();if((f!=a.selectedMonth||h!=a.selectedYear)&&!c)this._notifyChange(a);this._adjustInstDate(a);if(a.input)a.input.val(e?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&
+a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_generateHTML:function(a){var b=new Date;b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),e=this._get(a,"showButtonPanel"),f=this._get(a,"hideIfNoPrevNext"),h=this._get(a,"navigationAsDateFormat"),i=this._getNumberOfMonths(a),g=this._get(a,"showCurrentAtPos"),j=this._get(a,"stepMonths"),l=i[0]!=1||i[1]!=1,u=this._daylightSavingAdjust(!a.currentDay?
+new Date(9999,9,9):new Date(a.currentYear,a.currentMonth,a.currentDay)),k=this._getMinMaxDate(a,"min"),o=this._getMinMaxDate(a,"max");g=a.drawMonth-g;var m=a.drawYear;if(g<0){g+=12;m--}if(o){var n=this._daylightSavingAdjust(new Date(o.getFullYear(),o.getMonth()-i[0]*i[1]+1,o.getDate()));for(n=k&&n<k?k:n;this._daylightSavingAdjust(new Date(m,g,1))>n;){g--;if(g<0){g=11;m--}}}a.drawMonth=g;a.drawYear=m;n=this._get(a,"prevText");n=!h?n:this.formatDate(n,this._daylightSavingAdjust(new Date(m,g-j,1)),this._getFormatConfig(a));
+n=this._canAdjustMonth(a,-1,m,g)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+B+".datepicker._adjustDate('#"+a.id+"', -"+j+", 'M');\" title=\""+n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>":f?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>";var s=this._get(a,"nextText");s=!h?s:this.formatDate(s,this._daylightSavingAdjust(new Date(m,
+g+j,1)),this._getFormatConfig(a));f=this._canAdjustMonth(a,+1,m,g)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+B+".datepicker._adjustDate('#"+a.id+"', +"+j+", 'M');\" title=\""+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>":f?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>";j=this._get(a,"currentText");s=this._get(a,"gotoCurrent")&&
+a.currentDay?u:b;j=!h?j:this.formatDate(j,s,this._getFormatConfig(a));h=!a.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+B+'.datepicker._hideDatepicker();">'+this._get(a,"closeText")+"</button>":"";e=e?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?h:"")+(this._isInRange(a,s)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+
+B+".datepicker._gotoToday('#"+a.id+"');\">"+j+"</button>":"")+(c?"":h)+"</div>":"";h=parseInt(this._get(a,"firstDay"),10);h=isNaN(h)?0:h;j=this._get(a,"showWeek");s=this._get(a,"dayNames");this._get(a,"dayNamesShort");var q=this._get(a,"dayNamesMin"),A=this._get(a,"monthNames"),v=this._get(a,"monthNamesShort"),p=this._get(a,"beforeShowDay"),D=this._get(a,"showOtherMonths"),K=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var E=this._getDefaultDate(a),w="",x=0;x<i[0];x++){var O=
+"";this.maxRows=4;for(var G=0;G<i[1];G++){var P=this._daylightSavingAdjust(new Date(m,g,a.selectedDay)),t=" ui-corner-all",y="";if(l){y+='<div class="ui-datepicker-group';if(i[1]>1)switch(G){case 0:y+=" ui-datepicker-group-first";t=" ui-corner-"+(c?"right":"left");break;case i[1]-1:y+=" ui-datepicker-group-last";t=" ui-corner-"+(c?"left":"right");break;default:y+=" ui-datepicker-group-middle";t="";break}y+='">'}y+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+t+'">'+(/all|left/.test(t)&&
+x==0?c?f:n:"")+(/all|right/.test(t)&&x==0?c?n:f:"")+this._generateMonthYearHeader(a,g,m,k,o,x>0||G>0,A,v)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var z=j?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(t=0;t<7;t++){var r=(t+h)%7;z+="<th"+((t+h+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+s[r]+'">'+q[r]+"</span></th>"}y+=z+"</tr></thead><tbody>";z=this._getDaysInMonth(m,g);if(m==a.selectedYear&&g==a.selectedMonth)a.selectedDay=Math.min(a.selectedDay,
+z);t=(this._getFirstDayOfMonth(m,g)-h+7)%7;z=Math.ceil((t+z)/7);this.maxRows=z=l?this.maxRows>z?this.maxRows:z:z;r=this._daylightSavingAdjust(new Date(m,g,1-t));for(var Q=0;Q<z;Q++){y+="<tr>";var R=!j?"":'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(r)+"</td>";for(t=0;t<7;t++){var I=p?p.apply(a.input?a.input[0]:null,[r]):[true,""],F=r.getMonth()!=g,L=F&&!K||!I[0]||k&&r<k||o&&r>o;R+='<td class="'+((t+h+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(r.getTime()==
+P.getTime()&&g==a.selectedMonth&&a._keyEvent||E.getTime()==r.getTime()&&E.getTime()==P.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!D?"":" "+I[1]+(r.getTime()==u.getTime()?" "+this._currentClass:"")+(r.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!F||D)&&I[2]?' title="'+I[2]+'"':"")+(L?"":' onclick="DP_jQuery_'+B+".datepicker._selectDay('#"+a.id+"',"+r.getMonth()+","+r.getFullYear()+', this);return false;"')+">"+(F&&!D?"&#xa0;":L?'<span class="ui-state-default">'+
+r.getDate()+"</span>":'<a class="ui-state-default'+(r.getTime()==b.getTime()?" ui-state-highlight":"")+(r.getTime()==u.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+'" href="#">'+r.getDate()+"</a>")+"</td>";r.setDate(r.getDate()+1);r=this._daylightSavingAdjust(r)}y+=R+"</tr>"}g++;if(g>11){g=0;m++}y+="</tbody></table>"+(l?"</div>"+(i[0]>0&&G==i[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");O+=y}w+=O}w+=e+(d.browser.msie&&parseInt(d.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':
+"");a._keyEvent=false;return w},_generateMonthYearHeader:function(a,b,c,e,f,h,i,g){var j=this._get(a,"changeMonth"),l=this._get(a,"changeYear"),u=this._get(a,"showMonthAfterYear"),k='<div class="ui-datepicker-title">',o="";if(h||!j)o+='<span class="ui-datepicker-month">'+i[b]+"</span>";else{i=e&&e.getFullYear()==c;var m=f&&f.getFullYear()==c;o+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+B+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" >";for(var n=0;n<12;n++)if((!i||n>=e.getMonth())&&
+(!m||n<=f.getMonth()))o+='<option value="'+n+'"'+(n==b?' selected="selected"':"")+">"+g[n]+"</option>";o+="</select>"}u||(k+=o+(h||!(j&&l)?"&#xa0;":""));if(!a.yearshtml){a.yearshtml="";if(h||!l)k+='<span class="ui-datepicker-year">'+c+"</span>";else{g=this._get(a,"yearRange").split(":");var s=(new Date).getFullYear();i=function(q){q=q.match(/c[+-].*/)?c+parseInt(q.substring(1),10):q.match(/[+-].*/)?s+parseInt(q,10):parseInt(q,10);return isNaN(q)?s:q};b=i(g[0]);g=Math.max(b,i(g[1]||""));b=e?Math.max(b,
+e.getFullYear()):b;g=f?Math.min(g,f.getFullYear()):g;for(a.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+B+".datepicker._selectMonthYear('#"+a.id+"', this, 'Y');\" >";b<=g;b++)a.yearshtml+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>";k+=a.yearshtml;a.yearshtml=null}}k+=this._get(a,"yearSuffix");if(u)k+=(h||!(j&&l)?"&#xa0;":"")+o;k+="</div>";return k},_adjustInstDate:function(a,b,c){var e=a.drawYear+(c=="Y"?b:0),f=a.drawMonth+
+(c=="M"?b:0);b=Math.min(a.selectedDay,this._getDaysInMonth(e,f))+(c=="D"?b:0);e=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(e,f,b)));a.selectedDay=e.getDate();a.drawMonth=a.selectedMonth=e.getMonth();a.drawYear=a.selectedYear=e.getFullYear();if(c=="M"||c=="Y")this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max");b=c&&b<c?c:b;return b=a&&b>a?a:b},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");if(b)b.apply(a.input?
+a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,"numberOfMonths");return a==null?[1,1]:typeof a=="number"?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,e){var f=this._getNumberOfMonths(a);c=this._daylightSavingAdjust(new Date(c,
+e+(b<0?b:f[0]*f[1]),1));b<0&&c.setDate(this._getDaysInMonth(c.getFullYear(),c.getMonth()));return this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!a||b.getTime()<=a.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,
+"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,e){if(!b){a.currentDay=a.selectedDay;a.currentMonth=a.selectedMonth;a.currentYear=a.selectedYear}b=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(e,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});d.fn.datepicker=function(a){if(!this.length)return this;
+if(!d.datepicker.initialized){d(document).mousedown(d.datepicker._checkExternalClick).find("body").append(d.datepicker.dpDiv);d.datepicker.initialized=true}var b=Array.prototype.slice.call(arguments,1);if(typeof a=="string"&&(a=="isDisabled"||a=="getDate"||a=="widget"))return d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b));if(a=="option"&&arguments.length==2&&typeof arguments[1]=="string")return d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b));return this.each(function(){typeof a==
+"string"?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this].concat(b)):d.datepicker._attachDatepicker(this,a)})};d.datepicker=new M;d.datepicker.initialized=false;d.datepicker.uuid=(new Date).getTime();d.datepicker.version="1.8.16";window["DP_jQuery_"+B]=d})(jQuery);
+;/*
+ * jQuery UI Progressbar 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Progressbar
+ *
+ * Depends:
+ *   jquery.ui.core.js
+ *   jquery.ui.widget.js
+ */
+(function(b,d){b.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=b("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
+this.valueDiv.remove();b.Widget.prototype.destroy.apply(this,arguments)},value:function(a){if(a===d)return this._value();this._setOption("value",a);return this},_setOption:function(a,c){if(a==="value"){this.options.value=c;this._refreshValue();this._value()===this.options.max&&this._trigger("complete")}b.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;if(typeof a!=="number")a=0;return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*
+this._value()/this.options.max},_refreshValue:function(){var a=this.value(),c=this._percentage();if(this.oldValue!==a){this.oldValue=a;this._trigger("change")}this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(c.toFixed(0)+"%");this.element.attr("aria-valuenow",a)}});b.extend(b.ui.progressbar,{version:"1.8.16"})})(jQuery);
+;/*
+ * jQuery UI Effects 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/
+ */
+jQuery.effects||function(f,j){function m(c){var a;if(c&&c.constructor==Array&&c.length==3)return c;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)];if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return[parseFloat(a[1])*2.55,parseFloat(a[2])*2.55,parseFloat(a[3])*2.55];if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return[parseInt(a[1],
+16),parseInt(a[2],16),parseInt(a[3],16)];if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)];if(/rgba\(0, 0, 0, 0\)/.exec(c))return n.transparent;return n[f.trim(c).toLowerCase()]}function s(c,a){var b;do{b=f.curCSS(c,a);if(b!=""&&b!="transparent"||f.nodeName(c,"body"))break;a="backgroundColor"}while(c=c.parentNode);return m(b)}function o(){var c=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,
+a={},b,d;if(c&&c.length&&c[0]&&c[c[0]])for(var e=c.length;e--;){b=c[e];if(typeof c[b]=="string"){d=b.replace(/\-(\w)/g,function(g,h){return h.toUpperCase()});a[d]=c[b]}}else for(b in c)if(typeof c[b]==="string")a[b]=c[b];return a}function p(c){var a,b;for(a in c){b=c[a];if(b==null||f.isFunction(b)||a in t||/scrollbar/.test(a)||!/color/i.test(a)&&isNaN(parseFloat(b)))delete c[a]}return c}function u(c,a){var b={_:0},d;for(d in a)if(c[d]!=a[d])b[d]=a[d];return b}function k(c,a,b,d){if(typeof c=="object"){d=
+a;b=null;a=c;c=a.effect}if(f.isFunction(a)){d=a;b=null;a={}}if(typeof a=="number"||f.fx.speeds[a]){d=b;b=a;a={}}if(f.isFunction(b)){d=b;b=null}a=a||{};b=b||a.duration;b=f.fx.off?0:typeof b=="number"?b:b in f.fx.speeds?f.fx.speeds[b]:f.fx.speeds._default;d=d||a.complete;return[c,a,b,d]}function l(c){if(!c||typeof c==="number"||f.fx.speeds[c])return true;if(typeof c==="string"&&!f.effects[c])return true;return false}f.effects={};f.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor",
+"borderTopColor","borderColor","color","outlineColor"],function(c,a){f.fx.step[a]=function(b){if(!b.colorInit){b.start=s(b.elem,a);b.end=m(b.end);b.colorInit=true}b.elem.style[a]="rgb("+Math.max(Math.min(parseInt(b.pos*(b.end[0]-b.start[0])+b.start[0],10),255),0)+","+Math.max(Math.min(parseInt(b.pos*(b.end[1]-b.start[1])+b.start[1],10),255),0)+","+Math.max(Math.min(parseInt(b.pos*(b.end[2]-b.start[2])+b.start[2],10),255),0)+")"}});var n={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,
+0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,
+211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},q=["add","remove","toggle"],t={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};f.effects.animateClass=function(c,a,b,
+d){if(f.isFunction(b)){d=b;b=null}return this.queue(function(){var e=f(this),g=e.attr("style")||" ",h=p(o.call(this)),r,v=e.attr("class");f.each(q,function(w,i){c[i]&&e[i+"Class"](c[i])});r=p(o.call(this));e.attr("class",v);e.animate(u(h,r),{queue:false,duration:a,easing:b,complete:function(){f.each(q,function(w,i){c[i]&&e[i+"Class"](c[i])});if(typeof e.attr("style")=="object"){e.attr("style").cssText="";e.attr("style").cssText=g}else e.attr("style",g);d&&d.apply(this,arguments);f.dequeue(this)}})})};
+f.fn.extend({_addClass:f.fn.addClass,addClass:function(c,a,b,d){return a?f.effects.animateClass.apply(this,[{add:c},a,b,d]):this._addClass(c)},_removeClass:f.fn.removeClass,removeClass:function(c,a,b,d){return a?f.effects.animateClass.apply(this,[{remove:c},a,b,d]):this._removeClass(c)},_toggleClass:f.fn.toggleClass,toggleClass:function(c,a,b,d,e){return typeof a=="boolean"||a===j?b?f.effects.animateClass.apply(this,[a?{add:c}:{remove:c},b,d,e]):this._toggleClass(c,a):f.effects.animateClass.apply(this,
+[{toggle:c},a,b,d])},switchClass:function(c,a,b,d,e){return f.effects.animateClass.apply(this,[{add:a,remove:c},b,d,e])}});f.extend(f.effects,{version:"1.8.16",save:function(c,a){for(var b=0;b<a.length;b++)a[b]!==null&&c.data("ec.storage."+a[b],c[0].style[a[b]])},restore:function(c,a){for(var b=0;b<a.length;b++)a[b]!==null&&c.css(a[b],c.data("ec.storage."+a[b]))},setMode:function(c,a){if(a=="toggle")a=c.is(":hidden")?"show":"hide";return a},getBaseline:function(c,a){var b;switch(c[0]){case "top":b=
+0;break;case "middle":b=0.5;break;case "bottom":b=1;break;default:b=c[0]/a.height}switch(c[1]){case "left":c=0;break;case "center":c=0.5;break;case "right":c=1;break;default:c=c[1]/a.width}return{x:c,y:b}},createWrapper:function(c){if(c.parent().is(".ui-effects-wrapper"))return c.parent();var a={width:c.outerWidth(true),height:c.outerHeight(true),"float":c.css("float")},b=f("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),
+d=document.activeElement;c.wrap(b);if(c[0]===d||f.contains(c[0],d))f(d).focus();b=c.parent();if(c.css("position")=="static"){b.css({position:"relative"});c.css({position:"relative"})}else{f.extend(a,{position:c.css("position"),zIndex:c.css("z-index")});f.each(["top","left","bottom","right"],function(e,g){a[g]=c.css(g);if(isNaN(parseInt(a[g],10)))a[g]="auto"});c.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return b.css(a).show()},removeWrapper:function(c){var a,b=document.activeElement;
+if(c.parent().is(".ui-effects-wrapper")){a=c.parent().replaceWith(c);if(c[0]===b||f.contains(c[0],b))f(b).focus();return a}return c},setTransition:function(c,a,b,d){d=d||{};f.each(a,function(e,g){unit=c.cssUnit(g);if(unit[0]>0)d[g]=unit[0]*b+unit[1]});return d}});f.fn.extend({effect:function(c){var a=k.apply(this,arguments),b={options:a[1],duration:a[2],callback:a[3]};a=b.options.mode;var d=f.effects[c];if(f.fx.off||!d)return a?this[a](b.duration,b.callback):this.each(function(){b.callback&&b.callback.call(this)});
+return d.call(this,b)},_show:f.fn.show,show:function(c){if(l(c))return this._show.apply(this,arguments);else{var a=k.apply(this,arguments);a[1].mode="show";return this.effect.apply(this,a)}},_hide:f.fn.hide,hide:function(c){if(l(c))return this._hide.apply(this,arguments);else{var a=k.apply(this,arguments);a[1].mode="hide";return this.effect.apply(this,a)}},__toggle:f.fn.toggle,toggle:function(c){if(l(c)||typeof c==="boolean"||f.isFunction(c))return this.__toggle.apply(this,arguments);else{var a=k.apply(this,
+arguments);a[1].mode="toggle";return this.effect.apply(this,a)}},cssUnit:function(c){var a=this.css(c),b=[];f.each(["em","px","%","pt"],function(d,e){if(a.indexOf(e)>0)b=[parseFloat(a),e]});return b}});f.easing.jswing=f.easing.swing;f.extend(f.easing,{def:"easeOutQuad",swing:function(c,a,b,d,e){return f.easing[f.easing.def](c,a,b,d,e)},easeInQuad:function(c,a,b,d,e){return d*(a/=e)*a+b},easeOutQuad:function(c,a,b,d,e){return-d*(a/=e)*(a-2)+b},easeInOutQuad:function(c,a,b,d,e){if((a/=e/2)<1)return d/
+2*a*a+b;return-d/2*(--a*(a-2)-1)+b},easeInCubic:function(c,a,b,d,e){return d*(a/=e)*a*a+b},easeOutCubic:function(c,a,b,d,e){return d*((a=a/e-1)*a*a+1)+b},easeInOutCubic:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a+b;return d/2*((a-=2)*a*a+2)+b},easeInQuart:function(c,a,b,d,e){return d*(a/=e)*a*a*a+b},easeOutQuart:function(c,a,b,d,e){return-d*((a=a/e-1)*a*a*a-1)+b},easeInOutQuart:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a*a+b;return-d/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(c,a,b,
+d,e){return d*(a/=e)*a*a*a*a+b},easeOutQuint:function(c,a,b,d,e){return d*((a=a/e-1)*a*a*a*a+1)+b},easeInOutQuint:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a*a*a+b;return d/2*((a-=2)*a*a*a*a+2)+b},easeInSine:function(c,a,b,d,e){return-d*Math.cos(a/e*(Math.PI/2))+d+b},easeOutSine:function(c,a,b,d,e){return d*Math.sin(a/e*(Math.PI/2))+b},easeInOutSine:function(c,a,b,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+b},easeInExpo:function(c,a,b,d,e){return a==0?b:d*Math.pow(2,10*(a/e-1))+b},easeOutExpo:function(c,
+a,b,d,e){return a==e?b+d:d*(-Math.pow(2,-10*a/e)+1)+b},easeInOutExpo:function(c,a,b,d,e){if(a==0)return b;if(a==e)return b+d;if((a/=e/2)<1)return d/2*Math.pow(2,10*(a-1))+b;return d/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(c,a,b,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+b},easeOutCirc:function(c,a,b,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+b},easeInOutCirc:function(c,a,b,d,e){if((a/=e/2)<1)return-d/2*(Math.sqrt(1-a*a)-1)+b;return d/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(c,a,b,
+d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e)==1)return b+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g))+b},easeOutElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e)==1)return b+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*a)*Math.sin((a*e-c)*2*Math.PI/g)+d+b},easeInOutElastic:function(c,a,b,d,e){c=1.70158;var g=
+0,h=d;if(a==0)return b;if((a/=e/2)==2)return b+d;g||(g=e*0.3*1.5);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/h);if(a<1)return-0.5*h*Math.pow(2,10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g)+b;return h*Math.pow(2,-10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g)*0.5+d+b},easeInBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;return d*(a/=e)*a*((g+1)*a-g)+b},easeOutBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;return d*((a=a/e-1)*a*((g+1)*a+g)+1)+b},easeInOutBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;
+if((a/=e/2)<1)return d/2*a*a*(((g*=1.525)+1)*a-g)+b;return d/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+b},easeInBounce:function(c,a,b,d,e){return d-f.easing.easeOutBounce(c,e-a,0,d,e)+b},easeOutBounce:function(c,a,b,d,e){return(a/=e)<1/2.75?d*7.5625*a*a+b:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+b:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+0.9375)+b:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+b},easeInOutBounce:function(c,a,b,d,e){if(a<e/2)return f.easing.easeInBounce(c,a*2,0,d,e)*0.5+b;return f.easing.easeOutBounce(c,
+a*2-e,0,d,e)*0.5+d*0.5+b}})}(jQuery);
+;/*
+ * jQuery UI Effects Blind 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Blind
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(b){b.effects.blind=function(c){return this.queue(function(){var a=b(this),g=["position","top","bottom","left","right"],f=b.effects.setMode(a,c.options.mode||"hide"),d=c.options.direction||"vertical";b.effects.save(a,g);a.show();var e=b.effects.createWrapper(a).css({overflow:"hidden"}),h=d=="vertical"?"height":"width";d=d=="vertical"?e.height():e.width();f=="show"&&e.css(h,0);var i={};i[h]=f=="show"?d:0;e.animate(i,c.duration,c.options.easing,function(){f=="hide"&&a.hide();b.effects.restore(a,
+g);b.effects.removeWrapper(a);c.callback&&c.callback.apply(a[0],arguments);a.dequeue()})})}})(jQuery);
+;/*
+ * jQuery UI Effects Bounce 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Bounce
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(e){e.effects.bounce=function(b){return this.queue(function(){var a=e(this),l=["position","top","bottom","left","right"],h=e.effects.setMode(a,b.options.mode||"effect"),d=b.options.direction||"up",c=b.options.distance||20,m=b.options.times||5,i=b.duration||250;/show|hide/.test(h)&&l.push("opacity");e.effects.save(a,l);a.show();e.effects.createWrapper(a);var f=d=="up"||d=="down"?"top":"left";d=d=="up"||d=="left"?"pos":"neg";c=b.options.distance||(f=="top"?a.outerHeight({margin:true})/3:a.outerWidth({margin:true})/
+3);if(h=="show")a.css("opacity",0).css(f,d=="pos"?-c:c);if(h=="hide")c/=m*2;h!="hide"&&m--;if(h=="show"){var g={opacity:1};g[f]=(d=="pos"?"+=":"-=")+c;a.animate(g,i/2,b.options.easing);c/=2;m--}for(g=0;g<m;g++){var j={},k={};j[f]=(d=="pos"?"-=":"+=")+c;k[f]=(d=="pos"?"+=":"-=")+c;a.animate(j,i/2,b.options.easing).animate(k,i/2,b.options.easing);c=h=="hide"?c*2:c/2}if(h=="hide"){g={opacity:0};g[f]=(d=="pos"?"-=":"+=")+c;a.animate(g,i/2,b.options.easing,function(){a.hide();e.effects.restore(a,l);e.effects.removeWrapper(a);
+b.callback&&b.callback.apply(this,arguments)})}else{j={};k={};j[f]=(d=="pos"?"-=":"+=")+c;k[f]=(d=="pos"?"+=":"-=")+c;a.animate(j,i/2,b.options.easing).animate(k,i/2,b.options.easing,function(){e.effects.restore(a,l);e.effects.removeWrapper(a);b.callback&&b.callback.apply(this,arguments)})}a.queue("fx",function(){a.dequeue()});a.dequeue()})}})(jQuery);
+;/*
+ * jQuery UI Effects Clip 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Clip
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(b){b.effects.clip=function(e){return this.queue(function(){var a=b(this),i=["position","top","bottom","left","right","height","width"],f=b.effects.setMode(a,e.options.mode||"hide"),c=e.options.direction||"vertical";b.effects.save(a,i);a.show();var d=b.effects.createWrapper(a).css({overflow:"hidden"});d=a[0].tagName=="IMG"?d:a;var g={size:c=="vertical"?"height":"width",position:c=="vertical"?"top":"left"};c=c=="vertical"?d.height():d.width();if(f=="show"){d.css(g.size,0);d.css(g.position,
+c/2)}var h={};h[g.size]=f=="show"?c:0;h[g.position]=f=="show"?0:c/2;d.animate(h,{queue:false,duration:e.duration,easing:e.options.easing,complete:function(){f=="hide"&&a.hide();b.effects.restore(a,i);b.effects.removeWrapper(a);e.callback&&e.callback.apply(a[0],arguments);a.dequeue()}})})}})(jQuery);
+;/*
+ * jQuery UI Effects Drop 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Drop
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(c){c.effects.drop=function(d){return this.queue(function(){var a=c(this),h=["position","top","bottom","left","right","opacity"],e=c.effects.setMode(a,d.options.mode||"hide"),b=d.options.direction||"left";c.effects.save(a,h);a.show();c.effects.createWrapper(a);var f=b=="up"||b=="down"?"top":"left";b=b=="up"||b=="left"?"pos":"neg";var g=d.options.distance||(f=="top"?a.outerHeight({margin:true})/2:a.outerWidth({margin:true})/2);if(e=="show")a.css("opacity",0).css(f,b=="pos"?-g:g);var i={opacity:e==
+"show"?1:0};i[f]=(e=="show"?b=="pos"?"+=":"-=":b=="pos"?"-=":"+=")+g;a.animate(i,{queue:false,duration:d.duration,easing:d.options.easing,complete:function(){e=="hide"&&a.hide();c.effects.restore(a,h);c.effects.removeWrapper(a);d.callback&&d.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
+;/*
+ * jQuery UI Effects Explode 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Explode
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(j){j.effects.explode=function(a){return this.queue(function(){var c=a.options.pieces?Math.round(Math.sqrt(a.options.pieces)):3,d=a.options.pieces?Math.round(Math.sqrt(a.options.pieces)):3;a.options.mode=a.options.mode=="toggle"?j(this).is(":visible")?"hide":"show":a.options.mode;var b=j(this).show().css("visibility","hidden"),g=b.offset();g.top-=parseInt(b.css("marginTop"),10)||0;g.left-=parseInt(b.css("marginLeft"),10)||0;for(var h=b.outerWidth(true),i=b.outerHeight(true),e=0;e<c;e++)for(var f=
+0;f<d;f++)b.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-f*(h/d),top:-e*(i/c)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:h/d,height:i/c,left:g.left+f*(h/d)+(a.options.mode=="show"?(f-Math.floor(d/2))*(h/d):0),top:g.top+e*(i/c)+(a.options.mode=="show"?(e-Math.floor(c/2))*(i/c):0),opacity:a.options.mode=="show"?0:1}).animate({left:g.left+f*(h/d)+(a.options.mode=="show"?0:(f-Math.floor(d/2))*(h/d)),top:g.top+
+e*(i/c)+(a.options.mode=="show"?0:(e-Math.floor(c/2))*(i/c)),opacity:a.options.mode=="show"?1:0},a.duration||500);setTimeout(function(){a.options.mode=="show"?b.css({visibility:"visible"}):b.css({visibility:"visible"}).hide();a.callback&&a.callback.apply(b[0]);b.dequeue();j("div.ui-effects-explode").remove()},a.duration||500)})}})(jQuery);
+;/*
+ * jQuery UI Effects Fade 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Fade
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(b){b.effects.fade=function(a){return this.queue(function(){var c=b(this),d=b.effects.setMode(c,a.options.mode||"hide");c.animate({opacity:d},{queue:false,duration:a.duration,easing:a.options.easing,complete:function(){a.callback&&a.callback.apply(this,arguments);c.dequeue()}})})}})(jQuery);
+;/*
+ * jQuery UI Effects Fold 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Fold
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(c){c.effects.fold=function(a){return this.queue(function(){var b=c(this),j=["position","top","bottom","left","right"],d=c.effects.setMode(b,a.options.mode||"hide"),g=a.options.size||15,h=!!a.options.horizFirst,k=a.duration?a.duration/2:c.fx.speeds._default/2;c.effects.save(b,j);b.show();var e=c.effects.createWrapper(b).css({overflow:"hidden"}),f=d=="show"!=h,l=f?["width","height"]:["height","width"];f=f?[e.width(),e.height()]:[e.height(),e.width()];var i=/([0-9]+)%/.exec(g);if(i)g=parseInt(i[1],
+10)/100*f[d=="hide"?0:1];if(d=="show")e.css(h?{height:0,width:g}:{height:g,width:0});h={};i={};h[l[0]]=d=="show"?f[0]:g;i[l[1]]=d=="show"?f[1]:0;e.animate(h,k,a.options.easing).animate(i,k,a.options.easing,function(){d=="hide"&&b.hide();c.effects.restore(b,j);c.effects.removeWrapper(b);a.callback&&a.callback.apply(b[0],arguments);b.dequeue()})})}})(jQuery);
+;/*
+ * jQuery UI Effects Highlight 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Highlight
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(b){b.effects.highlight=function(c){return this.queue(function(){var a=b(this),e=["backgroundImage","backgroundColor","opacity"],d=b.effects.setMode(a,c.options.mode||"show"),f={backgroundColor:a.css("backgroundColor")};if(d=="hide")f.opacity=0;b.effects.save(a,e);a.show().css({backgroundImage:"none",backgroundColor:c.options.color||"#ffff99"}).animate(f,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){d=="hide"&&a.hide();b.effects.restore(a,e);d=="show"&&!b.support.opacity&&
+this.style.removeAttribute("filter");c.callback&&c.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
+;/*
+ * jQuery UI Effects Pulsate 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Pulsate
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(d){d.effects.pulsate=function(a){return this.queue(function(){var b=d(this),c=d.effects.setMode(b,a.options.mode||"show");times=(a.options.times||5)*2-1;duration=a.duration?a.duration/2:d.fx.speeds._default/2;isVisible=b.is(":visible");animateTo=0;if(!isVisible){b.css("opacity",0).show();animateTo=1}if(c=="hide"&&isVisible||c=="show"&&!isVisible)times--;for(c=0;c<times;c++){b.animate({opacity:animateTo},duration,a.options.easing);animateTo=(animateTo+1)%2}b.animate({opacity:animateTo},duration,
+a.options.easing,function(){animateTo==0&&b.hide();a.callback&&a.callback.apply(this,arguments)});b.queue("fx",function(){b.dequeue()}).dequeue()})}})(jQuery);
+;/*
+ * jQuery UI Effects Scale 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Scale
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(c){c.effects.puff=function(b){return this.queue(function(){var a=c(this),e=c.effects.setMode(a,b.options.mode||"hide"),g=parseInt(b.options.percent,10)||150,h=g/100,i={height:a.height(),width:a.width()};c.extend(b.options,{fade:true,mode:e,percent:e=="hide"?g:100,from:e=="hide"?i:{height:i.height*h,width:i.width*h}});a.effect("scale",b.options,b.duration,b.callback);a.dequeue()})};c.effects.scale=function(b){return this.queue(function(){var a=c(this),e=c.extend(true,{},b.options),g=c.effects.setMode(a,
+b.options.mode||"effect"),h=parseInt(b.options.percent,10)||(parseInt(b.options.percent,10)==0?0:g=="hide"?0:100),i=b.options.direction||"both",f=b.options.origin;if(g!="effect"){e.origin=f||["middle","center"];e.restore=true}f={height:a.height(),width:a.width()};a.from=b.options.from||(g=="show"?{height:0,width:0}:f);h={y:i!="horizontal"?h/100:1,x:i!="vertical"?h/100:1};a.to={height:f.height*h.y,width:f.width*h.x};if(b.options.fade){if(g=="show"){a.from.opacity=0;a.to.opacity=1}if(g=="hide"){a.from.opacity=
+1;a.to.opacity=0}}e.from=a.from;e.to=a.to;e.mode=g;a.effect("size",e,b.duration,b.callback);a.dequeue()})};c.effects.size=function(b){return this.queue(function(){var a=c(this),e=["position","top","bottom","left","right","width","height","overflow","opacity"],g=["position","top","bottom","left","right","overflow","opacity"],h=["width","height","overflow"],i=["fontSize"],f=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],k=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],
+p=c.effects.setMode(a,b.options.mode||"effect"),n=b.options.restore||false,m=b.options.scale||"both",l=b.options.origin,j={height:a.height(),width:a.width()};a.from=b.options.from||j;a.to=b.options.to||j;if(l){l=c.effects.getBaseline(l,j);a.from.top=(j.height-a.from.height)*l.y;a.from.left=(j.width-a.from.width)*l.x;a.to.top=(j.height-a.to.height)*l.y;a.to.left=(j.width-a.to.width)*l.x}var d={from:{y:a.from.height/j.height,x:a.from.width/j.width},to:{y:a.to.height/j.height,x:a.to.width/j.width}};
+if(m=="box"||m=="both"){if(d.from.y!=d.to.y){e=e.concat(f);a.from=c.effects.setTransition(a,f,d.from.y,a.from);a.to=c.effects.setTransition(a,f,d.to.y,a.to)}if(d.from.x!=d.to.x){e=e.concat(k);a.from=c.effects.setTransition(a,k,d.from.x,a.from);a.to=c.effects.setTransition(a,k,d.to.x,a.to)}}if(m=="content"||m=="both")if(d.from.y!=d.to.y){e=e.concat(i);a.from=c.effects.setTransition(a,i,d.from.y,a.from);a.to=c.effects.setTransition(a,i,d.to.y,a.to)}c.effects.save(a,n?e:g);a.show();c.effects.createWrapper(a);
+a.css("overflow","hidden").css(a.from);if(m=="content"||m=="both"){f=f.concat(["marginTop","marginBottom"]).concat(i);k=k.concat(["marginLeft","marginRight"]);h=e.concat(f).concat(k);a.find("*[width]").each(function(){child=c(this);n&&c.effects.save(child,h);var o={height:child.height(),width:child.width()};child.from={height:o.height*d.from.y,width:o.width*d.from.x};child.to={height:o.height*d.to.y,width:o.width*d.to.x};if(d.from.y!=d.to.y){child.from=c.effects.setTransition(child,f,d.from.y,child.from);
+child.to=c.effects.setTransition(child,f,d.to.y,child.to)}if(d.from.x!=d.to.x){child.from=c.effects.setTransition(child,k,d.from.x,child.from);child.to=c.effects.setTransition(child,k,d.to.x,child.to)}child.css(child.from);child.animate(child.to,b.duration,b.options.easing,function(){n&&c.effects.restore(child,h)})})}a.animate(a.to,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){a.to.opacity===0&&a.css("opacity",a.from.opacity);p=="hide"&&a.hide();c.effects.restore(a,
+n?e:g);c.effects.removeWrapper(a);b.callback&&b.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
+;/*
+ * jQuery UI Effects Shake 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Shake
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(d){d.effects.shake=function(a){return this.queue(function(){var b=d(this),j=["position","top","bottom","left","right"];d.effects.setMode(b,a.options.mode||"effect");var c=a.options.direction||"left",e=a.options.distance||20,l=a.options.times||3,f=a.duration||a.options.duration||140;d.effects.save(b,j);b.show();d.effects.createWrapper(b);var g=c=="up"||c=="down"?"top":"left",h=c=="up"||c=="left"?"pos":"neg";c={};var i={},k={};c[g]=(h=="pos"?"-=":"+=")+e;i[g]=(h=="pos"?"+=":"-=")+e*2;k[g]=
+(h=="pos"?"-=":"+=")+e*2;b.animate(c,f,a.options.easing);for(e=1;e<l;e++)b.animate(i,f,a.options.easing).animate(k,f,a.options.easing);b.animate(i,f,a.options.easing).animate(c,f/2,a.options.easing,function(){d.effects.restore(b,j);d.effects.removeWrapper(b);a.callback&&a.callback.apply(this,arguments)});b.queue("fx",function(){b.dequeue()});b.dequeue()})}})(jQuery);
+;/*
+ * jQuery UI Effects Slide 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Slide
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(c){c.effects.slide=function(d){return this.queue(function(){var a=c(this),h=["position","top","bottom","left","right"],f=c.effects.setMode(a,d.options.mode||"show"),b=d.options.direction||"left";c.effects.save(a,h);a.show();c.effects.createWrapper(a).css({overflow:"hidden"});var g=b=="up"||b=="down"?"top":"left";b=b=="up"||b=="left"?"pos":"neg";var e=d.options.distance||(g=="top"?a.outerHeight({margin:true}):a.outerWidth({margin:true}));if(f=="show")a.css(g,b=="pos"?isNaN(e)?"-"+e:-e:e);
+var i={};i[g]=(f=="show"?b=="pos"?"+=":"-=":b=="pos"?"-=":"+=")+e;a.animate(i,{queue:false,duration:d.duration,easing:d.options.easing,complete:function(){f=="hide"&&a.hide();c.effects.restore(a,h);c.effects.removeWrapper(a);d.callback&&d.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
+;/*
+ * jQuery UI Effects Transfer 1.8.16
+ *
+ * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * http://jquery.org/license
+ *
+ * http://docs.jquery.com/UI/Effects/Transfer
+ *
+ * Depends:
+ *	jquery.effects.core.js
+ */
+(function(e){e.effects.transfer=function(a){return this.queue(function(){var b=e(this),c=e(a.options.to),d=c.offset();c={top:d.top,left:d.left,height:c.innerHeight(),width:c.innerWidth()};d=b.offset();var f=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(a.options.className).css({top:d.top,left:d.left,height:b.innerHeight(),width:b.innerWidth(),position:"absolute"}).animate(c,a.duration,a.options.easing,function(){f.remove();a.callback&&a.callback.apply(b[0],arguments);
+b.dequeue()})})}})(jQuery);
+;
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/lib/head.load.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/head.load.min.js	(date 1594749336087)
+++ src/main/resources/static/static/lib/brat/lib/head.load.min.js	(date 1594749336087)
@@ -0,0 +1,8 @@
+/**
+	Head JS		The only script in your <HEAD>
+	Copyright	Tero Piirainen (tipiirai)
+	License		MIT / http://bit.ly/mit-license
+	Version		0.9
+	
+	http://headjs.com
+*/(function(a){var b=a.documentElement,c,d,e=[],f=[],g={},h={},i=a.createElement("script").async===true||"MozAppearance"in a.documentElement.style||window.opera;var j=window.head_conf&&head_conf.head||"head",k=window[j]=window[j]||function(){k.ready.apply(null,arguments)};var l=0,m=1,n=2,o=3;i?k.js=function(){var a=arguments,b=a[a.length-1],c=[];t(b)||(b=null),s(a,function(d,e){d!=b&&(d=r(d),c.push(d),x(d,b&&e==a.length-2?function(){u(c)&&p(b)}:null))});return k}:k.js=function(){var a=arguments,b=[].slice.call(a,1),d=b[0];if(!c){f.push(function(){k.js.apply(null,a)});return k}d?(s(b,function(a){t(a)||w(r(a))}),x(r(a[0]),t(d)?d:function(){k.js.apply(null,b)})):x(r(a[0]));return k},k.ready=function(a,b){if(a=="dom"){d?p(b):e.push(b);return k}t(a)&&(b=a,a="ALL");var c=h[a];if(c&&c.state==o||a=="ALL"&&u()&&d){p(b);return k}var f=g[a];f?f.push(b):f=g[a]=[b];return k},k.ready("dom",function(){c&&u()&&s(g.ALL,function(a){p(a)}),k.feature&&k.feature("domloaded",true)});function p(a){a._done||(a(),a._done=1)}function q(a){var b=a.split("/"),c=b[b.length-1],d=c.indexOf("?");return d!=-1?c.substring(0,d):c}function r(a){var b;if(typeof a=="object")for(var c in a)a[c]&&(b={name:c,url:a[c]});else b={name:q(a),url:a};var d=h[b.name];if(d&&d.url===b.url)return d;h[b.name]=b;return b}function s(a,b){if(a){typeof a=="object"&&(a=[].slice.call(a));for(var c=0;c<a.length;c++)b.call(a,a[c],c)}}function t(a){return Object.prototype.toString.call(a)=="[object Function]"}function u(a){a=a||h;var b=false,c=0;for(var d in a){if(a[d].state!=o)return false;b=true,c++}return b||c===0}function v(a){a.state=l,s(a.onpreload,function(a){a.call()})}function w(a,b){a.state||(a.state=m,a.onpreload=[],y({src:a.url,type:"cache"},function(){v(a)}))}function x(a,b){if(a.state==o&&b)return b();if(a.state==n)return k.ready(a.name,b);if(a.state==m)return a.onpreload.push(function(){x(a,b)});a.state=n,y(a.url,function(){a.state=o,b&&b(),s(g[a.name],function(a){p(a)}),d&&u()&&s(g.ALL,function(a){p(a)})})}function y(c,d){var e=a.createElement("script");e.type="text/"+(c.type||"javascript"),e.src=c.src||c,e.async=false,e.onreadystatechange=e.onload=function(){var a=e.readyState;!d.done&&(!a||/loaded|complete/.test(a))&&(d(),d.done=true)},b.appendChild(e)}setTimeout(function(){c=true,s(f,function(a){a()})},0);function z(){d||(d=true,s(e,function(a){p(a)}))}window.addEventListener?(a.addEventListener("DOMContentLoaded",z,false),window.addEventListener("onload",z,false)):window.attachEvent&&(a.attachEvent("onreadystatechange",function(){a.readyState==="complete"&&z()}),window.frameElement==null&&b.doScroll&&function(){try{b.doScroll("left"),z()}catch(a){setTimeout(arguments.callee,1);return}}(),window.attachEvent("onload",z)),!a.readyState&&a.addEventListener&&(a.readyState="loading",a.addEventListener("DOMContentLoaded",handler=function(){a.removeEventListener("DOMContentLoaded",handler,false),a.readyState="complete"},false))})(document)
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/lib/jquery.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/jquery.min.js	(date 1594749336093)
+++ src/main/resources/static/static/lib/brat/lib/jquery.min.js	(date 1594749336093)
@@ -0,0 +1,4 @@
+/*! jQuery v1.7.1 jquery.com | jquery.org/license */
+(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement)cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close();d=cm.createElement(a),cm.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)ca(a+"["+e+"]",b[e],c,d);else d(a,b)}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border")for(;g<h;g++)c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0;return d+"px"}d=bz(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;g<h;g++)d+=parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0);return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent)for(o in{submit:1,change:1,focusin:1})n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p;k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++)e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};
+f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++)r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),o[s]&&q.push(r);q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function()
+{for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bp)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof (r=k.length)=="number")for(i=0;i<r;i++)bn(k[i]);else bn(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bC(a,b,d);f.swap(a,bw,function(){e=bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS)return bS.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]==="http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bU,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)ca(g,a[g],c,e);return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch)ch[a](0,1)}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/lib/jquery-1.7.1.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/jquery-1.7.1.min.js	(date 1594749336089)
+++ src/main/resources/static/static/lib/brat/lib/jquery-1.7.1.min.js	(date 1594749336089)
@@ -0,0 +1,4 @@
+/*! jQuery v1.7.1 jquery.com | jquery.org/license */
+(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement)cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close();d=cm.createElement(a),cm.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)ca(a+"["+e+"]",b[e],c,d);else d(a,b)}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border")for(;g<h;g++)c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0;return d+"px"}d=bz(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;g<h;g++)d+=parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0);return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent)for(o in{submit:1,change:1,focusin:1})n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p;k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++)e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};
+f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++)r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),o[s]&&q.push(r);q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function()
+{for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bp)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof (r=k.length)=="number")for(i=0;i<r;i++)bn(k[i]);else bn(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bC(a,b,d);f.swap(a,bw,function(){e=bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS)return bS.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]==="http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bU,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)ca(g,a[g],c,e);return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch)ch[a](0,1)}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/lib/jquery.json.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/jquery.json.min.js	(date 1594749336092)
+++ src/main/resources/static/static/lib/brat/lib/jquery.json.min.js	(date 1594749336092)
@@ -0,0 +1,31 @@
+
+(function($){$.toJSON=function(o)
+{if(typeof(JSON)=='object'&&JSON.stringify)
+return JSON.stringify(o);var type=typeof(o);if(o===null)
+return"null";if(type=="undefined")
+return undefined;if(type=="number"||type=="boolean")
+return o+"";if(type=="string")
+return $.quoteString(o);if(type=='object')
+{if(typeof o.toJSON=="function")
+return $.toJSON(o.toJSON());if(o.constructor===Date)
+{var month=o.getUTCMonth()+1;if(month<10)month='0'+month;var day=o.getUTCDate();if(day<10)day='0'+day;var year=o.getUTCFullYear();var hours=o.getUTCHours();if(hours<10)hours='0'+hours;var minutes=o.getUTCMinutes();if(minutes<10)minutes='0'+minutes;var seconds=o.getUTCSeconds();if(seconds<10)seconds='0'+seconds;var milli=o.getUTCMilliseconds();if(milli<100)milli='0'+milli;if(milli<10)milli='0'+milli;return'"'+year+'-'+month+'-'+day+'T'+
+hours+':'+minutes+':'+seconds+'.'+milli+'Z"';}
+if(o.constructor===Array)
+{var ret=[];for(var i=0;i<o.length;i++)
+ret.push($.toJSON(o[i])||"null");return"["+ret.join(",")+"]";}
+var pairs=[];for(var k in o){var name;var type=typeof k;if(type=="number")
+name='"'+k+'"';else if(type=="string")
+name=$.quoteString(k);else
+continue;if(typeof o[k]=="function")
+continue;var val=$.toJSON(o[k]);pairs.push(name+":"+val);}
+return"{"+pairs.join(", ")+"}";}};$.evalJSON=function(src)
+{if(typeof(JSON)=='object'&&JSON.parse)
+return JSON.parse(src);return eval("("+src+")");};$.secureEvalJSON=function(src)
+{if(typeof(JSON)=='object'&&JSON.parse)
+return JSON.parse(src);var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,'@');filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']');filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered))
+return eval("("+src+")");else
+throw new SyntaxError("Error parsing JSON, source is not valid.");};$.quoteString=function(string)
+{if(string.match(_escapeable))
+{return'"'+string.replace(_escapeable,function(a)
+{var c=_meta[a];if(typeof c==='string')return c;c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}
+return'"'+string+'"';};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;var _meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};})(jQuery);
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/lib/webfont.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/webfont.js	(date 1594749336096)
+++ src/main/resources/static/static/lib/brat/lib/webfont.js	(date 1594749336096)
@@ -0,0 +1,46 @@
+/*
+ * Copyright 2012 Small Batch, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License"); you may not
+ * use this file except in compliance with the License. You may obtain a copy of
+ * the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
+ * License for the specific language governing permissions and limitations under
+ * the License.
+ */
+;(function(window,document,undefined){
+function i(a){return function(){return this[a]}}var j;function n(a,b){var c=arguments.length>2?Array.prototype.slice.call(arguments,2):[];return function(){c.push.apply(c,arguments);return b.apply(a,c)}};function o(a,b){this.K=a;this.c=b}o.prototype.createElement=function(a,b,c){a=this.K.createElement(a);if(b)for(var d in b)if(b.hasOwnProperty(d))d=="style"?q(this,a,b[d]):a.setAttribute(d,b[d]);c&&a.appendChild(this.K.createTextNode(c));return a};function r(a,b,c){a=a.K.getElementsByTagName(b)[0];if(!a)a=document.documentElement;if(a&&a.lastChild){a.insertBefore(c,a.lastChild);return true}return false}function aa(a,b){function c(){document.body?b():setTimeout(c,0)}c()}
+function s(a,b){if(b.parentNode){b.parentNode.removeChild(b);return true}return false}function t(a,b){return a.createElement("link",{rel:"stylesheet",href:b})}function u(a,b){return a.createElement("script",{src:b})}function v(a,b,c){a=b.className.split(/\s+/);for(var d=0,e=a.length;d<e;d++)if(a[d]==c)return;a.push(c);b.className=a.join(" ").replace(/^\s+/,"")}
+function w(a,b,c){a=b.className.split(/\s+/);for(var d=[],e=0,f=a.length;e<f;e++)a[e]!=c&&d.push(a[e]);b.className=d.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")}function x(a,b,c){a=b.className.split(/\s+/);b=0;for(var d=a.length;b<d;b++)if(a[b]==c)return true;return false}function q(a,b,c){if(a.c.getName()=="MSIE")b.style.cssText=c;else b.setAttribute("style",c)};function y(a,b,c,d,e,f,g,h){this.Ba=a;this.Ha=b;this.oa=c;this.na=d;this.Ea=e;this.Da=f;this.ma=g;this.Ia=h}j=y.prototype;j.getName=i("Ba");j.xa=i("Ha");j.Y=i("oa");j.ua=i("na");j.va=i("Ea");j.wa=i("Da");j.ta=i("ma");j.w=i("Ia");function z(a,b){this.c=a;this.k=b}var ba=new y("Unknown","Unknown","Unknown","Unknown","Unknown","Unknown",undefined,false);z.prototype.parse=function(){return this.c.indexOf("MSIE")!=-1?ca(this):this.c.indexOf("Opera")!=-1?da(this):this.c.indexOf("AppleWebKit")!=-1?ea(this):this.c.indexOf("Gecko")!=-1?fa(this):ba};
+function A(a){var b=C(a,a.c,/(iPod|iPad|iPhone|Android)/,1);if(b!="")return b;a=C(a,a.c,/(Linux|Mac_PowerPC|Macintosh|Windows)/,1);if(a!=""){if(a=="Mac_PowerPC")a="Macintosh";return a}return"Unknown"}function D(a){var b=C(a,a.c,/(OS X|Windows NT|Android) ([^;)]+)/,2);if(b)return b;if(b=C(a,a.c,/(iPhone )?OS ([\d_]+)/,2))return b;if(a=C(a,a.c,/Linux ([i\d]+)/,1))return a;return"Unknown"}
+function ca(a){var b=C(a,a.c,/(MSIE [\d\w\.]+)/,1);if(b!=""){var c=b.split(" ");b=c[0];c=c[1];return new y(b,c,b,c,A(a),D(a),E(a,a.k),F(a,c)>=6)}return new y("MSIE","Unknown","MSIE","Unknown",A(a),D(a),E(a,a.k),false)}
+function da(a){var b="Unknown",c="Unknown",d=C(a,a.c,/(Presto\/[\d\w\.]+)/,1);if(d!=""){c=d.split("/");b=c[0];c=c[1]}else{if(a.c.indexOf("Gecko")!=-1)b="Gecko";d=C(a,a.c,/rv:([^\)]+)/,1);if(d!="")c=d}if(a.c.indexOf("Version/")!=-1){d=C(a,a.c,/Version\/([\d\.]+)/,1);if(d!="")return new y("Opera",d,b,c,A(a),D(a),E(a,a.k),F(a,d)>=10)}d=C(a,a.c,/Opera[\/ ]([\d\.]+)/,1);if(d!="")return new y("Opera",d,b,c,A(a),D(a),E(a,a.k),F(a,d)>=10);return new y("Opera","Unknown",b,c,A(a),D(a),E(a,a.k),false)}
+function ea(a){var b=A(a),c=D(a),d=C(a,a.c,/AppleWebKit\/([\d\.\+]+)/,1);if(d=="")d="Unknown";var e="Unknown";if(a.c.indexOf("Chrome")!=-1)e="Chrome";else if(a.c.indexOf("Safari")!=-1)e="Safari";else if(a.c.indexOf("AdobeAIR")!=-1)e="AdobeAIR";var f="Unknown";if(a.c.indexOf("Version/")!=-1)f=C(a,a.c,/Version\/([\d\.\w]+)/,1);else if(e=="Chrome")f=C(a,a.c,/Chrome\/([\d\.]+)/,1);else if(e=="AdobeAIR")f=C(a,a.c,/AdobeAIR\/([\d\.]+)/,1);var g=false;if(e=="AdobeAIR"){g=C(a,f,/\d+\.(\d+)/,1);g=F(a,f)>2||
+F(a,f)==2&&parseInt(g,10)>=5}else{g=C(a,d,/\d+\.(\d+)/,1);g=F(a,d)>=526||F(a,d)>=525&&parseInt(g,10)>=13}return new y(e,f,"AppleWebKit",d,b,c,E(a,a.k),g)}
+function fa(a){var b="Unknown",c="Unknown",d=false;if(a.c.indexOf("Firefox")!=-1){b="Firefox";var e=C(a,a.c,/Firefox\/([\d\w\.]+)/,1);if(e!=""){d=C(a,e,/\d+\.(\d+)/,1);c=e;d=e!=""&&F(a,e)>=3&&parseInt(d,10)>=5}}else if(a.c.indexOf("Mozilla")!=-1)b="Mozilla";e=C(a,a.c,/rv:([^\)]+)/,1);if(e=="")e="Unknown";else if(!d){d=F(a,e);var f=parseInt(C(a,e,/\d+\.(\d+)/,1),10),g=parseInt(C(a,e,/\d+\.\d+\.(\d+)/,1),10);d=d>1||d==1&&f>9||d==1&&f==9&&g>=2||e.match(/1\.9\.1b[123]/)!=null||e.match(/1\.9\.1\.[\d\.]+/)!=
+null}return new y(b,c,"Gecko",e,A(a),D(a),E(a,a.k),d)}function F(a,b){a=C(a,b,/(\d+)/,1);if(a!="")return parseInt(a,10);return-1}function C(a,b,c,d){if((a=b.match(c))&&a[d])return a[d];return""}function E(a,b){if(b.documentMode)return b.documentMode};function ga(a,b,c,d){this.a=a;this.g=b;this.U=c;this.j=d||ha;this.h=new G("-")}var ha="wf";function H(a){v(a.a,a.g,a.h.e(a.j,"loading"));I(a,"loading")}function J(a){w(a.a,a.g,a.h.e(a.j,"loading"));x(a.a,a.g,a.h.e(a.j,"active"))||v(a.a,a.g,a.h.e(a.j,"inactive"));I(a,"inactive")}function ia(a){w(a.a,a.g,a.h.e(a.j,"loading"));w(a.a,a.g,a.h.e(a.j,"inactive"));v(a.a,a.g,a.h.e(a.j,"active"));I(a,"active")}function I(a,b,c,d){a.U[b]&&a.U[b](c,d)};function ja(){this.fa={}}function ka(a,b){var c=[];for(var d in b)if(b.hasOwnProperty(d)){var e=a.fa[d];e&&c.push(e(b[d]))}return c};function L(a,b,c,d,e){this.a=a;this.A=b;this.n=c;this.u=d;this.D=e;this.V=0;this.ja=this.ea=false}L.prototype.watch=function(a,b,c,d,e){for(var f=a.length,g=0;g<f;g++){var h=a[g];b[h]||(b[h]=["n4"]);this.V+=b[h].length}if(e)this.ea=e;for(g=0;g<f;g++){h=a[g];e=b[h];for(var l=c[h],k=0,m=e.length;k<m;k++){var B=e[k],p=this.A,K=h;v(p.a,p.g,p.h.e(p.j,K,B,"loading"));I(p,"fontloading",K,B);p=n(this,this.qa);K=n(this,this.ra);(new d(p,K,this.a,this.n,this.u,this.D,h,B,l)).start()}}};
+L.prototype.qa=function(a,b){var c=this.A;w(c.a,c.g,c.h.e(c.j,a,b,"loading"));w(c.a,c.g,c.h.e(c.j,a,b,"inactive"));v(c.a,c.g,c.h.e(c.j,a,b,"active"));I(c,"fontactive",a,b);this.ja=true;M(this)};L.prototype.ra=function(a,b){var c=this.A;w(c.a,c.g,c.h.e(c.j,a,b,"loading"));x(c.a,c.g,c.h.e(c.j,a,b,"active"))||v(c.a,c.g,c.h.e(c.j,a,b,"inactive"));I(c,"fontinactive",a,b);M(this)};function M(a){if(--a.V==0&&a.ea)a.ja?ia(a.A):J(a.A)};function N(a,b,c,d,e,f,g,h,l){this.H=a;this.$=b;this.a=c;this.n=d;this.u=e;this.D=f;this.Aa=new la;this.v=new O;this.L=g;this.B=h;this.sa=l||ma;this.O=na(this,oa);this.P=na(this,pa);this.ca=this.O;this.da=this.P;this.Q=P(this,oa);this.R=P(this,pa)}var oa="arial,'URW Gothic L',sans-serif",pa="Georgia,'Century Schoolbook L',serif",ma="BESbswy";N.prototype.start=function(){this.ia=this.D();this.J()};
+N.prototype.J=function(){var a=this.n.p(this.Q),b=this.n.p(this.R);if((this.O!=a||this.P!=b)&&this.ca==a&&this.da==b)Q(this,this.H);else if(this.D()-this.ia>=5E3)Q(this,this.$);else{this.ca=a;this.da=b;qa(this)}};function qa(a){a.u(function(b,c){return function(){c.call(b)}}(a,a.J),25)}function Q(a,b){s(a.a,a.Q);s(a.a,a.R);b(a.L,a.B)}function na(a,b){b=P(a,b,true);var c=a.n.p(b);s(a.a,b);return c}function P(a,b,c){b=a.a.createElement("span",{style:R(a,b,a.B,c)},a.sa);r(a.a,"body",b);return b}
+function R(a,b,c,d){c=a.v.expand(c);return"position:absolute;top:-999px;left:-999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;font-family:"+(d?"":a.Aa.quote(a.L)+",")+b+";"+c};function S(a,b,c,d,e){this.a=a;this.X=b;this.g=c;this.u=d;this.c=e;this.M=this.N=0}S.prototype.q=function(a,b){this.X.fa[a]=b};S.prototype.load=function(a){var b=new ga(this.a,this.g,a);this.c.w()?ra(this,b,a):J(b)};S.prototype.ya=function(a,b,c,d){var e=a.Z?a.Z():N;if(d)a.load(n(this,this.Ca,b,c,e));else{a=--this.N==0;this.M--;if(a)this.M==0?J(b):H(b);c.watch([],{},{},e,a)}};
+S.prototype.Ca=function(a,b,c,d,e,f){var g=--this.N==0;g&&H(a);this.u(n(this,function(h,l,k,m,B,p){h.watch(l,k||{},m||{},B,p)},b,d,e,f,c,g))};function ra(a,b,c){c=ka(a.X,c);a.M=a.N=c.length;for(var d=new L(a.a,b,{p:function(h){return h.offsetWidth}},a.u,function(){return(new Date).getTime()}),e=0,f=c.length;e<f;e++){var g=c[e];g.z(a.c,n(a,a.ya,g,b,d))}};function G(a){this.za=a||sa}var sa="-";G.prototype.e=function(){for(var a=[],b=0;b<arguments.length;b++)a.push(arguments[b].replace(/[\W_]+/g,"").toLowerCase());return a.join(this.za)};function la(){this.ha="'"}la.prototype.quote=function(a){var b=[];a=a.split(/,\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['"]/g,"");d.indexOf(" ")==-1?b.push(d):b.push(this.ha+d+this.ha)}return b.join(",")};function O(){this.G=ta;this.o=ua}var ta=["font-style","font-weight"],ua={"font-style":[["n","normal"],["i","italic"],["o","oblique"]],"font-weight":[["1","100"],["2","200"],["3","300"],["4","400"],["5","500"],["6","600"],["7","700"],["8","800"],["9","900"],["4","normal"],["7","bold"]]};function T(a,b,c){this.aa=a;this.Fa=b;this.o=c}T.prototype.compact=function(a,b){for(var c=0;c<this.o.length;c++)if(b==this.o[c][1]){a[this.aa]=this.o[c][0];return}};
+T.prototype.expand=function(a,b){for(var c=0;c<this.o.length;c++)if(b==this.o[c][0]){a[this.aa]=this.Fa+":"+this.o[c][1];return}};O.prototype.compact=function(a){var b=["n","4"];a=a.split(";");for(var c=0,d=a.length;c<d;c++){var e=a[c].replace(/\s+/g,"").split(":");if(e.length==2){var f=e[1];a:{e=e[0];for(var g=0;g<this.G.length;g++)if(e==this.G[g]){e=new T(g,e,this.o[e]);break a}e=null}e&&e.compact(b,f)}}return b.join("")};
+O.prototype.expand=function(a){if(a.length!=2)return null;for(var b=[null,null],c=0,d=this.G.length;c<d;c++){var e=this.G[c],f=a.substr(c,1);(new T(c,e,this.o[e])).expand(b,f)}return b[0]&&b[1]?b.join(";")+";":null};window.WebFont=function(){var a=(new z(navigator.userAgent,document)).parse();return new S(new o(document,a),new ja,document.documentElement,function(b,c){setTimeout(b,c)},a)}();window.WebFont.load=window.WebFont.load;window.WebFont.addModule=window.WebFont.q;y.prototype.getName=y.prototype.getName;y.prototype.getVersion=y.prototype.xa;y.prototype.getEngine=y.prototype.Y;y.prototype.getEngineVersion=y.prototype.ua;y.prototype.getPlatform=y.prototype.va;y.prototype.getPlatformVersion=y.prototype.wa;
+y.prototype.getDocumentMode=y.prototype.ta;y.prototype.isSupportingWebFont=y.prototype.w;function U(a,b){this.a=a;this.d=b}var va={regular:"n4",bold:"n7",italic:"i4",bolditalic:"i7",r:"n4",b:"n7",i:"i4",bi:"i7"};U.prototype.z=function(a,b){return b(a.w())};
+U.prototype.load=function(a){r(this.a,"head",t(this.a,("https:"==document.location.protocol?"https:":"http:")+"//webfonts.fontslive.com/css/"+this.d.key+".css"));var b;b=this.d.families;var c,d,e;c=[];d={};for(var f=0,g=b.length;f<g;f++){e=void 0;var h=void 0;h=void 0;h=b[f].split(":");e=h[0];h=h[1]?wa(this,h[1]):["n4"];e={W:e,T:h};c.push(e.W);d[e.W]=e.T}b={pa:c,T:d};a(b.pa,b.T)};
+function wa(a,b){a=b.split(",");b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];if(e){var f=va[e];b.push(f?f:e)}}return b}window.WebFont.q("ascender",function(a){var b=(new z(navigator.userAgent,document)).parse();return new U(new o(document,b),a)});function V(a,b,c,d,e,f,g,h,l){V.Ga.call(this,a,b,c,d,e,f,g,h,l);a=["Times New Roman","Lucida Sans Unicode","Courier New","Tahoma","Arial","Microsoft Sans Serif","Times","Lucida Console","Sans","Serif","Monospace"];b=a.length;c={};d=P(this,a[0],true);c[this.n.p(d)]=true;for(e=1;e<b;e++){f=a[e];q(this.a,d,R(this,f,this.B,true));c[this.n.p(d)]=true;if(this.B[1]!="4"){q(this.a,d,R(this,f,this.B[0]+"4",true));c[this.n.p(d)]=true}}s(this.a,d);this.t=c;this.la=false}
+(function(a,b){function c(){}c.prototype=a.prototype;b.prototype=new c;b.Ga=a;b.Ja=a.prototype})(N,V);var xa={Arimo:true,Cousine:true,Tinos:true};V.prototype.J=function(){var a=this.n.p(this.Q),b=this.n.p(this.R);if(!this.la&&a==b&&this.t[a]){this.t={};this.la=this.t[a]=true}if((this.O!=a||this.P!=b)&&!this.t[a]&&!this.t[b])Q(this,this.H);else if(this.D()-this.ia>=5E3)this.t[a]&&this.t[b]&&xa[this.L]?Q(this,this.H):Q(this,this.$);else qa(this)};function ya(a){this.I=a?a:("https:"==window.location.protocol?"https:":"http:")+za;this.f=[];this.S=[]}var za="//fonts.googleapis.com/css";ya.prototype.e=function(){if(this.f.length==0)throw new Error("No fonts to load !");if(this.I.indexOf("kit=")!=-1)return this.I;for(var a=this.f.length,b=[],c=0;c<a;c++)b.push(this.f[c].replace(/ /g,"+"));a=this.I+"?family="+b.join("%7C");if(this.S.length>0)a+="&subset="+this.S.join(",");return a};function Aa(a){this.f=a;this.ga=[];this.ka={};this.F={};this.v=new O}var Ba={ultralight:"n2",light:"n3",regular:"n4",bold:"n7",italic:"i4",bolditalic:"i7",ul:"n2",l:"n3",r:"n4",b:"n7",i:"i4",bi:"i7"},Ca={latin:ma,cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"};
+Aa.prototype.parse=function(){for(var a=this.f.length,b=0;b<a;b++){var c=this.f[b].split(":"),d=c[0],e=["n4"];if(c.length>=2){var f=c[1],g=[];if(f){f=f.split(",");for(var h=f.length,l=0;l<h;l++){var k;k=f[l];if(k.match(/^[\w ]+$/)){var m=Ba[k];if(m)k=m;else{m=k.match(/^(\d*)(\w*)$/);k=m[1];m=m[2];k=(k=this.v.expand([m?m:"n",k?k.substr(0,1):"4"].join("")))?this.v.compact(k):null}}else k="";k&&g.push(k)}}if(g.length>0)e=g;if(c.length==3){c=c[2];g=[];c=c?c.split(","):g;if(c.length>0)if(c=Ca[c[0]])this.F[d]=
+c}}if(!this.F[d])if(c=Ca[d])this.F[d]=c;this.ga.push(d);this.ka[d]=e}};function W(a,b,c){this.c=a;this.a=b;this.d=c}W.prototype.z=function(a,b){b(a.w())};W.prototype.Z=function(){if(this.c.Y()=="AppleWebKit")return V;return N};W.prototype.load=function(a){var b=this.a;this.c.getName()=="MSIE"&&this.d.blocking!=true?aa(b,n(this,this.ba,a)):this.ba(a)};
+W.prototype.ba=function(a){for(var b=this.a,c=new ya(this.d.api),d=this.d.families,e=d.length,f=0;f<e;f++){var g=d[f].split(":");g.length==3&&c.S.push(g.pop());c.f.push(g.join(":"))}d=new Aa(d);d.parse();r(b,"head",t(b,c.e()));a(d.ga,d.ka,d.F)};window.WebFont.q("google",function(a){var b=(new z(navigator.userAgent,document)).parse();return new W(b,new o(document,b),a)});function X(a,b){this.a=a;this.d=b}X.prototype.load=function(a){for(var b=this.d.urls||[],c=this.d.families||[],d=0,e=b.length;d<e;d++)r(this.a,"head",t(this.a,b[d]));a(c)};X.prototype.z=function(a,b){return b(a.w())};window.WebFont.q("custom",function(a){var b=(new z(navigator.userAgent,document)).parse();return new X(new o(document,b),a)});function Y(a,b,c){this.m=a;this.a=b;this.d=c;this.f=[];this.s={};this.v=new O}Y.prototype.C=function(a){return("https:"==this.m.location.protocol?"https:":"http:")+(this.d.api||"//f.fontdeck.com/s/css/js/")+this.m.document.location.hostname+"/"+a+".js"};
+Y.prototype.z=function(a,b){a=this.d.id;var c=this;if(a){this.m.__webfontfontdeckmodule__||(this.m.__webfontfontdeckmodule__={});this.m.__webfontfontdeckmodule__[a]=function(d,e){for(var f=0,g=e.fonts.length;f<g;++f){var h=e.fonts[f];c.f.push(h.name);c.s[h.name]=[c.v.compact("font-weight:"+h.weight+";font-style:"+h.style)]}b(d)};r(this.a,"head",u(this.a,this.C(a)))}else b(true)};Y.prototype.load=function(a){a(this.f,this.s)};
+window.WebFont.q("fontdeck",function(a){var b=(new z(navigator.userAgent,document)).parse();return new Y(window,new o(document,b),a)});function Z(a,b,c,d,e){this.m=a;this.c=b;this.a=c;this.k=d;this.d=e;this.f=[];this.s={}}
+Z.prototype.z=function(a,b){var c=this,d=c.d.projectId;if(d){var e=u(c.a,c.C(d));e.id="__MonotypeAPIScript__"+d;e.onreadystatechange=function(f){if(e.readyState==="loaded"||e.readyState==="complete"){e.onreadystatechange=null;e.onload(f)}};e.onload=function(){if(c.m["__mti_fntLst"+d]){var f=c.m["__mti_fntLst"+d]();if(f&&f.length){var g;for(g=0;g<f.length;g++)c.f.push(f[g].fontfamily)}}b(a.w())};r(this.a,"head",e)}else b(true)};
+Z.prototype.C=function(a){var b=this.protocol(),c=(this.d.api||"fast.fonts.com/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return b+"//"+c+"/"+a+".js"};Z.prototype.load=function(a){a(this.f,this.s)};Z.prototype.protocol=function(){var a=["http:","https:"],b=a[0];if(this.k&&this.k.location&&this.k.location.protocol){var c=0;for(c=0;c<a.length;c++)if(this.k.location.protocol===a[c])return this.k.location.protocol}return b};
+window.WebFont.q("monotype",function(a){var b=(new z(navigator.userAgent,document)).parse();return new Z(window,b,new o(document,b),document,a)});function $(a,b,c){this.m=a;this.a=b;this.d=c;this.f=[];this.s={}}$.prototype.C=function(a){var b="https:"==window.location.protocol?"https:":"http:";return(this.d.api||b+"//use.typekit.com")+"/"+a+".js"};$.prototype.z=function(a,b){var c=this.d.id,d=this.d,e=this;if(c){this.m.__webfonttypekitmodule__||(this.m.__webfonttypekitmodule__={});this.m.__webfonttypekitmodule__[c]=function(f){f(a,d,function(g,h,l){e.f=h;e.s=l;b(g)})};r(this.a,"head",u(this.a,this.C(c)))}else b(true)};
+$.prototype.load=function(a){a(this.f,this.s)};window.WebFont.q("typekit",function(a){var b=(new z(navigator.userAgent,document)).parse();return new $(window,new o(document,b),a)});window.WebFontConfig&&window.WebFont.load(window.WebFontConfig);
+})(this,document);
Index: src/main/resources/static/static/lib/brat/lib/jquery.svg.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/jquery.svg.min.js	(date 1594749336095)
+++ src/main/resources/static/static/lib/brat/lib/jquery.svg.min.js	(date 1594749336095)
@@ -0,0 +1,7 @@
+/* http://keith-wood.name/svg.html
+   SVG for jQuery v1.4.3.
+   Written by Keith Wood (kbwood{at}iinet.com.au) August 2007.
+   Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and 
+   MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses. 
+   Please attribute the author if you use it. */
+(function($){function SVGManager(){this._settings=[];this._extensions=[];this.regional=[];this.regional['']={errorLoadingText:'Error loading',notSupportedText:'This browser does not support SVG'};this.local=this.regional[''];this._uuid=new Date().getTime();this._renesis=detectActiveX('RenesisX.RenesisCtrl')}function detectActiveX(a){try{return!!(window.ActiveXObject&&new ActiveXObject(a))}catch(e){return false}}var p='svgwrapper';$.extend(SVGManager.prototype,{markerClassName:'hasSVG',svgNS:'http://www.w3.org/2000/svg',xlinkNS:'http://www.w3.org/1999/xlink',_wrapperClass:SVGWrapper,_attrNames:{class_:'class',in_:'in',alignmentBaseline:'alignment-baseline',baselineShift:'baseline-shift',clipPath:'clip-path',clipRule:'clip-rule',colorInterpolation:'color-interpolation',colorInterpolationFilters:'color-interpolation-filters',colorRendering:'color-rendering',dominantBaseline:'dominant-baseline',enableBackground:'enable-background',fillOpacity:'fill-opacity',fillRule:'fill-rule',floodColor:'flood-color',floodOpacity:'flood-opacity',fontFamily:'font-family',fontSize:'font-size',fontSizeAdjust:'font-size-adjust',fontStretch:'font-stretch',fontStyle:'font-style',fontVariant:'font-variant',fontWeight:'font-weight',glyphOrientationHorizontal:'glyph-orientation-horizontal',glyphOrientationVertical:'glyph-orientation-vertical',horizAdvX:'horiz-adv-x',horizOriginX:'horiz-origin-x',imageRendering:'image-rendering',letterSpacing:'letter-spacing',lightingColor:'lighting-color',markerEnd:'marker-end',markerMid:'marker-mid',markerStart:'marker-start',stopColor:'stop-color',stopOpacity:'stop-opacity',strikethroughPosition:'strikethrough-position',strikethroughThickness:'strikethrough-thickness',strokeDashArray:'stroke-dasharray',strokeDashOffset:'stroke-dashoffset',strokeLineCap:'stroke-linecap',strokeLineJoin:'stroke-linejoin',strokeMiterLimit:'stroke-miterlimit',strokeOpacity:'stroke-opacity',strokeWidth:'stroke-width',textAnchor:'text-anchor',textDecoration:'text-decoration',textRendering:'text-rendering',underlinePosition:'underline-position',underlineThickness:'underline-thickness',vertAdvY:'vert-adv-y',vertOriginY:'vert-origin-y',wordSpacing:'word-spacing',writingMode:'writing-mode'},_attachSVG:function(a,b){var c=(a.namespaceURI==this.svgNS?a:null);var a=(c?null:a);if($(a||c).hasClass(this.markerClassName)){return}if(typeof b=='string'){b={loadURL:b}}else if(typeof b=='function'){b={onLoad:b}}$(a||c).addClass(this.markerClassName);try{if(!c){c=document.createElementNS(this.svgNS,'svg');c.setAttribute('version','1.1');c.setAttribute('width',a.clientWidth);c.setAttribute('height',a.clientHeight);a.appendChild(c)}this._afterLoad(a,c,b||{})}catch(e){if($.browser.msie){if(!a.id){a.id='svg'+(this._uuid++)}this._settings[a.id]=b;a.innerHTML='<embed type="image/svg+xml" width="100%" '+'height="100%" src="'+(b.initPath||'')+'blank.svg"/>'}else{a.innerHTML='<p class="svg_error">'+this.local.notSupportedText+'</p>'}}},_registerSVG:function(){for(var i=0;i<document.embeds.length;i++){var a=document.embeds[i].parentNode;if(!$(a).hasClass($.svg.markerClassName)||$.data(a,p)){continue}var b=null;try{b=document.embeds[i].getSVGDocument()}catch(e){setTimeout($.svg._registerSVG,250);return}b=(b?b.documentElement:null);if(b){$.svg._afterLoad(a,b)}}},_afterLoad:function(a,b,c){var c=c||this._settings[a.id];this._settings[a?a.id:'']=null;var d=new this._wrapperClass(b,a);$.data(a||b,p,d);try{if(c.loadURL){d.load(c.loadURL,c)}if(c.settings){d.configure(c.settings)}if(c.onLoad&&!c.loadURL){c.onLoad.apply(a||b,[d])}}catch(e){alert(e)}},_getSVG:function(a){a=(typeof a=='string'?$(a)[0]:(a.jquery?a[0]:a));return $.data(a,p)},_destroySVG:function(a){var b=$(a);if(!b.hasClass(this.markerClassName)){return}b.removeClass(this.markerClassName);if(a.namespaceURI!=this.svgNS){b.empty()}$.removeData(a,p)},addExtension:function(a,b){this._extensions.push([a,b])}});function SVGWrapper(a,b){this._svg=a;this._container=b;for(var i=0;i<$.svg._extensions.length;i++){var c=$.svg._extensions[i];this[c[0]]=new c[1](this)}}$.extend(SVGWrapper.prototype,{_width:function(){return(this._container?this._container.clientWidth:this._svg.width)},_height:function(){return(this._container?this._container.clientHeight:this._svg.height)},root:function(){return this._svg},configure:function(a,b){if(b){for(var i=this._svg.attributes.length-1;i>=0;i--){var c=this._svg.attributes.item(i);if(!(c.nodeName=='onload'||c.nodeName=='version'||c.nodeName.substring(0,5)=='xmlns')){this._svg.attributes.removeNamedItem(c.nodeName)}}}for(var d in a){this._svg.setAttribute(d,a[d])}return this},getElementById:function(a){return this._svg.ownerDocument.getElementById(a)},change:function(a,b){if(a){for(var c in b){if(b[c]==null){a.removeAttribute(c)}else{a.setAttribute(c,b[c])}}}return this},_args:function(b,c,d){c.splice(0,0,'parent');c.splice(c.length,0,'settings');var e={};var f=0;if(b[0]!=null&&b[0].jquery){b[0]=b[0][0]}if(b[0]!=null&&!(typeof b[0]=='object'&&b[0].nodeName)){e['parent']=null;f=1}for(var i=0;i<b.length;i++){e[c[i+f]]=b[i]}if(d){$.each(d,function(i,a){if(typeof e[a]=='object'){e.settings=e[a];e[a]=null}})}return e},title:function(a,b,c){var d=this._args(arguments,['text']);var e=this._makeNode(d.parent,'title',d.settings||{});e.appendChild(this._svg.ownerDocument.createTextNode(d.text));return e},describe:function(a,b,c){var d=this._args(arguments,['text']);var e=this._makeNode(d.parent,'desc',d.settings||{});e.appendChild(this._svg.ownerDocument.createTextNode(d.text));return e},defs:function(a,b,c){var d=this._args(arguments,['id'],['id']);return this._makeNode(d.parent,'defs',$.extend((d.id?{id:d.id}:{}),d.settings||{}))},symbol:function(a,b,c,d,e,f,g){var h=this._args(arguments,['id','x1','y1','width','height']);return this._makeNode(h.parent,'symbol',$.extend({id:h.id,viewBox:h.x1+' '+h.y1+' '+h.width+' '+h.height},h.settings||{}))},marker:function(a,b,c,d,e,f,g,h){var i=this._args(arguments,['id','refX','refY','mWidth','mHeight','orient'],['orient']);return this._makeNode(i.parent,'marker',$.extend({id:i.id,refX:i.refX,refY:i.refY,markerWidth:i.mWidth,markerHeight:i.mHeight,orient:i.orient||'auto'},i.settings||{}))},style:function(a,b,c){var d=this._args(arguments,['styles']);var e=this._makeNode(d.parent,'style',$.extend({type:'text/css'},d.settings||{}));e.appendChild(this._svg.ownerDocument.createTextNode(d.styles));if($.browser.opera){$('head').append('<style type="text/css">'+d.styles+'</style>')}return e},script:function(a,b,c,d){var e=this._args(arguments,['script','type'],['type']);var f=this._makeNode(e.parent,'script',$.extend({type:e.type||'text/javascript'},e.settings||{}));f.appendChild(this._svg.ownerDocument.createTextNode(this._escapeXML(e.script)));if(!$.browser.mozilla){$.globalEval(e.script)}return f},linearGradient:function(a,b,c,d,e,f,g,h){var i=this._args(arguments,['id','stops','x1','y1','x2','y2'],['x1']);var j=$.extend({id:i.id},(i.x1!=null?{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}:{}));return this._gradient(i.parent,'linearGradient',$.extend(j,i.settings||{}),i.stops)},radialGradient:function(a,b,c,d,e,r,f,g,h){var i=this._args(arguments,['id','stops','cx','cy','r','fx','fy'],['cx']);var j=$.extend({id:i.id},(i.cx!=null?{cx:i.cx,cy:i.cy,r:i.r,fx:i.fx,fy:i.fy}:{}));return this._gradient(i.parent,'radialGradient',$.extend(j,i.settings||{}),i.stops)},_gradient:function(a,b,c,d){var e=this._makeNode(a,b,c);for(var i=0;i<d.length;i++){var f=d[i];this._makeNode(e,'stop',$.extend({offset:f[0],stopColor:f[1]},(f[2]!=null?{stopOpacity:f[2]}:{})))}return e},pattern:function(a,b,x,y,c,d,e,f,g,h,i){var j=this._args(arguments,['id','x','y','width','height','vx','vy','vwidth','vheight'],['vx']);var k=$.extend({id:j.id,x:j.x,y:j.y,width:j.width,height:j.height},(j.vx!=null?{viewBox:j.vx+' '+j.vy+' '+j.vwidth+' '+j.vheight}:{}));return this._makeNode(j.parent,'pattern',$.extend(k,j.settings||{}))},mask:function(a,b,x,y,c,d,e){var f=this._args(arguments,['id','x','y','width','height']);return this._makeNode(f.parent,'mask',$.extend({id:f.id,x:f.x,y:f.y,width:f.width,height:f.height},f.settings||{}))},createPath:function(){return new SVGPath()},createText:function(){return new SVGText()},svg:function(a,x,y,b,c,d,e,f,g,h){var i=this._args(arguments,['x','y','width','height','vx','vy','vwidth','vheight'],['vx']);var j=$.extend({x:i.x,y:i.y,width:i.width,height:i.height},(i.vx!=null?{viewBox:i.vx+' '+i.vy+' '+i.vwidth+' '+i.vheight}:{}));return this._makeNode(i.parent,'svg',$.extend(j,i.settings||{}))},group:function(a,b,c){var d=this._args(arguments,['id'],['id']);return this._makeNode(d.parent,'g',$.extend({id:d.id},d.settings||{}))},use:function(a,x,y,b,c,d,e){var f=this._args(arguments,['x','y','width','height','ref']);if(typeof f.x=='string'){f.ref=f.x;f.settings=f.y;f.x=f.y=f.width=f.height=null}var g=this._makeNode(f.parent,'use',$.extend({x:f.x,y:f.y,width:f.width,height:f.height},f.settings||{}));g.setAttributeNS($.svg.xlinkNS,'href',f.ref);return g},link:function(a,b,c){var d=this._args(arguments,['ref']);var e=this._makeNode(d.parent,'a',d.settings);e.setAttributeNS($.svg.xlinkNS,'href',d.ref);return e},image:function(a,x,y,b,c,d,e){var f=this._args(arguments,['x','y','width','height','ref']);var g=this._makeNode(f.parent,'image',$.extend({x:f.x,y:f.y,width:f.width,height:f.height},f.settings||{}));g.setAttributeNS($.svg.xlinkNS,'href',f.ref);return g},path:function(a,b,c){var d=this._args(arguments,['path']);return this._makeNode(d.parent,'path',$.extend({d:(d.path.path?d.path.path():d.path)},d.settings||{}))},rect:function(a,x,y,b,c,d,e,f){var g=this._args(arguments,['x','y','width','height','rx','ry'],['rx']);return this._makeNode(g.parent,'rect',$.extend({x:g.x,y:g.y,width:g.width,height:g.height},(g.rx?{rx:g.rx,ry:g.ry}:{}),g.settings||{}))},circle:function(a,b,c,r,d){var e=this._args(arguments,['cx','cy','r']);return this._makeNode(e.parent,'circle',$.extend({cx:e.cx,cy:e.cy,r:e.r},e.settings||{}))},ellipse:function(a,b,c,d,e,f){var g=this._args(arguments,['cx','cy','rx','ry']);return this._makeNode(g.parent,'ellipse',$.extend({cx:g.cx,cy:g.cy,rx:g.rx,ry:g.ry},g.settings||{}))},line:function(a,b,c,d,e,f){var g=this._args(arguments,['x1','y1','x2','y2']);return this._makeNode(g.parent,'line',$.extend({x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2},g.settings||{}))},polyline:function(a,b,c){var d=this._args(arguments,['points']);return this._poly(d.parent,'polyline',d.points,d.settings)},polygon:function(a,b,c){var d=this._args(arguments,['points']);return this._poly(d.parent,'polygon',d.points,d.settings)},_poly:function(a,b,c,d){var e='';for(var i=0;i<c.length;i++){e+=c[i].join()+' '}return this._makeNode(a,b,$.extend({points:$.trim(e)},d||{}))},text:function(a,x,y,b,c){var d=this._args(arguments,['x','y','value']);if(typeof d.x=='string'&&arguments.length<4){d.value=d.x;d.settings=d.y;d.x=d.y=null}return this._text(d.parent,'text',d.value,$.extend({x:(d.x&&isArray(d.x)?d.x.join(' '):d.x),y:(d.y&&isArray(d.y)?d.y.join(' '):d.y)},d.settings||{}))},textpath:function(a,b,c,d){var e=this._args(arguments,['path','value']);var f=this._text(e.parent,'textPath',e.value,e.settings||{});f.setAttributeNS($.svg.xlinkNS,'href',e.path);return f},_text:function(a,b,c,d){var e=this._makeNode(a,b,d);if(typeof c=='string'){e.appendChild(e.ownerDocument.createTextNode(c))}else{for(var i=0;i<c._parts.length;i++){var f=c._parts[i];if(f[0]=='tspan'){var g=this._makeNode(e,f[0],f[2]);g.appendChild(e.ownerDocument.createTextNode(f[1]));e.appendChild(g)}else if(f[0]=='tref'){var g=this._makeNode(e,f[0],f[2]);g.setAttributeNS($.svg.xlinkNS,'href',f[1]);e.appendChild(g)}else if(f[0]=='textpath'){var h=$.extend({},f[2]);h.href=null;var g=this._makeNode(e,f[0],h);g.setAttributeNS($.svg.xlinkNS,'href',f[2].href);g.appendChild(e.ownerDocument.createTextNode(f[1]));e.appendChild(g)}else{e.appendChild(e.ownerDocument.createTextNode(f[1]))}}}return e},other:function(a,b,c){var d=this._args(arguments,['name']);return this._makeNode(d.parent,d.name,d.settings||{})},_makeNode:function(a,b,c){a=a||this._svg;var d=this._svg.ownerDocument.createElementNS($.svg.svgNS,b);for(var b in c){var e=c[b];if(e!=null&&e!=null&&(typeof e!='string'||e!='')){d.setAttribute($.svg._attrNames[b]||b,e)}}a.appendChild(d);return d},add:function(b,c){var d=this._args((arguments.length==1?[null,b]:arguments),['node']);var f=this;d.parent=d.parent||this._svg;try{if($.svg._renesis){throw'Force traversal';}d.parent.appendChild(d.node.cloneNode(true))}catch(e){d.node=(d.node.jquery?d.node:$(d.node));d.node.each(function(){var a=f._cloneAsSVG(this);if(a){d.parent.appendChild(a)}})}return this},_cloneAsSVG:function(a){var b=null;if(a.nodeType==1){b=this._svg.ownerDocument.createElementNS($.svg.svgNS,this._checkName(a.nodeName));for(var i=0;i<a.attributes.length;i++){var c=a.attributes.item(i);if(c.nodeName!='xmlns'&&c.nodeValue){if(c.prefix=='xlink'){b.setAttributeNS($.svg.xlinkNS,c.localName,c.nodeValue)}else{b.setAttribute(this._checkName(c.nodeName),c.nodeValue)}}}for(var i=0;i<a.childNodes.length;i++){var d=this._cloneAsSVG(a.childNodes[i]);if(d){b.appendChild(d)}}}else if(a.nodeType==3){if($.trim(a.nodeValue)){b=this._svg.ownerDocument.createTextNode(a.nodeValue)}}else if(a.nodeType==4){if($.trim(a.nodeValue)){try{b=this._svg.ownerDocument.createCDATASection(a.nodeValue)}catch(e){b=this._svg.ownerDocument.createTextNode(a.nodeValue.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'))}}}return b},_checkName:function(a){a=(a.substring(0,1)>='A'&&a.substring(0,1)<='Z'?a.toLowerCase():a);return(a.substring(0,4)=='svg:'?a.substring(4):a)},load:function(h,j){j=(typeof j=='boolean'?{addTo:j}:(typeof j=='function'?{onLoad:j}:j||{}));if(!j.addTo){this.clear(false)}var k=[this._svg.getAttribute('width'),this._svg.getAttribute('height')];var l=this;var m=function(a){a=$.svg.local.errorLoadingText+': '+a;if(j.onLoad){j.onLoad.apply(l._container||l._svg,[l,a])}else{l.text(null,10,20,a)}};var n=function(a){var b=new ActiveXObject('Microsoft.XMLDOM');b.validateOnParse=false;b.resolveExternals=false;b.async=false;b.loadXML(a);if(b.parseError.errorCode!=0){m(b.parseError.reason);return null}return b};var o=function(a){if(!a){return}if(a.documentElement.nodeName!='svg'){var b=a.getElementsByTagName('parsererror');var c=(b.length?b[0].getElementsByTagName('div'):[]);m(!b.length?'???':(c.length?c[0]:b[0]).firstChild.nodeValue);return}var d={};for(var i=0;i<a.documentElement.attributes.length;i++){var f=a.documentElement.attributes.item(i);if(!(f.nodeName=='version'||f.nodeName.substring(0,5)=='xmlns')){d[f.nodeName]=f.nodeValue}}l.configure(d,true);var g=a.documentElement.childNodes;for(var i=0;i<g.length;i++){try{if($.svg._renesis){throw'Force traversal';}l._svg.appendChild(g[i].cloneNode(true));if(g[i].nodeName=='script'){$.globalEval(g[i].textContent)}}catch(e){l.add(null,g[i])}}if(!j.changeSize){l.configure({width:k[0],height:k[1]})}if(j.onLoad){j.onLoad.apply(l._container||l._svg,[l])}};if(h.match('<svg')){o($.browser.msie?n(h):new DOMParser().parseFromString(h,'text/xml'))}else{$.ajax({url:h,dataType:($.browser.msie?'text':'xml'),success:function(a){o($.browser.msie?n(a):a)},error:function(a,b,c){m(b+(c?' '+c.message:''))}})}return this},remove:function(a){a=(a.jquery?a[0]:a);a.parentNode.removeChild(a);return this},clear:function(a){if(a){this.configure({},true)}while(this._svg.firstChild){this._svg.removeChild(this._svg.firstChild)}return this},toSVG:function(a){a=a||this._svg;return(typeof XMLSerializer=='undefined'?this._toSVG(a):new XMLSerializer().serializeToString(a))},_toSVG:function(a){var b='';if(!a){return b}if(a.nodeType==3){b=a.nodeValue}else if(a.nodeType==4){b='<![CDATA['+a.nodeValue+']]>'}else{b='<'+a.nodeName;if(a.attributes){for(var i=0;i<a.attributes.length;i++){var c=a.attributes.item(i);if(!($.trim(c.nodeValue)==''||c.nodeValue.match(/^\[object/)||c.nodeValue.match(/^function/))){b+=' '+(c.namespaceURI==$.svg.xlinkNS?'xlink:':'')+c.nodeName+'="'+c.nodeValue+'"'}}}if(a.firstChild){b+='>';var d=a.firstChild;while(d){b+=this._toSVG(d);d=d.nextSibling}b+='</'+a.nodeName+'>'}else{b+='/>'}}return b},_escapeXML:function(a){a=a.replace(/&/g,'&amp;');a=a.replace(/</g,'&lt;');a=a.replace(/>/g,'&gt;');return a}});function SVGPath(){this._path=''}$.extend(SVGPath.prototype,{reset:function(){this._path='';return this},move:function(x,y,a){a=(isArray(x)?y:a);return this._coords((a?'m':'M'),x,y)},line:function(x,y,a){a=(isArray(x)?y:a);return this._coords((a?'l':'L'),x,y)},horiz:function(x,a){this._path+=(a?'h':'H')+(isArray(x)?x.join(' '):x);return this},vert:function(y,a){this._path+=(a?'v':'V')+(isArray(y)?y.join(' '):y);return this},curveC:function(a,b,c,d,x,y,e){e=(isArray(a)?b:e);return this._coords((e?'c':'C'),a,b,c,d,x,y)},smoothC:function(a,b,x,y,c){c=(isArray(a)?b:c);return this._coords((c?'s':'S'),a,b,x,y)},curveQ:function(a,b,x,y,c){c=(isArray(a)?b:c);return this._coords((c?'q':'Q'),a,b,x,y)},smoothQ:function(x,y,a){a=(isArray(x)?y:a);return this._coords((a?'t':'T'),x,y)},_coords:function(a,b,c,d,e,f,g){if(isArray(b)){for(var i=0;i<b.length;i++){var h=b[i];this._path+=(i==0?a:' ')+h[0]+','+h[1]+(h.length<4?'':' '+h[2]+','+h[3]+(h.length<6?'':' '+h[4]+','+h[5]))}}else{this._path+=a+b+','+c+(d==null?'':' '+d+','+e+(f==null?'':' '+f+','+g))}return this},arc:function(a,b,c,d,e,x,y,f){f=(isArray(a)?b:f);this._path+=(f?'a':'A');if(isArray(a)){for(var i=0;i<a.length;i++){var g=a[i];this._path+=(i==0?'':' ')+g[0]+','+g[1]+' '+g[2]+' '+(g[3]?'1':'0')+','+(g[4]?'1':'0')+' '+g[5]+','+g[6]}}else{this._path+=a+','+b+' '+c+' '+(d?'1':'0')+','+(e?'1':'0')+' '+x+','+y}return this},close:function(){this._path+='z';return this},path:function(){return this._path}});SVGPath.prototype.moveTo=SVGPath.prototype.move;SVGPath.prototype.lineTo=SVGPath.prototype.line;SVGPath.prototype.horizTo=SVGPath.prototype.horiz;SVGPath.prototype.vertTo=SVGPath.prototype.vert;SVGPath.prototype.curveCTo=SVGPath.prototype.curveC;SVGPath.prototype.smoothCTo=SVGPath.prototype.smoothC;SVGPath.prototype.curveQTo=SVGPath.prototype.curveQ;SVGPath.prototype.smoothQTo=SVGPath.prototype.smoothQ;SVGPath.prototype.arcTo=SVGPath.prototype.arc;function SVGText(){this._parts=[]}$.extend(SVGText.prototype,{reset:function(){this._parts=[];return this},string:function(a){this._parts[this._parts.length]=['text',a];return this},span:function(a,b){this._parts[this._parts.length]=['tspan',a,b];return this},ref:function(a,b){this._parts[this._parts.length]=['tref',a,b];return this},path:function(a,b,c){this._parts[this._parts.length]=['textpath',b,$.extend({href:a},c||{})];return this}});$.fn.svg=function(a){var b=Array.prototype.slice.call(arguments,1);if(typeof a=='string'&&a=='get'){return $.svg['_'+a+'SVG'].apply($.svg,[this[0]].concat(b))}return this.each(function(){if(typeof a=='string'){$.svg['_'+a+'SVG'].apply($.svg,[this].concat(b))}else{$.svg._attachSVG(this,a||{})}})};function isArray(a){return(a&&a.constructor==Array)}$.svg=new SVGManager()})(jQuery);
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/src/util.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/util.js	(date 1594749336103)
+++ src/main/resources/static/static/lib/brat/src/util.js	(date 1594749336103)
@@ -0,0 +1,609 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+var Util = (function(window, undefined) {
+
+    var monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
+
+    var cmp = function(a,b) {
+      return a < b ? -1 : a > b ? 1 : 0;
+    }
+
+    var cmpArrayOnFirstElement = function(a,b) {
+      a = a[0];
+      b = b[0];
+      return a < b ? -1 : a > b ? 1 : 0;
+    }
+
+    var unitAgo = function(n, unit) {
+      if (n == 1) return "" + n + " " + unit + " ago";
+      return "" + n + " " + unit + "s ago";
+    };
+
+    var formatTimeAgo = function(time) {
+      if (time == -1000) {
+        return "never"; // FIXME make the server return the server time!
+      }
+
+      var nowDate = new Date();
+      var now = nowDate.getTime();
+      var diff = Math.floor((now - time) / 1000);
+      if (!diff) return "just now";
+      if (diff < 60) return unitAgo(diff, "second");
+      diff = Math.floor(diff / 60);
+      if (diff < 60) return unitAgo(diff, "minute");
+      diff = Math.floor(diff / 60);
+      if (diff < 24) return unitAgo(diff, "hour");
+      diff = Math.floor(diff / 24);
+      if (diff < 7) return unitAgo(diff, "day");
+      if (diff < 28) return unitAgo(Math.floor(diff / 7), "week");
+      var thenDate = new Date(time);
+      var result = thenDate.getDate() + ' ' + monthNames[thenDate.getMonth()];
+      if (thenDate.getYear() != nowDate.getYear()) {
+        result += ' ' + thenDate.getFullYear();
+      }
+      return result;
+    }
+
+    var realBBox = function(span) {
+      var box = span.rect.getBBox();
+      var chunkTranslation = span.chunk.translation;
+      var rowTranslation = span.chunk.row.translation;
+      box.x += chunkTranslation.x + rowTranslation.x;
+      box.y += chunkTranslation.y + rowTranslation.y;
+      return box;
+    }
+
+    var escapeHTML = function(str) {
+      return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
+    }
+
+    var escapeHTMLandQuotes = function(str) {
+      return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\"/g,'&quot;');
+    }
+
+    var escapeHTMLwithNewlines = function(str) {
+      return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br/>');
+    }
+
+    var escapeQuotes = function(str) {
+      // we only use double quotes for HTML attributes
+      return str.replace(/\"/g,'&quot;');
+    }
+
+    var getSpanLabels = function(spanTypes, spanType) {
+      var type = spanTypes[spanType];
+      return type && type.labels || [];
+    }
+
+    var spanDisplayForm = function(spanTypes, spanType) {
+      var labels = getSpanLabels(spanTypes, spanType);
+      return labels[0] || spanType;
+    }
+
+    var getArcLabels = function(spanTypes, spanType, arcType, relationTypesHash) {
+      var type = spanTypes[spanType];
+      var arcTypes = type && type.arcs || [];
+      var arcDesc = null;
+      // also consider matches without suffix number, if any
+      var noNumArcType;
+      if (arcType) {
+          var splitType = arcType.match(/^(.*?)(\d*)$/);
+          noNumArcType = splitType[1];
+      }
+      $.each(arcTypes, function(arcno, arcDescI) {
+        if (arcDescI.type == arcType || arcDescI.type == noNumArcType) {
+          arcDesc = arcDescI;
+          return false;
+        }
+      });
+      // fall back to relation types for unconfigured or missing def
+      if (!arcDesc) {
+        arcDesc = $.extend({}, relationTypesHash[arcType] || relationTypesHash[noNumArcType]);
+      }
+      return arcDesc && arcDesc.labels || [];
+    }
+
+    var arcDisplayForm = function(spanTypes, spanType, arcType, relationTypesHash) {
+      var labels = getArcLabels(spanTypes, spanType, arcType, relationTypesHash);
+      return labels[0] || arcType;
+    }
+
+    // TODO: switching to use of $.param(), this function should
+    // be deprecated and removed.
+    var objectToUrlStr = function(o) {
+      a = [];
+      $.each(o, function(key,value) {
+        a.push(key+"="+encodeURIComponent(value));
+      });
+      return a.join("&");
+    }
+
+    // color name RGB list, converted from
+    // http://www.w3schools.com/html/html_colornames.asp
+    // with perl as
+    //     perl -e 'print "var colors = {\n"; while(<>) { /(\S+)\s+\#([0-9a-z]{2})([0-9a-z]{2})([0-9a-z]{2})\s*/i or die "Failed to parse $_"; ($r,$g,$b)=(hex($2),hex($3),hex($4)); print "    '\''",lc($1),"'\'':\[$r,$g,$b\],\n" } print "};\n" '
+    var colors = {
+        'aliceblue':[240,248,255],
+        'antiquewhite':[250,235,215],
+        'aqua':[0,255,255],
+        'aquamarine':[127,255,212],
+        'azure':[240,255,255],
+        'beige':[245,245,220],
+        'bisque':[255,228,196],
+        'black':[0,0,0],
+        'blanchedalmond':[255,235,205],
+        'blue':[0,0,255],
+        'blueviolet':[138,43,226],
+        'brown':[165,42,42],
+        'burlywood':[222,184,135],
+        'cadetblue':[95,158,160],
+        'chartreuse':[127,255,0],
+        'chocolate':[210,105,30],
+        'coral':[255,127,80],
+        'cornflowerblue':[100,149,237],
+        'cornsilk':[255,248,220],
+        'crimson':[220,20,60],
+        'cyan':[0,255,255],
+        'darkblue':[0,0,139],
+        'darkcyan':[0,139,139],
+        'darkgoldenrod':[184,134,11],
+        'darkgray':[169,169,169],
+        'darkgrey':[169,169,169],
+        'darkgreen':[0,100,0],
+        'darkkhaki':[189,183,107],
+        'darkmagenta':[139,0,139],
+        'darkolivegreen':[85,107,47],
+        'darkorange':[255,140,0],
+        'darkorchid':[153,50,204],
+        'darkred':[139,0,0],
+        'darksalmon':[233,150,122],
+        'darkseagreen':[143,188,143],
+        'darkslateblue':[72,61,139],
+        'darkslategray':[47,79,79],
+        'darkslategrey':[47,79,79],
+        'darkturquoise':[0,206,209],
+        'darkviolet':[148,0,211],
+        'deeppink':[255,20,147],
+        'deepskyblue':[0,191,255],
+        'dimgray':[105,105,105],
+        'dimgrey':[105,105,105],
+        'dodgerblue':[30,144,255],
+        'firebrick':[178,34,34],
+        'floralwhite':[255,250,240],
+        'forestgreen':[34,139,34],
+        'fuchsia':[255,0,255],
+        'gainsboro':[220,220,220],
+        'ghostwhite':[248,248,255],
+        'gold':[255,215,0],
+        'goldenrod':[218,165,32],
+        'gray':[128,128,128],
+        'grey':[128,128,128],
+        'green':[0,128,0],
+        'greenyellow':[173,255,47],
+        'honeydew':[240,255,240],
+        'hotpink':[255,105,180],
+        'indianred':[205,92,92],
+        'indigo':[75,0,130],
+        'ivory':[255,255,240],
+        'khaki':[240,230,140],
+        'lavender':[230,230,250],
+        'lavenderblush':[255,240,245],
+        'lawngreen':[124,252,0],
+        'lemonchiffon':[255,250,205],
+        'lightblue':[173,216,230],
+        'lightcoral':[240,128,128],
+        'lightcyan':[224,255,255],
+        'lightgoldenrodyellow':[250,250,210],
+        'lightgray':[211,211,211],
+        'lightgrey':[211,211,211],
+        'lightgreen':[144,238,144],
+        'lightpink':[255,182,193],
+        'lightsalmon':[255,160,122],
+        'lightseagreen':[32,178,170],
+        'lightskyblue':[135,206,250],
+        'lightslategray':[119,136,153],
+        'lightslategrey':[119,136,153],
+        'lightsteelblue':[176,196,222],
+        'lightyellow':[255,255,224],
+        'lime':[0,255,0],
+        'limegreen':[50,205,50],
+        'linen':[250,240,230],
+        'magenta':[255,0,255],
+        'maroon':[128,0,0],
+        'mediumaquamarine':[102,205,170],
+        'mediumblue':[0,0,205],
+        'mediumorchid':[186,85,211],
+        'mediumpurple':[147,112,216],
+        'mediumseagreen':[60,179,113],
+        'mediumslateblue':[123,104,238],
+        'mediumspringgreen':[0,250,154],
+        'mediumturquoise':[72,209,204],
+        'mediumvioletred':[199,21,133],
+        'midnightblue':[25,25,112],
+        'mintcream':[245,255,250],
+        'mistyrose':[255,228,225],
+        'moccasin':[255,228,181],
+        'navajowhite':[255,222,173],
+        'navy':[0,0,128],
+        'oldlace':[253,245,230],
+        'olive':[128,128,0],
+        'olivedrab':[107,142,35],
+        'orange':[255,165,0],
+        'orangered':[255,69,0],
+        'orchid':[218,112,214],
+        'palegoldenrod':[238,232,170],
+        'palegreen':[152,251,152],
+        'paleturquoise':[175,238,238],
+        'palevioletred':[216,112,147],
+        'papayawhip':[255,239,213],
+        'peachpuff':[255,218,185],
+        'peru':[205,133,63],
+        'pink':[255,192,203],
+        'plum':[221,160,221],
+        'powderblue':[176,224,230],
+        'purple':[128,0,128],
+        'red':[255,0,0],
+        'rosybrown':[188,143,143],
+        'royalblue':[65,105,225],
+        'saddlebrown':[139,69,19],
+        'salmon':[250,128,114],
+        'sandybrown':[244,164,96],
+        'seagreen':[46,139,87],
+        'seashell':[255,245,238],
+        'sienna':[160,82,45],
+        'silver':[192,192,192],
+        'skyblue':[135,206,235],
+        'slateblue':[106,90,205],
+        'slategray':[112,128,144],
+        'slategrey':[112,128,144],
+        'snow':[255,250,250],
+        'springgreen':[0,255,127],
+        'steelblue':[70,130,180],
+        'tan':[210,180,140],
+        'teal':[0,128,128],
+        'thistle':[216,191,216],
+        'tomato':[255,99,71],
+        'turquoise':[64,224,208],
+        'violet':[238,130,238],
+        'wheat':[245,222,179],
+        'white':[255,255,255],
+        'whitesmoke':[245,245,245],
+        'yellow':[255,255,0],
+        'yellowgreen':[154,205,50],
+    };
+
+    // color parsing function originally from
+    // http://plugins.jquery.com/files/jquery.color.js.txt
+    // (with slight modifications)
+
+    // Parse strings looking for color tuples [255,255,255]
+    var rgbNumRE = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/;
+    var rgbPercRE = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/;
+    var rgbHash6RE = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/;
+    var rgbHash3RE = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/;
+
+    var strToRgb = function(color) {
+      var result;
+
+      // Check if we're already dealing with an array of colors
+//         if ( color && color.constructor == Array && color.length == 3 )
+//             return color;
+      
+      // Look for rgb(num,num,num)
+      if (result = rgbNumRE.exec(color))
+        return [parseInt(result[1]), parseInt(result[2]), parseInt(result[3])];
+      
+      // Look for rgb(num%,num%,num%)
+      if (result = rgbPercRE.exec(color))
+        return [parseFloat(result[1])*2.55, parseFloat(result[2])*2.55, parseFloat(result[3])*2.55];
+      
+      // Look for #a0b1c2
+      if (result = rgbHash6RE.exec(color))
+        return [parseInt(result[1],16), parseInt(result[2],16), parseInt(result[3],16)];
+      
+      // Look for #fff
+      if (result = rgbHash3RE.exec(color))
+        return [parseInt(result[1]+result[1],16), parseInt(result[2]+result[2],16), parseInt(result[3]+result[3],16)];
+      
+      // Otherwise, we're most likely dealing with a named color
+      return colors[$.trim(color).toLowerCase()];
+    }
+
+    var rgbToStr = function(rgb) {
+      // TODO: there has to be a better way, even in JS
+      var r = Math.floor(rgb[0]).toString(16);
+      var g = Math.floor(rgb[1]).toString(16);
+      var b = Math.floor(rgb[2]).toString(16);
+      // pad
+      r = r.length < 2 ? '0' + r : r;
+      g = g.length < 2 ? '0' + g : g;
+      b = b.length < 2 ? '0' + b : b;        
+      return ('#'+r+g+b);
+    }
+    
+    // Functions rgbToHsl and hslToRgb originally from 
+    // http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript
+    // implementation of functions in Wikipedia
+    // (with slight modifications)
+
+    // RGB to HSL color conversion
+    var rgbToHsl = function(rgb) {
+      var r = rgb[0]/255, g = rgb[1]/255, b = rgb[2]/255;
+      var max = Math.max(r, g, b), min = Math.min(r, g, b);
+      var h, s, l = (max + min) / 2;
+
+      if (max == min) {
+        h = s = 0; // achromatic
+      } else {
+        var d = max - min;
+        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
+        switch (max) {
+          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
+          case g: h = (b - r) / d + 2; break;
+          case b: h = (r - g) / d + 4; break;
+        }
+        h /= 6;
+      }
+      
+      return [h, s, l];
+    }
+
+    var hue2rgb = function(p, q, t) {
+      if (t < 0) t += 1;
+      if (t > 1) t -= 1;
+      if (t < 1/6) return p + (q - p) * 6 * t;
+      if (t < 1/2) return q;
+      if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
+      return p;
+    }
+
+    var hslToRgb = function(hsl) {
+      var h = hsl[0], s = hsl[1], l = hsl[2];
+
+      var r, g, b;
+
+      if (s == 0) {
+        r = g = b = l; // achromatic
+      } else {
+        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
+        var p = 2 * l - q;
+        r = hue2rgb(p, q, h + 1/3);
+        g = hue2rgb(p, q, h);
+        b = hue2rgb(p, q, h - 1/3);
+      }
+      
+      return [r * 255, g * 255, b * 255];
+    }
+
+    var adjustLightnessCache = {};
+
+    // given color string and -1<=adjust<=1, returns color string
+    // where lightness (in the HSL sense) is adjusted by the given
+    // amount, the larger the lighter: -1 gives black, 1 white, and 0
+    // the given color.
+    var adjustColorLightness = function(colorstr, adjust) {
+      if (!(colorstr in adjustLightnessCache)) {
+        adjustLightnessCache[colorstr] = {}
+      }
+      if (!(adjust in adjustLightnessCache[colorstr])) {
+        var rgb = strToRgb(colorstr);
+        if (rgb === undefined) {
+          // failed color string conversion; just return the input
+          adjustLightnessCache[colorstr][adjust] = colorstr;
+        } else {
+          var hsl = rgbToHsl(rgb);
+          if (adjust > 0.0) {
+            hsl[2] = 1.0 - ((1.0-hsl[2])*(1.0-adjust));
+          } else {
+            hsl[2] = (1.0+adjust)*hsl[2];
+          }
+          var lightRgb = hslToRgb(hsl);
+          adjustLightnessCache[colorstr][adjust] = rgbToStr(lightRgb);
+        }
+      }
+      return adjustLightnessCache[colorstr][adjust];
+    }
+
+    // Partially stolen from: http://documentcloud.github.com/underscore/
+    // MIT-License
+    // TODO: Mention in LICENSE.md
+    var isEqual = function(a, b) {
+      // Check object identity.
+      if (a === b) return true;
+      // Different types?
+      var atype = typeof(a), btype = typeof(b);
+      if (atype != btype) return false;
+      // Basic equality test (watch out for coercions).
+      if (a == b) return true;
+      // One is falsy and the other truthy.
+      if ((!a && b) || (a && !b)) return false;
+      // If a is not an object by this point, we can't handle it.
+      if (atype !== 'object') return false;
+      // Check for different array lengths before comparing contents.
+      if (a.length && (a.length !== b.length)) return false;
+      // Nothing else worked, deep compare the contents.
+      for (var key in b) if (!(key in a)) return false;
+      // Recursive comparison of contents.
+      for (var key in a) if (!(key in b) || !isEqual(a[key], b[key])) return false;
+      return true;
+    };
+
+    var keyValRE = /^([^=]+)=(.*)$/; // key=value
+    var isDigitsRE = /^[0-9]+$/;
+
+    var deparam = function(str) {
+      var args = str.split('&');
+      var len = args.length;
+      if (!len) return null;
+      var result = {};
+      for (var i = 0; i < len; i++) {
+        var parts = args[i].match(keyValRE);
+        if (!parts || parts.length != 3) break;
+        var val = [];
+        var arr = parts[2].split(',');
+        var sublen = arr.length;
+        for (var j = 0; j < sublen; j++) {
+          var innermost = [];
+          // map empty arguments ("" in URL) to empty arrays
+          // (innermost remains [])
+          if (arr[j].length) {
+            var arrsplit = arr[j].split('~');
+            var subsublen = arrsplit.length;
+            for (var k = 0; k < subsublen; k++) {
+              if(arrsplit[k].match(isDigitsRE)) {
+                // convert digits into ints ...
+                innermost.push(parseInt(arrsplit[k], 10));
+              }
+              else {
+                // ... anything else remains a string.
+                innermost.push(arrsplit[k]);
+              }
+            }
+          }
+          val.push(innermost);
+        }
+        result[parts[1]] = val;
+      }
+      return result;
+    };
+
+    var paramArray = function(val) {
+      val = val || [];
+      var len = val.length;
+      var arr = [];
+      for (var i = 0; i < len; i++) {
+        if ($.isArray(val[i])) {
+          arr.push(val[i].join('~'));
+        } else {
+          // non-array argument; this is an error from the caller
+          console.error('param: Error: received non-array-in-array argument [', i, ']', ':', val[i], '(fix caller)');
+        }
+      }
+      return arr;
+    };
+
+    var param = function(args) {
+      if (!args) return '';
+      var vals = [];
+      for (var key in args) {
+        if (args.hasOwnProperty(key)) {
+          var val = args[key];
+          if (val == undefined) {
+            console.error('Error: received argument', key, 'with value', val);
+            continue;
+          }
+          // values normally expected to be arrays, but some callers screw
+          // up, so check
+          if ($.isArray(val)) {
+            var arr = paramArray(val);
+            vals.push(key + '=' + arr.join(','));
+          } else {
+            // non-array argument; this is an error from the caller
+            console.error('param: Error: received non-array argument', key, ':', val, '(fix caller)');
+          }
+        }
+      }
+      return vals.join('&');
+    };
+
+    var profiles = {};
+    var profileStarts = {};
+    var profileOn = false;
+    var profileEnable = function(on) {
+      if (on === undefined) on = true;
+      profileOn = on;
+    }; // profileEnable
+    var profileClear = function() {
+      if (!profileOn) return;
+      profiles = {};
+      profileStarts = {};
+    }; // profileClear
+    var profileStart = function(label) {
+      if (!profileOn) return;
+      profileStarts[label] = new Date();
+    }; // profileStart
+    var profileEnd = function(label) {
+      if (!profileOn) return;
+      var profileElapsed = new Date() - profileStarts[label]
+      if (!profiles[label]) profiles[label] = 0;
+      profiles[label] += profileElapsed;
+    }; // profileEnd
+    var profileReport = function() {
+      if (!profileOn) return;
+      if (window.console) {
+        $.each(profiles, function(label, time) {
+          console.log("profile " + label, time);
+        });
+        console.log("-------");
+      }
+    }; // profileReport
+
+    // container: ID or jQuery element
+    // collData: the collection data (in the format of the result of
+    //   http://.../brat/ajax.cgi?action=getCollectionInformation&collection=...
+    // docData: the document data (in the format of the result of
+    //   http://.../brat/ajax.cgi?action=getDocument&collection=...&document=...
+    // returns the embedded visualizer's dispatcher object
+    var embed = function(container, collData, docData, webFontURLs) {
+      var dispatcher = new Dispatcher();
+      var visualizer = new Visualizer(dispatcher, container, webFontURLs);
+      docData.collection = null;
+      dispatcher.post('collectionLoaded', [collData]);
+      dispatcher.post('requestRenderData', [docData]);
+      return dispatcher;
+    };
+
+    // container: ID or jQuery element
+    // collDataURL: the URL of the collection data, or collection data
+    //   object (if pre-fetched)
+    // docDataURL: the url of the document data (if pre-fetched, use
+    //   simple `embed` instead)
+    // callback: optional; the callback to call afterwards; it will be
+    //   passed the embedded visualizer's dispatcher object
+    var embedByURL = function(container, collDataURL, docDataURL, callback) {
+      var collData, docData;
+      var handler = function() {
+        if (collData && docData) {
+          var dispatcher = embed(container, collData, docData);
+          if (callback) callback(dispatcher);
+        }
+      };
+      if (typeof(container) == 'string') {
+        $.getJSON(collDataURL, function(data) { collData = data; handler(); });
+      } else {
+        collData = collDataURL;
+      }
+      $.getJSON(docDataURL, function(data) { docData = data; handler(); });
+    };
+
+
+    return {
+      profileEnable: profileEnable,
+      profileClear: profileClear,
+      profileStart: profileStart,
+      profileEnd: profileEnd,
+      profileReport: profileReport,
+      formatTimeAgo: formatTimeAgo,
+      realBBox: realBBox,
+      getSpanLabels: getSpanLabels,
+      spanDisplayForm: spanDisplayForm,
+      getArcLabels: getArcLabels,
+      arcDisplayForm: arcDisplayForm,
+      escapeQuotes: escapeQuotes,
+      escapeHTML: escapeHTML,
+      escapeHTMLandQuotes: escapeHTMLandQuotes,
+      escapeHTMLwithNewlines: escapeHTMLwithNewlines,
+      cmp: cmp,
+      rgbToHsl: rgbToHsl,
+      hslToRgb: hslToRgb,
+      adjustColorLightness: adjustColorLightness,
+      objectToUrlStr: objectToUrlStr,
+      isEqual: isEqual,
+      paramArray: paramArray,
+      param: param,
+      deparam: deparam,
+      embed: embed,
+      embedByURL: embedByURL,
+    };
+
+})(window);
Index: src/main/resources/static/static/lib/brat/lib/jquery.svgdom.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/jquery.svgdom.min.js	(date 1594749336096)
+++ src/main/resources/static/static/lib/brat/lib/jquery.svgdom.min.js	(date 1594749336096)
@@ -0,0 +1,7 @@
+/* http://keith-wood.name/svg.html
+   SVG/jQuery DOM compatibility for jQuery v1.4.3.
+   Written by Keith Wood (kbwood{at}iinet.com.au) April 2009.
+   Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and 
+   MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses. 
+   Please attribute the author if you use it. */
+(function($){$.fn.addClass=function(e){return function(d){d=d||'';return this.each(function(){if(isSVGElem(this)){var c=this;$.each(d.split(/\s+/),function(i,a){var b=(c.className?c.className.baseVal:c.getAttribute('class'));if($.inArray(a,b.split(/\s+/))==-1){b+=(b?' ':'')+a;(c.className?c.className.baseVal=b:c.setAttribute('class',b))}})}else{e.apply($(this),[d])}})}}($.fn.addClass);$.fn.removeClass=function(e){return function(d){d=d||'';return this.each(function(){if(isSVGElem(this)){var c=this;$.each(d.split(/\s+/),function(i,a){var b=(c.className?c.className.baseVal:c.getAttribute('class'));b=$.grep(b.split(/\s+/),function(n,i){return n!=a}).join(' ');(c.className?c.className.baseVal=b:c.setAttribute('class',b))})}else{e.apply($(this),[d])}})}}($.fn.removeClass);$.fn.toggleClass=function(c){return function(a,b){return this.each(function(){if(isSVGElem(this)){if(typeof b!=='boolean'){b=!$(this).hasClass(a)}$(this)[(b?'add':'remove')+'Class'](a)}else{c.apply($(this),[a,b])}})}}($.fn.toggleClass);$.fn.hasClass=function(d){return function(b){b=b||'';var c=false;this.each(function(){if(isSVGElem(this)){var a=(this.className?this.className.baseVal:this.getAttribute('class')).split(/\s+/);c=($.inArray(b,a)>-1)}else{c=(d.apply($(this),[b]))}return!c});return c}}($.fn.hasClass);$.fn.attr=function(h){return function(b,c,d){if(typeof b==='string'&&c===undefined){var e=h.apply(this,[b,c,d]);if(e&&e.baseVal&&e.baseVal.numberOfItems!=null){c='';e=e.baseVal;for(var i=0;i<e.numberOfItems;i++){var f=e.getItem(i);switch(f.type){case 1:c+=' matrix('+f.matrix.a+','+f.matrix.b+','+f.matrix.c+','+f.matrix.d+','+f.matrix.e+','+f.matrix.f+')';break;case 2:c+=' translate('+f.matrix.e+','+f.matrix.f+')';break;case 3:c+=' scale('+f.matrix.a+','+f.matrix.d+')';break;case 4:c+=' rotate('+f.angle+')';break;case 5:c+=' skewX('+f.angle+')';break;case 6:c+=' skewY('+f.angle+')';break}}e=c.substring(1)}return(e&&e.baseVal?e.baseVal.valueAsString:e)}var g=b;if(typeof b==='string'){g={};g[b]=c}return this.each(function(){if(isSVGElem(this)){for(var n in g){var a=($.isFunction(g[n])?g[n]():g[n]);(d?this.style[n]=a:this.setAttribute(n,a))}}else{h.apply($(this),[b,c,d])}})}}($.fn.attr);$.fn.removeAttr=function(b){return function(a){return this.each(function(){if(isSVGElem(this)){(this[a]&&this[a].baseVal?this[a].baseVal.value='':this.setAttribute(a,''))}else{b.apply($(this),[a])}})}}($.fn.removeAttr);function anySVG(a){for(var i=0;i<a.length;i++){if(a[i].nodeType==1&&a[i].namespaceURI==$.svg.svgNS){return true}}return false}$.expr.relative['+']=function(d){return function(a,b,c){d(a,b,c||anySVG(a))}}($.expr.relative['+']);$.expr.relative['>']=function(d){return function(a,b,c){d(a,b,c||anySVG(a))}}($.expr.relative['>']);$.expr.relative['']=function(d){return function(a,b,c){d(a,b,c||anySVG(a))}}($.expr.relative['']);$.expr.relative['~']=function(d){return function(a,b,c){d(a,b,c||anySVG(a))}}($.expr.relative['~']);$.expr.find.ID=function(d){return function(a,b,c){return(isSVGElem(b)?[b.ownerDocument.getElementById(a[1])]:d(a,b,c))}}($.expr.find.ID);var j=document.createElement('div');j.appendChild(document.createComment(''));if(j.getElementsByTagName('*').length>0){$.expr.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==='*'){var d=[];for(var i=0;c[i]||c.item(i);i++){if((c[i]||c.item(i)).nodeType===1){d.push(c[i]||c.item(i))}}c=d}return c}}$.expr.preFilter.CLASS=function(a,b,c,d,f,g){a=' '+a[1].replace(/\\/g,'')+' ';if(g){return a}for(var i=0,elem={};elem!=null;i++){elem=b[i];if(!elem){try{elem=b.item(i)}catch(e){}}if(elem){var h=(!isSVGElem(elem)?elem.className:(elem.className?elem.className.baseVal:'')||elem.getAttribute('class'));if(f^(h&&(' '+h+' ').indexOf(a)>-1)){if(!c)d.push(elem)}else if(c){b[i]=false}}}return false};$.expr.filter.CLASS=function(a,b){var c=(!isSVGElem(a)?a.className:(a.className?a.className.baseVal:a.getAttribute('class')));return(' '+c+' ').indexOf(b)>-1};$.expr.filter.ATTR=function(g){return function(c,d){var e=null;if(isSVGElem(c)){e=d[1];$.expr.attrHandle[e]=function(a){var b=a.getAttribute(e);return b&&b.baseVal||b}}var f=g(c,d);if(e){$.expr.attrHandle[e]=null}return f}}($.expr.filter.ATTR);function isSVGElem(a){return(a.nodeType==1&&a.namespaceURI==$.svg.svgNS)}})(jQuery);
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/lib/jquery.ba-bbq.min.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/lib/jquery.ba-bbq.min.js	(date 1594749336092)
+++ src/main/resources/static/static/lib/brat/lib/jquery.ba-bbq.min.js	(date 1594749336092)
@@ -0,0 +1,18 @@
+/*
+ * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
+ * http://benalman.com/projects/jquery-bbq-plugin/
+ * 
+ * Copyright (c) 2010 "Cowboy" Ben Alman
+ * Dual licensed under the MIT and GPL licenses.
+ * http://benalman.com/about/license/
+ */
+(function($,p){var i,m=Array.prototype.slice,r=decodeURIComponent,a=$.param,c,l,v,b=$.bbq=$.bbq||{},q,u,j,e=$.event.special,d="hashchange",A="querystring",D="fragment",y="elemUrlAttr",g="location",k="href",t="src",x=/^.*\?|#.*$/g,w=/^.*\#/,h,C={};function E(F){return typeof F==="string"}function B(G){var F=m.call(arguments,1);return function(){return G.apply(this,F.concat(m.call(arguments)))}}function n(F){return F.replace(/^[^#]*#?(.*)$/,"$1")}function o(F){return F.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function f(H,M,F,I,G){var O,L,K,N,J;if(I!==i){K=F.match(H?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);J=K[3]||"";if(G===2&&E(I)){L=I.replace(H?w:x,"")}else{N=l(K[2]);I=E(I)?l[H?D:A](I):I;L=G===2?I:G===1?$.extend({},I,N):$.extend({},N,I);L=a(L);if(H){L=L.replace(h,r)}}O=K[1]+(H?"#":L||!K[1]?"?":"")+L+J}else{O=M(F!==i?F:p[g][k])}return O}a[A]=B(f,0,o);a[D]=c=B(f,1,n);c.noEscape=function(G){G=G||"";var F=$.map(G.split(""),encodeURIComponent);h=new RegExp(F.join("|"),"g")};c.noEscape(",/");$.deparam=l=function(I,F){var H={},G={"true":!0,"false":!1,"null":null};$.each(I.replace(/\+/g," ").split("&"),function(L,Q){var K=Q.split("="),P=r(K[0]),J,O=H,M=0,R=P.split("]["),N=R.length-1;if(/\[/.test(R[0])&&/\]$/.test(R[N])){R[N]=R[N].replace(/\]$/,"");R=R.shift().split("[").concat(R);N=R.length-1}else{N=0}if(K.length===2){J=r(K[1]);if(F){J=J&&!isNaN(J)?+J:J==="undefined"?i:G[J]!==i?G[J]:J}if(N){for(;M<=N;M++){P=R[M]===""?O.length:R[M];O=O[P]=M<N?O[P]||(R[M+1]&&isNaN(R[M+1])?{}:[]):J}}else{if($.isArray(H[P])){H[P].push(J)}else{if(H[P]!==i){H[P]=[H[P],J]}else{H[P]=J}}}}else{if(P){H[P]=F?i:""}}});return H};function z(H,F,G){if(F===i||typeof F==="boolean"){G=F;F=a[H?D:A]()}else{F=E(F)?F.replace(H?w:x,""):F}return l(F,G)}l[A]=B(z,0);l[D]=v=B(z,1);$[y]||($[y]=function(F){return $.extend(C,F)})({a:k,base:k,iframe:t,img:t,input:t,form:"action",link:k,script:t});j=$[y];function s(I,G,H,F){if(!E(H)&&typeof H!=="object"){F=H;H=G;G=i}return this.each(function(){var L=$(this),J=G||j()[(this.nodeName||"").toLowerCase()]||"",K=J&&L.attr(J)||"";L.attr(J,a[I](K,H,F))})}$.fn[A]=B(s,A);$.fn[D]=B(s,D);b.pushState=q=function(I,F){if(E(I)&&/^#/.test(I)&&F===i){F=2}var H=I!==i,G=c(p[g][k],H?I:{},H?F:2);p[g][k]=G+(/#/.test(G)?"":"#")};b.getState=u=function(F,G){return F===i||typeof F==="boolean"?v(F):v(G)[F]};b.removeState=function(F){var G={};if(F!==i){G=u();$.each($.isArray(F)?F:arguments,function(I,H){delete G[H]})}q(G,2)};e[d]=$.extend(e[d],{add:function(F){var H;function G(J){var I=J[D]=c();J.getState=function(K,L){return K===i||typeof K==="boolean"?l(I,K):l(I,L)[K]};H.apply(this,arguments)}if($.isFunction(F)){H=F;return G}else{H=F.handler;F.handler=G}}})})(jQuery,this);
+/*
+ * jQuery hashchange event - v1.2 - 2/11/2010
+ * http://benalman.com/projects/jquery-hashchange-plugin/
+ * 
+ * Copyright (c) 2010 "Cowboy" Ben Alman
+ * Dual licensed under the MIT and GPL licenses.
+ * http://benalman.com/about/license/
+ */
+(function($,i,b){var j,k=$.event.special,c="location",d="hashchange",l="href",f=$.browser,g=document.documentMode,h=f.msie&&(g===b||g<8),e="on"+d in i&&!h;function a(m){m=m||i[c][l];return m.replace(/^[^#]*#?(.*)$/,"$1")}$[d+"Delay"]=100;k[d]=$.extend(k[d],{setup:function(){if(e){return false}$(j.start)},teardown:function(){if(e){return false}$(j.stop)}});j=(function(){var m={},r,n,o,q;function p(){o=q=function(s){return s};if(h){n=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;q=function(){return a(n.document[c][l])};o=function(u,s){if(u!==s){var t=n.document;t.open().close();t[c].hash="#"+u}};o(a())}}m.start=function(){if(r){return}var t=a();o||p();(function s(){var v=a(),u=q(t);if(v!==t){o(t=v,u);$(i).trigger(d)}else{if(u!==t){i[c][l]=i[c][l].replace(/#.*/,"")+"#"+u}}r=setTimeout(s,$[d+"Delay"])})()};m.stop=function(){if(!n){r&&clearTimeout(r);r=0}};return m})()})(jQuery,this);
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/src/dispatcher.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/dispatcher.js	(date 1594749336100)
+++ src/main/resources/static/static/lib/brat/src/dispatcher.js	(date 1594749336100)
@@ -0,0 +1,130 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+// TODO: does 'arguments.callee.caller' work?
+
+var Dispatcher = (function($, window, undefined) {
+    var Dispatcher = function() {
+      var that = this;
+
+      var table = {};
+
+      var on = function(message, host, handler) {
+        if (handler === undefined) {
+          handler = host;
+          host = arguments.callee.caller;
+        }
+        if (table[message] === undefined) {
+          table[message] = [];
+        }
+        table[message].push([host, handler]);
+        return this;
+      };
+
+      // Notify listeners that we encountered an error in an asynch call
+      var inAsynchError = false; // To avoid error avalanches
+      var handleAsynchError = function(e) {
+        if (!inAsynchError) {
+          inAsynchError = true;
+          // TODO: Hook printout into dispatch elsewhere?
+          console.warn('Handled async error:', e);
+          that.post('dispatchAsynchError', [e]);
+          inAsynchError = false;
+        } else {
+          console.warn('Dropped asynch error:', e);
+        }
+      };
+
+      var post = function(asynch, message, args, returnType) {
+        if (typeof(asynch) !== 'number') {
+          // no asynch parameter
+          returnType = args;
+          args = message;
+          message = asynch;
+          asynch = null;
+        }
+        if (args === undefined) {
+          args = [];
+        }
+        var results = [];
+        // DEBUG: if (typeof(message) != "string" || !(message.match(/mouse/) || message == "hideComment")) console.log(message, args);
+
+        if (typeof(message) === 'function') {
+          // someone was lazy and sent a simple function
+          var host = arguments.callee.caller;
+          if (asynch !== null) {
+            result = setTimeout(function() {
+              try {
+                message.apply(host, args);
+              } catch(e) {
+                that.handleAsynchError(e);
+              }
+            }, asynch);
+          } else {
+            result = message.apply(host, args);
+          }
+          results.push(result);
+        } else {
+          // a proper message, propagate to all interested parties
+          var todo = table[message];
+          if (todo !== undefined) {
+            $.each(todo, function(itemNo, item) {
+              var result;
+              if (asynch !== null) {
+                result = setTimeout(function() {
+                  try {
+                    item[1].apply(item[0], args);
+                  } catch (e) {
+                    that.handleAsynchError(e);
+                  }
+                }, asynch);
+              } else {
+                result = item[1].apply(item[0], args);
+              }
+              results.push(result);
+            });
+/* DEBUG
+          } else {
+            console.warn('Message ' + message + ' has no subscribers.'); // DEBUG
+*/
+          }
+        }
+        if (returnType == 'any') {
+          var i = results.length;
+          while (i--) {
+            if (results[i] !== false) return results[i];
+          }
+          return false;
+        }
+        if (returnType == 'all') {
+          var i = results.length;
+          while (i--) {
+            if (results[i] === false) return results[i];
+          }
+        }
+        return results;
+      };
+
+      var proxy = function(destination, message) {
+        this.on(message, function() {
+          destination.post(message, Array.prototype.slice.call(arguments));
+        });
+      };
+
+      var dispatcher = {
+        on: on,
+        post: post,
+        proxy: proxy,
+      };
+      Dispatcher.dispatchers.push(dispatcher);
+      return dispatcher;
+    };
+
+    Dispatcher.dispatchers = [];
+    Dispatcher.post = function(asynch, message, args, returnType) {
+      $.each(Dispatcher.dispatchers, function(dispatcherNo, dispatcher) {
+        dispatcher.post(asynch, message, args, returnType);
+      });
+    };
+
+    return Dispatcher;
+})(jQuery, window);
Index: src/main/resources/static/static/lib/brat/src/visualizer_ui.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/visualizer_ui.js	(date 1594749336105)
+++ src/main/resources/static/static/lib/brat/src/visualizer_ui.js	(date 1594749336105)
@@ -0,0 +1,2247 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+var VisualizerUI = (function($, window, undefined) {
+    var VisualizerUI = function(dispatcher, svg) {
+      var that = this;
+
+      var messagePostOutFadeDelay = 1000;
+      var messageDefaultFadeDelay = 3000;
+      var defaultFloatFormat = '%.1f/right';
+
+      var documentListing = null; // always documents of current collection
+      var selectorData = null;    // can be search results when available
+      var searchActive = false;   // whether search results received and in use
+      var loadedSearchData = null;
+
+      var currentForm;
+      var spanTypes = null;
+      var relationTypesHash = null;
+      // TODO: confirm unnecessary and remove
+//       var attributeTypes = null;
+      var data = null;
+      var mtime = null;
+      var searchConfig = null;
+      var coll, doc, args;
+      var collScroll;
+      var docScroll;
+      var user = null;
+      var annotationAvailable = false;
+
+      var svgElement = $(svg._svg);
+      var svgId = svgElement.parent().attr('id');
+
+      var maxMessages = 100;
+
+      var currentDocumentSVGsaved = false;
+      var fileBrowserClosedWithSubmit = false;
+
+      // normalization: server-side DB by norm DB name
+      var normServerDbByNormDbName = {};
+
+      var matchFocus = '';
+      var matches = '';
+
+      /* START "no svg" message - related */
+
+      var noSvgTimer = null;
+
+      // this is necessary for centering
+      $('#no_svg_wrapper').css('display', 'table');
+      // on initial load, hide the "no SVG" message
+      $('#no_svg_wrapper').hide();
+
+      var hideNoDocMessage = function() {
+        clearTimeout(noSvgTimer);
+        $('#no_svg_wrapper').hide(0);
+        $('#source_files').show();
+      }
+
+      var showNoDocMessage = function() {
+        clearTimeout(noSvgTimer);
+        noSvgTimer = setTimeout(function() {
+          $('#no_svg_wrapper').fadeIn(500);
+        }, 2000);
+        $('#source_files').hide();
+      }
+      
+      /* END "no svg" message - related */
+
+      /* START collection browser sorting - related */
+
+      var lastGoodCollection = '/';
+      var sortOrder = [2, 1]; // column (0..), sort order (1, -1)
+      var collectionSortOrder; // holds previous sort while search is active
+      var docSortFunction = function(a, b) {
+          // parent at the top
+          if (a[2] === '..') return -1;
+          if (b[2] === '..') return 1;
+
+          // then other collections
+          var aIsColl = a[0] == "c";
+          var bIsColl = b[0] == "c";
+          if (aIsColl !== bIsColl) return aIsColl ? -1 : 1;
+
+          // desired column in the desired order
+          var col = sortOrder[0];
+          var aa = a[col];
+          var bb = b[col];
+          if (selectorData.header[col - 2][1] === 'string-reverse') {
+            aa = aa.split('').reverse().join('');
+            bb = bb.split('').reverse().join('');
+          }
+          if (aa != bb) return (aa < bb) ? -sortOrder[1] : sortOrder[1];
+
+          // prevent random shuffles on columns with duplicate values
+          // (alphabetical order of documents)
+          aa = a[2];
+          bb = b[2];
+          if (aa != bb) return (aa < bb) ? -1 : 1;
+          return 0;
+      };
+
+      var makeSortChangeFunction = function(sort, th, thNo) {
+          $(th).click(function() {
+              // TODO: avoid magic numbers in access to the selector
+              // data (column 0 is type, 1 is args, rest is data)
+              if (sort[0] === thNo + 1) sort[1] = -sort[1];
+              else {
+                var type = selectorData.header[thNo - 1][1];
+                var ascending = type === "string";
+                sort[0] = thNo + 1;
+                sort[1] = ascending ? 1 : -1;
+              }
+              selectorData.items.sort(docSortFunction);
+              docScroll = 0;
+              showFileBrowser(); // resort
+          });
+      }
+
+      /* END collection browser sorting - related */
+
+
+      /* START message display - related */
+
+      var showPullupTrigger = function() {
+        $('#pulluptrigger').show('puff');
+      }
+
+      var $messageContainer = $('#messages');
+      var $messagepullup = $('#messagepullup');
+      var pullupTimer = null;
+      var displayMessages = function(msgs) {
+        var initialMessageNum = $messagepullup.children().length;
+
+        if (msgs === false) {
+          $messageContainer.children().each(function(msgElNo, msgEl) {
+              $(msgEl).remove();
+          });
+        } else {
+          $.each(msgs, function(msgNo, msg) {
+            var element;
+            var timer = null;
+            try {
+              element = $('<div class="' + msg[1] + '">' + msg[0] + '</div>');
+            }
+            catch(x) {
+              escaped = msg[0].replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
+              element = $('<div class="error"><b>[ERROR: could not display the following message normally due to malformed XML:]</b><br/>' + escaped + '</div>');
+            }
+            var pullupElement = element.clone();
+            $messageContainer.append(element);
+            $messagepullup.append(pullupElement.css('display', 'none'));
+            slideToggle(pullupElement, true, true);
+
+            var fader = function() {
+              if ($messagepullup.is(':visible')) {
+                element.remove();
+              } else {
+                element.hide('slow', function() {
+                  element.remove();
+                });
+              }
+            };
+            var delay = (msg[2] === undefined)
+                          ? messageDefaultFadeDelay
+                          : (msg[2] === -1)
+                              ? null
+                              : (msg[2] * 1000);
+            if (delay === null) {
+              var button = $('<input type="button" value="OK"/>');
+              element.prepend(button);
+              button.click(function(evt) {
+                timer = setTimeout(fader, 0);
+              });
+            } else {
+              timer = setTimeout(fader, delay);
+              element.mouseover(function() {
+                  clearTimeout(timer);
+                  element.show();
+              }).mouseout(function() {
+                  timer = setTimeout(fader, messagePostOutFadeDelay);
+              });
+            }
+            // setTimeout(fader, messageDefaultFadeDelay);
+          });
+
+          // limited history - delete oldest
+          var $messages = $messagepullup.children();
+          for (var i = 0; i < $messages.length - maxMessages; i++) {
+            $($messages[i]).remove();
+          }
+        }
+
+        // if there is change in the number of messages, may need to
+        // tweak trigger visibility
+        var messageNum = $messagepullup.children().length;
+        if (messageNum != initialMessageNum) {
+          if (messageNum == 0) {
+            // all gone; nothing to trigger
+            $('#pulluptrigger').hide('slow');
+          } else if (initialMessageNum == 0) {
+            // first messages, show trigger at fade
+            setTimeout(showPullupTrigger, messageDefaultFadeDelay+250);
+          }
+        }
+      };
+
+      // hide pullup trigger by default, show on first message
+      $('#pulluptrigger').hide();
+      $('#pulluptrigger').
+        mouseenter(function(evt) {
+          $('#pulluptrigger').hide('puff');
+          clearTimeout(pullupTimer);
+          slideToggle($messagepullup.stop(), true, true, true);
+        });
+      $('#messagepullup').
+        mouseleave(function(evt) {
+          setTimeout(showPullupTrigger, 500);
+          clearTimeout(pullupTimer);
+          pullupTimer = setTimeout(function() {
+            slideToggle($messagepullup.stop(), false, true, true);
+          }, 500);
+        });
+
+
+      /* END message display - related */
+
+
+      /* START comment popup - related */
+
+      var adjustToCursor = function(evt, element, offset, top, right) {
+        // get the real width, without wrapping
+        element.css({ left: 0, top: 0 });
+        var screenHeight = $(window).height();
+        var screenWidth = $(window).width();
+        // FIXME why the hell is this 22 necessary?!?
+        var elementHeight = element.height() + 22;
+        var elementWidth = element.width() + 22;
+        var x, y;
+        offset = offset || 0;
+        if (top) {
+          y = evt.clientY - elementHeight - offset;
+          if (y < 0) top = false;
+        }
+        if (!top) {
+          y = evt.clientY + offset;
+        }
+        if (right) {
+          x = evt.clientX + offset;
+          if (x >= screenWidth - elementWidth) right = false;
+        }
+        if (!right) {
+          x = evt.clientX - elementWidth - offset;
+        }
+        if (y < 0) y = 0;
+        if (x < 0) x = 0;
+        element.css({ top: y, left: x });
+      };
+
+      var commentPopup = $('#commentpopup');
+      var commentDisplayed = false;
+
+      var displayCommentTimer = null;
+      var displayComment = function(evt, target, comment, commentText, commentType, immediately) {
+        var idtype;
+        if (commentType) {
+          // label comment by type, with special case for default note type
+          var commentLabel;
+          if (commentType == 'AnnotatorNotes') {
+            commentLabel = '<b>Note:</b> ';
+          } else {
+            commentLabel = '<b>'+Util.escapeHTML(commentType)+':</b> ';
+          }
+          comment += commentLabel + Util.escapeHTMLwithNewlines(commentText);
+          idtype = 'comment_' + commentType;
+        }
+        commentPopup[0].className = idtype;
+        commentPopup.html(comment);
+        adjustToCursor(evt, commentPopup, 10, true, true);
+        clearTimeout(displayCommentTimer);
+        /* slight "tooltip" delay to allow highlights to be seen
+           before the popup obstructs them. */
+        displayCommentTimer = setTimeout(function() {
+          commentPopup.stop(true, true).fadeIn();
+          commentDisplayed = true;
+        }, immediately ? 0 : 500);
+      };
+
+      // to avoid clobbering on delayed response
+      var commentPopupNormInfoSeqId = 0;
+
+      var normInfoSortFunction = function(a, b) {
+        // images at the top
+        if (a[0].toLowerCase() == '<img>') return -1;
+        if (b[0].toLowerCase() == '<img>') return 1;
+        // otherwise stable
+        return Util.cmp(a[2],b[2]);
+      }
+
+      var displaySpanComment = function(
+          evt, target, spanId, spanType, mods, spanText, commentText, 
+          commentType, normalizations) {
+
+        var immediately = false;
+        var comment = ( '<div><span class="comment_type_id_wrapper">' +
+                        '<span class="comment_type">' +
+                        Util.escapeHTML(Util.spanDisplayForm(spanTypes,
+                                                             spanType)) +
+                        '</span>' +
+                        ' ' +
+                        '<span class="comment_id">' +
+                        'ID:'+Util.escapeHTML(spanId) +
+                        '</span></span>' );
+        if (mods.length) {
+          comment += '<div>' + Util.escapeHTML(mods.join(', ')) + '</div>';
+        }
+
+        comment += '</div>';
+        comment += ('<div class="comment_text">"' + 
+                    Util.escapeHTML(spanText) + 
+                    '"</div>');
+        var validArcTypesForDrag = dispatcher.post('getValidArcTypesForDrag', [spanId, spanType]);
+        if (validArcTypesForDrag && validArcTypesForDrag[0]) {
+          if (validArcTypesForDrag[0].length) {
+            comment += '<div>' + validArcTypesForDrag[0].join(', ') + '</div>';
+          } else {
+            $('rect[data-span-id="' + spanId + '"]').addClass('badTarget');
+          }
+          immediately = true;
+        }
+        // process normalizations
+        var normsToQuery = [];
+        $.each(normalizations, function(normNo, norm) {
+          var dbName = norm[0], dbKey = norm[1];
+          comment += ( '<hr/>' +
+                       '<span class="comment_id">' +
+                       Util.escapeHTML(dbName) + ':' +
+                       Util.escapeHTML(dbKey) + '</span>');
+          if (dbName in normServerDbByNormDbName &&
+              normServerDbByNormDbName[dbName] != '<NONE>') {
+            // DB available, add drop-off point to HTML and store
+            // query parameters
+            commentPopupNormInfoSeqId++;
+            comment += ('<br/><div id="norm_info_drop_point_'+
+                        commentPopupNormInfoSeqId+'"/>');
+            normsToQuery.push([dbName, dbKey, commentPopupNormInfoSeqId]);
+          } else {
+            // no DB, just attach "human-readable" text provided
+            // with the annotation, if any
+            if (norm[2]) {
+                comment += ('<br/><span class="norm_info_value">'+
+                            Util.escapeHTML(norm[2])+'</span>');
+            }
+          }
+        });
+
+        // display initial comment HTML 
+        displayComment(evt, target, comment, commentText, commentType, 
+                       immediately);
+
+        // initiate AJAX calls for the normalization data to query
+        $.each(normsToQuery, function(normqNo, normq) {
+          // TODO: cache some number of most recent norm_get_data results
+          var dbName = normq[0], dbKey = normq[1], infoSeqId = normq[2];
+          dispatcher.post('ajax', [{
+            action: 'normData',
+            database: dbName,
+            key: dbKey,
+            collection: coll,
+          },
+          function(response) {
+            if (response.exception) {
+              ; // TODO: response to error
+            } else if (!response.value) {
+              ; // TODO: response to missing key
+            } else {
+              // extend comment popup with normalization data
+              norminfo = '';
+              // flatten outer (name, attr, info) array (idx for sort)
+              infos = [];
+              var idx = 0;
+              for (var i = 0; i < response.value.length; i++) {
+                for (var j = 0; j < response.value[i].length; j++) {
+                  var label = response.value[i][j][0];
+                  var value = response.value[i][j][1];
+                  infos.push([label, value, idx++]);
+                }
+              }
+              // sort, prioritizing images (to get floats right)
+              infos = infos.sort(normInfoSortFunction);
+              // generate HTML
+              for (var i = 0; i < infos.length; i++) {
+                var label = infos[i][0];
+                var value = infos[i][1];
+                if (label && value) {
+                  // special treatment for some label values
+                  if (label.toLowerCase() == '<img>') {
+                    // image
+                    norminfo += ('<img class="norm_info_img" src="'+
+                                 value+
+                                 '"/>');
+                  } else {
+                    // normal, as text
+
+                    // max length restriction
+                    if (value.length > 300) {
+                      value = value.substr(0, 300) + ' ...';
+                    }                          
+
+                    norminfo += ('<span class="norm_info_label">'+
+                                 Util.escapeHTML(label)+
+                                 '</span>'+
+                                 '<span class="norm_info_value">'+':'+
+                                 Util.escapeHTML(value)+
+                                 '</span>'+
+                                 '<br/>');
+                  }
+                }
+              }
+              var drop=$('#norm_info_drop_point_'+infoSeqId);
+              if (drop) {
+                drop.html(norminfo);
+              } else {
+                console.log('norm info drop point not found!'); //TODO XXX
+              }
+            }
+          }]);
+        });
+      };
+
+      var onDocChanged = function() {
+        commentPopup.hide();
+        commentDisplayed = false;
+      };
+
+      var displayArcComment = function(
+          evt, target, symmetric, arcId,
+          originSpanId, originSpanType, role, 
+          targetSpanId, targetSpanType,
+          commentText, commentType) {
+        var arcRole = target.attr('data-arc-role');
+        // in arrowStr, &#8212 == mdash, &#8594 == Unicode right arrow
+        var arrowStr = symmetric ? '&#8212;' : '&#8594;';
+        var arcDisplayForm = Util.arcDisplayForm(spanTypes, 
+                                                 data.spans[originSpanId].type, 
+                                                 arcRole,
+                                                 relationTypesHash);
+        var comment = "";
+        comment += ('<span class="comment_type_id_wrapper">' +
+                    '<span class="comment_type">' +
+                    Util.escapeHTML(Util.spanDisplayForm(spanTypes,
+                                                         originSpanType)) +
+                    ' ' + arrowStr + ' ' +
+                    Util.escapeHTML(arcDisplayForm) +
+                    ' ' + arrowStr + ' ' +
+                    Util.escapeHTML(Util.spanDisplayForm(spanTypes,
+                                                         targetSpanType)) +
+                    '</span>' +
+                    '<span class="comment_id">' +
+                    (arcId ? 'ID:'+arcId : 
+                     Util.escapeHTML(originSpanId) +
+                     arrowStr + 
+                     Util.escapeHTML(targetSpanId)) +
+                    '</span>' +
+                    '</span>');
+        comment += ('<div class="comment_text">' + 
+                    Util.escapeHTML('"'+data.spans[originSpanId].text+'"') +
+                    arrowStr +
+                    Util.escapeHTML('"'+data.spans[targetSpanId].text + '"') +
+                    '</div>');
+        displayComment(evt, target, comment, commentText, commentType);
+      };
+
+      var displaySentComment = function(
+          evt, target, commentText, commentType) {
+        displayComment(evt, target, '', commentText, commentType);
+      };
+
+      var hideComment = function() {
+        clearTimeout(displayCommentTimer);
+        if (commentDisplayed) {
+          commentPopup.stop(true, true).fadeOut(function() { commentDisplayed = false; });
+        }
+      };
+
+      var onMouseMove = function(evt) {
+        if (commentDisplayed) {
+          adjustToCursor(evt, commentPopup, 10, true, true);
+        }
+      };
+
+      /* END comment popup - related */
+
+
+      /* START form management - related */
+
+      initForm = function(form, opts) {
+        opts = opts || {};
+        var formId = form.attr('id');
+
+        // alsoResize is special
+        var alsoResize = opts.alsoResize;
+        delete opts.alsoResize;
+
+        // Always add OK and Cancel
+        var buttons = (opts.buttons || []);
+        if (opts.no_ok) {
+          delete opts.no_ok;
+        } else {
+          buttons.push({
+              id: formId + "-ok",
+              text: "OK",
+              click: function() { form.submit(); }
+            });
+        }
+        if (opts.no_cancel) {
+          delete opts.no_cancel;
+        } else {
+          buttons.push({
+              id: formId + "-cancel",
+              text: "Cancel",
+              click: function() { form.dialog('close'); }
+            });
+        }
+        delete opts.buttons;
+
+        opts = $.extend({
+            autoOpen: false,
+            closeOnEscape: true,
+            buttons: buttons,
+            modal: true
+          }, opts);
+
+        form.dialog(opts);
+        form.bind('dialogclose', function() {
+          if (form == currentForm) {
+            currentForm = null;
+          }
+        });
+
+        // HACK: jQuery UI's dialog does not support alsoResize
+        // nor does resizable support a jQuery object of several
+        // elements
+        // See: http://bugs.jqueryui.com/ticket/4666
+        if (alsoResize) {
+          form.parent().resizable('option', 'alsoResize',
+              '#' + form.attr('id') + ', ' + alsoResize);
+        }
+      };
+
+      var showForm = function(form) {
+        currentForm = form;
+        // as suggested in http://stackoverflow.com/questions/2657076/jquery-ui-dialog-fixed-positioning
+        form.parent().css({position:"fixed"});
+        form.dialog('open');
+        slideToggle($('#pulldown').stop(), false);
+        return form;
+      };
+
+      var hideForm = function() {
+        if (!currentForm) return;
+        // currentForm.fadeOut(function() { currentForm = null; });
+        currentForm.dialog('close');
+        currentForm = null;
+      };
+
+      /* END form management - related */
+
+
+      /* START collection browser - related */
+
+      var selectElementInTable = function(table, docname, mf) {
+        table = $(table);
+        table.find('tr').removeClass('selected');
+        var sel = 'tr';
+        var $element;
+        if (docname) {
+          sel += '[data-doc="' + docname + '"]';
+          if (mf) {
+            sel += '[data-mf="' + Util.paramArray(mf) + '"]';
+          }
+          var $element = table.find(sel).first();
+          $element.addClass('selected');
+        }
+        matchFocus = $element && $element.attr('data-mf');
+        matches = $element && $element.attr('data-match');
+      }
+
+      var chooseDocument = function(evt) {
+        var $element = $(evt.target).closest('tr');
+        $('#document_select tr').removeClass('selected');
+        $('#document_input').val($element.attr('data-doc'));
+
+        $element.addClass('selected');
+        matchFocus = $element.attr('data-mf');
+        matches = $element.attr('data-match');
+      }
+
+      var chooseDocumentAndSubmit = function(evt) {
+        chooseDocument(evt);
+        fileBrowserSubmit(evt);
+      }
+
+      var fileBrowser = $('#collection_browser');
+      initForm(fileBrowser, {
+          alsoResize: '#document_select',
+          close: function(evt) {
+            if (!doc) {
+              // no document; set and show the relevant message, and
+              // clear the "blind" unless waiting for a collection
+              if (fileBrowserClosedWithSubmit) {
+                $('#no_document_message').hide();
+                $('#loading_message').show();
+              } else {
+                $('#loading_message').hide();
+                $('#no_document_message').show();
+                $('#waiter').dialog('close');
+              }
+              showNoDocMessage();
+            } else if (!fileBrowserClosedWithSubmit && !searchActive) {
+              dispatcher.post('setArguments', [{}, true]);
+            }
+          },
+          width: 500
+      });
+
+      /* XXX removed per #900
+      // insert the Save link
+      var $fileBrowserButtonset = fileBrowser.
+          parent().find('.ui-dialog-buttonpane .ui-dialog-buttonset').prepend(' ');
+      $('<a href="ajax.cgi?action=downloadSearchFile" id="save_search">Save</a>').
+          prependTo($fileBrowserButtonset).button().css('display', 'none');
+      */
+
+      var docInputHandler = function(evt) {
+        selectElementInTable('#document_select', $(this).val());
+      };
+      $('#document_input').keyup(docInputHandler);
+
+      var fileBrowserSubmit = function(evt) {
+        var _coll, _doc, _args, found;
+        var input = $('#document_input').
+            val().
+            replace(/\/?\s+$/, '').
+            replace(/^\s+/, '');
+        if (!input.length) return false;
+        if (input.substr(0, 2) === '..') {
+          // ..
+          var pos = coll.substr(0, coll.length - 1).lastIndexOf('/');
+          if (pos === -1) {
+            dispatcher.post('messages', [[['At the root', 'error', 2]]]);
+            $('#document_input').focus().select();
+            return false;
+          } else {
+            _coll = coll.substr(0, pos + 1);
+            _doc = '';
+          }
+        } else if (found = input.match(/^(\/?)((?:[^\/]*\/)*)([^\/?]*)$/)) {
+          var abs = found[1];
+          var collname = found[2].substr(0, found[2].length - 1);
+          var docname = found[3];
+          if (abs) {
+            _coll = abs + collname;
+            if (_coll.length < 2) coll += '/';
+            _doc = docname;
+          } else {
+            if (collname) collname += '/';
+            _coll = coll + collname;
+            _doc = docname;
+          }
+        } else {
+          dispatcher.post('messages', [[['Invalid document name format', 'error', 2]]]);
+          $('#document_input').focus().select();
+        }
+        docScroll = $('#document_select')[0].scrollTop;
+        fileBrowser.find('#document_select tbody').empty();
+
+        if (coll != _coll || doc != _doc ||
+            Util.paramArray(args.matchfocus) != matchFocus) {
+          // something changed
+
+          // set to allow keeping "blind" down during reload
+          fileBrowserClosedWithSubmit = true;
+          // ... and change BG message to a more appropriate one
+
+          // trigger clear and changes if something other than the
+          // current thing is chosen, but only blank screen before
+          // render if the document changed (prevent "flicker" on
+          // e.g. picking search results)
+          if (coll != _coll || doc != _doc) {
+            dispatcher.post('clearSVG');
+          }
+          dispatcher.post('allowReloadByURL');
+          var newArgs = [];
+          if (matchFocus) newArgs.push('matchfocus=' + matchFocus);
+          if (matches) newArgs.push('match=' + matches);
+          dispatcher.post('setCollection', [_coll, _doc, Util.deparam(newArgs.join('&'))]);
+        } else {
+          // hide even on select current thing
+          hideForm();
+        }
+        return false;
+      };
+      fileBrowser.
+          submit(fileBrowserSubmit).
+          bind('reset', hideForm);
+
+      var fileBrowserWaiting = false;
+      var showFileBrowser = function() {
+        // keep tabs on how the browser is closed; we need to keep the
+        // "blind" up when retrieving a collection, but not when canceling
+        // without selection (would hang the UI)
+        fileBrowserClosedWithSubmit = false;
+
+        // no point in showing this while the browser is shown
+        hideNoDocMessage();
+
+        if (currentForm == tutorialForm) {
+          fileBrowserWaiting = true;
+          return;
+        }
+        fileBrowserWaiting = false;
+
+        // hide "no document" message when file browser shown
+        // TODO: can't make this work; I can't detect when it gets hidden.
+//         hideNoDocMessage();
+
+        if (!(selectorData && showForm(fileBrowser))) return false;
+
+        var html = ['<tr><th/>'];
+        var tbody;
+        $.each(selectorData.header, function(headNo, head) {
+          html.push('<th>' + head[0] + '</th>');
+        });
+        html.push('</tr>');
+        $('#document_select thead').html(html.join(''));
+
+        html = [];
+        // NOTE: we seem to have some excessive sorting going on;
+        // disabling this as a test. If everything works, just remove
+        // the following commented-out line (and this comment):
+        //selectorData.items.sort(docSortFunction);
+        $.each(selectorData.items, function(docNo, doc) {
+          var isColl = doc[0] == "c"; // "collection"
+          // second column is optional annotation-specific pointer,
+          // used (at least) for search results
+          var annp = doc[1] ? ('?' + Util.escapeHTML(Util.param(doc[1]))) : '';
+          var name = Util.escapeHTML(doc[2]);
+          var collFile = isColl ? 'collection' : 'file';
+          //var collFileImg = isColl ? 'ic_list_folder.png' : 'ic_list_drafts.png';
+          //var collFileImg = isColl ? 'Fugue-folder-horizontal-open.png' : 'Fugue-document.png';
+          var collFileImg = isColl ? 'Fugue-shadowless-folder-horizontal-open.png' : 'Fugue-shadowless-document.png';
+          var collSuffix = isColl ? '/' : '';
+          if (doc[1]) {
+            var matchfocus = doc[1].matchfocus || [];
+            var mfstr = ' data-mf="' + Util.paramArray(matchfocus) + '"';
+            var match = doc[1].match || [];
+            var matchstr = ' data-match="' + Util.paramArray(match) + '"';
+          } else {
+            var matchstr = '';
+            var mfstr = '';
+          }
+          html.push('<tr class="' + collFile + '" data-doc="'
+            + name + collSuffix + '"' + matchstr + mfstr + '>');
+          html.push('<th><img src="static/img/' + collFileImg + '" alt="' + collFile + '"/></th>');
+          html.push('<th>' + name + collSuffix + '</th>');
+          var len = selectorData.header.length - 1;
+          for (var i = 0; i < len; i++) {
+            var type = selectorData.header[i + 1][1];
+            var datum = doc[i + 3];
+            // format rest according to "data type" specified in header
+            var formatted = null;
+            var cssClass = null;
+            if (!type) {
+              console.error('Missing document list data type');
+              formatted = datum;
+            } else if (datum === undefined) {
+              formatted = '';
+            } else if (type === 'string') {
+              formatted = Util.escapeHTML(datum);
+            } else if (type === 'string-right' || type === 'string-reverse') {
+              formatted = Util.escapeHTML(datum);
+              cssClass = 'rightalign';
+            } else if (type === 'string-center') {
+              formatted = Util.escapeHTML(datum);
+              cssClass = 'centeralign';
+            } else if (type === 'time') {
+              formatted = Util.formatTimeAgo(datum * 1000);
+            } else if (type === 'float') {
+              type = defaultFloatFormat;
+              cssClass = 'rightalign';
+            } else if (type === 'int') {
+              formatted = '' + datum;
+              cssClass = 'rightalign';
+            }
+            if (formatted === null) {
+              var m = type.match(/^(.*?)(?:\/(right))?$/);
+              cssClass = m[2] ? 'rightalign' : null;
+              formatted = $.sprintf(m[1], datum);
+            }
+            html.push('<td' + (cssClass ? ' class="' + cssClass + '"' : '') + '>' +
+                formatted + '</td>');
+          }
+          html.push('</tr>');
+        });
+        html = html.join('');
+        tbody = $('#document_select tbody').html(html);
+        $('#document_select')[0].scrollTop = docScroll;
+        tbody.find('tr').
+            click(chooseDocument).
+            dblclick(chooseDocumentAndSubmit);
+
+        $('#document_select thead tr *').each(function(thNo, th) {
+            makeSortChangeFunction(sortOrder, th, thNo);
+        });
+
+        $('#collection_input').val(selectorData.collection);
+        $('#document_input').val(doc);
+
+        $('#readme').val(selectorData.description || '');
+        if (selectorData.description && 
+            (selectorData.description.match(/\n/) ||
+             selectorData.description.length > 50)) {
+          // multi-line or long description; show "more" button and fill
+          // dialog text
+          $('#more_readme_button').button(); // TODO: more reasonable place
+          $('#more_readme_button').show();
+          // only display text up to the first newline in the short info
+          var split_readme_text = selectorData.description.match(/^[^\n]*/);
+          $('#readme').val(split_readme_text[0]);
+          $('#more_info_readme').text(selectorData.description);
+        } else {
+          // empty or short, single-line description; no need for more
+          $('#more_readme_button').hide();
+          $('#more_info_readme').text('');
+        }
+
+        selectElementInTable($('#document_select'), doc, args.matchfocus);
+        setTimeout(function() {
+          $('#document_input').focus().select();
+        }, 0);
+      }; // end showFileBrowser()
+      $('#collection_browser_button').click(function(evt) {
+        dispatcher.post('clearSearch');
+      });
+
+      var currentSelectorPosition = function() {
+        var pos;
+        $.each(selectorData.items, function(docNo, docRow) {
+          if (docRow[2] == doc) {
+            // args may have changed, so lacking a perfect match return
+            // last matching document as best guess
+            pos = docNo;
+            // check whether 'focus' agrees; the rest of the args are
+            // irrelevant for determining position.
+            var collectionArgs = docRow[1] || {};
+            if (Util.isEqual(collectionArgs.matchfocus, args.matchfocus)) {
+              pos = docNo;
+              return false;
+            }
+          }
+        });
+        return pos;
+      }
+
+      /* END collection browser - related */
+
+
+      /* START search - related */
+
+      var addSpanTypesToSelect = function($select, types, included) {
+        if (!included) included = {};
+        if (!included['']) {
+          included[''] = true;
+          $select.html('<option value="">- Any -</option>');
+        }
+        $.each(types, function(typeNo, type) {
+          if (type !== null) {
+            if (!included[type.name]) {
+              included[type.name] = true;
+              var $option = $('<option value="' + Util.escapeQuotes(type.type) + '"/>').text(type.name);
+              $select.append($option);
+              if (type.children) {
+                addSpanTypesToSelect($select, type.children, included);
+              }
+            }
+          }
+        });
+      };
+
+      var rememberNormDb = function(response) {
+        // the visualizer needs to remember aspects of the norm setup
+        // so that it can avoid making queries for unconfigured or
+        // missing normalization DBs.
+        var norm_resources = response.normalization_config || [];
+        $.each(norm_resources, function(normNo, norm) {
+          var normName = norm[0];
+          var serverDb = norm[3];
+          normServerDbByNormDbName[normName] = serverDb;
+        });
+      }
+
+      var setupSearchTypes = function(response) {
+        addSpanTypesToSelect($('#search_form_entity_type'), response.entity_types);
+        addSpanTypesToSelect($('#search_form_event_type'), response.event_types);
+        addSpanTypesToSelect($('#search_form_relation_type'), response.relation_types);
+        // nice-looking selects and upload fields
+        $('#search_form select').addClass('ui-widget ui-state-default ui-button-text');
+        $('#search_form_load_file').addClass('ui-widget ui-state-default ui-button-text');
+      }
+
+      // when event role changes, event types do as well
+      var searchEventRoles = [];
+      var searchEventRoleChanged = function(evt) {
+        var $type = $(this).parent().next().children('select');
+        var type = $type.val();
+        var role = $(this).val();
+        var origin = $('#search_form_event_type').val();
+        var eventType = spanTypes[origin];
+        var arcTypes = eventType && eventType.arcs || [];
+        var arcType = null;
+        $type.html('<option value="">- Any -</option>');
+        $.each(arcTypes, function(arcNo, arcDesc) {
+          if (arcDesc.type == role) {
+            arcType = arcDesc;
+            return false;
+          }
+        });
+        var targets = arcType && arcType.targets || [];
+        $.each(targets, function(targetNo, target) {
+          var spanType = spanTypes[target];
+          var spanName = spanType.name || spanType.labels[0] || target;
+          var option = '<option value="' + Util.escapeQuotes(target) + '">' + Util.escapeHTML(spanName) + '</option>'
+          $type.append(option);
+        });
+        // return the type to the same value, if possible
+        if (type) {
+          $type.val(type);
+        };
+      };
+
+      $('#search_form_event_roles .search_event_role select').live('change', searchEventRoleChanged);
+
+      // adding new role rows
+      var addEmptySearchEventRole = function() {
+        var $roles = $('#search_form_event_roles');
+        var rowNo = $roles.children().length;
+        var $role = $('<select class="fullwidth"/>');
+        $role.append('<option value="">- Any -</option>');
+        $.each(searchEventRoles, function(arcTypePairNo, arcTypePair) {
+          var option = '<option value="' + Util.escapeQuotes(arcTypePair[0]) + '">' + Util.escapeHTML(arcTypePair[1]) + '</option>'
+          $role.append(option);
+        });
+        var $type = $('<select class="fullwidth"/>');
+        var $text = $('<input class="fullwidth"/>');
+        var button = $('<input type="button"/>');
+        var rowButton = $('<td/>').append(button);
+        if (rowNo) {
+          rowButton.addClass('search_event_role_del');
+          button.val('\u2013'); // n-dash
+        } else {
+          rowButton.addClass('search_event_role_add');
+          button.val('+');
+        }
+        var $tr = $('<tr/>').
+          append($('<td class="search_event_role"/>').append($role)).
+          append($('<td class="search_event_type"/>').append($type)).
+          append($('<td class="search_event_text"/>').append($text)).
+          append(rowButton);
+        $roles.append($tr);
+        $role.trigger('change');
+        // style selector
+        $role.addClass('ui-widget ui-state-default ui-button-text');
+        $type.addClass('ui-widget ui-state-default ui-button-text');
+        // style button
+        button.button();
+        button.addClass('small-buttons ui-button-text').removeClass('ui-button');
+      };
+
+      // deleting role rows
+      var delSearchEventRole = function(evt) {
+        $row = $(this).closest('tr');
+        $row.remove();
+      }
+
+      $('#search_form_event_roles .search_event_role_add input').live('click', addEmptySearchEventRole);
+      $('#search_form_event_roles .search_event_role_del input').live('click', delSearchEventRole);
+
+      // When event type changes, the event roles do as well
+      // Also, put in one empty role row
+      $('#search_form_event_type').change(function(evt) {
+        var $roles = $('#search_form_event_roles').empty();
+        searchEventRoles = [];
+        var eventType = spanTypes[$(this).val()];
+        var arcTypes = eventType && eventType.arcs || [];
+        $.each(arcTypes, function(arcTypeNo, arcType) {
+          var arcTypeName = arcType.labels && arcType.labels[0] || arcType.type;
+          searchEventRoles.push([arcType.type, arcTypeName]);
+        });
+        addEmptySearchEventRole();
+      });
+
+      // when relation changes, change choices of arg1 type
+      $('#search_form_relation_type').change(function(evt) {
+        var relTypeType = $(this).val();
+        var $arg1 = $('#search_form_relation_arg1_type').
+            html('<option value="">- Any -</option>');
+        var $arg2 = $('#search_form_relation_arg2_type').empty();
+        $.each(spanTypes,
+          function(spanTypeType, spanType) {
+          if (spanType.arcs) {
+            $.each(spanType.arcs, function(arcTypeNo, arcType) {
+              if (arcType.type === relTypeType) {
+                var spanName = spanType.name;
+                var option = '<option value="' + Util.escapeQuotes(spanTypeType) + '">' + Util.escapeHTML(spanName) + '</option>'
+                $arg1.append(option);
+              }
+            });
+          }
+        });
+        $('#search_form_relation_arg1_type').change();
+        // style the selects
+        $arg1.addClass('ui-widget ui-state-default ui-button-text');
+        $arg2.addClass('ui-widget ui-state-default ui-button-text');
+      });
+
+      // when arg1 type changes, change choices of arg2 type
+      $('#search_form_relation_arg1_type').change(function(evt) {
+        var $arg2 = $('#search_form_relation_arg2_type').
+            html('<option value="">- Any -</option>');
+        var relType = $('#search_form_relation_type').val();
+        var arg1Type = spanTypes[$(this).val()];
+        var arcTypes = arg1Type && arg1Type.arcs || [];
+        var arcType = null;
+        $.each(arcTypes, function(arcNo, arcDesc) {
+          if (arcDesc.type == relType) {
+            arcType = arcDesc;
+            return false;
+          }
+        });
+        if (arcType && arcType.targets) {
+          $.each(arcType.targets, function(spanTypeNo, spanTypeType) {
+            var spanName = Util.spanDisplayForm(spanTypes, spanTypeType);
+            var option = '<option value="' + Util.escapeQuotes(spanTypeType) + '">' + Util.escapeHTML(spanName) + '</option>'
+            $arg2.append(option);
+          });
+        }
+      });
+
+      $('#search_form_note_category').change(function(evt) {
+        var category = $(this).val();
+        var $type = $('#search_form_note_type');
+        if ($.inArray(category, ['entity', 'event', 'relation']) != -1) {
+          $type.html($('#search_form_' + category + '_type').html()).val('');
+          $('#search_form_note_type_row:not(:visible)').show('highlight');
+        } else {
+          $type.html('');
+          $('#search_form_note_type_row:visible').hide('highlight');
+        }
+      });
+
+
+      // context length setting should only be visible if
+      // concordancing is on
+      // TODO: @amadanmath: help, my jQuery is horrible
+      if ($('#concordancing_on').is(':checked')) {
+        $('#context_size_div').show("highlight");
+      } else {
+        $('#context_size_div').hide("highlight");
+      }
+      $('#concordancing input[type="radio"]').change(function() {
+        if ($('#concordancing_on').is(':checked')) {
+          $('#context_size_div').show("highlight");
+        } else {
+          $('#context_size_div').hide("highlight");
+        }
+      });
+      $('#search_options div.advancedOptions').hide("highlight");
+      // set up advanced search options; only visible is clicked
+      var advancedSearchOptionsVisible = false;
+      $('#advanced_search_option_toggle').click(function(evt) {
+        if (advancedSearchOptionsVisible) {
+          $('#search_options div.advancedOptions').hide("highlight");
+          $('#advanced_search_option_toggle').text("Show advanced");
+        } else {
+          $('#search_options div.advancedOptions').show("highlight");
+          $('#advanced_search_option_toggle').text("Hide advanced");
+        }
+        advancedSearchOptionsVisible = !advancedSearchOptionsVisible;
+        // block default
+        return false;
+      });
+
+      var activeSearchTab = function() {
+        // activeTab: 0 = Text, 1 = Entity, 2 = Event, 3 = Relation, 4 = Notes, 5 = Load
+        var activeTab = $('#search_tabs').tabs('option', 'selected');
+        return ['searchText', 'searchEntity', 'searchEvent',
+            'searchRelation', 'searchNote', 'searchLoad'][activeTab];
+      }
+
+      var onSearchTabSelect = function() {
+        var action = activeSearchTab();
+        switch (action) {
+          case 'searchText':
+            $('#search_form_text_text').focus().select();
+            break;
+          case 'searchEntity':
+            $('#search_form_entity_text').focus().select();
+            break;
+          case 'searchEvent':
+            $('#search_form_event_trigger').focus().select();
+            break;
+          case 'searchRelation':
+            $('#search_form_relation_type').focus().select();
+            break;
+          case 'searchNote':
+            $('#search_form_note_text').focus().select();
+            break;
+          case 'searchLoad':
+            $('#search_form_load_file').focus().select();
+            break;
+        }
+      };
+
+      // set up jQuery UI elements in search form
+      $('#search_tabs').tabs({
+        show: onSearchTabSelect
+      });
+      $('#search_form').find('.radio_group').buttonset();
+
+      var applySearchResults = function(response) {
+        if (!searchActive) {
+          collectionSortOrder = sortOrder;
+        }
+        dispatcher.post('searchResultsReceived', [response]);
+        searchActive = true;
+        updateSearchButtons();
+      };
+
+      var searchForm = $('#search_form');
+
+      var searchFormSubmit = function(evt) {
+        // hack around empty document; "" would be interpreted as
+        // missing argument by server dispatcher (issue #513)
+        // TODO: do this properly, avoiding magic strings
+        var action = activeSearchTab();
+        var docArg = doc ? doc : "/NO-DOCUMENT/";
+        var opts = {
+          action : action,
+          collection : coll,
+          document: docArg,
+          // TODO the search form got complex :)
+        };
+
+        switch (action) {
+          case 'searchText':
+            opts.text = $('#search_form_text_text').val();
+            if (!opts.text.length) {
+              dispatcher.post('messages', [[['Please fill in the text to search for!', 'comment']]]);
+              return false;
+            }
+            break;
+          case 'searchEntity':
+            opts.type = $('#search_form_entity_type').val() || '';
+            opts.text = $('#search_form_entity_text').val();
+            break;
+          case 'searchEvent':
+            opts.type = $('#search_form_event_type').val() || '';
+            opts.trigger = $('#search_form_event_trigger').val();
+            var eargs = [];
+            $('#search_form_event_roles tr').each(function() {
+              var earg = {};
+              earg.role = $(this).find('.search_event_role select').val() || '';
+              earg.type = $(this).find('.search_event_type select').val() || '';
+              earg.text = $(this).find('.search_event_text input').val();
+              eargs.push(earg);
+            });
+            opts.args = $.toJSON(eargs);
+            break;
+          case 'searchRelation':
+            opts.type = $('#search_form_relation_type').val() || '';
+            opts.arg1 = $('#search_form_relation_arg1_text').val();
+            opts.arg1type = $('#search_form_relation_arg1_type').val() || '';
+            opts.arg2 = $('#search_form_relation_arg2_text').val();
+            opts.arg2type = $('#search_form_relation_arg2_type').val() || '';
+            break;
+          case 'searchNote':
+            opts.category = $('#search_form_note_category').val() || '';
+            opts.type = $('#search_form_note_type').val() || '';
+            opts.text = $('#search_form_note_text').val() || '';
+            break;
+          case 'searchLoad':
+            applySearchResults(loadedSearchData);
+            return false;
+        }
+
+        // fill in scope of search ("document" / "collection")
+        var searchScope = $('#search_scope input:checked').val();
+        opts.scope = searchScope;
+
+        // adjust specific action to invoke by scope
+        if (searchScope == "document") {
+          opts.action = opts.action + "InDocument";
+        } else {
+          opts.action = opts.action + "InCollection";
+        }
+
+        // fill in concordancing options
+        opts.concordancing = $('#concordancing_on').is(':checked');
+        opts.context_length = $('#context_length').val();
+
+        // fill in text match options
+        opts.text_match = $('#text_match input:checked').val()
+        opts.match_case = $('#match_case_on').is(':checked');
+
+        dispatcher.post('hideForm');
+        dispatcher.post('ajax', [opts, function(response) {
+          if(response && response.items && response.items.length == 0) {
+            // TODO: might consider having this message come from the
+            // server instead
+            dispatcher.post('messages', [[['No matches to search.', 'comment']]]);
+            dispatcher.post('clearSearch', [true]);
+          } else {
+            applySearchResults(response);
+          }
+        }]);
+        return false;
+      };
+
+      $('#search_form_load_file').change(function(evt) {
+        var $file = $('#search_form_load_file');
+        var file = $file[0].files[0];
+        var reader = new FileReader();
+        reader.onerror = function(evt) {
+          dispatcher.post('messages', [[['The file could not be read.', 'error']]]);
+        };
+        reader.onloadend = function(evt) {
+          try {
+            loadedSearchData = JSON.parse(evt.target.result);
+            // TODO XXX check for validity of contents, not just whether
+            // it's valid JSON or not; throw something if not
+          } catch (x) {
+            dispatcher.post('messages', [[['The file contains invalid data.', 'error']]]);
+            return;
+          }
+        };
+        reader.readAsText(file);
+      });
+
+      searchForm.submit(searchFormSubmit);
+
+      initForm(searchForm, {
+          width: 500,
+          // alsoResize: '#search_tabs',
+          resizable: false,
+          open: function(evt) {
+            keymap = {};
+          },
+      });
+      $('#search_form_clear').attr('title', 'Clear the search and resume normal collection browsing');
+
+      var showSearchForm = function() {
+        // this.checked = searchActive; // TODO: dup? unnecessary? remove if yes.
+        updateSearchButtons();
+        $('#search_form_event_type').change();
+        $('#search_form_relation_type').change();
+        dispatcher.post('showForm', [searchForm]);
+        onSearchTabSelect();
+      }
+
+      $('#search_button').click(showSearchForm);
+
+      var clearSearchResults = function() {
+        // clear UI, don't show collection browser
+        dispatcher.post('clearSearch', [true]);
+        // TODO: this was the only way I found to reset search. It
+        // trigger an unnecessary round-trip to the server, though,
+        // so there should be a better way ...
+        dispatcher.post('setArguments', [{}, true]);
+      }
+
+      $('#clear_search_button').click(clearSearchResults);
+
+      var updateSearchButtons = function() {
+        $searchButton = $('#search_button');
+        $searchButton[0].checked = searchActive;
+        $searchButton.button('refresh');
+        $clearSearchButton = $('#clear_search_button');
+        if (searchActive) {
+            // TODO: this is a bit poor form, using jQuery UI classes
+            // directly -- are these names guaranteed to be stable?
+            $('#search_button_label').removeClass('ui-corner-all');
+            $('#search_button_label').addClass('ui-corner-left');
+            $clearSearchButton.show();
+        } else {
+            $('#search_button_label').removeClass('ui-corner-left');
+            $('#search_button_label').addClass('ui-corner-all');
+            $clearSearchButton.hide();
+        }
+      }
+
+      /* END search - related */
+
+
+      /* START data dialog - related */
+
+      var dataForm = $('#data_form');
+      var dataFormSubmit = function(evt) {
+        dispatcher.post('hideForm');
+        return false;
+      };
+      dataForm.submit(dataFormSubmit);
+      initForm(dataForm, {
+          width: 500,
+          resizable: false,
+          no_cancel: true,
+          open: function(evt) {
+            keymap = {};
+            // aspects of the data form relating to the current document should
+            // only be shown when a document is selected.
+            if (!doc) {
+              $('#document_export').hide();
+              $('#document_visualization').hide();
+            } else {
+              $('#document_export').show();
+              $('#document_visualization').show();
+              // the SVG button can only be accessed through the data form,
+              // so we'll spare unnecessary saves by only saving here
+              saveSVG();
+            }
+          }
+      });
+      $('#data_button').click(function() {
+        dispatcher.post('showForm', [dataForm]);
+      });
+      // make nice-looking buttons for checkboxes and buttons
+      $('#data_form').find('input[type="checkbox"]').button();
+      $('#data_form').find('input[type="button"]').button();
+
+      // resize invalidates stored visualization (SVG etc.); add a
+      // button to regen
+      $('#stored_file_regenerate').button().hide();
+      $('#stored_file_regenerate').click(function(evt) {
+        $('#stored_file_regenerate').hide();
+        saveSVG();
+      });
+
+      /* END data dialog - related */
+
+
+      /* START options dialog - related */
+
+      var optionsForm = $('#options_form');
+      var optionsFormSubmit = function(evt) {
+        dispatcher.post('hideForm');
+        return false;
+      };
+      optionsForm.submit(optionsFormSubmit);
+      initForm(optionsForm, {
+          width: 550,
+          resizable: false,
+          no_cancel: true,
+          open: function(evt) {
+            keymap = {};
+          }
+      });
+      $('#options_button').click(function() {
+        dispatcher.post('showForm', [optionsForm]);
+      });
+      // make nice-looking buttons for checkboxes and radios
+      $('#options_form').find('input[type="checkbox"]').button();
+      $('#options_form').find('.radio_group').buttonset();
+      $('#rapid_model').addClass('ui-widget ui-state-default ui-button-text');
+
+      var fillDisambiguatorOptions = function(disambiguators) {
+        $('#annotation_speed3').button(disambiguators.length ? 'enable': 'disable');
+        //XXX: We need to disable rapid in the conf too if it is not available
+        var $rapid_mode = $('#rapid_model').html('');
+        $.each(disambiguators, function(modelNo, model) {
+          var $option = $('<option/>').attr('value', model[2]).text(model[2]);
+          $rapid_mode.append($option);
+        });
+      };
+
+      /* END options dialog - related */
+
+
+      /* START "more collection information" dialog - related */
+
+      var moreInfoDialog = $('#more_information_dialog');
+      var moreInfoDialogSubmit = function(evt) {
+        dispatcher.post('hideForm');
+        return false;
+      };
+      moreInfoDialog.submit(moreInfoDialogSubmit);
+      initForm(moreInfoDialog, {
+          width: 500,
+          no_cancel: true,
+          open: function(evt) {
+            keymap = {};
+          },
+          alsoResize: '#more_info_readme',
+      });
+      $('#more_readme_button').click(function() {
+        dispatcher.post('showForm', [moreInfoDialog]);
+      });
+
+      /* END "more collection information" dialog - related */
+
+
+      var onKeyDown = function(evt) {
+        var code = evt.which;
+
+        if (code === $.ui.keyCode.ESCAPE) {
+          dispatcher.post('messages', [false]);
+          return;
+        }
+
+        if (currentForm) {
+          if (code === $.ui.keyCode.ENTER) {
+            // don't trigger submit in textareas to allow multiline text
+            // entry
+            // NOTE: spec seems to require this to be upper-case,
+            // but at least chrome 8.0.552.215 returns lowercased
+            var nodeType = evt.target.type ? evt.target.type.toLowerCase() : '';
+            if (evt.target.nodeName && 
+                evt.target.nodeName.toLowerCase() == 'input' && 
+                (nodeType == 'text' || 
+                 nodeType == 'password')) {
+              currentForm.trigger('submit');
+              return false;
+            }
+          } else if (evt.ctrlKey &&
+                (code == 'F'.charCodeAt(0) || code == 'G'.charCodeAt(0))) {
+            // prevent Ctrl-F/Ctrl-G in forms
+            evt.preventDefault();
+            return false;
+          }
+          return;
+        }
+
+        if (code === $.ui.keyCode.TAB) {
+          showFileBrowser();
+          return false;
+        } else if (code == $.ui.keyCode.LEFT) {
+          return moveInFileBrowser(-1);
+        } else if (code === $.ui.keyCode.RIGHT) {
+          return moveInFileBrowser(+1);
+        } else if (evt.shiftKey && code === $.ui.keyCode.UP) {
+          autoPaging(true);
+        } else if (evt.shiftKey && code === $.ui.keyCode.DOWN) {
+          autoPaging(false);
+        } else if (evt.ctrlKey && code == 'F'.charCodeAt(0)) {
+          evt.preventDefault();
+          showSearchForm();
+        } else if (searchActive && evt.ctrlKey && code == 'G'.charCodeAt(0)) {
+          evt.preventDefault();
+          return moveInFileBrowser(+1);
+        } else if (searchActive && evt.ctrlKey && code == 'K'.charCodeAt(0)) {
+          evt.preventDefault();
+          clearSearchResults();
+        }
+      };
+
+      var moveInFileBrowser = function(dir) {
+        var pos = currentSelectorPosition();
+        var newPos = pos + dir;
+        if (newPos >= 0 && newPos < selectorData.items.length &&
+            selectorData.items[newPos][0] != "c") {
+          // not at the start, and the previous is not a collection (dir)
+          dispatcher.post('allowReloadByURL');
+          dispatcher.post('setDocument', [selectorData.items[newPos][2],
+                                          selectorData.items[newPos][1]]);
+        }
+        return false;
+      };
+     
+      /* Automatically proceed from document to document */ 
+      var autoPagingTimeout = null;
+      var autoPaging = function(on) {
+          clearTimeout(autoPagingTimeout);
+          if (on) {
+            autoPagingTimeout = setInterval(function() {
+              moveInFileBrowser(+1);
+            }, 2000);
+          }
+      };
+
+      var resizeFunction = function(evt) {
+        dispatcher.post('renderData');
+      };
+
+      var resizerTimeout = null;
+      var onResize = function(evt) {
+        if (evt.target === window) {
+          clearTimeout(resizerTimeout);
+          resizerTimeout = setTimeout(resizeFunction, 100); // TODO is 100ms okay?
+        }
+      };
+
+      var collectionLoaded = function(response) {
+        if (response.exception) {
+          if (response.exception == 'annotationCollectionNotFound' ||
+              response.exception == 'collectionNotAccessible') {
+              // revert to last good
+              dispatcher.post('setCollection', [lastGoodCollection]);
+          } else {
+              dispatcher.post('messages', [[['Unknown error: ' + response.exception, 'error']]]);
+              dispatcher.post('setCollection', ['/']);
+          }
+        } else {
+          lastGoodCollection = response.collection;
+          fillDisambiguatorOptions(response.disambiguator_config);
+          selectorData = response;
+          documentListing = response; // 'backup'
+          searchConfig = response.search_config;
+          selectorData.items.sort(docSortFunction);
+          setupSearchTypes(response);
+          // scroller at the top
+          docScroll = 0;
+        }
+      };
+
+      var searchResultsReceived = function(response) {
+        if (response.exception) {
+            ; // TODO: reasonable reaction
+        } else {
+          selectorData = response;
+          sortOrder = [2, 1]; // reset
+          // NOTE: don't sort, allowing order in which
+          // responses are given to be used as default
+          //selectorData.items.sort(docSortFunction);
+          if (response.action.match(/Collection$/)) {
+            showFileBrowser();
+          } else {
+            var item = response.items[0];
+            dispatcher.post('setDocument', [item[2], item[1]]);
+          }
+          $('#save_search').css('display', 'inline-block');
+        }
+      };
+
+      var clearSearch = function(dontShowFileBrowser) {
+        dispatcher.post('hideForm');
+
+        // back off to document collection
+        if (searchActive) {
+          $('#save_search').css('display', 'none');
+          selectorData = documentListing;
+          sortOrder = collectionSortOrder;
+          selectorData.items.sort(docSortFunction);
+          searchActive = false;
+          updateSearchButtons();
+        }
+
+        if (!dontShowFileBrowser) {
+          showFileBrowser();
+        }
+      }
+
+      var saveSVGTimer = null;
+      var saveSVG = function() {
+        if (currentDocumentSVGsaved) {
+          // no need to store again
+          return false;
+        }
+        clearTimeout(saveSVGTimer);
+        $('#stored_file_regenerate').hide();
+        $('#stored_file_spinner').show()
+        saveSVGTimer = dispatcher.post(1, 'ajax', [{
+          action: 'storeSVG',
+          svg: $('#svg').html(),
+          collection: coll,
+          document: doc
+        }, 'savedSVG']);
+      };
+
+      var onDoneRendering = function(coll, doc, args) {
+        if (args && !args.edited) {
+          var svgtop = $('svg').offset().top;
+          var $inFocus = $('#svg animate[data-type="focus"]:first').parent();
+          if ($inFocus.length) {
+            $('html,body').
+                animate({ scrollTop: $inFocus.offset().top - svgtop - window.innerHeight / 2 }, { duration: 'slow', easing: 'swing'});
+          }
+        }
+        dispatcher.post('allowReloadByURL');
+        if (!currentForm) {
+          $('#waiter').dialog('close');
+        }
+      }
+
+      var onStartedRendering = function() {
+        hideForm();
+        if (!currentForm) {
+          $('#waiter').dialog('open');
+        }
+      }
+
+      var savedSVGreceived = function(response) {
+        $('#stored_file_spinner').hide()
+
+        if (response && response.exception == 'corruptSVG') {
+          dispatcher.post('messages', [[['Cannot save SVG: corrupt', 'error']]]);
+          return;
+        }
+        var $downloadStored = $('#download_stored').empty().show();
+        $.each(response.stored, function(storedNo, stored) {
+          var params = {
+            'action': 'retrieveStored',
+            'document': doc,
+            'suffix': stored.suffix,
+            // TODO: Extract the protocol version into somewhere global
+            'protocol': 1
+          };
+          var $downloadLink = $('<a id="download_'+stored.name+'"' +
+                                ' target="'+stored.name+'"' +
+                                '>'+stored.name+'</a>');
+          $downloadLink.attr('href', 'ajax.cgi?' + $.param(params));
+          $downloadLink.button();
+          if (storedNo) $downloadStored.append(' ');
+          $downloadStored.append($downloadLink);
+        });
+        currentDocumentSVGsaved = true;
+      };
+
+      var invalidateSavedSVG = function() {
+        // assuming that invalidation of the SVG invalidates all stored
+        // static visualizations, as others are derived from the SVG
+        $('#download_stored').hide();
+        // have a way to regenerate if dialog open when data invalidated
+        $('#stored_file_regenerate').show();
+        currentDocumentSVGsaved = false;
+      };
+
+      var onNewSourceData = function(sourceData) {
+        if (!sourceData) return;
+        var $sourceFiles = $('#source_files').empty();
+        /* Add download links for all available extensions */
+        $.each(sourceData.source_files, function(extNo, ext) {
+          var $link = $('<a target="brat_search"/>').
+              text(ext).
+              attr('href',
+                  'ajax.cgi?action=downloadFile&collection=' + encodeURIComponent(coll) +
+                  '&document=' + encodeURIComponent(doc) + '&extension=' + encodeURIComponent(ext) +
+                  // TODO: Extract the protocol version into somewhere global
+                  '&protocol=' + 1);
+          $link.button();
+          if (extNo) $sourceFiles.append(' ');
+          $sourceFiles.append($link);
+        });
+        /* Add a download link for the whole collection */
+        invalidateSavedSVG();
+
+        mtime = sourceData.mtime;
+        if (mtime) {
+          // we're getting seconds and need milliseconds
+          //$('#document_ctime').text("Created: " + Annotator.formatTime(1000 * sourceData.ctime)).css("display", "inline");
+          $('#document_mtime').text("Last modified: " + Util.formatTimeAgo(1000 * mtime)).show();
+        } else {
+          //$('#document_ctime').css("display", "none");
+          $('#document_mtime').hide();
+        }
+      }
+
+      var gotCurrent = function(_coll, _doc, _args) {
+        var oldColl = coll;
+
+        coll = _coll;
+        doc = _doc;
+        args = _args;
+
+        // if we have a specific document, hide the "no document" message
+        if (_doc) {
+          hideNoDocMessage();
+        }
+
+        // if we have a collection change, update "collection download" and
+        // "side-by-side comparison" buttons
+        if (oldColl != coll) {
+          var $sourceCollection = $('#source_collection').empty();
+          var $collectionDownloadLink = $('<a target="brat_search"/>')
+            .text('Download tar.gz')
+            .attr('href', 'ajax.cgi?action=downloadCollection&collection=' + encodeURIComponent(coll)
+            // TODO: Extract the protocol version into somewhere global
+            + '&protocol=' + 1);
+          $sourceCollection.append($collectionDownloadLink);
+          $collectionDownloadLink.button();
+
+          $cmpButton = $('#side-by-side_cmp').empty();
+          var $cmpLink = $('<a target="_blank"/>')
+            .text('Comparison mode')
+            .attr('href', 'diff.xhtml?diff=' + encodeURIComponent(coll));
+          $cmpButton.append($cmpLink);
+          $cmpLink.button();
+        }
+          
+        $docName = $('#document_name input').val(coll + doc);
+        var docName = $docName[0];
+        // TODO do this on resize, as well
+        // scroll the document name to the right, so the name is visible
+        // (even if the collection name isn't, fully)
+        docName.scrollLeft = docName.scrollWidth;
+
+        $('#document_mtime').hide();
+        invalidateSavedSVG();
+      };
+
+      var slideToggle = function(el, show, autoHeight, bottom) {
+        var el = $(el);
+        var visible = el.is(":visible");
+        var height;
+
+        if (show === undefined) show = !visible;
+
+        // @amadanmath: commenting this out appears to remove the annoying
+        // misfeature where it's possible to stop the menu halfway by
+        // mousing out and back in during closing. Please check that
+        // this doesn't introduce other trouble and remove these lines.
+//         if (show === visible) return false;
+
+        if (!autoHeight) {
+          height = el.data("cachedHeight");
+        } else {
+          el.height('auto');
+        }
+        if (!height) {
+          height = el.show().height();
+          el.data('cachedHeight', height);
+          if (!visible) el.hide().css({ height: 0 });
+        }
+
+        if (show) {
+          el.show().animate({ height: height }, {
+            duration: 150,
+            complete: function() {
+              if (autoHeight) {
+                el.height('auto');
+              }
+            },
+            step: bottom ? function(now, fx) {
+              fx.elem.scrollTop = fx.elem.scrollHeight;
+            } : undefined
+          });
+        } else {
+          el.animate({ height: 0 }, {
+            duration: 300,
+            complete: function() {
+              el.hide();
+            }
+          });
+        }
+      }
+
+      var menuTimer = null;
+      $('#header').
+        mouseenter(function(evt) {
+          clearTimeout(menuTimer);
+          slideToggle($('#pulldown').stop(), true);
+        }).
+        mouseleave(function(evt) {
+          clearTimeout(menuTimer);
+          menuTimer = setTimeout(function() {
+            slideToggle($('#pulldown').stop(), false);
+          }, 500);
+        });
+
+      $('#label_abbreviations input').click(function(evt) {
+        var val = this.value;
+        val = val === 'on';
+        if (val) {
+          dispatcher.post('messages', [[['Abbreviations are now on', 'comment']]]);
+        } else {
+          dispatcher.post('messages', [[['Abbreviations are now off', 'comment']]]);
+        }
+        dispatcher.post('abbrevs', [val]);
+        // TODO: XXX: for some insane reason, doing the following call
+        // synchronously breaks the checkbox (#456). If you ever figure
+        // out why, it would make more sense to call
+        //    dispatcher.post('resetData');
+        // without the asynch.
+        dispatcher.post(1, 'resetData');
+      });
+
+      $('#text_backgrounds input').click(function(evt) {
+        var val = this.value;
+        dispatcher.post('textBackgrounds', [val]);
+        // TODO: XXX: see comment above for why this is asynchronous
+        dispatcher.post(1, 'resetData');
+      });
+
+      $('#layout_density input').click(function(evt) {
+        var val = this.value;
+        dispatcher.post('layoutDensity', [val]);
+        // TODO: XXX: see comment above for why this is asynchronous
+        dispatcher.post(1, 'resetData');
+        return false;
+      });
+
+      $('#svg_width_unit input').click(function(evt) {
+        var width_unit = this.value;
+        var width_value = $('#svg_width_value')[0].value;
+        var val = width_value+width_unit;
+        dispatcher.post('svgWidth', [val]);
+        // TODO: XXX: see comment above for why this is asynchronous
+        dispatcher.post(1, 'resetData');
+        return false;
+      });
+
+      $('#annotation_speed input').click(function(evt) {
+        var val = this.value;
+        dispatcher.post('annotationSpeed', [val]);
+        return false;
+      });      
+    
+      $('#pulldown').find('input').button();
+      var headerHeight = $('#mainHeader').height();
+      $('#svg').css('margin-top', headerHeight + 10);
+      aboutDialog = $('#about');
+      aboutDialog.dialog({
+            autoOpen: false,
+            closeOnEscape: true,
+            resizable: false,
+            modal: true,
+            open: function() {
+                aboutDialog.find('*').blur();
+              },
+            beforeClose: function() {
+                currentForm = null;
+              }
+          });
+      $('#mainlogo').click(function() {
+        showForm(aboutDialog);
+      });
+
+      // TODO: copy from annotator_ui; DRY it up
+      var adjustFormToCursor = function(evt, element) {
+        var screenHeight = $(window).height() - 8; // TODO HACK - no idea why -8 is needed
+        var screenWidth = $(window).width() - 8;
+        var elementHeight = element.height();
+        var elementWidth = element.width();
+        var y = Math.min(evt.clientY, screenHeight - elementHeight);
+        var x = Math.min(evt.clientX, screenWidth - elementWidth);
+        element.css({ top: y, left: x });
+      };
+      var viewspanForm = $('#viewspan_form');
+      var onDblClick = function(evt) {
+        if (user && annotationAvailable) return;
+        var target = $(evt.target);
+        var id;
+        if (id = target.attr('data-span-id')) {
+          window.getSelection().removeAllRanges();
+          var span = data.spans[id];
+
+          var urlHash = URLHash.parse(window.location.hash);
+          urlHash.setArgument('focus', [[span.id]]);
+          $('#viewspan_highlight_link').show().attr('href', urlHash.getHash());
+
+          $('#viewspan_selected').text(span.text);
+          var encodedText = encodeURIComponent(span.text);
+          $.each(searchConfig, function(searchNo, search) {
+            $('#viewspan_'+search[0]).attr('href', search[1].replace('%s', encodedText));
+          });
+          // annotator comments
+          $('#viewspan_notes').val(span.annotatorNotes || '');
+          dispatcher.post('showForm', [viewspanForm]);
+          $('#viewspan_form-ok').focus();
+          adjustFormToCursor(evt, viewspanForm.parent());
+        }
+      };
+      viewspanForm.submit(function(evt) {
+        dispatcher.post('hideForm');
+        return false;
+      });
+
+      var authForm = $('#auth_form');
+      initForm(authForm, { resizable: false });
+      var authFormSubmit = function(evt) {
+        dispatcher.post('hideForm');
+        var _user = $('#auth_user').val();
+        var password = $('#auth_pass').val();
+        dispatcher.post('ajax', [{
+            action: 'login',
+            user: _user,
+            password: password,
+          },
+          function(response) {
+              if (response.exception) {
+                dispatcher.post('showForm', [authForm]);
+                $('#auth_user').select().focus();
+              } else {
+                user = _user;
+                $('#auth_button').val('Logout ' + user);
+                $('#auth_user').val('');
+                $('#auth_pass').val('');
+                $('.login').show();
+                dispatcher.post('user', [user]);
+              }
+          }]);
+        return false;
+      };
+      $('#auth_button').click(function(evt) {
+        if (user) {
+          dispatcher.post('ajax', [{
+            action: 'logout'
+          }, function(response) {
+            user = null;
+            $('#auth_button').val('Login');
+            $('.login').hide();
+            dispatcher.post('user', [null]);
+          }]);
+        } else {
+          dispatcher.post('showForm', [authForm]);
+        }
+      });
+      authForm.submit(authFormSubmit);
+
+
+      var tutorialForm = $('#tutorial');
+      if (!$.browser.webkit) {
+        // Inject the browser warning
+        $('#browserwarning').css('display', 'block');
+      }
+      initForm(tutorialForm, {
+        width: 800,
+        height: 600,
+        no_cancel: true,
+        no_ok: true,
+        buttons: [{
+          id: "tutorial-ok",
+          text: "OK",
+          click: function() { tutorialForm.dialog('close'); }
+        }],
+        close: function() {
+          if (fileBrowserWaiting) {
+            showFileBrowser();
+          }
+        }
+      });
+
+      var init = function() {
+        dispatcher.post('initForm', [viewspanForm, {
+            width: 760,
+            no_cancel: true
+          }]);
+        dispatcher.post('ajax', [{
+            action: 'whoami'
+          }, function(response) {
+            var auth_button = $('#auth_button');
+            if (response.user) {
+              user = response.user;
+              dispatcher.post('messages', [[['Welcome back, user "' + user + '"', 'comment']]]);
+              auth_button.val('Logout ' + user);
+              dispatcher.post('user', [user]);
+              $('.login').show();
+            } else {
+              user = null;
+              auth_button.val('Login');
+              dispatcher.post('user', [null]);
+              $('.login').hide();
+              // don't show tutorial if there's a specific document (annoyance)
+              if (!doc) {
+                dispatcher.post('showForm', [tutorialForm]);
+                $('#tutorial-ok').focus();
+              }
+            }
+          },
+          { keep: true }
+        ]);
+        dispatcher.post('ajax', [{ action: 'loadConf' }, function(response) {
+          if (response.config != undefined) {
+            // TODO: check for exceptions
+            try {
+              Configuration = JSON.parse(response.config);
+            } catch(x) {
+              // XXX Bad config
+              Configuration = {};
+              dispatcher.post('messages', [[['Corrupted configuration; resetting.', 'error']]]);
+              configurationChanged();
+            }
+            // TODO: make whole-object assignment work
+            // @amadanmath: help! This code is horrible
+            // Configuration.svgWidth = storedConf.svgWidth;
+            dispatcher.post('svgWidth', [Configuration.svgWidth]);
+            // Configuration.abbrevsOn = storedConf.abbrevsOn == "true";
+            // Configuration.textBackgrounds = storedConf.textBackgrounds;
+            // Configuration.rapidModeOn = storedConf.rapidModeOn == "true";
+            // Configuration.confirmModeOn = storedConf.confirmModeOn == "true";
+            // Configuration.autorefreshOn = storedConf.autorefreshOn == "true";
+            if (Configuration.autorefreshOn) {
+              checkForDocumentChanges();
+            }
+            // Configuration.visual.margin.x = parseInt(storedConf.visual.margin.x);
+            // Configuration.visual.margin.y = parseInt(storedConf.visual.margin.y);
+            // Configuration.visual.boxSpacing = parseInt(storedConf.visual.boxSpacing);
+            // Configuration.visual.curlyHeight = parseInt(storedConf.visual.curlyHeight);
+            // Configuration.visual.arcSpacing = parseInt(storedConf.visual.arcSpacing);
+            // Configuration.visual.arcStartHeight = parseInt(storedConf.visual.arcStartHeight);
+          }
+          dispatcher.post('configurationUpdated');
+        }]);
+      };
+
+      var noFileSpecified = function() {
+        // not (only) an error, so no messaging
+        dispatcher.post('clearSVG');
+        showFileBrowser();
+      }
+
+      var showUnableToReadTextFile = function() {
+        dispatcher.post('messages', [[['Unable to read the text file.', 'error']]]);
+        dispatcher.post('clearSVG');
+        showFileBrowser();
+      };
+
+      var showAnnotationFileNotFound = function() {
+        dispatcher.post('messages', [[['Annotation file not found.', 'error']]]);
+        dispatcher.post('clearSVG');
+        showFileBrowser();
+      };
+
+      var showUnknownError = function(exception) {
+        dispatcher.post('messages', [[['Unknown error: ' + exception, 'error']]]);
+        dispatcher.post('clearSVG');
+        showFileBrowser();
+      };
+
+      var reloadDirectoryWithSlash = function(sourceData) {
+        var collection = sourceData.collection + sourceData.document + '/';
+        dispatcher.post('setCollection', [collection, '', sourceData.arguments]);
+      };
+
+      // TODO: confirm attributeTypes unnecessary and remove
+//       var spanAndAttributeTypesLoaded = function(_spanTypes, _attributeTypes) {
+//         spanTypes = _spanTypes;
+//         attributeTypes = _attributeTypes;
+//       };
+      // TODO: spanAndAttributeTypesLoaded is obviously not descriptive of
+      // the full function. Rename reasonably.
+      var spanAndAttributeTypesLoaded = function(_spanTypes, _entityAttributeTypes, _eventAttributeTypes, _relationTypesHash) {
+        spanTypes = _spanTypes;
+        relationTypesHash = _relationTypesHash;
+      };
+
+      var annotationIsAvailable = function() {
+        annotationAvailable = true;
+      };
+
+      // hide anything requiring login, just in case
+      $('.login').hide();
+
+      // XXX TODO a lot
+      var touchStart;
+      var onTouchStart = function(evt) {
+        // evt.preventDefault();
+        evt = evt.originalEvent;
+        if (evt.touches.length == 1) {
+          // single touch; start tracking to see if we're doing
+          // left/right
+          touchStart = $.extend({}, evt.touches[0]); // clone
+        } else if (evt.touches.length == 4) {
+          // 4 finger tap: file browser
+          showFileBrowser();
+          return false;
+        }
+      };
+      var onTouchEnd = function(evt) {
+        // evt.preventDefault();
+        evt = evt.originalEvent;
+        $.each(evt.changedTouches, function(touchEndNo, touchEnd) {
+          if (touchStart.identifier == touchEnd.identifier) {
+            var dx = touchEnd.screenX - touchStart.screenX;
+            var dy = touchEnd.screenY - touchStart.screenY;
+            var adx = Math.abs(dx);
+            var ady = Math.abs(dy);
+            if (adx > 200 && ady < adx / 2) {
+              // it's left/right!
+              return moveInFileBrowser(dx < 0 ? -1 : +1);
+            }
+          }
+        });
+      };
+
+      var documentChangesTimer = null;
+      var maxDocumentChangesTimeout = 32 * 1000;
+      var documentChangesTimeout = 1 * 1000;
+      var checkForDocumentChanges = function() {
+        if (coll && doc && dispatcher.post('isReloadOkay', [], 'all')) {
+          opts = {
+            'action': 'getDocumentTimestamp',
+            'collection': coll,
+            'document': doc
+          }
+          dispatcher.post('ajax', [opts, function(response) {
+            if (data) {
+              if (mtime != response.mtime) {
+                dispatcher.post('current', [coll, doc, args, true]);
+                documentChangesTimeout = 1 * 1000;
+              } else {
+                documentChangesTimeout *= 2;
+                if (documentChangesTimeout >= maxDocumentChangesTimeout)
+                  documentChangesTimeout = maxDocumentChangesTimeout;
+              }
+            }
+          }]);
+        } else {
+          documentChangesTimeout = 1 * 1000;
+        }
+        documentChangesTimer = setTimeout(checkForDocumentChanges, documentChangesTimeout);
+      }
+
+      if (Configuration.autorefreshOn) {
+        checkForDocumentChanges();
+      }
+
+      $('#autorefresh_mode').click(function(evt) {
+        var val = this.checked;
+        if (val) {
+          Configuration.autorefreshOn = true;
+          checkForDocumentChanges();
+          dispatcher.post('messages', [[['Autorefresh mode is now on', 'comment']]]);
+        } else {
+          Configuration.autorefreshOn = false;
+          clearTimeout(documentChangesTimer);
+          dispatcher.post('messages', [[['Autorefresh mode is now off', 'comment']]]);
+        }
+        dispatcher.post('configurationChanged');
+      });
+
+      var isReloadOkay = function() {
+        // do not reload while the user is in the dialog
+        return currentForm == null;
+      };
+
+      var configurationChanged = function() {
+        // just assume that any config change makes stored
+        // visualizations invalid. This is a bit excessive (not all
+        // options affect visualization) but mostly harmless.
+        invalidateSavedSVG();
+
+        // save configuration changed by user action
+        dispatcher.post('ajax', [{
+                    action: 'saveConf',
+                    config: JSON.stringify(Configuration),
+                }, null]);
+      };
+
+      var updateConfigurationUI = function() {
+        // update UI to reflect non-user config changes (e.g. load)
+        
+        // Annotation mode
+        if (Configuration.confirmModeOn) {
+          $('#annotation_speed1')[0].checked = true;
+        } else if (Configuration.rapidModeOn) {
+          $('#annotation_speed3')[0].checked = true;
+        } else {
+          $('#annotation_speed2')[0].checked = true;
+        }
+        $('#annotation_speed input').button('refresh');
+
+        // Label abbrevs
+        $('#label_abbreviations_on')[0].checked  = Configuration.abbrevsOn;
+        $('#label_abbreviations_off')[0].checked = !Configuration.abbrevsOn; 
+        $('#label_abbreviations input').button('refresh');
+
+        // Text backgrounds        
+        $('#text_backgrounds input[value="'+Configuration.textBackgrounds+'"]')[0].checked = true;
+        $('#text_backgrounds input').button('refresh');
+
+        // SVG width
+        var splitSvgWidth = Configuration.svgWidth.match(/^(.*?)(px|\%)$/);
+        if (!splitSvgWidth) {
+          // TODO: reset to sensible value?
+          dispatcher.post('messages', [[['Error parsing SVG width "'+Configuration.svgWidth+'"', 'error', 2]]]);
+        } else {
+          $('#svg_width_value')[0].value = splitSvgWidth[1];
+          $('#svg_width_unit input[value="'+splitSvgWidth[2]+'"]')[0].checked = true;
+          $('#svg_width_unit input').button('refresh');
+        }
+
+        // Autorefresh
+        $('#autorefresh_mode')[0].checked = Configuration.autorefreshOn;
+        $('#autorefresh_mode').button('refresh');
+      }
+
+      $('#prev').button().click(function() {
+        return moveInFileBrowser(-1);
+      });
+      $('#next').button().click(function() {
+        return moveInFileBrowser(+1);
+      });
+      $('#footer').show();
+
+      var rememberData = function(_data) {
+        if (_data && !_data.exception) {
+          data = _data;
+        }
+      };
+
+      var onScreamingHalt = function() {
+        $('#waiter').dialog('close');
+        $('#pulldown, #navbuttons, #spinner').remove();
+        dispatcher.post('hideForm');
+      };
+
+      dispatcher.
+          on('init', init).
+          on('dataReady', rememberData).
+          on('annotationIsAvailable', annotationIsAvailable).
+          on('messages', displayMessages).
+          on('displaySpanComment', displaySpanComment).
+          on('displayArcComment', displayArcComment).
+          on('displaySentComment', displaySentComment).
+          on('docChanged', onDocChanged).
+          on('hideComment', hideComment).
+          on('showForm', showForm).
+          on('hideForm', hideForm).
+          on('initForm', initForm).
+          on('collectionLoaded', rememberNormDb).
+          on('collectionLoaded', collectionLoaded).
+          on('spanAndAttributeTypesLoaded', spanAndAttributeTypesLoaded).
+          on('isReloadOkay', isReloadOkay).
+          on('current', gotCurrent).
+          on('doneRendering', onDoneRendering).
+          on('startedRendering', onStartedRendering).
+          on('newSourceData', onNewSourceData).
+          on('savedSVG', savedSVGreceived).
+          on('renderError:noFileSpecified', noFileSpecified).
+          on('renderError:annotationFileNotFound', showAnnotationFileNotFound).
+          on('renderError:unableToReadTextFile', showUnableToReadTextFile).
+          on('renderError:isDirectoryError', reloadDirectoryWithSlash).
+          on('unknownError', showUnknownError).
+          on('keydown', onKeyDown).
+          on('mousemove', onMouseMove).
+          on('dblclick', onDblClick).
+          on('touchstart', onTouchStart).
+          on('touchend', onTouchEnd).
+          on('resize', onResize).
+          on('searchResultsReceived', searchResultsReceived).
+          on('clearSearch', clearSearch).
+          on('clearSVG', showNoDocMessage).
+          on('screamingHalt', onScreamingHalt).
+          on('configurationChanged', configurationChanged).
+          on('configurationUpdated', updateConfigurationUI);
+    };
+
+    return VisualizerUI;
+})(jQuery, window);
Index: src/main/resources/static/static/lib/brat/src/offline_ajax.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/offline_ajax.js	(date 1594749336101)
+++ src/main/resources/static/static/lib/brat/src/offline_ajax.js	(date 1594749336101)
@@ -0,0 +1,105 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+
+// Offline data files should go into URL_BASE directory (default:
+// offline_data). Each directory should have collection.js which
+// contains the result of getCollectionInformation action, and any
+// number of *.data.js files, which contain the results of getDocument
+// actions. The contents of both should be prefixed with "jsonp =".
+
+var OfflineAjax = (function($, window, undefined) {
+    var OfflineAjax = function(dispatcher) {
+      var URL_BASE = 'offline_data';
+
+      var that = this;
+
+      // merge data will get merged into the response data
+      // before calling the callback
+      var ajaxCall = function(data, callback, merge) {
+        dispatcher.post('spin');
+
+        var url;
+        switch (data.action) {
+          case 'getDocument':
+            url = data.collection + data.document + '.data.js';
+            break;
+
+          case 'getCollectionInformation':
+            url = data.collection + 'collection.js';
+            break;
+
+          case 'whoami':
+          case 'storeSVG':
+            // ignore
+            // TODO: disable SVG links
+            dispatcher.post(0, callback, [{ user: null, messages: [], action: data.action }]);
+            dispatcher.post('unspin');
+            return;
+
+          default:
+            // an action that is not a visualisation action got through
+            alert("DEBUG TODO XXX UNSUPPORTED ALERT WHATNOW ETC: " + data.action); // XXX
+        }
+
+        // load the file
+        // NOTE: beware, there is no error checking possible in this
+        // loading method. No error handler. If the file is malformed,
+        // there will be an error that is not under our control. If the
+        // file is missing, there will be no error, and no callback -
+        // the interface will get stuck. Be sure collection.js is up to
+        // date, and no manual messing with URL :)
+        var scr = document.createElement('script');
+        scr.onload = function(evt) {
+          jsonp.messages = [];
+          if (merge) {
+            $.extend(jsonp, merge);
+          }
+          dispatcher.post(0, callback, [jsonp]);
+          dispatcher.post('unspin');
+          document.head.removeChild(evt.target);
+        };
+        scr.type = 'text/javascript';
+        scr.src = URL_BASE + url;
+        document.head.appendChild(scr);
+
+        /*
+        * Chrome "feature" prevents this nice pure JSON solution
+        * http://www.google.com/support/forum/p/Chrome/thread?tid=36708c2c62cb9b0c&hl=en
+        * http://code.google.com/p/chromium/issues/detail?id=46167
+        *
+        *
+        * chrome.exe --allow-file-access-from-files
+        * open /Applications/Google\ Chrome.app --args --allow-file-access-from-files
+        */
+        /*
+        var $iframe = $('<iframe/>');
+        $iframe.bind('load', function(evt) {
+          console.log("foo3", evt.target);
+          var json = $iframe.contents().text();
+          console.log("ok1");
+          var response = $.parseJSON(json);
+          console.log("ok2", merge, json);
+          response.messages = [];
+          response.action = [];
+          $iframe.remove();
+
+          if (merge) {
+            $.extend(response, merge);
+          }
+          dispatcher.post(0, callback, [response]);
+          dispatcher.post('unspin');
+        });
+
+        $('body').append($iframe);
+        $iframe.css('display', 'none');
+        $iframe.attr('src', URL_BASE + url);
+        console.log("foo2", $iframe);
+        */
+      };
+
+      dispatcher.
+          on('ajax', ajaxCall);
+    };
+
+    return OfflineAjax;
+})(jQuery, window);
Index: src/main/resources/static/static/lib/brat/src/configuration.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/configuration.js	(date 1594749336099)
+++ src/main/resources/static/static/lib/brat/src/configuration.js	(date 1594749336099)
@@ -0,0 +1,29 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+var Configuration = (function(window, undefined) {
+    var abbrevsOn = true;
+    var textBackgrounds = "striped";
+    var svgWidth = '100%';
+    var rapidModeOn = false;
+    var confirmModeOn = true;
+    var autorefreshOn = false;
+    
+    var visual = {
+      margin: { x: 2, y: 1 },
+      arcTextMargin: 1,
+      boxSpacing: 1,
+      curlyHeight: 4,
+      arcSpacing: 9, //10;
+      arcStartHeight: 19, //23; //25;
+    }
+
+    return {
+      abbrevsOn: abbrevsOn,
+      textBackgrounds: textBackgrounds,
+      visual: visual,
+      svgWidth: svgWidth,
+      rapidModeOn: rapidModeOn,
+      confirmModeOn: confirmModeOn,
+      autorefreshOn: autorefreshOn,
+    };
+})(window);
\ No newline at end of file
Index: .idea/libraries/Maven__org_apache_commons_commons_csv_1_8.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/libraries/Maven__org_apache_commons_commons_csv_1_8.xml	(date 1594749401085)
+++ .idea/libraries/Maven__org_apache_commons_commons_csv_1_8.xml	(date 1594749401085)
@@ -0,0 +1,13 @@
+<component name="libraryTable">
+  <library name="Maven: org.apache.commons:commons-csv:1.8">
+    <CLASSES>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/commons/commons-csv/1.8/commons-csv-1.8.jar!/" />
+    </CLASSES>
+    <JAVADOC>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/commons/commons-csv/1.8/commons-csv-1.8-javadoc.jar!/" />
+    </JAVADOC>
+    <SOURCES>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/commons/commons-csv/1.8/commons-csv-1.8-sources.jar!/" />
+    </SOURCES>
+  </library>
+</component>
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/src/visualizer.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/visualizer.js	(date 1594749336104)
+++ src/main/resources/static/static/lib/brat/src/visualizer.js	(date 1594749336104)
@@ -0,0 +1,3139 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+
+var Visualizer = (function($, window, undefined) {
+    var fontLoadTimeout = 5000; // 5 seconds
+  
+    var DocumentData = function(text) {
+      this.text = text;
+      this.chunks = [];
+      this.spans = {};
+      this.eventDescs = {};
+      this.sentComment = {};
+      this.arcs = [];
+      this.arcById = {};
+      this.markedSent = {};
+      this.spanAnnTexts = {};
+      this.towers = {};
+      // this.sizes = {};
+    };
+
+    var Fragment = function(id, span, from, to) {
+      this.id = id;
+      this.span = span;
+      this.from = from;
+      this.to = to;
+      // this.towerId = undefined;
+      // this.drawOrder = undefined;
+    };
+
+    var Span = function(id, type, offsets, generalType) {
+      this.id = id;
+      this.type = type;
+      this.totalDist = 0;
+      this.numArcs = 0;
+      this.generalType = generalType;
+      this.offsets = offsets;
+      this.headFragment = null;
+      // this.from = undefined;
+      // this.to = undefined;
+      // this.wholeFrom = undefined;
+      // this.wholeTo = undefined;
+      // this.headFragment = undefined;
+      // this.chunk = undefined;
+      // this.marked = undefined;
+      // this.avgDist = undefined;
+      // this.curly = undefined;
+      // this.comment = undefined; // { type: undefined, text: undefined };
+      // this.annotatorNotes = undefined;
+      // this.drawCurly = undefined;
+      // this.glyphedLabelText = undefined;
+      // this.group = undefined;
+      // this.height = undefined;
+      // this.highlightPos = undefined;
+      // this.indexNumber = undefined;
+      // this.labelText = undefined;
+      // this.nestingDepth = undefined;
+      // this.nestingDepthLR = undefined;
+      // this.nestingDepthRL = undefined;
+      // this.nestingHeight = undefined;
+      // this.nestingHeightLR = undefined;
+      // this.nestingHeightRL = undefined;
+      // this.rect = undefined;
+      // this.rectBox = undefined;
+      // this.refedIndexSum = undefined;
+      // this.right = undefined;
+      // this.totaldist = undefined;
+      // this.width = undefined;
+      this.initContainers(offsets);
+    };
+
+    Span.prototype.initContainers = function() {
+      this.incoming = [];
+      this.outgoing = [];
+      this.attributes = {};
+      this.attributeText = [];
+      this.attributeCues = {};
+      this.attributeCueFor = {};
+      this.attributeMerge = {}; // for box, cross, etc. that are span-global
+      this.fragments = [];
+      this.normalizations = [];
+    };
+
+    Span.prototype.copy = function(id) {
+      var span = $.extend(new Span(), this); // clone
+      span.id = id;
+      span.initContainers(); // protect from shallow copy
+      return span;
+    };
+
+    var EventDesc = function(id, triggerId, roles, klass) {
+      this.id = id;
+      this.triggerId = triggerId;
+      var roleList = this.roles = [];
+      $.each(roles, function(roleNo, role) {
+        roleList.push({ type: role[0], targetId: role[1] });
+      });
+      if (klass == "equiv") {
+        this.equiv = true;
+      } else if (klass == "relation") {
+        this.relation = true;
+      }
+      // this.leftSpans = undefined;
+      // this.rightSpans = undefined;
+      // this.annotatorNotes = undefined;
+    };
+
+    var Chunk = function(index, text, from, to, space, spans) {
+      this.index = index;
+      this.text = text;
+      this.from = from;
+      this.to = to;
+      this.space = space;
+      this.fragments = [];
+      // this.sentence = undefined;
+      // this.group = undefined;
+      // this.highlightGroup = undefined;
+      // this.markedTextStart = undefined;
+      // this.markedTextEnd = undefined;
+      // this.nextSpace = undefined;
+      // this.right = undefined;
+      // this.row = undefined;
+      // this.textX = undefined;
+      // this.translation = undefined;
+    }
+
+    var Arc = function(eventDesc, role, dist, eventNo) {
+      this.origin = eventDesc.id;
+      this.target = role.targetId;
+      this.dist = dist;
+      this.type = role.type;
+      this.shadowClass = eventDesc.shadowClass;
+      this.jumpHeight = 0;
+      if (eventDesc.equiv) {
+        this.equiv = true;
+        this.eventDescId = eventNo;
+        eventDesc.equivArc = this;
+      } else if (eventDesc.relation) {
+        this.relation = true;
+        this.eventDescId = eventNo;
+      }
+      // this.marked = undefined;
+    };
+
+    var Row = function(svg) {
+      this.group = svg.group();
+      this.background = svg.group(this.group);
+      this.chunks = [];
+      this.hasAnnotations = false;
+      this.maxArcHeight = 0;
+      this.maxSpanHeight = 0;
+    };
+
+    var Measurements = function(widths, height, y) {
+      this.widths = widths;
+      this.height = height;
+      this.y = y;
+    };
+
+    // A naive whitespace tokeniser
+    var tokenise = function(text) {
+      var tokenOffsets = [];
+      var tokenStart = null;
+      var lastCharPos = null;
+
+      for (var i = 0; i < text.length; i++) {
+        var c = text[i];
+        // Have we found the start of a token?
+        if (tokenStart == null && !/\s/.test(c)) {
+          tokenStart = i;
+          lastCharPos = i;
+        // Have we found the end of a token?
+        } else if (/\s/.test(c) && tokenStart != null) {
+          tokenOffsets.push([tokenStart, i]);
+          tokenStart = null;
+        // Is it a non-whitespace character?
+        } else if (!/\s/.test(c)) {
+          lastCharPos = i;
+        }
+      }
+      // Do we have a trailing token?
+      if (tokenStart != null) {
+        tokenOffsets.push([tokenStart, lastCharPos + 1]);
+      }
+
+      return tokenOffsets;
+    };
+
+    // A naive newline sentence splitter
+    var sentenceSplit = function(text) {
+      var sentenceOffsets = [];
+      var sentStart = null;
+      var lastCharPos = null;
+
+      for (var i = 0; i < text.length; i++) {
+        var c = text[i];
+        // Have we found the start of a sentence?
+        if (sentStart == null && !/\s/.test(c)) {
+          sentStart = i;
+          lastCharPos = i;
+        // Have we found the end of a sentence?
+        } else if (c == '\n' && sentStart != null) {
+          sentenceOffsets.push([sentStart, i]);
+          sentStart = null;
+        // Is it a non-whitespace character?
+        } else if (!/\s/.test(c)) {
+          lastCharPos = i;
+        }
+      }
+      // Do we have a trailing sentence without a closing newline?
+      if (sentStart != null) {
+        sentenceOffsets.push([sentStart, lastCharPos + 1]);
+      }
+
+      return sentenceOffsets;
+    };
+
+    // Sets default values for a wide range of optional attributes
+    var setSourceDataDefaults = function(sourceData) {
+      // The following are empty lists if not set
+      $.each([
+          'attributes',
+          'comments',
+          'entities',
+          'equivs',
+          'events',
+          'modifications',
+          'normalizations',
+          'relations',
+          'triggers',
+          ], function(attrNo, attr) {
+        if (sourceData[attr] === undefined) {
+          sourceData[attr] = [];
+        }
+      });
+
+      // If we lack sentence offsets we fall back on naive sentence splitting
+      if (sourceData.sentence_offsets === undefined) {
+        sourceData.sentence_offsets = sentenceSplit(sourceData.text);
+      }
+      // Similarily we fall back on whitespace tokenisation
+      if (sourceData.token_offsets === undefined) {
+        sourceData.token_offsets = tokenise(sourceData.text);
+      }
+    };
+
+    // Set default values for a variety of collection attributes
+    var setCollectionDefaults = function(collectionData) {
+      // The following are empty lists if not set
+      $.each([
+          'entity_attribute_types',
+          'entity_types',
+          'event_attribute_types',
+          'event_types',
+          'relation_attribute_types',
+          'relation_types',
+          'unconfigured_types',
+          ], function(attrNo, attr) {
+        if (collectionData[attr] === undefined) {
+          collectionData[attr] = [];
+        }
+      });
+    };
+
+    var Visualizer = function(dispatcher, svgId, webFontURLs) {
+      var $svgDiv = $('#' + svgId);
+      if (!$svgDiv.length) {
+        throw Error('Could not find container with id="' + svgId + '"');
+      }
+      var that = this;
+
+      // OPTIONS
+      var roundCoordinates = true; // try to have exact pixel offsets
+      var boxTextMargin = { x: 0, y: 1.5 }; // effect is inverse of "margin" for some reason
+      var highlightRounding = { x: 3, y:3 }; // rx, ry for highlight boxes
+      var spaceWidths = {
+        ' ': 4,
+        '\u00a0': 4,
+        '\u200b': 0,
+        '\u3000': 8,
+        '\n': 4
+      };
+      var coloredCurlies = true; // color curlies by box BG
+      var arcSlant = 15; //10;
+      var minArcSlant = 8;
+      var arcHorizontalSpacing = 10; // min space boxes with connecting arc
+      var rowSpacing = -5;          // for some funny reason approx. -10 gives "tight" packing.
+      var sentNumMargin = 20;
+      var smoothArcCurves = true;   // whether to use curves (vs lines) in arcs
+      var smoothArcSteepness = 0.5; // steepness of smooth curves (control point)
+      var reverseArcControlx = 5;   // control point distance for "UFO catchers"
+
+      // "shadow" effect settings (note, error, incompelete)
+      var rectShadowSize = 3;
+      var rectShadowRounding = 2.5;
+      var arcLabelShadowSize = 1;
+      var arcLabelShadowRounding = 5;
+      var shadowStroke = 2.5; // TODO XXX: this doesn't affect anything..?
+
+      // "marked" effect settings (edited, focus, match)
+      var markedSpanSize = 6;
+      var markedArcSize = 2;
+      var markedArcStroke = 7; // TODO XXX: this doesn't seem to do anything..?
+
+      var rowPadding = 2;
+      var nestingAdjustYStepSize = 2; // size of height adjust for nested/nesting spans
+      var nestingAdjustXStepSize = 1; // size of height adjust for nested/nesting spans
+
+      var highlightSequence = '#FF9632;#FFCC00;#FF9632'; // yellow - deep orange
+      //var highlightSequence = '#FFFC69;#FFCC00;#FFFC69'; // a bit toned town
+      var highlightSpanSequence = highlightSequence;
+      var highlightArcSequence =  highlightSequence;
+      var highlightTextSequence = highlightSequence;
+      var highlightDuration = '2s';
+      // different sequence for "mere" matches (as opposed to "focus" and
+      // "edited" highlights)
+      var highlightMatchSequence = '#FFFF00'; // plain yellow
+
+      var fragmentConnectorDashArray = '1,3,3,3';
+      var fragmentConnectorColor = '#000000';
+
+      // END OPTIONS
+
+
+      var svg;
+      var $svg;
+      var data = null;
+      var sourceData = null;
+      var requestedData = null;
+      var coll, doc, args;
+      var relationTypesHash;
+      var isRenderRequested;
+      var isCollectionLoaded = false;
+      var entityAttributeTypes = null;
+      var eventAttributeTypes = null;
+      var spanTypes = null;
+      var highlightGroup;
+
+      // var commentPrioLevels = ['Unconfirmed', 'Incomplete', 'Warning', 'Error', 'AnnotatorNotes'];
+      // XXX Might need to be tweaked - inserted diff levels
+      var commentPrioLevels = [
+        'Unconfirmed', 'Incomplete', 'Warning', 'Error', 'AnnotatorNotes',
+        'AddedAnnotation', 'MissingAnnotation', 'ChangedAnnotation'];
+
+      this.arcDragOrigin = null; // TODO
+
+      // due to silly Chrome bug, I have to make it pay attention
+      var forceRedraw = function() {
+        if (!$.browser.chrome) return; // not needed
+        $svg.css('margin-bottom', 1);
+        setTimeout(function() { $svg.css('margin-bottom', 0); }, 0);
+      }
+
+      var rowBBox = function(span) {
+        var box = $.extend({}, span.rectBox); // clone
+        var chunkTranslation = span.chunk.translation;
+        box.x += chunkTranslation.x;
+        box.y += chunkTranslation.y;
+        return box;
+      };
+
+      var commentPriority = function(commentClass) {
+        if (commentClass === undefined) return -1;
+        var len = commentPrioLevels.length;
+        for (var i = 0; i < len; i++) {
+          if (commentClass.indexOf(commentPrioLevels[i]) != -1) return i;
+        }
+        return 0;
+      };
+
+      var clearSVG = function() {
+        data = null;
+        sourceData = null;
+        svg.clear();
+        $svgDiv.hide();
+      };
+
+      var setMarked = function(markedType) {
+        $.each(args[markedType] || [], function(markedNo, marked) {
+          if (marked[0] == 'sent') {
+            data.markedSent[marked[1]] = true;
+          } else if (marked[0] == 'equiv') { // [equiv, Equiv, T1]
+            $.each(sourceData.equivs, function(equivNo, equiv) {
+              if (equiv[1] == marked[1]) {
+                var len = equiv.length;
+                for (var i = 2; i < len; i++) {
+                  if (equiv[i] == marked[2]) {
+                    // found it
+                    len -= 3;
+                    for (var i = 1; i <= len; i++) {
+                      var arc = data.eventDescs[equiv[0] + "*" + i].equivArc;
+                      arc.marked = markedType;
+                    }
+                    return; // next equiv
+                  }
+                }
+              }
+            });
+          } else if (marked.length == 2) {
+            markedText.push([parseInt(marked[0], 10), parseInt(marked[1], 10), markedType]);
+          } else {
+            var span = data.spans[marked[0]];
+            if (span) {
+              if (marked.length == 3) { // arc
+                $.each(span.outgoing, function(arcNo, arc) {
+                  if (arc.target == marked[2] && arc.type == marked[1]) {
+                    arc.marked = markedType;
+                  }
+                });
+              } else { // span
+                span.marked = markedType;
+              }
+            } else {
+              var eventDesc = data.eventDescs[marked[0]];
+              if (eventDesc) { // relation
+                var relArc = eventDesc.roles[0];
+                $.each(data.spans[eventDesc.triggerId].outgoing, function(arcNo, arc) {
+                  if (arc.target == relArc.targetId && arc.type == relArc.type) {
+                    arc.marked = markedType;
+                  }
+                });
+              } else { // try for trigger
+                $.each(data.eventDescs, function(eventDescNo, eventDesc) {
+                  if (eventDesc.triggerId == marked[0]) {
+                    data.spans[eventDesc.id].marked = markedType;
+                  }
+                });
+              }
+            }
+          }
+        });
+      };
+
+      var fragmentComparator = function(a, b) {
+        var tmp;
+        var aSpan = a.span;
+        var bSpan = b.span;
+
+        // spans with more fragments go first
+        tmp = aSpan.fragments.length - bSpan.fragments.length;
+        if (tmp) {
+          return tmp < 0 ? 1 : -1;
+        }
+
+        // longer arc distances go last
+        tmp = aSpan.avgDist - bSpan.avgDist;
+        if (tmp) {
+          return tmp < 0 ? -1 : 1;
+        }
+        // spans with more arcs go last
+        tmp = aSpan.numArcs - bSpan.numArcs;
+        if (tmp) {
+          return tmp < 0 ? -1 : 1;
+        }
+        // compare the span widths,
+        // put wider on bottom so they don't mess with arcs, or shorter
+        // on bottom if there are no arcs.
+        var ad = a.to - a.from;
+        var bd = b.to - b.from;
+        tmp = ad - bd;
+        if (aSpan.numArcs == 0 && bSpan.numArcs == 0) {
+          tmp = -tmp;
+        }
+        if (tmp) {
+          return tmp < 0 ? 1 : -1;
+        }
+        tmp = aSpan.refedIndexSum - bSpan.refedIndexSum;
+        if (tmp) {
+          return tmp < 0 ? -1 : 1;
+        }
+        // if no other criterion is found, sort by type to maintain
+        // consistency
+        // TODO: isn't there a cmp() in JS?
+        if (aSpan.type < bSpan.type) {
+          return -1;
+        } else if (aSpan.type > bSpan.type) {
+          return 1;
+        }
+
+        return 0;
+      };
+
+
+      var setData = function(_sourceData) {
+        if (!args) args = {};
+        sourceData = _sourceData;
+        dispatcher.post('newSourceData', [sourceData]);
+        data = new DocumentData(sourceData.text);
+
+        // collect annotation data
+        $.each(sourceData.entities, function(entityNo, entity) {
+          // offsets given as array of (start, end) pairs
+          var span =
+              //      (id,        type,      offsets,   generalType)
+              new Span(entity[0], entity[1], entity[2], 'entity');
+          data.spans[entity[0]] = span;
+        });
+        var triggerHash = {};
+        $.each(sourceData.triggers, function(triggerNo, trigger) {
+          triggerHash[trigger[0]] =
+              //       (id,         type,       offsets,    generalType), eventList
+              [new Span(trigger[0], trigger[1], trigger[2], 'trigger'), []];
+        });
+        $.each(sourceData.events, function(eventNo, eventRow) {
+          var eventDesc = data.eventDescs[eventRow[0]] =
+              //           (id,          triggerId,   roles,        klass)
+              new EventDesc(eventRow[0], eventRow[1], eventRow[2]);
+          var trigger = triggerHash[eventDesc.triggerId];
+          var span = trigger[0].copy(eventDesc.id);
+          trigger[1].push(span);
+          data.spans[eventDesc.id] = span;
+        });
+
+        // XXX modifications: delete later
+        $.each(sourceData.modifications, function(modNo, mod) {
+          // mod: [id, spanId, modification]
+          if (!data.spans[mod[2]]) {
+            dispatcher.post('messages', [[['<strong>ERROR</strong><br/>Event ' + mod[2] + ' (referenced from modification ' + mod[0] + ') does not occur in document ' + data.document + '<br/>(please correct the source data)', 'error', 5]]]);
+            return;
+          }
+          data.spans[mod[2]][mod[1]] = true;
+        });
+
+        var midpointComparator = function(a, b) {
+          var tmp = a.from + a.to - b.from - b.to;
+          if (!tmp) return 0;
+          return tmp < 0 ? -1 : 1;
+        };
+        // split spans into span fragments (for discontinuous spans)
+        $.each(data.spans, function(spanNo, span) {
+          $.each(span.offsets, function(offsetsNo, offsets) {
+            var from = parseInt(offsets[0], 10);
+            var to = parseInt(offsets[1], 10);
+            var fragment = new Fragment(offsetsNo, span, from, to);
+            span.fragments.push(fragment);
+          });
+          // ensure ascending order
+          span.fragments.sort(midpointComparator);
+          span.wholeFrom = span.fragments[0].from;
+          span.wholeTo = span.fragments[span.fragments.length - 1].to;
+          span.headFragment = span.fragments[(true) ? span.fragments.length - 1 : 0]; // TODO configurable!
+        });
+
+        var spanComparator = function(a, b) {
+          var aSpan = data.spans[a];
+          var bSpan = data.spans[b];
+          var tmp = aSpan.headFragment.from + aSpan.headFragment.to - bSpan.headFragment.from - bSpan.headFragment.to;
+          if (tmp) {
+            return tmp < 0 ? -1 : 1;
+          }
+          return 0;
+        };
+        $.each(sourceData.equivs, function(equivNo, equiv) {
+          // equiv: ['*', 'Equiv', spanId...]
+          equiv[0] = "*" + equivNo;
+          var equivSpans = equiv.slice(2);
+          var okEquivSpans = [];
+          // collect the equiv spans in an array
+          $.each(equivSpans, function(equivSpanNo, equivSpan) {
+            if (data.spans[equivSpan]) okEquivSpans.push(equivSpan);
+            // TODO: #404, inform the user with a message?
+          });
+          // sort spans in the equiv by their midpoint
+          okEquivSpans.sort(spanComparator);
+          // generate the arcs
+          var len = okEquivSpans.length;
+          for (var i = 1; i < len; i++) {
+            var eventDesc = data.eventDescs[equiv[0] + '*' + i] =
+                //           (id,                  triggerId,           roles,                         klass)
+                new EventDesc(okEquivSpans[i - 1], okEquivSpans[i - 1], [[equiv[1], okEquivSpans[i]]], 'equiv');
+            eventDesc.leftSpans = okEquivSpans.slice(0, i);
+            eventDesc.rightSpans = okEquivSpans.slice(i);
+          }
+        });
+        $.each(sourceData.relations, function(relNo, rel) {
+          // rel[2] is args, rel[2][a][0] is role and rel[2][a][1] is value for a in (0,1)
+          var argsDesc = relationTypesHash[rel[1]];
+          argsDesc = argsDesc && argsDesc.args;
+          var t1, t2;
+          if (argsDesc) {
+            // sort the arguments according to the config
+            var args = {}
+            args[rel[2][0][0]] = rel[2][0][1];
+            args[rel[2][1][0]] = rel[2][1][1];
+            t1 = args[argsDesc[0].role];
+            t2 = args[argsDesc[1].role];
+          } else {
+            // (or leave as-is in its absence)
+            t1 = rel[2][0][1];
+            t2 = rel[2][1][1];
+          }
+          data.eventDescs[rel[0]] =
+              //           (id, triggerId, roles,          klass)
+              new EventDesc(t1, t1,        [[rel[1], t2]], 'relation');
+        });
+
+        // attributes
+        $.each(sourceData.attributes, function(attrNo, attr) {
+          // attr: [id, name, spanId, value, cueSpanId
+
+          // TODO: might wish to check what's appropriate for the type
+          // instead of using the first attribute def found
+          var attrType = (eventAttributeTypes[attr[1]] ||
+                          entityAttributeTypes[attr[1]]);
+          var attrValue = attrType && attrType.values[attrType.bool || attr[3]];
+          var span = data.spans[attr[2]];
+          if (!span) {
+            dispatcher.post('messages', [[['Annotation ' + attr[2] + ', referenced from attribute ' + attr[0] + ', does not exist.', 'error']]]);
+            return;
+          }
+          var valText = (attrValue && attrValue.name) || attr[3];
+          var attrText = attrType
+            ? (attrType.bool ? attrType.name : (attrType.name + ': ' + valText))
+            : (attr[3] == true ? attr[1] : attr[1] + ': ' + attr[3]);
+          span.attributeText.push(attrText);
+          span.attributes[attr[1]] = attr[3];
+          if (attr[4]) { // cue
+            span.attributeCues[attr[1]] = attr[4];
+            var cueSpan = data.spans[attr[4]];
+            cueSpan.attributeCueFor[data.spans[1]] = attr[2];
+            cueSpan.cue = 'CUE'; // special css type
+          }
+          $.extend(span.attributeMerge, attrValue);
+        });
+
+        // comments
+        $.each(sourceData.comments, function(commentNo, comment) {
+          // comment: [entityId, type, text]
+
+          // TODO error handling
+
+          // sentence id: ['sent', sentId]
+          if (comment[0] instanceof Array && comment[0][0] == 'sent') {
+            // sentence comment
+            var sent = comment[0][1];
+            var text = comment[2];
+            if (data.sentComment[sent]) {
+              text = data.sentComment[sent].text + '<br/>' + text;
+            }
+            data.sentComment[sent] = { type: comment[1], text: text };
+          } else {
+            var id = comment[0];
+            var trigger = triggerHash[id];
+            var eventDesc = data.eventDescs[id];
+            var commentEntities =
+                trigger
+                ? trigger[1] // trigger: [span, ...]
+                : id in data.spans
+                  ? [data.spans[id]] // span: [span]
+                  : id in data.eventDescs
+                    ? [data.eventDescs[id]] // arc: [eventDesc]
+                    : [];
+            $.each(commentEntities, function(entityId, entity) {
+              // if duplicate comment for entity:
+              // overwrite type, concatenate comment with a newline
+              if (!entity.comment) {
+                entity.comment = { type: comment[1], text: comment[2] };
+              } else {
+                entity.comment.type = comment[1];
+                entity.comment.text += "\n" + comment[2];
+              }
+              // partially duplicate marking of annotator note comments
+              if (comment[1] == "AnnotatorNotes") {
+                entity.annotatorNotes = comment[2];
+              }
+              // prioritize type setting when multiple comments are present
+              if (commentPriority(comment[1]) > commentPriority(entity.shadowClass)) {
+                entity.shadowClass = comment[1];
+              }
+            });
+          }
+        });
+
+        // normalizations
+        $.each(sourceData.normalizations, function(normNo, norm) {
+          var id = norm[0];
+          var normType = norm[1];
+          var target = norm[2];
+          var refdb = norm[3];
+          var refid = norm[4];
+          var reftext = norm[5];
+
+          // grab entity / event the normalization applies to
+          var span = data.spans[target];
+          if (!span) {
+            dispatcher.post('messages', [[['Annotation ' + target + ', referenced from normalization ' + id + ', does not exist.', 'error']]]);
+            return;
+          }
+
+          // TODO: do we have any possible use for the normType?
+          span.normalizations.push([refdb, refid, reftext]);
+
+          // quick hack for span box visual style
+          span.normalized = 'Normalized';
+        });
+
+        // prepare span boundaries for token containment testing
+        var sortedFragments = [];
+        $.each(data.spans, function(spanNo, span) {
+          $.each(span.fragments, function(fragmentNo, fragment) {
+            sortedFragments.push(fragment);
+          });
+        });
+        // sort fragments by beginning, then by end
+        sortedFragments.sort(function(a, b) {
+          var x = a.from;
+          var y = b.from;
+          if (x == y) {
+            x = a.to;
+            y = b.to;
+          }
+          return ((x < y) ? -1 : ((x > y) ? 1 : 0));
+        });
+        var currentFragmentId = 0;
+        var startFragmentId = 0;
+        var numFragments = sortedFragments.length;
+        var lastTo = 0;
+        var firstFrom = null;
+        var chunkNo = 0;
+        var space;
+        var chunk = null;
+        // token containment testing (chunk recognition)
+        $.each(sourceData.token_offsets, function() {
+          var from = this[0];
+          var to = this[1];
+          if (firstFrom === null) firstFrom = from;
+
+          // Replaced for speedup; TODO check correctness
+          // inSpan = false;
+          // $.each(data.spans, function(spanNo, span) {
+          //   if (span.from < to && to < span.to) {
+          //     // it does; no word break
+          //     inSpan = true;
+          //     return false;
+          //   }
+          // });
+
+          // Is the token end inside a span?
+          if (startFragmentId && to > sortedFragments[startFragmentId - 1].to) {
+            while (startFragmentId < numFragments && to > sortedFragments[startFragmentId].from) {
+              startFragmentId++;
+            }
+          }
+          currentFragmentId = startFragmentId;
+          while (currentFragmentId < numFragments && to >= sortedFragments[currentFragmentId].to) {
+            currentFragmentId++;
+          }
+          // if yes, the next token is in the same chunk
+          if (currentFragmentId < numFragments && to > sortedFragments[currentFragmentId].from) {
+            return;
+          }
+
+          // otherwise, create the chunk found so far
+          space = data.text.substring(lastTo, firstFrom);
+          var text = data.text.substring(firstFrom, to);
+          if (chunk) chunk.nextSpace = space;
+          //               (index,     text, from,      to, space) {
+          chunk = new Chunk(chunkNo++, text, firstFrom, to, space);
+          data.chunks.push(chunk);
+          lastTo = to;
+          firstFrom = null;
+        });
+        var numChunks = chunkNo;
+
+        // find sentence boundaries in relation to chunks
+        chunkNo = 0;
+        var sentenceNo = 0;
+        var pastFirst = false;
+        $.each(sourceData.sentence_offsets, function() {
+          var from = this[0];
+          if (chunkNo >= numChunks) return false;
+          if (data.chunks[chunkNo].from > from) return;
+          var chunk;
+          while (chunkNo < numChunks && (chunk = data.chunks[chunkNo]).from < from) {
+            chunkNo++;
+          }
+          chunkNo++;
+          if (pastFirst && from <= chunk.from) {
+            var numNL = chunk.space.split("\n").length - 1;
+            if (!numNL) numNL = 1;
+            sentenceNo += numNL;
+            chunk.sentence = sentenceNo;
+          } else {
+            pastFirst = true;
+          }
+        });
+
+        // assign fragments to appropriate chunks
+        var currentChunkId = 0;
+        var chunk;
+        $.each(sortedFragments, function(fragmentId, fragment) {
+          while (fragment.to > (chunk = data.chunks[currentChunkId]).to) currentChunkId++;
+          chunk.fragments.push(fragment);
+          fragment.text = chunk.text.substring(fragment.from - chunk.from, fragment.to - chunk.from);
+          fragment.chunk = chunk;
+        });
+
+        // assign arcs to spans; calculate arc distances
+        $.each(data.eventDescs, function(eventNo, eventDesc) {
+          var dist = 0;
+          var origin = data.spans[eventDesc.id];
+          if (!origin) {
+            // TODO: include missing trigger ID in error message
+            dispatcher.post('messages', [[['<strong>ERROR</strong><br/>Trigger for event "' + eventDesc.id + '" not found in ' + data.document + '<br/>(please correct the source data)', 'error', 5]]]);
+            return;
+          }
+          var here = origin.headFragment.from + origin.headFragment.to;
+          $.each(eventDesc.roles, function(roleNo, role) {
+            var target = data.spans[role.targetId];
+            if (!target) {
+              dispatcher.post('messages', [[['<strong>ERROR</strong><br/>"' + role.targetId + '" (referenced from "' + eventDesc.id + '") not found in ' + data.document + '<br/>(please correct the source data)', 'error', 5]]]);
+              return;
+            }
+            var there = target.headFragment.from + target.headFragment.to;
+            var dist = Math.abs(here - there);
+            var arc = new Arc(eventDesc, role, dist, eventNo);
+            origin.totalDist += dist;
+            origin.numArcs++;
+            target.totalDist += dist;
+            target.numArcs++;
+            data.arcs.push(arc);
+            target.incoming.push(arc);
+            origin.outgoing.push(arc);
+            // ID dict for easy access. TODO: have a function defining the
+            // (origin,type,target)->id mapping (see also annotator_ui.js)
+            var arcId = origin.id + '--' + role.type + '--' + target.id;
+            data.arcById[arcId] = arc;
+          }); // roles
+        }); // eventDescs
+
+        // highlighting
+        markedText = [];
+        setMarked('edited'); // set by editing process
+        setMarked('focus'); // set by URL
+        setMarked('matchfocus'); // set by search process, focused match
+        setMarked('match'); // set by search process, other (non-focused) match
+
+        $.each(data.spans, function(spanId, span) {
+          // calculate average arc distances
+          // average distance of arcs (0 for no arcs)
+          span.avgDist = span.numArcs ? span.totalDist / span.numArcs : 0;
+          lastSpan = span;
+
+          // collect fragment texts into span texts
+          var fragmentTexts = [];
+          $.each(span.fragments, function(fragmentNo, fragment) {
+            // TODO heuristics
+            fragmentTexts.push(fragment.text);
+          });
+          span.text = fragmentTexts.join('');
+        }); // data.spans
+
+        for (var i = 0; i < 2; i++) {
+          // preliminary sort to assign heights for basic cases
+          // (first round) and cases resolved in the previous
+          // round(s).
+          $.each(data.chunks, function(chunkNo, chunk) {
+            // sort
+            chunk.fragments.sort(fragmentComparator);
+            // renumber
+            $.each(chunk.fragments, function(fragmentNo, fragment) {
+              fragment.indexNumber = fragmentNo;
+            });
+          });
+          // nix the sums, so we can sum again
+          $.each(data.spans, function(spanNo, span) {
+            span.refedIndexSum = 0;
+          });
+          // resolved cases will now have indexNumber set
+          // to indicate their relative order. Sum those for referencing cases
+          // for use in iterative resorting
+          $.each(data.arcs, function(arcNo, arc) {
+            data.spans[arc.origin].refedIndexSum += data.spans[arc.target].headFragment.indexNumber;
+          });
+        }
+
+        // Final sort of fragments in chunks for drawing purposes
+        // Also identify the marked text boundaries regarding chunks
+        $.each(data.chunks, function(chunkNo, chunk) {
+          // and make the next sort take this into account. Note that this will
+          // now resolve first-order dependencies between sort orders but not
+          // second-order or higher.
+          chunk.fragments.sort(fragmentComparator);
+          $.each(chunk.fragments, function(fragmentNo, fragment) {
+            fragment.drawOrder = fragmentNo;
+          });
+        });
+
+        data.spanDrawOrderPermutation = Object.keys(data.spans);
+        data.spanDrawOrderPermutation.sort(function(a, b) {
+          var spanA = data.spans[a];
+          var spanB = data.spans[b];
+
+          // We're jumping all over the chunks, but it's enough that
+          // we're doing everything inside each chunk in the right
+          // order. should it become necessary to actually do these in
+          // linear order, put in a similar condition for
+          // spanX.headFragment.chunk.index; but it should not be
+          // needed.
+
+          var tmp = spanA.headFragment.drawOrder - spanB.headFragment.drawOrder;
+          if (tmp) return tmp < 0 ? -1 : 1;
+
+          return 0;
+        });
+
+        // resort the spans for linear order by center
+        sortedFragments.sort(midpointComparator);
+
+        // sort fragments into towers, calculate average arc distances
+        var lastFragment = null;
+        var towerId = -1;
+        $.each(sortedFragments, function(i, fragment) {
+          if (!lastFragment || (lastFragment.from != fragment.from || lastFragment.to != fragment.to)) {
+            towerId++;
+          }
+          fragment.towerId = towerId;
+          lastFragment = fragment;
+        }); // sortedFragments
+
+        // find curlies (only the first fragment drawn in a tower)
+        $.each(data.spanDrawOrderPermutation, function(spanIdNo, spanId) {
+          var span = data.spans[spanId];
+
+          $.each(span.fragments, function(fragmentNo, fragment) {
+            if (!data.towers[fragment.towerId]) {
+              data.towers[fragment.towerId] = [];
+              fragment.drawCurly = true;
+              fragment.span.drawCurly = true;
+            }
+            data.towers[fragment.towerId].push(fragment);
+          });
+        });
+
+        var spanAnnTexts = {};
+        $.each(data.chunks, function(chunkNo, chunk) {
+          chunk.markedTextStart = [];
+          chunk.markedTextEnd = [];
+
+          $.each(chunk.fragments, function(fragmentNo, fragment) {
+            if (chunk.firstFragmentIndex == undefined) {
+              chunk.firstFragmentIndex = fragment.towerId;
+            }
+            chunk.lastFragmentIndex = fragment.towerId;
+
+            var spanLabels = Util.getSpanLabels(spanTypes, fragment.span.type);
+            fragment.labelText = Util.spanDisplayForm(spanTypes, fragment.span.type);
+            // Find the most appropriate label according to text width
+            if (Configuration.abbrevsOn && spanLabels) {
+              var labelIdx = 1; // first abbrev
+              var maxLength = (fragment.to - fragment.from) / 0.8;
+              while (fragment.labelText.length > maxLength &&
+                  spanLabels[labelIdx]) {
+                fragment.labelText = spanLabels[labelIdx];
+                labelIdx++;
+              }
+            }
+
+            var svgtext = svg.createText(); // one "text" element per row
+            var postfixArray = [];
+            var prefix = '';
+            var postfix = '';
+            var warning = false;
+            $.each(fragment.span.attributes, function(attrType, valType) {
+              // TODO: might wish to check what's appropriate for the type
+              // instead of using the first attribute def found
+              var attr = (eventAttributeTypes[attrType] ||
+                          entityAttributeTypes[attrType]);
+              if (!attr) {
+                // non-existent type
+                warning = true;
+                return;
+              }
+              var val = attr.values[attr.bool || valType];
+              if (!val) {
+                // non-existent value
+                warning = true;
+                return;
+              }
+              if ($.isEmptyObject(val)) {
+                // defined, but lacks any visual presentation
+                warning = true;
+                return;
+              }
+              if (val.glyph) {
+                if (val.position == "left") {
+                  prefix = val.glyph + prefix;
+                  var css = 'glyph';
+                  if (attr.css) css += ' glyph_' + Util.escapeQuotes(attr.css);
+                  svgtext.span(val.glyph, { 'class': css });
+                } else { // XXX right is implied - maybe change
+                  postfixArray.push([attr, val]);
+                  postfix += val.glyph;
+                }
+              }
+            });
+            var text = fragment.labelText;
+            if (prefix !== '') {
+              text = prefix + ' ' + text;
+              svgtext.string(' ');
+            }
+            svgtext.string(fragment.labelText);
+            if (postfixArray.length) {
+              text += ' ' + postfix;
+              svgtext.string(' ');
+              $.each(postfixArray, function(elNo, el) {
+                var css = 'glyph';
+                if (el[0].css) css += ' glyph_' + Util.escapeQuotes(el[0].css);
+                svgtext.span(el[1].glyph, { 'class': css });
+              });
+            }
+            if (warning) {
+              svgtext.span("#", { 'class': 'glyph attribute_warning' });
+              text += ' #';
+            }
+            fragment.glyphedLabelText = text;
+
+            if (!spanAnnTexts[text]) {
+              spanAnnTexts[text] = true;
+              data.spanAnnTexts[text] = svgtext;
+            }
+          }); // chunk.fragments
+        }); // chunks
+
+        var numChunks = data.chunks.length;
+        // note the location of marked text with respect to chunks
+        var startChunk = 0;
+        var currentChunk;
+        // sort by "from"; we don't need to sort by "to" as well,
+        // because unlike spans, chunks are disjunct
+        markedText.sort(function(a, b) {
+          return Util.cmp(a[0], b[0]);
+        });
+        $.each(markedText, function(textNo, textPos) {
+          var from = textPos[0];
+          var to = textPos[1];
+          var markedType = textPos[2];
+          if (from < 0) from = 0;
+          if (to < 0) to = 0;
+          if (to >= data.text.length) to = data.text.length - 1;
+          if (from > to) from = to;
+          while (startChunk < numChunks) {
+            var chunk = data.chunks[startChunk];
+            if (from <= chunk.to) {
+              chunk.markedTextStart.push([textNo, true, from - chunk.from, null, markedType]);
+              break;
+            }
+            startChunk++;
+          }
+          if (startChunk == numChunks) {
+            dispatcher.post('messages', [[['Wrong text offset', 'error']]]);
+            return;
+          }
+          currentChunk = startChunk;
+          while (currentChunk < numChunks) {
+            var chunk = data.chunks[currentChunk];
+            if (to <= chunk.to) {
+              chunk.markedTextEnd.push([textNo, false, to - chunk.from]);
+              break
+            }
+            currentChunk++;
+          }
+          if (currentChunk == numChunks) {
+            dispatcher.post('messages', [[['Wrong text offset', 'error']]]);
+            var chunk = data.chunks[data.chunks.length - 1];
+            chunk.markedTextEnd.push([textNo, false, chunk.text.length]);
+            return;
+          }
+        }); // markedText
+
+        dispatcher.post('dataReady', [data]);
+      };
+
+      var resetData = function() {
+        setData(sourceData);
+        renderData();
+      }
+
+      var translate = function(element, x, y) {
+        $(element.group).attr('transform', 'translate(' + x + ', ' + y + ')');
+        element.translation = { x: x, y: y };
+      };
+
+      var showMtime = function() {
+        if (data.mtime) {
+            // we're getting seconds and need milliseconds
+            //$('#document_ctime').text("Created: " + Annotator.formatTime(1000 * data.ctime)).css("display", "inline");
+            $('#document_mtime').text("Last modified: " + Util.formatTimeAgo(1000 * data.mtime)).css("display", "inline");
+        } else {
+            //$('#document_ctime').css("display", "none");
+            $('#document_mtime').css("display", "none");
+        }
+      };
+
+      var addHeaderAndDefs = function() {
+        var commentName = (coll + '/' + doc).replace('--', '-\\-');
+        $svg.append('<!-- document: ' + commentName + ' -->');
+        var defs = svg.defs();
+        var $blurFilter = $('<filter id="Gaussian_Blur"><feGaussianBlur in="SourceGraphic" stdDeviation="2" /></filter>');
+        svg.add(defs, $blurFilter);
+        return defs;
+      }
+
+      var getTextMeasurements = function(textsHash, options, callback) {
+        // make some text elements, find out the dimensions
+        var textMeasureGroup = svg.group(options);
+
+        // changed from $.each because of #264 ('length' can appear)
+        for (var text in textsHash) {
+          if (textsHash.hasOwnProperty(text)) {
+            svg.text(textMeasureGroup, 0, 0, text);
+          }
+        }
+
+        // measuring goes on here
+        var widths = {};
+        $(textMeasureGroup).find('text').each(function(svgTextNo, svgText) {
+          var text = $(svgText).text();
+          widths[text] = this.getComputedTextLength();
+
+          if (callback) {
+            $.each(textsHash[text], function(text, object) {
+              callback(object, svgText);
+            });
+          }
+        });
+        var bbox = textMeasureGroup.getBBox();
+        svg.remove(textMeasureGroup);
+
+        return new Measurements(widths, bbox.height, bbox.y);
+      };
+
+      var getTextAndSpanTextMeasurements = function() {
+        // get the span text sizes
+        var chunkTexts = {}; // set of span texts
+        $.each(data.chunks, function(chunkNo, chunk) {
+          chunk.row = undefined; // reset
+          if (!(chunk.text in chunkTexts)) chunkTexts[chunk.text] = []
+          var chunkText = chunkTexts[chunk.text];
+
+          // here we also need all the spans that are contained in
+          // chunks with this text, because we need to know the position
+          // of the span text within the respective chunk text
+          chunkText.push.apply(chunkText, chunk.fragments);
+          // and also the markedText boundaries
+          chunkText.push.apply(chunkText, chunk.markedTextStart);
+          chunkText.push.apply(chunkText, chunk.markedTextEnd);
+        });
+        var textSizes = getTextMeasurements(
+          chunkTexts,
+          undefined,
+          function(fragment, text) {
+            if (fragment instanceof Fragment) { // it's a fragment!
+              // measure the fragment text position in pixels
+              var firstChar = fragment.from - fragment.chunk.from;
+              if (firstChar < 0) {
+                firstChar = 0;
+                dispatcher.post('messages', [[['<strong>WARNING</strong>' +
+                  '<br/> ' +
+                  'The fragment [' + fragment.from + ', ' + fragment.to + '] (' + fragment.text + ') is not ' +
+                  'contained in its designated chunk [' +
+                  fragment.chunk.from + ', ' + fragment.chunk.to + '] most likely ' +
+                  'due to the fragment starting or ending with a space, please ' +
+                  'verify the sanity of your data since we are unable to ' +
+                  'visualise this fragment correctly and will drop leading ' +
+                  'space characters'
+                  , 'warning', 15]]]);
+              }
+              var startPos = text.getStartPositionOfChar(firstChar).x;
+              var lastChar = fragment.to - fragment.chunk.from - 1;
+              var endPos = (lastChar < 0)
+                ? startPos
+                : text.getEndPositionOfChar(lastChar).x;
+              fragment.curly = {
+                from: startPos,
+                to: endPos
+              };
+            } else { // it's markedText [id, start?, char#, offset]
+              if (fragment[2] < 0) fragment[2] = 0;
+              if (!fragment[2]) { // start
+                fragment[3] = text.getStartPositionOfChar(fragment[2]).x;
+              } else {
+                fragment[3] = text.getEndPositionOfChar(fragment[2] - 1).x + 1;
+              }
+            }
+          });
+
+        // get the fragment annotation text sizes
+        var fragmentTexts = {};
+        var noSpans = true;
+        $.each(data.spans, function(spanNo, span) {
+          $.each(span.fragments, function(fragmentNo, fragment) {
+            fragmentTexts[fragment.glyphedLabelText] = true;
+            noSpans = false;
+          });
+        });
+        if (noSpans) fragmentTexts.$ = true; // dummy so we can at least get the height
+        var fragmentSizes = getTextMeasurements(fragmentTexts, {'class': 'span'});
+
+        return {
+          texts: textSizes,
+          fragments: fragmentSizes
+        };
+      };
+
+      var addArcTextMeasurements = function(sizes) {
+        // get the arc annotation text sizes (for all labels)
+        var arcTexts = {};
+        $.each(data.arcs, function(arcNo, arc) {
+          var labels = Util.getArcLabels(spanTypes, data.spans[arc.origin].type, arc.type, relationTypesHash);
+          if (!labels.length) labels = [arc.type];
+          $.each(labels, function(labelNo, label) {
+            arcTexts[label] = true;
+          });
+        });
+        var arcSizes = getTextMeasurements(arcTexts, {'class': 'arcs'});
+        sizes.arcs = arcSizes;
+      };
+
+      var adjustTowerAnnotationSizes = function() {
+        // find biggest annotation in each tower
+        $.each(data.towers, function(towerNo, tower) {
+          var maxWidth = 0;
+          $.each(tower, function(fragmentNo, fragment) {
+            var width = data.sizes.fragments.widths[fragment.glyphedLabelText];
+            if (width > maxWidth) maxWidth = width;
+          }); // tower
+          $.each(tower, function(fragmentNo, fragment) {
+            fragment.width = maxWidth;
+          }); // tower
+        }); // data.towers
+      };
+
+      var makeArrow = function(defs, spec) {
+        var parsedSpec = spec.split(',');
+        var type = parsedSpec[0];
+        if (type == 'none') return;
+
+        var width = 5;
+        var height = 5;
+        var color = "black";
+        if ($.isNumeric(parsedSpec[1]) && parsedSpec[2]) {
+          if ($.isNumeric(parsedSpec[2]) && parsedSpec[3]) {
+            // 3 args, 2 numeric: assume width, height, color
+            width = parsedSpec[1];
+            height = parsedSpec[2];
+            color = parsedSpec[3] || 'black';
+          } else {
+            // 2 args, 1 numeric: assume width/height, color
+            width = height = parsedSpec[1];
+            color = parsedSpec[2] || 'black';
+          }
+        } else {
+          // other: assume color only
+          width = height = 5;
+          color = parsedSpec[1] || 'black';
+        }
+        // hash needs to be replaced as IDs don't permit it.
+        var arrowId = 'arrow_' + spec.replace(/#/g, '').replace(/,/g, '_');
+
+        var arrow;
+        if (type == 'triangle') {
+          arrow = svg.marker(defs, arrowId,
+            width, height / 2, width, height, 'auto',
+            {
+              markerUnits: 'strokeWidth',
+              'fill': color,
+            });
+          svg.polyline(arrow, [[0, 0], [width, height / 2], [0, height], [width / 12, height / 2]]);
+        }
+        return arrowId;
+      }
+
+
+      var drawing = false;
+      var redraw = false;
+
+      var renderDataReal = function(sourceData) {
+
+
+Util.profileEnd('before render');
+Util.profileStart('render');
+Util.profileStart('init');
+
+        if (!sourceData && !data) {
+          dispatcher.post('doneRendering', [coll, doc, args]);
+          return;
+        }
+        $svgDiv.show();
+        if ((sourceData && sourceData.collection && (sourceData.document !== doc || sourceData.collection !== coll)) || drawing) {
+          redraw = true;
+          dispatcher.post('doneRendering', [coll, doc, args]);
+          return;
+        }
+        redraw = false;
+        drawing = true;
+
+        if (sourceData) setData(sourceData);
+        showMtime();
+
+        // clear the SVG
+        svg.clear(true);
+        if (!data || data.length == 0) return;
+
+        // establish the width according to the enclosing element
+        canvasWidth = that.forceWidth || $svgDiv.width();
+
+        var defs = addHeaderAndDefs();
+
+        var backgroundGroup = svg.group({ 'class': 'background' });
+        var glowGroup = svg.group({ 'class': 'glow' });
+        highlightGroup = svg.group({ 'class': 'highlight' });
+        var textGroup = svg.group({ 'class': 'text' });
+
+Util.profileEnd('init');
+Util.profileStart('measures');
+
+        var sizes = getTextAndSpanTextMeasurements();
+        data.sizes = sizes;
+
+        adjustTowerAnnotationSizes();
+        var maxTextWidth = 0;
+        for (var text in sizes.texts.widths) {
+          if (sizes.texts.widths.hasOwnProperty(text)) {
+            var width = sizes.texts.widths[text]
+            if (width > maxTextWidth) maxTextWidth = width;
+          }
+        }
+
+Util.profileEnd('measures');
+Util.profileStart('chunks');
+
+        var currentX = Configuration.visual.margin.x + sentNumMargin + rowPadding;
+        var rows = [];
+        var fragmentHeights = [];
+        var sentenceToggle = 0;
+        var sentenceNumber = 0;
+        var row = new Row(svg);
+        row.sentence = ++sentenceNumber;
+        row.backgroundIndex = sentenceToggle;
+        row.index = 0;
+        var rowIndex = 0;
+        var twoBarWidths; // HACK to avoid measuring space's width
+        var openTextHighlights = {};
+        var textMarkedRows = [];
+
+        addArcTextMeasurements(sizes);
+
+        // reserve places for spans
+        var floors = [];
+        var reservations = []; // reservations[chunk][floor] = [[from, to, headroom]...]
+        for (var i = 0; i <= data.lastFragmentIndex; i++) {
+          reservation[i] = {};
+        }
+        var inf = 1.0/0.0;
+
+        $.each(data.spanDrawOrderPermutation, function(spanIdNo, spanId) {
+          var span = data.spans[spanId];
+
+          var f1 = span.fragments[0];
+          var f2 = span.fragments[span.fragments.length - 1];
+
+          var x1 = (f1.curly.from + f1.curly.to - f1.width) / 2 -
+              Configuration.visual.margin.x;
+          var i1 = f1.chunk.index;
+
+          var x2 = (f2.curly.from + f2.curly.to + f2.width) / 2 +
+              Configuration.visual.margin.x;
+          var i2 = f2.chunk.index;
+
+          // Start from the ground level, going up floor by floor.
+          // If no more floors, make a new available one.
+          // If a floor is available and there is no carpet, mark it as carpet.
+          // If a floor is available and there is carpet and height
+          //   difference is at least fragment height + curly, OK.
+          // If a floor is not available, forget about carpet.
+          // --
+          // When OK, calculate exact ceiling.
+          // If there isn't one, make a new floor, copy reservations
+          //   from floor below (with decreased ceiling)
+          // Make the reservation from the carpet to just below the
+          //   current floor.
+          //
+          // TODO drawCurly and height could be prettified to only check
+          // actual positions of curlies
+          var carpet = 0;
+          var outside = true;
+          var thisCurlyHeight = span.drawCurly ? Configuration.visual.curlyHeight : 0;
+          var height = sizes.fragments.height + thisCurlyHeight + Configuration.visual.boxSpacing +
+              2 * Configuration.visual.margin.y - 3;
+          $.each(floors, function(floorNo, floor) {
+            var floorAvailable = true;
+            for (var i = i1; i <= i2; i++) {
+              if (!(reservations[i] && reservations[i][floor])) continue;
+              var from = (i == i1) ? x1 : -inf;
+              var to = (i == i2) ? x2 : inf;
+              $.each(reservations[i][floor], function(resNo, res) {
+                if (res[0] < to && from < res[1]) {
+                  floorAvailable = false;
+                  return false;
+                }
+              });
+            }
+            if (floorAvailable) {
+              if (carpet === null) {
+                carpet = floor;
+              } else if (height + carpet <= floor) {
+                // found our floor!
+                outside = false;
+                return false;
+              }
+            } else {
+              carpet = null;
+            }
+          });
+          var reslen = reservations.length;
+          var makeNewFloorIfNeeded = function(floor) {
+            var floorNo = $.inArray(floor, floors);
+            if (floorNo == -1) {
+              floors.push(floor);
+              floors.sort(Util.cmp);
+              floorNo = $.inArray(floor, floors);
+              if (floorNo != 0) {
+                // copy reservations from the floor below
+                var parquet = floors[floorNo - 1];
+                for (var i = 0; i <= reslen; i++) {
+                  if (reservations[i]) {
+                    if (!reservations[i][parquet]) {
+                      reservations[i][parquet] = [];
+                    }
+                    var footroom = floor - parquet;
+                    $.each(reservations[i][parquet], function(resNo, res) {
+                      if (res[2] > footroom) {
+                        if (!reservations[i][floor]) {
+                          reservations[i][floor] = [];
+                        }
+                        reservations[i][floor].push([res[0], res[1], res[2] - footroom]);
+                      }
+                    });
+                  }
+                }
+              }
+            }
+            return floorNo;
+          }
+          var ceiling = carpet + height;
+          var ceilingNo = makeNewFloorIfNeeded(ceiling);
+          var carpetNo = makeNewFloorIfNeeded(carpet);
+          // make the reservation
+          var floor, floorNo;
+          for (floorNo = carpetNo;
+              (floor = floors[floorNo]) !== undefined && floor < ceiling;
+              floorNo++) {
+            var headroom = ceiling - floor;
+            for (var i = i1; i <= i2; i++) {
+              var from = (i == i1) ? x1 : 0;
+              var to = (i == i2) ? x2 : inf;
+              if (!reservations[i]) reservations[i] = {};
+              if (!reservations[i][floor]) reservations[i][floor] = [];
+              reservations[i][floor].push([from, to, headroom]); // XXX maybe add fragment; probably unnecessary
+            }
+          }
+          span.floor = carpet + thisCurlyHeight;
+        });
+
+        $.each(data.chunks, function(chunkNo, chunk) {
+          reservations = new Array();
+          chunk.group = svg.group(row.group);
+          chunk.highlightGroup = svg.group(chunk.group);
+
+          var y = 0;
+          var minArcDist;
+          var hasLeftArcs, hasRightArcs, hasInternalArcs;
+          var hasAnnotations;
+          var chunkFrom = Infinity;
+          var chunkTo = 0;
+          var chunkHeight = 0;
+          var spacing = 0;
+          var spacingChunkId = null;
+          var spacingRowBreak = 0;
+
+          $.each(chunk.fragments, function(fragmentNo, fragment) {
+            var span = fragment.span;
+            var spanDesc = spanTypes[span.type];
+            var bgColor = ((spanDesc && spanDesc.bgColor) ||
+                           (spanTypes.SPAN_DEFAULT &&
+                            spanTypes.SPAN_DEFAULT.bgColor) || '#ffffff');
+            var fgColor = ((spanDesc && spanDesc.fgColor) ||
+                           (spanTypes.SPAN_DEFAULT &&
+                            spanTypes.SPAN_DEFAULT.fgColor) || '#000000');
+            var borderColor = ((spanDesc && spanDesc.borderColor) ||
+                               (spanTypes.SPAN_DEFAULT &&
+                                spanTypes.SPAN_DEFAULT.borderColor) || '#000000');
+
+            // special case: if the border 'color' value is 'darken',
+            // then just darken the BG color a bit for the border.
+            if (borderColor == 'darken') {
+                borderColor = Util.adjustColorLightness(bgColor, -0.6);
+            }
+
+            fragment.group = svg.group(chunk.group, {
+              'class': 'span',
+            });
+
+            var fragmentHeight = 0;
+
+            if (!y) y = -sizes.texts.height;
+            var x = (fragment.curly.from + fragment.curly.to) / 2;
+
+            // XXX is it maybe sizes.texts?
+            var yy = y + sizes.fragments.y;
+            var hh = sizes.fragments.height;
+            var ww = fragment.width;
+            var xx = x - ww / 2;
+
+            // text margin fine-tuning
+            yy += boxTextMargin.y;
+            hh -= 2*boxTextMargin.y;
+            xx += boxTextMargin.x;
+            ww -= 2*boxTextMargin.x;
+            var rectClass = 'span_' + (span.cue || span.type) + ' span_default'; // TODO XXX first part unneeded I think; remove
+
+            // attach e.g. "False_positive" into the type
+            if (span.comment && span.comment.type) { rectClass += ' '+span.comment.type; }
+            var bx = xx - Configuration.visual.margin.x - boxTextMargin.x;
+            var by = yy - Configuration.visual.margin.y;
+            var bw = ww + 2 * Configuration.visual.margin.x;
+            var bh = hh + 2 * Configuration.visual.margin.y;
+
+            if (roundCoordinates) {
+              x  = (x|0)+0.5;
+              bx = (bx|0)+0.5;
+            }
+
+            var shadowRect;
+            var markedRect;
+            if (span.marked) {
+              markedRect = svg.rect(chunk.highlightGroup,
+                  bx - markedSpanSize, by - markedSpanSize,
+                  bw + 2 * markedSpanSize, bh + 2 * markedSpanSize, {
+
+                  // filter: 'url(#Gaussian_Blur)',
+                  'class': "shadow_EditHighlight",
+                  rx: markedSpanSize,
+                  ry: markedSpanSize,
+              });
+              svg.other(markedRect, 'animate', {
+                'data-type': span.marked,
+                attributeName: 'fill',
+                values: (span.marked == 'match'? highlightMatchSequence
+                         : highlightSpanSequence),
+                dur: highlightDuration,
+                repeatCount: 'indefinite',
+                begin: 'indefinite'
+              });
+              chunkFrom = Math.min(bx - markedSpanSize, chunkFrom);
+              chunkTo = Math.max(bx + bw + markedSpanSize, chunkTo);
+              fragmentHeight = Math.max(bh + 2 * markedSpanSize, fragmentHeight);
+            }
+            // .match() removes unconfigured shadows, which were
+            // always showing up as black.
+            // TODO: don't hard-code configured shadowclasses.
+            if (span.shadowClass &&
+                span.shadowClass.match('True_positive|False_positive|False_negative|AnnotationError|AnnotationWarning|AnnotatorNotes|Normalized|AnnotationIncomplete|AnnotationUnconfirmed|rectEditHighlight|EditHighlight_arc|MissingAnnotation|ChangedAnnotation ')) {
+              shadowRect = svg.rect(fragment.group,
+                  bx - rectShadowSize, by - rectShadowSize,
+                  bw + 2 * rectShadowSize, bh + 2 * rectShadowSize, {
+                  'class': 'shadow_' + span.shadowClass,
+                  filter: 'url(#Gaussian_Blur)',
+                  rx: rectShadowRounding,
+                  ry: rectShadowRounding,
+              });
+              chunkFrom = Math.min(bx - rectShadowSize, chunkFrom);
+              chunkTo = Math.max(bx + bw + rectShadowSize, chunkTo);
+              fragmentHeight = Math.max(bh + 2 * rectShadowSize, fragmentHeight);
+            }
+            fragment.rect = svg.rect(fragment.group,
+                bx, by, bw, bh, {
+
+                'class': rectClass,
+                fill: bgColor,
+                stroke: borderColor,
+                rx: Configuration.visual.margin.x,
+                ry: Configuration.visual.margin.y,
+                'data-span-id': span.id,
+                'data-fragment-id': fragment.id,
+                'strokeDashArray': span.attributeMerge.dashArray,
+              });
+
+            // TODO XXX: quick nasty hack to allow normalizations
+            // to be marked visually; do something cleaner!
+            if (span.normalized) {
+              $(fragment.rect).addClass(span.normalized);
+            }
+
+            fragment.right = bx + bw; // TODO put it somewhere nicer?
+            if (!(span.shadowClass || span.marked)) {
+              chunkFrom = Math.min(bx, chunkFrom);
+              chunkTo = Math.max(bx + bw, chunkTo);
+              fragmentHeight = Math.max(bh, fragmentHeight);
+            }
+
+            fragment.rectBox = { x: bx, y: by - span.floor, width: bw, height: bh };
+            fragment.height = span.floor + hh + 3 * Configuration.visual.margin.y + Configuration.visual.curlyHeight + Configuration.visual.arcSpacing;
+            var spacedTowerId = fragment.towerId * 2;
+            if (!fragmentHeights[spacedTowerId] || fragmentHeights[spacedTowerId] < fragment.height) {
+              fragmentHeights[spacedTowerId] = fragment.height;
+            }
+            $(fragment.rect).attr('y', yy - Configuration.visual.margin.y - span.floor);
+            if (shadowRect) {
+              $(shadowRect).attr('y', yy - rectShadowSize - Configuration.visual.margin.y - span.floor);
+            }
+            if (markedRect) {
+              $(markedRect).attr('y', yy - markedSpanSize - Configuration.visual.margin.y - span.floor);
+            }
+            if (span.attributeMerge.box === "crossed") {
+              svg.path(fragment.group, svg.createPath().
+                  move(xx, yy - Configuration.visual.margin.y - span.floor).
+                  line(xx + fragment.width,
+                    yy + hh + Configuration.visual.margin.y - span.floor),
+                  { 'class': 'boxcross' });
+              svg.path(fragment.group, svg.createPath().
+                  move(xx + fragment.width, yy - Configuration.visual.margin.y - span.floor).
+                  line(xx, yy + hh + Configuration.visual.margin.y - span.floor),
+                  { 'class': 'boxcross' });
+            }
+            var fragmentText = svg.text(fragment.group, x, y - span.floor, data.spanAnnTexts[fragment.glyphedLabelText], { fill: fgColor });
+
+            // Make curlies to show the fragment
+            if (fragment.drawCurly) {
+              var curlyColor = 'grey';
+              if (coloredCurlies) {
+                var spanDesc = spanTypes[span.type];
+                var bgColor = ((spanDesc && spanDesc.bgColor) ||
+                               (spanTypes.SPAN_DEFAULT &&
+                                spanTypes.SPAN_DEFAULT.fgColor) ||
+                               '#000000');
+                curlyColor = Util.adjustColorLightness(bgColor, -0.6);
+              }
+
+              var bottom = yy + hh + Configuration.visual.margin.y - span.floor + 1;
+              svg.path(fragment.group, svg.createPath()
+                  .move(fragment.curly.from, bottom + Configuration.visual.curlyHeight)
+                  .curveC(fragment.curly.from, bottom,
+                    x, bottom + Configuration.visual.curlyHeight,
+                    x, bottom)
+                  .curveC(x, bottom + Configuration.visual.curlyHeight,
+                    fragment.curly.to, bottom,
+                    fragment.curly.to, bottom + Configuration.visual.curlyHeight),
+                {
+                  'class': 'curly',
+                  'stroke': curlyColor,
+                });
+              chunkFrom = Math.min(fragment.curly.from, chunkFrom);
+              chunkTo = Math.max(fragment.curly.to, chunkTo);
+              fragmentHeight = Math.max(Configuration.visual.curlyHeight, fragmentHeight);
+            }
+
+            if (fragment == span.headFragment) {
+              // find the gap to fit the backwards arcs, but only on
+              // head fragment - other fragments don't have arcs
+              $.each(span.incoming, function(arcId, arc) {
+                var leftSpan = data.spans[arc.origin];
+                var origin = leftSpan.headFragment.chunk;
+                var border;
+                if (chunk.index == origin.index) {
+                  hasInternalArcs = true;
+                }
+                if (origin.row) {
+                  var labels = Util.getArcLabels(spanTypes, leftSpan.type, arc.type, relationTypesHash);
+                  if (!labels.length) labels = [arc.type];
+                  if (origin.row.index == rowIndex) {
+                    // same row, but before this
+                    border = origin.translation.x + leftSpan.fragments[leftSpan.fragments.length - 1].right;
+                  } else {
+                    border = Configuration.visual.margin.x + sentNumMargin + rowPadding;
+                  }
+                  var labelNo = Configuration.abbrevsOn ? labels.length - 1 : 0;
+                  var smallestLabelWidth = sizes.arcs.widths[labels[labelNo]] + 2 * minArcSlant;
+                  var gap = currentX + bx - border;
+                  var arcSpacing = smallestLabelWidth - gap;
+                  if (!hasLeftArcs || spacing < arcSpacing) {
+                    spacing = arcSpacing;
+                    spacingChunkId = origin.index + 1;
+                  }
+                  arcSpacing = smallestLabelWidth - bx;
+                  if (!hasLeftArcs || spacingRowBreak < arcSpacing) {
+                    spacingRowBreak = arcSpacing;
+                  }
+                  hasLeftArcs = true;
+                } else {
+                  hasRightArcs = true;
+                }
+              });
+              $.each(span.outgoing, function(arcId, arc) {
+                var leftSpan = data.spans[arc.target];
+                var target = leftSpan.headFragment.chunk;
+                var border;
+                if (target.row) {
+                  var labels = Util.getArcLabels(spanTypes, span.type, arc.type, relationTypesHash);
+                  if (!labels.length) labels = [arc.type];
+                  if (target.row.index == rowIndex) {
+                    // same row, but before this
+                    border = target.translation.x + leftSpan.fragments[leftSpan.fragments.length - 1].right;
+                  } else {
+                    border = Configuration.visual.margin.x + sentNumMargin + rowPadding;
+                  }
+                  var labelNo = Configuration.abbrevsOn ? labels.length - 1 : 0;
+                  var smallestLabelWidth = sizes.arcs.widths[labels[labelNo]] + 2 * minArcSlant;
+                  var gap = currentX + bx - border;
+                  var arcSpacing = smallestLabelWidth - gap;
+                  if (!hasLeftArcs || spacing < arcSpacing) {
+                    spacing = arcSpacing;
+                    spacingChunkId = target.index + 1;
+                  }
+                  arcSpacing = smallestLabelWidth - bx;
+                  if (!hasLeftArcs || spacingRowBreak < arcSpacing) {
+                    spacingRowBreak = arcSpacing;
+                  }
+                  hasLeftArcs = true;
+                } else {
+                  hasRightArcs = true;
+                }
+              });
+            }
+            fragmentHeight += span.floor || Configuration.visual.curlyHeight;
+            if (fragmentHeight > chunkHeight) chunkHeight = fragmentHeight;
+            hasAnnotations = true;
+          }); // fragments
+
+          // positioning of the chunk
+          chunk.right = chunkTo;
+          var textWidth = sizes.texts.widths[chunk.text];
+          chunkHeight += sizes.texts.height;
+          var boxX = -Math.min(chunkFrom, 0);
+          var boxWidth =
+              Math.max(textWidth, chunkTo) -
+              Math.min(0, chunkFrom);
+          // if (hasLeftArcs) {
+            // TODO change this with smallestLeftArc
+            // var spacing = arcHorizontalSpacing - (currentX - lastArcBorder);
+            // arc too small?
+          if (spacing > 0) currentX += spacing;
+          // }
+          var rightBorderForArcs = hasRightArcs ? arcHorizontalSpacing : (hasInternalArcs ? arcSlant : 0);
+
+          var lastX = currentX;
+          var lastRow = row;
+
+          if (chunk.sentence) {
+            while (sentenceNumber < chunk.sentence) {
+              sentenceNumber++;
+              row.arcs = svg.group(row.group, { 'class': 'arcs' });
+              rows.push(row);
+              row = new Row(svg);
+              sentenceToggle = 1 - sentenceToggle;
+              row.backgroundIndex = sentenceToggle;
+              row.index = ++rowIndex;
+            }
+            sentenceToggle = 1 - sentenceToggle;
+          }
+
+          if (chunk.sentence ||
+              currentX + boxWidth + rightBorderForArcs >= canvasWidth - 2 * Configuration.visual.margin.x) {
+            // the chunk does not fit
+            row.arcs = svg.group(row.group, { 'class': 'arcs' });
+            // TODO: related to issue #571
+            // replace arcHorizontalSpacing with a calculated value
+            currentX = Configuration.visual.margin.x + sentNumMargin + rowPadding +
+                (hasLeftArcs ? arcHorizontalSpacing : (hasInternalArcs ? arcSlant : 0));
+            if (hasLeftArcs) {
+              var adjustedCurTextWidth = sizes.texts.widths[chunk.text] + arcHorizontalSpacing;
+              if (adjustedCurTextWidth > maxTextWidth) {
+                maxTextWidth = adjustedCurTextWidth;
+              }
+            }
+            if (spacingRowBreak > 0) {
+              currentX += spacingRowBreak;
+              spacing = 0; // do not center intervening elements
+            }
+
+            // new row
+            rows.push(row);
+
+            svg.remove(chunk.group);
+            row = new Row(svg);
+            row.backgroundIndex = sentenceToggle;
+            row.index = ++rowIndex;
+            svg.add(row.group, chunk.group);
+            chunk.group = row.group.lastElementChild;
+            $(chunk.group).children("g[class='span']").
+              each(function(index, element) {
+                  chunk.fragments[index].group = element;
+              });
+            $(chunk.group).find("rect[data-span-id]").
+              each(function(index, element) {
+                  chunk.fragments[index].rect = element;
+              });
+          }
+
+          // break the text highlights when the row breaks
+          if (row.index !== lastRow.index) {
+            $.each(openTextHighlights, function(textId, textDesc) {
+              if (textDesc[3] != lastX) {
+                var newDesc = [lastRow, textDesc[3], lastX + boxX, textDesc[4]];
+                textMarkedRows.push(newDesc);
+              }
+              textDesc[3] = currentX;
+            });
+          }
+
+          // open text highlights
+          $.each(chunk.markedTextStart, function(textNo, textDesc) {
+            textDesc[3] += currentX + boxX;
+            openTextHighlights[textDesc[0]] = textDesc;
+          });
+
+          // close text highlights
+          $.each(chunk.markedTextEnd, function(textNo, textDesc) {
+            textDesc[3] += currentX + boxX;
+            var startDesc = openTextHighlights[textDesc[0]];
+            delete openTextHighlights[textDesc[0]];
+            markedRow = [row, startDesc[3], textDesc[3], startDesc[4]];
+            textMarkedRows.push(markedRow);
+          });
+
+          // XXX check this - is it used? should it be lastRow?
+          if (hasAnnotations) row.hasAnnotations = true;
+
+          if (chunk.sentence) {
+            row.sentence = ++sentenceNumber;
+          }
+
+          if (spacing > 0) {
+            // if we added a gap, center the intervening elements
+            spacing /= 2;
+            var firstChunkInRow = row.chunks[row.chunks.length - 1];
+            if (spacingChunkId < firstChunkInRow.index) {
+              spacingChunkId = firstChunkInRow.index + 1;
+            }
+            for (var chunkIndex = spacingChunkId; chunkIndex < chunk.index; chunkIndex++) {
+              var movedChunk = data.chunks[chunkIndex];
+              translate(movedChunk, movedChunk.translation.x + spacing, 0);
+              movedChunk.textX += spacing;
+            }
+          }
+
+          row.chunks.push(chunk);
+          chunk.row = row;
+
+          translate(chunk, currentX + boxX, 0);
+          chunk.textX = currentX + boxX;
+
+          var spaceWidth = 0;
+          var spaceLen = chunk.nextSpace && chunk.nextSpace.length || 0;
+          for (var i = 0; i < spaceLen; i++) spaceWidth += spaceWidths[chunk.nextSpace[i]] || 0;
+          currentX += spaceWidth + boxWidth;
+        }); // chunks
+
+        // finish the last row
+        row.arcs = svg.group(row.group, { 'class': 'arcs' });
+        rows.push(row);
+
+Util.profileEnd('chunks');
+Util.profileStart('arcsPrep');
+
+        var arrows = {};
+        var arrow = makeArrow(defs, 'none');
+        if (arrow) arrows['none'] = arrow;
+
+        var len = fragmentHeights.length;
+        for (var i = 0; i < len; i++) {
+          if (!fragmentHeights[i] || fragmentHeights[i] < Configuration.visual.arcStartHeight) {
+            fragmentHeights[i] = Configuration.visual.arcStartHeight;
+          }
+        }
+
+        // find out how high the arcs have to go
+        $.each(data.arcs, function(arcNo, arc) {
+          arc.jumpHeight = 0;
+          var fromFragment = data.spans[arc.origin].headFragment;
+          var toFragment = data.spans[arc.target].headFragment;
+          if (fromFragment.towerId > toFragment.towerId) {
+            var tmp = fromFragment; fromFragment = toFragment; toFragment = tmp;
+          }
+          var from, to;
+          if (fromFragment.chunk.index == toFragment.chunk.index) {
+            from = fromFragment.towerId;
+            to = toFragment.towerId;
+          } else {
+            from = fromFragment.towerId + 1;
+            to = toFragment.towerId - 1;
+          }
+          for (var i = from; i <= to; i++) {
+            if (arc.jumpHeight < fragmentHeights[i * 2]) arc.jumpHeight = fragmentHeights[i * 2];
+          }
+        });
+
+        // sort the arcs
+        data.arcs.sort(function(a, b) {
+          // first write those that have less to jump over
+          var tmp = a.jumpHeight - b.jumpHeight;
+          if (tmp) return tmp < 0 ? -1 : 1;
+          // if equal, then those that span less distance
+          tmp = a.dist - b.dist;
+          if (tmp) return tmp < 0 ? -1 : 1;
+          // if equal, then those where heights of the targets are smaller
+          tmp = data.spans[a.origin].headFragment.height + data.spans[a.target].headFragment.height -
+            data.spans[b.origin].headFragment.height - data.spans[b.target].headFragment.height;
+          if (tmp) return tmp < 0 ? -1 : 1;
+          // if equal, then those with the lower origin
+          tmp = data.spans[a.origin].headFragment.height - data.spans[b.origin].headFragment.height;
+          if (tmp) return tmp < 0 ? -1 : 1;
+          // if equal, they're just equal.
+          return 0;
+        });
+
+        // draw the drag arc marker
+        var arrowhead = svg.marker(defs, 'drag_arrow',
+          5, 2.5, 5, 5, 'auto',
+          {
+            markerUnits: 'strokeWidth',
+            'class': 'drag_fill',
+          });
+        svg.polyline(arrowhead, [[0, 0], [5, 2.5], [0, 5], [0.2, 2.5]]);
+
+Util.profileEnd('arcsPrep');
+Util.profileStart('arcs');
+
+        // add the arcs
+        $.each(data.arcs, function(arcNo, arc) {
+          // separate out possible numeric suffix from type
+          var noNumArcType;
+          var splitArcType;
+          if (arc.type) {
+            splitArcType = arc.type.match(/^(.*?)(\d*)$/);
+            noNumArcType = splitArcType[1];
+          }
+
+          var originSpan = data.spans[arc.origin];
+          var targetSpan = data.spans[arc.target];
+
+          var leftToRight = originSpan.headFragment.towerId < targetSpan.headFragment.towerId;
+          var left, right;
+          if (leftToRight) {
+            left = originSpan.headFragment;
+            right = targetSpan.headFragment;
+          } else {
+            left = targetSpan.headFragment;
+            right = originSpan.headFragment;
+          }
+
+          var spanDesc = spanTypes[originSpan.type];
+          // TODO: might make more sense to reformat this as dict instead
+          // of searching through the list every type
+          var arcDesc;
+          if (spanDesc && spanDesc.arcs) {
+            $.each(spanDesc.arcs, function(arcDescNo, arcDescIter) {
+                if (arcDescIter.type == arc.type) {
+                  arcDesc = arcDescIter;
+                }
+              });
+          }
+          // fall back on unnumbered type if not found in full
+          if (!arcDesc && noNumArcType && noNumArcType != arc.type &&
+            spanDesc && spanDesc.arcs) {
+            $.each(spanDesc.arcs, function(arcDescNo, arcDescIter) {
+                if (arcDescIter.type == noNumArcType) {
+                  arcDesc = arcDescIter;
+                }
+              });
+          }
+          // fall back on relation types in case we still don't have
+          // an arc description, with final fallback to unnumbered relation
+          if (!arcDesc) {
+            arcDesc = $.extend({}, relationTypesHash[arc.type] || relationTypesHash[noNumArcType]);
+          }
+          var color = ((arcDesc && arcDesc.color) ||
+                       (spanTypes.ARC_DEFAULT && spanTypes.ARC_DEFAULT.color) ||
+                       '#000000');
+          var symmetric = arcDesc && arcDesc.properties && arcDesc.properties.symmetric;
+          var dashArray = arcDesc && arcDesc.dashArray;
+          var arrowHead = ((arcDesc && arcDesc.arrowHead) ||
+                           (spanTypes.ARC_DEFAULT && spanTypes.ARC_DEFAULT.arrowHead) ||
+                           'triangle,5') + ',' + color;
+          var labelArrowHead = ((arcDesc && arcDesc.labelArrow) ||
+                                (spanTypes.ARC_DEFAULT && spanTypes.ARC_DEFAULT.labelArrow) ||
+                                'triangle,5') + ',' + color;
+
+          var leftBox = rowBBox(left);
+          var rightBox = rowBBox(right);
+          var leftRow = left.chunk.row.index;
+          var rightRow = right.chunk.row.index;
+
+          if (!arrows[arrowHead]) {
+            var arrow = makeArrow(defs, arrowHead);
+            if (arrow) arrows[arrowHead] = arrow;
+          }
+          if (!arrows[labelArrowHead]) {
+            var arrow = makeArrow(defs, labelArrowHead);
+            if (arrow) arrows[labelArrowHead] = arrow;
+          }
+
+          // find the next height
+          var height = 0;
+
+          var fromIndex2, toIndex2;
+          if (left.chunk.index == right.chunk.index) {
+            fromIndex2 = left.towerId * 2;
+            toIndex2 = right.towerId * 2;
+          } else {
+            fromIndex2 = left.towerId * 2 + 1;
+            toIndex2 = right.towerId * 2 - 1;
+          }
+          for (var i = fromIndex2; i <= toIndex2; i++) {
+            if (fragmentHeights[i] > height) height = fragmentHeights[i];
+          }
+          height += Configuration.visual.arcSpacing;
+          var leftSlantBound, rightSlantBound;
+          for (var i = fromIndex2; i <= toIndex2; i++) {
+            if (fragmentHeights[i] < height) fragmentHeights[i] = height;
+          }
+
+          // Adjust the height to align with pixels when rendered
+
+          // TODO: on at least Chrome, this doesn't make a difference:
+          // the lines come out pixel-width even without it. Check.
+          height += 0.5
+
+          var chunkReverse = false;
+          var ufoCatcher = originSpan.headFragment.chunk.index == targetSpan.headFragment.chunk.index;
+          if (ufoCatcher) {
+            chunkReverse =
+              leftBox.x + leftBox.width / 2 < rightBox.x + rightBox.width / 2;
+          }
+          var ufoCatcherMod = ufoCatcher ? chunkReverse ? -0.5 : 0.5 : 1;
+
+          for (var rowIndex = leftRow; rowIndex <= rightRow; rowIndex++) {
+            var row = rows[rowIndex];
+            row.hasAnnotations = true;
+            var arcGroup = svg.group(row.arcs, {
+                'data-from': arc.origin,
+                'data-to': arc.target
+            });
+            var from, to;
+
+            if (rowIndex == leftRow) {
+              from = leftBox.x + (chunkReverse ? 0 : leftBox.width);
+            } else {
+              from = sentNumMargin;
+            }
+
+            if (rowIndex == rightRow) {
+              to = rightBox.x + (chunkReverse ? rightBox.width : 0);
+            } else {
+              to = canvasWidth - 2 * Configuration.visual.margin.y;
+            }
+
+            var originType = data.spans[arc.origin].type;
+            var arcLabels = Util.getArcLabels(spanTypes, originType, arc.type, relationTypesHash);
+            var labelText = Util.arcDisplayForm(spanTypes, originType, arc.type, relationTypesHash);
+            // if (Configuration.abbrevsOn && !ufoCatcher && arcLabels) {
+            if (Configuration.abbrevsOn && arcLabels) {
+              var labelIdx = 1; // first abbreviation
+              // strictly speaking 2*arcSlant would be needed to allow for
+              // the full-width arcs to fit, but judged unabbreviated text
+              // to be more important than the space for arcs.
+              var maxLength = (to - from) - (arcSlant);
+              while (sizes.arcs.widths[labelText] > maxLength &&
+                     arcLabels[labelIdx]) {
+                labelText = arcLabels[labelIdx];
+                labelIdx++;
+              }
+            }
+
+            var shadowGroup;
+            if (arc.shadowClass || arc.marked) {
+              shadowGroup = svg.group(arcGroup);
+            }
+            var options = {
+              'fill': color,
+              'data-arc-role': arc.type,
+              'data-arc-origin': arc.origin,
+              'data-arc-target': arc.target,
+              // TODO: confirm this is unused and remove.
+              //'data-arc-id': arc.id,
+              'data-arc-ed': arc.eventDescId,
+            };
+
+            // construct SVG text, showing possible trailing index
+            // numbers (as in e.g. "Theme2") as subscripts
+            var svgText;
+            if (!splitArcType[2]) {
+                // no subscript, simple string suffices
+                svgText = labelText;
+            } else {
+                // Need to parse out possible numeric suffixes to avoid
+                // duplicating number in label and its subscript
+                var splitLabelText = labelText.match(/^(.*?)(\d*)$/);
+                var noNumLabelText = splitLabelText[1];
+
+                svgText = svg.createText();
+                // TODO: to address issue #453, attaching options also
+                // to spans, not only primary text. Make sure there
+                // are no problems with this.
+                svgText.span(noNumLabelText, options);
+                var subscriptSettings = {
+                  'dy': '0.3em',
+                  'font-size': '80%'
+                };
+                // alternate possibility
+//                 var subscriptSettings = {
+//                   'baseline-shift': 'sub',
+//                   'font-size': '80%'
+//                 };
+                $.extend(subscriptSettings, options);
+                svgText.span(splitArcType[2], subscriptSettings);
+            }
+
+            // guess at the correct baseline shift to get vertical centering.
+            // (CSS dominant-baseline can't be used as not all SVG rendereds support it.)
+            var baseline_shift = sizes.arcs.height / 4;
+            var text = svg.text(arcGroup, (from + to) / 2, -height + baseline_shift,
+                                svgText, options);
+
+            var width = sizes.arcs.widths[labelText];
+            var textBox = {
+              x: (from + to - width) / 2,
+              width: width,
+              y: -height - sizes.arcs.height / 2,
+              height: sizes.arcs.height,
+            }
+            if (arc.marked) {
+              var markedRect = svg.rect(shadowGroup,
+                  textBox.x - markedArcSize, textBox.y - markedArcSize,
+                  textBox.width + 2 * markedArcSize, textBox.height + 2 * markedArcSize, {
+                    // filter: 'url(#Gaussian_Blur)',
+                    'class': "shadow_EditHighlight",
+                    rx: markedArcSize,
+                    ry: markedArcSize,
+              });
+              svg.other(markedRect, 'animate', {
+                'data-type': arc.marked,
+                attributeName: 'fill',
+                values: (arc.marked == 'match' ? highlightMatchSequence
+                         : highlightArcSequence),
+                dur: highlightDuration,
+                repeatCount: 'indefinite',
+                begin: 'indefinite'
+              });
+            }
+            if (arc.shadowClass) {
+              svg.rect(shadowGroup,
+                  textBox.x - arcLabelShadowSize,
+                  textBox.y - arcLabelShadowSize,
+                  textBox.width  + 2 * arcLabelShadowSize,
+                  textBox.height + 2 * arcLabelShadowSize, {
+                    'class': 'shadow_' + arc.shadowClass,
+                    filter: 'url(#Gaussian_Blur)',
+                    rx: arcLabelShadowRounding,
+                    ry: arcLabelShadowRounding,
+              });
+            }
+            var textStart = textBox.x;
+            var textEnd = textBox.x + textBox.width;
+
+            // adjust by margin for arc drawing
+            textStart -= Configuration.visual.arcTextMargin;
+            textEnd += Configuration.visual.arcTextMargin;
+
+            if (from > to) {
+              var tmp = textStart; textStart = textEnd; textEnd = tmp;
+            }
+
+            var path;
+
+            if (roundCoordinates) {
+              // don't ask
+              height = (height|0)+0.5;
+            }
+            if (height > row.maxArcHeight) row.maxArcHeight = height;
+
+            var myArrowHead   = ((arcDesc && arcDesc.arrowHead) ||
+                                 (spanTypes.ARC_DEFAULT && spanTypes.ARC_DEFAULT.arrowHead));
+            var arrowName = (leftToRight ?
+                symmetric && myArrowHead || 'none' :
+                myArrowHead || 'triangle,5') + ',' + color;
+            var arrowType = arrows[arrowName];
+            var arrowDecl = arrowType && ('url(#' + arrowType + ')');
+
+            var arrowAtLabelAdjust = 0;
+            var labelArrowDecl = null;
+            var myLabelArrowHead = ((arcDesc && arcDesc.labelArrow) ||
+                                    (spanTypes.ARC_DEFAULT && spanTypes.ARC_DEFAULT.labelArrow));
+            if (myLabelArrowHead) {
+              var labelArrowName = (leftToRight ?
+                  symmetric && myLabelArrowHead || 'none' :
+                  myLabelArrowHead || 'triangle,5') + ',' + color;
+              var labelArrowSplit = labelArrowName.split(',');
+              arrowAtLabelAdjust = labelArrowSplit[0] != 'none' && parseInt(labelArrowSplit[1], 10) || 0;
+              var labelArrowType = arrows[labelArrowName];
+              var labelArrowDecl = labelArrowType && ('url(#' + labelArrowType + ')');
+              if (ufoCatcher) arrowAtLabelAdjust = -arrowAtLabelAdjust;
+            }
+            var arrowStart = textStart - arrowAtLabelAdjust;
+            path = svg.createPath().move(arrowStart, -height);
+            if (rowIndex == leftRow) {
+              var cornerx = from + ufoCatcherMod * arcSlant;
+              // for normal cases, should not be past textStart even if narrow
+              if (!ufoCatcher && cornerx > arrowStart - 1) { cornerx = arrowStart - 1; }
+              if (smoothArcCurves) {
+                var controlx = ufoCatcher ? cornerx + 2*ufoCatcherMod*reverseArcControlx : smoothArcSteepness*from+(1-smoothArcSteepness)*cornerx;
+                var endy = leftBox.y + (leftToRight || arc.equiv ? leftBox.height / 2 : Configuration.visual.margin.y);
+                // no curving for short lines covering short vertical
+                // distances, the arrowheads can go off (#925)
+                if (Math.abs(-height-endy) < 2 &&
+                    Math.abs(cornerx-from) < 5) {
+                  endy = -height;
+                }
+                line = path.line(cornerx, -height).
+                    curveQ(controlx, -height, from, endy);
+              } else {
+                path.line(cornerx, -height).
+                    line(from, leftBox.y + (leftToRight || arc.equiv ? leftBox.height / 2 : Configuration.visual.margin.y));
+              }
+            } else {
+              path.line(from, -height);
+            }
+            svg.path(arcGroup, path, {
+                markerEnd: arrowDecl,
+                markerStart: labelArrowDecl,
+                style: 'stroke: ' + color,
+                'strokeDashArray': dashArray,
+            });
+            if (arc.marked) {
+              svg.path(shadowGroup, path, {
+                  'class': 'shadow_EditHighlight_arc',
+                  strokeWidth: markedArcStroke,
+                  'strokeDashArray': dashArray,
+              });
+              svg.other(markedRect, 'animate', {
+                'data-type': arc.marked,
+                attributeName: 'fill',
+                values: (arc.marked == 'match' ? highlightMatchSequence
+                         : highlightArcSequence),
+                dur: highlightDuration,
+                repeatCount: 'indefinite',
+                begin: 'indefinite'
+              });
+            }
+            if (arc.shadowClass) {
+              svg.path(shadowGroup, path, {
+                  'class': 'shadow_' + arc.shadowClass,
+                  strokeWidth: shadowStroke,
+                  'strokeDashArray': dashArray,
+              });
+            }
+            var myArrowHead = ((arcDesc && arcDesc.arrowHead) ||
+                               (spanTypes.ARC_DEFAULT && spanTypes.ARC_DEFAULT.arrowHead));
+            var arrowName = (leftToRight ?
+                myArrowHead || 'triangle,5' :
+                symmetric && myArrowHead || 'none') + ',' + color;
+            var arrowType = arrows[arrowName];
+            var arrowDecl = arrowType && ('url(#' + arrowType + ')');
+
+            var arrowAtLabelAdjust = 0;
+            var labelArrowDecl = null;
+            var myLabelArrowHead = ((arcDesc && arcDesc.labelArrow) ||
+                                    (spanTypes.ARC_DEFAULT && spanTypes.ARC_DEFAULT.labelArrow));
+            if (myLabelArrowHead) {
+              var labelArrowName = (leftToRight ?
+                  myLabelArrowHead || 'triangle,5' :
+                  symmetric && myLabelArrowHead || 'none') + ',' + color;
+              var labelArrowSplit = labelArrowName.split(',');
+              arrowAtLabelAdjust = labelArrowSplit[0] != 'none' && parseInt(labelArrowSplit[1], 10) || 0;
+              var labelArrowType = arrows[labelArrowName];
+              var labelArrowDecl = labelArrowType && ('url(#' + labelArrowType + ')');
+              if (ufoCatcher) arrowAtLabelAdjust = -arrowAtLabelAdjust;
+            }
+            var arrowEnd = textEnd + arrowAtLabelAdjust;
+            path = svg.createPath().move(arrowEnd, -height);
+            if (rowIndex == rightRow) {
+              var cornerx  = to - ufoCatcherMod * arcSlant;
+              // TODO: duplicates above in part, make funcs
+              // for normal cases, should not be past textEnd even if narrow
+              if (!ufoCatcher && cornerx < arrowEnd + 1) { cornerx = arrowEnd + 1; }
+              if (smoothArcCurves) {
+                var controlx = ufoCatcher ? cornerx - 2*ufoCatcherMod*reverseArcControlx : smoothArcSteepness*to+(1-smoothArcSteepness)*cornerx;
+                var endy = rightBox.y + (leftToRight && !arc.equiv ? Configuration.visual.margin.y : rightBox.height / 2);
+                // no curving for short lines covering short vertical
+                // distances, the arrowheads can go off (#925)
+                if (Math.abs(-height-endy) < 2 &&
+                    Math.abs(cornerx-to) < 5) {
+                  endy = -height;
+                }
+                path.line(cornerx, -height).
+                    curveQ(controlx, -height, to, endy);
+              } else {
+                path.line(cornerx, -height).
+                    line(to, rightBox.y + (leftToRight && !arc.equiv ? Configuration.visual.margin.y : rightBox.height / 2));
+              }
+            } else {
+              path.line(to, -height);
+            }
+            svg.path(arcGroup, path, {
+                markerEnd: arrowDecl,
+                markerStart: labelArrowDecl,
+                style: 'stroke: ' + color,
+                'strokeDashArray': dashArray,
+            });
+            if (arc.marked) {
+              svg.path(shadowGroup, path, {
+                  'class': 'shadow_EditHighlight_arc',
+                  strokeWidth: markedArcStroke,
+                  'strokeDashArray': dashArray,
+              });
+            }
+            if (shadowGroup) {
+              svg.path(shadowGroup, path, {
+                  'class': 'shadow_' + arc.shadowClass,
+                  strokeWidth: shadowStroke,
+                  'strokeDashArray': dashArray,
+              });
+            }
+          } // arc rows
+        }); // arcs
+
+Util.profileEnd('arcs');
+Util.profileStart('fragmentConnectors');
+
+        $.each(data.spans, function(spanNo, span) {
+          var numConnectors = span.fragments.length - 1;
+          for (var connectorNo = 0; connectorNo < numConnectors; connectorNo++) {
+            var left = span.fragments[connectorNo];
+            var right = span.fragments[connectorNo + 1];
+
+            var leftBox = rowBBox(left);
+            var rightBox = rowBBox(right);
+            var leftRow = left.chunk.row.index;
+            var rightRow = right.chunk.row.index;
+
+            for (var rowIndex = leftRow; rowIndex <= rightRow; rowIndex++) {
+              var row = rows[rowIndex];
+              row.hasAnnotations = true;
+
+              if (rowIndex == leftRow) {
+                from = leftBox.x + leftBox.width;
+              } else {
+                from = sentNumMargin;
+              }
+
+              if (rowIndex == rightRow) {
+                to = rightBox.x;
+              } else {
+                to = canvasWidth - 2 * Configuration.visual.margin.y;
+              }
+
+              var height = leftBox.y + leftBox.height - Configuration.visual.margin.y;
+              if (roundCoordinates) {
+                // don't ask
+                height = (height|0)+0.5;
+              }
+
+              var path = svg.createPath().move(from, height).line(to, height);
+              svg.path(row.arcs, path, {
+                style: 'stroke: ' + fragmentConnectorColor,
+                'strokeDashArray': fragmentConnectorDashArray
+              });
+            } // rowIndex
+          } // connectorNo
+        }); // spans
+
+Util.profileEnd('fragmentConnectors');
+Util.profileStart('rows');
+
+        // position the rows
+        var y = Configuration.visual.margin.y;
+        var sentNumGroup = svg.group({'class': 'sentnum'});
+        var currentSent;
+        $.each(rows, function(rowId, row) {
+          $.each(row.chunks, function(chunkId, chunk) {
+            $.each(chunk.fragments, function(fragmentId, fragment) {
+              if (row.maxSpanHeight < fragment.height) row.maxSpanHeight = fragment.height;
+            });
+          });
+          if (row.sentence) {
+            currentSent = row.sentence;
+          }
+          // SLOW (#724) and replaced with calculations:
+          //
+          // var rowBox = row.group.getBBox();
+          // // Make it work on IE
+          // rowBox = { x: rowBox.x, y: rowBox.y, height: rowBox.height, width: rowBox.width };
+          // // Make it work on Firefox and Opera
+          // if (rowBox.height == -Infinity) {
+          //   rowBox = { x: 0, y: 0, height: 0, width: 0 };
+          // }
+
+          // XXX TODO HACK: find out where 5 and 1.5 come from!
+          // This is the fix for #724, but the numbers are guessed.
+          var rowBoxHeight = Math.max(row.maxArcHeight + 5, row.maxSpanHeight + 1.5); // XXX TODO HACK: why 5, 1.5?
+          if (row.hasAnnotations) {
+            // rowBox.height = -rowBox.y + rowSpacing;
+            rowBoxHeight += rowSpacing + 1.5; // XXX TODO HACK: why 1.5?
+          } else {
+            rowBoxHeight -= 5; // XXX TODO HACK: why -5?
+          }
+
+          rowBoxHeight += rowPadding;
+          var bgClass;
+          if (data.markedSent[currentSent]) {
+            // specifically highlighted
+            bgClass = 'backgroundHighlight';
+          } else if (Configuration.textBackgrounds == "striped") {
+            // give every other sentence a different bg class
+            bgClass = 'background'+ row.backgroundIndex;
+          } else {
+            // plain "standard" bg
+            bgClass = 'background0';
+          }
+          svg.rect(backgroundGroup,
+            0, y + sizes.texts.y + sizes.texts.height,
+            canvasWidth, rowBoxHeight + sizes.texts.height + 1, {
+            'class': bgClass,
+          });
+          y += rowBoxHeight;
+          y += sizes.texts.height;
+          row.textY = y - rowPadding;
+          if (row.sentence) {
+            var sentence_hash = new URLHash(coll, doc, { focus: [[ 'sent', row.sentence ]] } );
+            var link = svg.link(sentNumGroup, sentence_hash.getHash());
+            var text = svg.text(link, sentNumMargin - Configuration.visual.margin.x, y - rowPadding,
+                '' + row.sentence, { 'data-sent': row.sentence });
+            var sentComment = data.sentComment[row.sentence];
+            if (sentComment) {
+              var box = text.getBBox();
+              svg.remove(text);
+              // TODO: using rectShadowSize, but this shadow should
+              // probably have its own setting for shadow size
+              shadowRect = svg.rect(sentNumGroup,
+                  box.x - rectShadowSize, box.y - rectShadowSize,
+                  box.width + 2 * rectShadowSize, box.height + 2 * rectShadowSize, {
+
+                  'class': 'shadow_' + sentComment.type,
+                  filter: 'url(#Gaussian_Blur)',
+                  rx: rectShadowRounding,
+                  ry: rectShadowRounding,
+                  'data-sent': row.sentence,
+              });
+              var text = svg.text(sentNumGroup, sentNumMargin - Configuration.visual.margin.x, y - rowPadding,
+                  '' + row.sentence, { 'data-sent': row.sentence });
+            }
+          }
+
+          var rowY = y - rowPadding;
+          if (roundCoordinates) {
+            rowY = rowY|0;
+          }
+          translate(row, 0, rowY);
+          y += Configuration.visual.margin.y;
+        });
+        y += Configuration.visual.margin.y;
+
+Util.profileEnd('rows');
+Util.profileStart('chunkFinish');
+
+        // chunk index sort functions for overlapping fragment drawing
+        // algorithm; first for left-to-right pass, sorting primarily
+        // by start offset, second for right-to-left pass by end
+        // offset. Secondary sort by fragment length in both cases.
+        var currentChunk;
+        var lrChunkComp = function(a,b) {
+          var ac = currentChunk.fragments[a];
+          var bc = currentChunk.fragments[b]
+          var startDiff = Util.cmp(ac.from, bc.from);
+          return startDiff != 0 ? startDiff : Util.cmp(bc.to-bc.from, ac.to-ac.from);
+        }
+        var rlChunkComp = function(a,b) {
+          var ac = currentChunk.fragments[a];
+          var bc = currentChunk.fragments[b]
+          var endDiff = Util.cmp(bc.to, ac.to);
+          return endDiff != 0 ? endDiff : Util.cmp(bc.to-bc.from, ac.to-ac.from);
+        }
+
+        var sentenceText = null;
+        $.each(data.chunks, function(chunkNo, chunk) {
+          // context for sort
+          currentChunk = chunk;
+
+          // text rendering
+          if (chunk.sentence) {
+            if (sentenceText) {
+              // svg.text(textGroup, sentenceText); // avoids jQuerySVG bug
+              svg.text(textGroup, 0, 0, sentenceText);
+            }
+            sentenceText = null;
+          }
+          if (!sentenceText) {
+            sentenceText = svg.createText();
+          }
+          var nextChunk = data.chunks[chunkNo + 1];
+          var nextSpace = nextChunk ? nextChunk.space : '';
+          sentenceText.span(chunk.text + nextSpace, {
+            x: chunk.textX,
+            y: chunk.row.textY,
+            'data-chunk-id': chunk.index
+          });
+
+          // chunk backgrounds
+          if (chunk.fragments.length) {
+            var orderedIdx = [];
+            for (var i=chunk.fragments.length-1; i>=0; i--) {
+              orderedIdx.push(i);
+            }
+
+            // Mark entity nesting height/depth (number of
+            // nested/nesting entities). To account for crossing
+            // brackets in a (mostly) reasonable way, determine
+            // depth/height separately in a left-to-right traversal
+            // and a right-to-left traversal.
+            orderedIdx.sort(lrChunkComp);
+
+            var openFragments = [];
+            for(var i=0; i<orderedIdx.length; i++) {
+              var current = chunk.fragments[orderedIdx[i]];
+              current.nestingHeightLR = 0;
+              current.nestingDepthLR = 0;
+              var stillOpen = [];
+              for(var o=0; o<openFragments.length; o++) {
+                if(openFragments[o].to > current.from) {
+                  stillOpen.push(openFragments[o]);
+                  openFragments[o].nestingHeightLR++;
+                }
+              }
+              openFragments = stillOpen;
+              current.nestingDepthLR=openFragments.length;
+              openFragments.push(current);
+            }
+
+            // re-sort for right-to-left traversal by end position
+            orderedIdx.sort(rlChunkComp);
+
+            openFragments = [];
+            for(var i=0; i<orderedIdx.length; i++) {
+              var current = chunk.fragments[orderedIdx[i]];
+              current.nestingHeightRL = 0;
+              current.nestingDepthRL = 0;
+              var stillOpen = [];
+              for(var o=0; o<openFragments.length; o++) {
+                if(openFragments[o].from < current.to) {
+                  stillOpen.push(openFragments[o]);
+                  openFragments[o].nestingHeightRL++;
+                }
+              }
+              openFragments = stillOpen;
+              current.nestingDepthRL=openFragments.length;
+              openFragments.push(current);
+            }
+
+            // the effective depth and height are the max of those
+            // for the left-to-right and right-to-left traversals.
+            for(var i=0; i<orderedIdx.length; i++) {
+              var c = chunk.fragments[orderedIdx[i]];
+              c.nestingHeight = c.nestingHeightLR > c.nestingHeightRL ? c.nestingHeightLR : c.nestingHeightRL;
+              c.nestingDepth = c.nestingDepthLR > c.nestingDepthRL ? c.nestingDepthLR : c.nestingDepthRL;
+            }
+
+            // Re-order by nesting height and draw in order
+            orderedIdx.sort(function(a,b) { return Util.cmp(chunk.fragments[b].nestingHeight, chunk.fragments[a].nestingHeight) });
+
+            for(var i=0; i<chunk.fragments.length; i++) {
+              var fragment=chunk.fragments[orderedIdx[i]];
+              var spanDesc = spanTypes[fragment.span.type];
+              var bgColor = ((spanDesc && spanDesc.bgColor) ||
+                             (spanTypes.SPAN_DEFAULT && spanTypes.SPAN_DEFAULT.bgColor) ||
+                             '#ffffff');
+
+              // Tweak for nesting depth/height. Recognize just three
+              // levels for now: normal, nested, and nesting, where
+              // nested+nesting yields normal. (Currently testing
+              // minor tweak: don't shrink for depth 1 as the nesting
+              // highlight will grow anyway [check nestingDepth > 1])
+              var shrink = 0;
+              if(fragment.nestingDepth > 1 && fragment.nestingHeight == 0) {
+                  shrink = 1;
+              } else if(fragment.nestingDepth == 0 && fragment.nestingHeight > 0) {
+                  shrink = -1;
+              }
+              var yShrink = shrink * nestingAdjustYStepSize;
+              var xShrink = shrink * nestingAdjustXStepSize;
+              // bit lighter
+              var lightBgColor = Util.adjustColorLightness(bgColor, 0.8);
+              // tweak for Y start offset (and corresponding height
+              // reduction): text rarely hits font max height, so this
+              // tends to look better
+              var yStartTweak = 1;
+              // store to have same mouseover highlight without recalc
+              fragment.highlightPos = {
+                  x: chunk.textX + fragment.curly.from + xShrink,
+                  y: chunk.row.textY + sizes.texts.y + yShrink + yStartTweak,
+                  w: fragment.curly.to - fragment.curly.from - 2*xShrink,
+                  h: sizes.texts.height - 2*yShrink - yStartTweak,
+              };
+              svg.rect(highlightGroup,
+                  fragment.highlightPos.x, fragment.highlightPos.y,
+                  fragment.highlightPos.w, fragment.highlightPos.h,
+                  { fill: lightBgColor, //opacity:1,
+                    rx: highlightRounding.x,
+                    ry: highlightRounding.y,
+                  });
+            }
+          }
+        });
+        if (sentenceText) {
+          // svg.text(textGroup, sentenceText); // avoids jQuerySVG bug
+          svg.text(textGroup, 0, 0, sentenceText);
+        }
+
+        // draw the markedText
+        $.each(textMarkedRows, function(textRowNo, textRowDesc) { // row, from, to
+          var textHighlight = svg.rect(highlightGroup,
+              textRowDesc[1] - 2, textRowDesc[0].textY - sizes.fragments.height,
+              textRowDesc[2] - textRowDesc[1] + 4, sizes.fragments.height + 4,
+              { fill: 'yellow' } // TODO: put into css file, as default - turn into class
+          );
+          // NOTE: changing highlightTextSequence here will give
+          // different-colored highlights
+          // TODO: entirely different settings for non-animations?
+          var markedType = textRowDesc[3];
+          svg.other(textHighlight, 'animate', {
+            'data-type': markedType,
+            attributeName: 'fill',
+            values: (markedType == 'match' ? highlightMatchSequence
+                     : highlightTextSequence),
+            dur: highlightDuration,
+            repeatCount: 'indefinite',
+            begin: 'indefinite'
+          });
+        });
+
+
+Util.profileEnd('chunkFinish');
+Util.profileStart('finish');
+
+        svg.path(sentNumGroup, svg.createPath().
+          move(sentNumMargin, 0).
+          line(sentNumMargin, y));
+
+        // resize the SVG
+        var width = maxTextWidth + sentNumMargin + 2 * Configuration.visual.margin.x + 1;
+        if (width > canvasWidth) canvasWidth = width;
+
+        $svg.width(canvasWidth);
+        $svg.height(y);
+        $svgDiv.height(y);
+
+Util.profileEnd('finish');
+Util.profileEnd('render');
+Util.profileReport();
+
+
+        drawing = false;
+        if (redraw) {
+          redraw = false;
+          renderDataReal();
+        }
+        $svg.find('animate').each(function() {
+          if (this.beginElement) { // protect against non-SMIL browsers
+            this.beginElement();
+          }
+        });
+        dispatcher.post('doneRendering', [coll, doc, args]);
+      };
+
+      var renderErrors = {
+        unableToReadTextFile: true,
+        annotationFileNotFound: true,
+        isDirectoryError: true
+      };
+      var renderData = function(sourceData) {
+        Util.profileEnd('invoke getDocument');
+        if (sourceData && sourceData.exception) {
+          if (renderErrors[sourceData.exception]) {
+            dispatcher.post('renderError:' + sourceData.exception, [sourceData]);
+          } else {
+            dispatcher.post('unknownError', [sourceData.exception]);
+          }
+        } else {
+          // Fill in default values that don't necessarily go over the protocol
+          if (sourceData) {
+            setSourceDataDefaults(sourceData);
+          }
+
+          dispatcher.post('startedRendering', [coll, doc, args]);
+          dispatcher.post('spin');
+          setTimeout(function() {
+              try {
+                renderDataReal(sourceData);
+              } catch (e) {
+                // We are sure not to be drawing anymore, reset the state
+                drawing = false;
+                // TODO: Hook printout into dispatch elsewhere?
+                console.warn('Rendering terminated due to:', e);
+                dispatcher.post('renderError: Fatal', [sourceData, e]);
+              }
+              dispatcher.post('unspin');
+          }, 0);
+        }
+      };
+
+      var renderDocument = function() {
+        Util.profileStart('invoke getDocument');
+        dispatcher.post('ajax', [{
+            action: 'getDocument',
+            collection: coll,
+            'document': doc,
+          }, 'renderData', {
+            collection: coll,
+            'document': doc
+          }]);
+      };
+
+      var triggerRender = function() {
+        if (svg && ((isRenderRequested && isCollectionLoaded) || requestedData) && Visualizer.areFontsLoaded) {
+          isRenderRequested = false;
+          if (requestedData) {
+
+Util.profileClear();
+Util.profileStart('before render');
+
+            renderData(requestedData);
+          } else if (doc.length) {
+
+Util.profileClear();
+Util.profileStart('before render');
+
+            renderDocument();
+          } else {
+            dispatcher.post(0, 'renderError:noFileSpecified');
+          }
+        }
+      };
+
+      var requestRenderData = function(sourceData) {
+        requestedData = sourceData;
+        triggerRender();
+      };
+
+      var collectionChanged = function() {
+        isCollectionLoaded = false;
+      };
+
+      var gotCurrent = function(_coll, _doc, _args, reloadData) {
+        coll = _coll;
+        doc  = _doc;
+        args = _args;
+        if (reloadData) {
+          isRenderRequested = true;
+          triggerRender();
+        }
+      };
+
+
+      // event handlers
+
+      var highlight, highlightArcs, highlightSpans, commentId;
+
+      var onMouseOver = function(evt) {
+        var target = $(evt.target);
+        var id;
+        if (id = target.attr('data-span-id')) {
+          commentId = id;
+          var span = data.spans[id];
+          dispatcher.post('displaySpanComment', [
+              evt, target, id, span.type, span.attributeText,
+              span.text,
+              span.comment && span.comment.text,
+              span.comment && span.comment.type,
+              span.normalizations]);
+
+          var spanDesc = spanTypes[span.type];
+          var bgColor = ((spanDesc && spanDesc.bgColor) ||
+                         (spanTypes.SPAN_DEFAULT && spanTypes.SPAN_DEFAULT.bgColor) ||
+                         '#ffffff');
+          highlight = [];
+          $.each(span.fragments, function(fragmentNo, fragment) {
+            highlight.push(svg.rect(highlightGroup,
+                                 fragment.highlightPos.x, fragment.highlightPos.y,
+                                 fragment.highlightPos.w, fragment.highlightPos.h,
+                                 { 'fill': bgColor, opacity:0.75,
+                                   rx: highlightRounding.x,
+                                   ry: highlightRounding.y,
+                                 }));
+          });
+
+          if (that.arcDragOrigin) {
+            target.parent().addClass('highlight');
+          } else {
+            highlightArcs = $svg.
+                find('g[data-from="' + id + '"], g[data-to="' + id + '"]').
+                addClass('highlight');
+            var spans = {};
+            spans[id] = true;
+            var spanIds = [];
+            $.each(span.incoming, function(arcNo, arc) {
+                spans[arc.origin] = true;
+            });
+            $.each(span.outgoing, function(arcNo, arc) {
+                spans[arc.target] = true;
+            });
+            $.each(spans, function(spanId, dummy) {
+                spanIds.push('rect[data-span-id="' + spanId + '"]');
+            });
+            highlightSpans = $svg.
+                find(spanIds.join(', ')).
+                parent().
+                addClass('highlight');
+          }
+          forceRedraw();
+        } else if (!that.arcDragOrigin && (id = target.attr('data-arc-role'))) {
+          var originSpanId = target.attr('data-arc-origin');
+          var targetSpanId = target.attr('data-arc-target');
+          var role = target.attr('data-arc-role');
+          var symmetric = (relationTypesHash &&
+                           relationTypesHash[role] &&
+                           relationTypesHash[role].properties &&
+                           relationTypesHash[role].properties.symmetric);
+          // NOTE: no commentText, commentType for now
+          var arcEventDescId = target.attr('data-arc-ed');
+          var commentText = '';
+          var commentType = '';
+          var arcId;
+          if (arcEventDescId) {
+            var eventDesc = data.eventDescs[arcEventDescId];
+            var comment = eventDesc.comment;
+            if (comment) {
+              commentText = comment.text;
+              commentType = comment.type;
+              if (commentText == '' && commentType) {
+                  // default to type if missing text
+                  commentText = commentType;
+              }
+            }
+            if (eventDesc.relation) {
+              // among arcs, only ones corresponding to relations have
+              // "independent" IDs
+              arcId = arcEventDescId;
+            }
+          }
+          var originSpanType = data.spans[originSpanId].type || '';
+          var targetSpanType = data.spans[targetSpanId].type || '';
+          dispatcher.post('displayArcComment', [
+              evt, target, symmetric, arcId,
+              originSpanId, originSpanType, role,
+              targetSpanId, targetSpanType,
+              commentText, commentType]);
+          highlightArcs = $svg.
+              find('g[data-from="' + originSpanId + '"][data-to="' + targetSpanId + '"]').
+              addClass('highlight');
+          highlightSpans = $($svg).
+              find('rect[data-span-id="' + originSpanId + '"], rect[data-span-id="' + targetSpanId + '"]').
+              parent().
+              addClass('highlight');
+        } else if (id = target.attr('data-sent')) {
+          var comment = data.sentComment[id];
+          if (comment) {
+            dispatcher.post('displaySentComment', [evt, target, comment.text, comment.type]);
+          }
+        }
+      };
+
+      var onMouseOut = function(evt) {
+        var target = $(evt.target);
+        target.removeClass('badTarget');
+        dispatcher.post('hideComment');
+        if (highlight) {
+          $.each(highlight, function() {
+            svg.remove(this);
+          });
+          highlight = undefined;
+        }
+        if (highlightSpans) {
+          highlightArcs.removeClass('highlight');
+          highlightSpans.removeClass('highlight');
+          highlightSpans = undefined;
+        }
+        forceRedraw();
+      };
+
+      var setAbbrevs = function(_abbrevsOn) {
+        // TODO: this is a slightly weird place to tweak the configuration
+        Configuration.abbrevsOn = _abbrevsOn;
+        dispatcher.post('configurationChanged');
+      }
+
+      var setTextBackgrounds = function(_textBackgrounds) {
+        Configuration.textBackgrounds = _textBackgrounds;
+        dispatcher.post('configurationChanged');
+      }
+
+      var setLayoutDensity = function(_density) {
+        //dispatcher.post('messages', [[['Setting layout density ' + _density, 'comment']]]);
+        // TODO: store standard settings instead of hard-coding
+        // them here (again)
+        if (_density < 2) {
+          // dense
+          Configuration.visual.margin = { x: 1, y: 0 };
+          Configuration.visual.boxSpacing = 1;
+          Configuration.visual.curlyHeight = 1;
+          Configuration.visual.arcSpacing = 7;
+          Configuration.visual.arcStartHeight = 18
+        } else if(_density > 2) {
+          // spacious
+          Configuration.visual.margin = { x: 2, y: 1 };
+          Configuration.visual.boxSpacing = 3;
+          Configuration.visual.curlyHeight = 6;
+          Configuration.visual.arcSpacing = 12;
+          Configuration.visual.arcStartHeight = 23;
+        } else {
+          // standard
+          Configuration.visual.margin = { x: 2, y: 1 };
+          Configuration.visual.boxSpacing = 1;
+          Configuration.visual.curlyHeight = 4;
+          Configuration.visual.arcSpacing = 9;
+          Configuration.visual.arcStartHeight = 19;
+        }
+        dispatcher.post('configurationChanged');
+      }
+
+      var setSvgWidth = function(_width) {
+        $svgDiv.width(_width);
+        if (Configuration.svgWidth != _width) {
+          Configuration.svgWidth = _width;
+          dispatcher.post('configurationChanged');
+        }
+      }
+
+      $svgDiv = $($svgDiv).hide();
+
+      // register event listeners
+      var registerHandlers = function(element, events) {
+        $.each(events, function(eventNo, eventName) {
+            element.bind(eventName,
+              function(evt) {
+                dispatcher.post(eventName, [evt], 'all');
+              }
+            );
+        });
+      };
+      registerHandlers($svgDiv, [
+          'mouseover', 'mouseout', 'mousemove',
+          'mouseup', 'mousedown',
+          'dragstart',
+          'dblclick', 'click'
+      ]);
+      registerHandlers($(document), [
+          'keydown', 'keypress',
+          'touchstart', 'touchend'
+      ]);
+      registerHandlers($(window), [
+          'resize'
+      ]);
+
+      // create the svg wrapper
+      $svgDiv.svg({
+          onLoad: function(_svg) {
+              that.svg = svg = _svg;
+              $svg = $(svg._svg);
+
+              /* XXX HACK REMOVED - not efficient?
+
+              // XXX HACK to allow off-DOM SVG element creation
+              // we need to replace the jQuery SVG's _makeNode function
+              // with a modified one.
+              // Be aware of potential breakage upon jQuery SVG upgrade.
+              svg._makeNode = function(parent, name, settings) {
+                  // COMMENTED OUT: parent = parent || this._svg;
+                  var node = this._svg.ownerDocument.createElementNS($.svg.svgNS, name);
+                  for (var name in settings) {
+                    var value = settings[name];
+                    if (value != null && value != null &&
+                        (typeof value != 'string' || value != '')) {
+                      node.setAttribute($.svg._attrNames[name] || name, value);
+                    }
+                  }
+                  // ADDED IN:
+                  if (parent)
+                    parent.appendChild(node);
+                  return node;
+                };
+              */
+
+              triggerRender();
+          }
+      });
+
+      var loadSpanTypes = function(types) {
+        $.each(types, function(typeNo, type) {
+          if (type) {
+            spanTypes[type.type] = type;
+            var children = type.children;
+            if (children && children.length) {
+              loadSpanTypes(children);
+            }
+          }
+        });
+      }
+
+      var loadAttributeTypes = function(response_types) {
+        var processed = {};
+        $.each(response_types, function(aTypeNo, aType) {
+          processed[aType.type] = aType;
+          // count the values; if only one, it's a boolean attribute
+          var values = [];
+          for (var i in aType.values) {
+            if (aType.values.hasOwnProperty(i)) {
+              values.push(i);
+            }
+          }
+          if (values.length == 1) {
+            aType.bool = values[0];
+          }
+        });
+        return processed;
+      }
+
+      var loadRelationTypes = function(relation_types) {
+        $.each(relation_types, function(relTypeNo, relType) {
+          if (relType) {
+            relationTypesHash[relType.type] = relType;
+            var children = relType.children;
+            if (children && children.length) {
+              loadRelationTypes(children);
+            }
+          }
+        });
+      }
+
+      var collectionLoaded = function(response) {
+        if (!response.exception) {
+          setCollectionDefaults(response);
+          eventAttributeTypes = loadAttributeTypes(response.event_attribute_types);
+          entityAttributeTypes = loadAttributeTypes(response.entity_attribute_types);
+          spanTypes = {};
+          loadSpanTypes(response.entity_types);
+          loadSpanTypes(response.event_types);
+          loadSpanTypes(response.unconfigured_types);
+          relationTypesHash = {};
+          loadRelationTypes(response.relation_types);
+          loadRelationTypes(response.unconfigured_types);
+          // TODO XXX: isn't the following completely redundant with
+          // loadRelationTypes?
+          $.each(response.relation_types, function(relTypeNo, relType) {
+            relationTypesHash[relType.type] = relType;
+          });
+
+          dispatcher.post('spanAndAttributeTypesLoaded', [spanTypes, entityAttributeTypes, eventAttributeTypes, relationTypesHash]);
+
+          isCollectionLoaded = true;
+          triggerRender();
+        } else {
+          // exception on collection load; allow visualizer_ui
+          // collectionLoaded to handle this
+        }
+      };
+
+      var isReloadOkay = function() {
+        // do not reload while the user is in the dialog
+        return !drawing;
+      };
+
+      // If we are yet to load our fonts, dispatch them
+      if (!Visualizer.areFontsLoaded) {
+        var webFontConfig = {
+          custom: {
+            families: [
+              'Astloch',
+              'PT Sans Caption',
+              //        'Ubuntu',
+              'Liberation Sans'
+            ],
+            /* For some cases, in particular for embedding, we need to
+              allow for fonts being hosted elsewhere */
+            urls: webFontURLs !== undefined ? webFontURLs : [
+              'static/fonts/Astloch-Bold.ttf',
+              'static/fonts/PT_Sans-Caption-Web-Regular.ttf',
+              //
+              'static/fonts/Liberation_Sans-Regular.ttf'
+            ],
+          },
+          active: proceedWithFonts,
+          inactive: proceedWithFonts,
+          fontactive: function(fontFamily, fontDescription) {
+            // Note: Enable for font debugging
+            //console.log("font active: ", fontFamily, fontDescription);
+          },
+          fontloading: function(fontFamily, fontDescription) {
+            // Note: Enable for font debugging
+            //console.log("font loading:", fontFamily, fontDescription);
+          },
+        };
+        // WebFont.load(webFontConfig);
+        // setTimeout(function() {
+        //   if (!Visualizer.areFontsLoaded) {
+        //     console.error('Timeout in loading fonts');
+        //     proceedWithFonts();
+        //   }
+        // }, fontLoadTimeout);
+        proceedWithFonts();
+      }
+
+      dispatcher.
+          on('collectionChanged', collectionChanged).
+          on('collectionLoaded', collectionLoaded).
+          on('renderData', renderData).
+          on('triggerRender', triggerRender).
+          on('requestRenderData', requestRenderData).
+          on('isReloadOkay', isReloadOkay).
+          on('resetData', resetData).
+          on('abbrevs', setAbbrevs).
+          on('textBackgrounds', setTextBackgrounds).
+          on('layoutDensity', setLayoutDensity).
+          on('svgWidth', setSvgWidth).
+          on('current', gotCurrent).
+          on('clearSVG', clearSVG).
+          on('mouseover', onMouseOver).
+          on('mouseout', onMouseOut);
+    };
+
+    Visualizer.areFontsLoaded = false;
+
+    var proceedWithFonts = function() {
+      Visualizer.areFontsLoaded = true;
+      // Note: Enable for font debugging
+      //console.log("fonts done");
+      Dispatcher.post('triggerRender');
+    };
+
+    return Visualizer;
+})(jQuery, window);
Index: .idea/libraries/Maven__commons_codec_commons_codec_1_13.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/libraries/Maven__commons_codec_commons_codec_1_13.xml	(date 1594749401077)
+++ .idea/libraries/Maven__commons_codec_commons_codec_1_13.xml	(date 1594749401077)
@@ -0,0 +1,13 @@
+<component name="libraryTable">
+  <library name="Maven: commons-codec:commons-codec:1.13">
+    <CLASSES>
+      <root url="jar://$MAVEN_REPOSITORY$/commons-codec/commons-codec/1.13/commons-codec-1.13.jar!/" />
+    </CLASSES>
+    <JAVADOC>
+      <root url="jar://$MAVEN_REPOSITORY$/commons-codec/commons-codec/1.13/commons-codec-1.13-javadoc.jar!/" />
+    </JAVADOC>
+    <SOURCES>
+      <root url="jar://$MAVEN_REPOSITORY$/commons-codec/commons-codec/1.13/commons-codec-1.13-sources.jar!/" />
+    </SOURCES>
+  </library>
+</component>
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/src/url_monitor.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/url_monitor.js	(date 1594749336102)
+++ src/main/resources/static/static/lib/brat/src/url_monitor.js	(date 1594749336102)
@@ -0,0 +1,233 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+var URLMonitor = (function($, window, undefined) {
+    var URLMonitor = function(dispatcher) {
+      var that = this;
+
+      var reloadData = true;
+      var changed = false;
+      var newIntArgs = {};
+
+      that.url_hash = new URLHash();
+
+      // Thanks to:
+      // http://kilianvalkhof.com/2010/javascript/the-case-of-the-disappearing-favicon/
+      var setFavicon = function() {
+        var link = $('link[type="image/x-icon"]').remove().attr("href");
+        $('<link href="'+ link +'" rel="shortcut icon" type="image/x-icon" />').appendTo('head');
+      }
+
+      var updateURL = function() {
+        var new_hash = that.url_hash.getHash();
+        changed = false;
+        window.location.hash = new_hash;
+        setFavicon();
+        dispatcher.post('hideForm');
+      };
+
+      var setArguments = function(args, force) {
+        var oldArgs = that.url_hash.arguments;
+        var argSplit = URLHash.splitArgs(args);
+
+        if (!Util.isEqual(that.url_hash.extArguments, argSplit[1])) {
+          changed = true;
+          that.url_hash.setArguments(args);
+          dispatcher.post('argsChanged', [args, oldArgs]);
+        }
+        if (changed) {
+          // hashchange event will trigger
+          newIntArgs = argSplit[0];
+          updateURL();
+        } else if (force || !Util.isEqual(that.url_hash.intArguments, argSplit[0])) {
+          // hash is same, but internal arguments differ
+          that.url_hash.setArguments(args);
+          // hashchange event won't trigger, but internal args have
+          // changed, so we have to do updateState's job
+          dispatcher.post('hideForm');
+          dispatcher.post('argsChanged', [args, oldArgs]);
+          dispatcher.post('current', [that.url_hash.collection,
+              that.url_hash.document, that.url_hash.arguments, reloadData]);
+          reloadData = true;
+        }
+      };
+
+      var setDocument = function(doc, args) {
+        var oldDoc = that.url_hash.document;
+        if (oldDoc !== doc) {
+          changed = true;
+          that.url_hash.setDocument(doc);
+          dispatcher.post('docChanged', [doc, oldDoc]);
+        }
+        setArguments(args || null);
+      };
+
+      var setCollection = function(coll, doc, args) {
+        var oldColl = that.url_hash.collection;
+        if (oldColl !== coll) {
+          changed = true;
+          that.url_hash.setCollection(coll);
+
+          // keep "blind" down while loading new collection
+          $('#waiter').dialog('open');
+
+          dispatcher.post('ajax', [{
+              action: 'getCollectionInformation',
+              collection: coll
+            }, 'collectionLoaded', {
+              collection: coll,
+              keep: true
+            }]);
+          dispatcher.post('collectionChanged', [coll, oldColl]);
+        }
+        setDocument(doc || '', args);
+      }
+
+      var updateState = function() {
+        dispatcher.post('makeAjaxObsolete');
+        if (!changed) {
+          var new_url_hash = URLHash.parse(window.location.hash);
+          setCollection(new_url_hash.collection, new_url_hash.document,
+              $.extend(new_url_hash.arguments, newIntArgs));
+          that.url_hash = new_url_hash;
+          newIntArgs = {};
+        }
+       
+        dispatcher.post('current', [that.url_hash.collection,
+            that.url_hash.document, that.url_hash.arguments, reloadData]);
+        reloadData = true;
+      };
+
+      var forceUpdate = function() {
+        $(window).trigger('hashchange');
+      };
+
+      var preventReloadByURL = function() {
+        reloadData = false;
+      }
+      var allowReloadByURL = function() {
+        reloadData = true;
+      }
+
+      var init = function() {
+        $(window).bind('hashchange', updateState);
+        forceUpdate();
+      }
+
+      dispatcher.
+          on('forceUpdate', forceUpdate).
+          on('setArguments', setArguments).
+          on('setDocument', setDocument).
+          on('setCollection', setCollection).
+          on('preventReloadByURL', preventReloadByURL).
+          on('allowReloadByURL', allowReloadByURL).
+          on('init', init);
+    };
+
+    return URLMonitor;
+})(jQuery, window);
+
+var URLHash = (function($, window, undefined) {
+    var URLHash = function(collection, _document, _arguments) {
+      var that = this;
+      that.collection = collection;
+      that.document = _document || '';
+      that.arguments = _arguments || {};
+      that.calcArgs();
+    }
+
+    URLHash.prototype = {
+      calcArgs: function() {
+        var args = URLHash.splitArgs(this.arguments);
+        this.intArguments = args[0];
+        this.extArguments = args[1];
+      },
+
+      setArgument: function(argument, value) {
+        if (!this.arguments) {
+          this.arguments = {};
+        }
+        this.arguments[argument] = value;
+        this.calcArgs();
+        return this;
+      },
+
+      setArguments: function(_arguments) {
+        // the $.extend here basically takes a copy; raw assignment
+        // would allow changes of the args to alter original, which
+        // could be e.g. the "args" of search results
+        this.arguments = $.extend({}, _arguments || {});
+        this.calcArgs();
+        return this;
+      },
+
+      setDocument: function(_document) {
+        this.document = _document;
+        return this;
+      },
+
+      setCollection: function(collection) {
+        this.collection = collection;
+        return this;
+      },
+
+      getHash: function() {
+        var url_hash = this.collection + this.document;
+
+        var url_args = Util.param(this.extArguments);
+
+        if (url_args.length) {
+          url_hash += '?' + url_args;
+        }
+
+        if (url_hash.length) {
+          url_hash = '#' + url_hash;
+        }
+
+        return url_hash;
+      },
+    };
+
+    // arguments that do not appear in the URL
+    var INT_ARGS = ['match', 'matchfocus', 'edited'];
+
+    URLHash.splitArgs = function(args) {
+      var intArgs = {};
+      var extArgs = $.extend({}, args);
+      var intArgNameLen = INT_ARGS.length;
+      for (var i = 0; i < intArgNameLen; i++) {
+        intArgs[INT_ARGS[i]] = extArgs[INT_ARGS[i]];
+        delete extArgs[INT_ARGS[i]];
+      }
+      return [intArgs, extArgs];
+    };
+
+    // TODO: Document and conform variables to the rest of the object
+    URLHash.parse = function(hash) {
+      if (hash.length) {
+        // Remove the leading hash (#)
+        hash = hash.substr(1);
+      }
+
+      var pathAndArgs = hash.split('?');
+      var path = pathAndArgs[0] || '';
+      var argsStr = pathAndArgs[1] || '';
+      var coll;
+      var slashPos = path.lastIndexOf('/');
+      if (slashPos === -1) {
+        coll = '/';
+      } else {
+        coll = path.substr(0, slashPos + 1);
+        if (coll[coll.length - 1] !== '/') {
+          coll += '/';
+        }
+        if (coll[0] !== '/') {
+          coll = '/' + coll;
+        }
+      }
+      var doc = path.substr(slashPos + 1);
+      var args = Util.deparam(argsStr);
+      return new URLHash(coll, doc, args);
+    };
+
+    return URLHash;
+})(jQuery, window)
Index: src/main/resources/static/static/lib/brat/src/spinner.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/spinner.js	(date 1594749336102)
+++ src/main/resources/static/static/lib/brat/src/spinner.js	(date 1594749336102)
@@ -0,0 +1,28 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+var Spinner = (function($, window, undefined) {
+    var Spinner = function(dispatcher, spinElement) {
+      var that = this;
+      var spinElement = $(spinElement);
+
+      var count = 0;
+      var spin = function() {
+        if (count === 0) {
+          spinElement.css('display', 'block');
+        }
+        count++;
+      };
+      var unspin = function() {
+        count--;
+        if (count === 0) {
+          spinElement.css('display', 'none');
+        }
+      };
+
+      dispatcher.
+          on('spin', spin).
+          on('unspin', unspin);
+    };
+
+    return Spinner;
+})(jQuery, window);
Index: src/main/resources/static/static/lib/brat/src/ajax.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/ajax.js	(date 1594749336097)
+++ src/main/resources/static/static/lib/brat/src/ajax.js	(date 1594749336097)
@@ -0,0 +1,115 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+var Ajax = (function($, window, undefined) {
+    var Ajax = function(dispatcher) {
+      var that = this;
+      var pending = 0;
+      var count = 0;
+      var pendingList = {};
+
+      // merge data will get merged into the response data
+      // before calling the callback
+      var ajaxCall = function(data, callback, merge) {
+        merge = merge || {};
+        dispatcher.post('spin');
+        pending++;
+        var id = count++;
+
+        // special value: `merge.keep = true` prevents obsolescence
+        pendingList[id] = merge.keep || false;
+        delete merge.keep;
+
+        // If no protocol version is explicitly set, set it to current
+        if (data['protocol'] === undefined) {
+          // TODO: Extract the protocol version somewhere global
+          data['protocol'] = 1;
+        }
+
+        $.ajax({
+          url: 'ajax.cgi',
+          data: data,
+          type: 'POST',
+          success: function(response) {
+            pending--;
+            // If no exception is set, verify the server results
+            if (response.exception == undefined && response.action !== data.action) {
+              console.error('Action ' + data.action +
+                ' returned the results of action ' + response.action);
+              response.exception = true;
+              dispatcher.post('messages', [[['Protocol error: Action' + data.action + ' returned the results of action ' + response.action + ' maybe the server is unable to run, please run tools/troubleshooting.sh from your installation to diagnose it', 'error', -1]]]);
+            }
+
+            // If the request is obsolete, do nothing; if not...
+            if (pendingList.hasOwnProperty(id)) {
+              dispatcher.post('messages', [response.messages]);
+              if (response.exception == 'configurationError'
+                  || response.exception == 'protocolVersionMismatch') {
+                // this is a no-rescue critical failure.
+                // Stop *everything*.
+                pendingList = {};
+                dispatcher.post('screamingHalt');
+                // If we had a protocol mismatch, prompt the user for a reload
+                if (response.exception == 'protocolVersionMismatch') {
+                  if(confirm('The server is running a different version ' +
+                      'from brat than your client, possibly due to a ' +
+                      'server upgrade. Would you like to reload the ' +
+                      'current page to update your client to the latest ' +
+                      'version?')) {
+                    window.location.reload(true);
+                  } else {
+                    dispatcher.post('messages', [[['Fatal Error: Protocol ' +
+                        'version mismatch, please contact the administrator',
+                        'error', -1]]]);
+                  }
+                }
+                return;
+              }
+
+              delete pendingList[id];
+
+              // if .exception is just Boolean true, do not process
+              // the callback; if it is anything else, the
+              // callback is responsible for handling it
+              if (response.exception == true) {
+                $('#waiter').dialog('close');
+              } else if (callback) {
+                $.extend(response, merge);
+                dispatcher.post(0, callback, [response]);
+              }
+            }
+            dispatcher.post('unspin');
+          },
+          error: function(response, textStatus, errorThrown) {
+            pending--;
+            dispatcher.post('unspin');
+            $('#waiter').dialog('close');
+            dispatcher.post('messages', [[['Error: Action' + data.action + ' failed on error ' + response.statusText, 'error']]]);
+            console.error(textStatus + ':', errorThrown, response);
+          }
+        });
+        return id;
+      };
+
+      var isReloadOkay = function() {
+        // do not reload while data is pending
+        return pending == 0;
+      };
+
+      var makeObsolete = function(all) {
+        if (all) {
+          pendingList = {};
+        } else {
+          $.each(pendingList, function(id, keep) {
+            if (!keep) delete pendingList[id];
+          });
+        }
+      }
+
+      dispatcher.
+          on('isReloadOkay', isReloadOkay).
+          on('makeAjaxObsolete', makeObsolete).
+          on('ajax', ajaxCall);
+    };
+
+    return Ajax;
+})(jQuery, window);
Index: .idea/libraries/Maven__org_springframework_boot_spring_boot_devtools_2_2_2_RELEASE.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/libraries/Maven__org_springframework_boot_spring_boot_devtools_2_2_2_RELEASE.xml	(date 1594749401106)
+++ .idea/libraries/Maven__org_springframework_boot_spring_boot_devtools_2_2_2_RELEASE.xml	(date 1594749401106)
@@ -0,0 +1,13 @@
+<component name="libraryTable">
+  <library name="Maven: org.springframework.boot:spring-boot-devtools:2.2.2.RELEASE">
+    <CLASSES>
+      <root url="jar://$MAVEN_REPOSITORY$/org/springframework/boot/spring-boot-devtools/2.2.2.RELEASE/spring-boot-devtools-2.2.2.RELEASE.jar!/" />
+    </CLASSES>
+    <JAVADOC>
+      <root url="jar://$MAVEN_REPOSITORY$/org/springframework/boot/spring-boot-devtools/2.2.2.RELEASE/spring-boot-devtools-2.2.2.RELEASE-javadoc.jar!/" />
+    </JAVADOC>
+    <SOURCES>
+      <root url="jar://$MAVEN_REPOSITORY$/org/springframework/boot/spring-boot-devtools/2.2.2.RELEASE/spring-boot-devtools-2.2.2.RELEASE-sources.jar!/" />
+    </SOURCES>
+  </library>
+</component>
\ No newline at end of file
Index: .idea/libraries/Maven__org_apache_httpcomponents_httpcore_4_4_12.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/libraries/Maven__org_apache_httpcomponents_httpcore_4_4_12.xml	(date 1594749401099)
+++ .idea/libraries/Maven__org_apache_httpcomponents_httpcore_4_4_12.xml	(date 1594749401099)
@@ -0,0 +1,13 @@
+<component name="libraryTable">
+  <library name="Maven: org.apache.httpcomponents:httpcore:4.4.12">
+    <CLASSES>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12.jar!/" />
+    </CLASSES>
+    <JAVADOC>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12-javadoc.jar!/" />
+    </JAVADOC>
+    <SOURCES>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12-sources.jar!/" />
+    </SOURCES>
+  </library>
+</component>
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/src/annotator_ui.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/annotator_ui.js	(date 1594749336099)
+++ src/main/resources/static/static/lib/brat/src/annotator_ui.js	(date 1594749336099)
@@ -0,0 +1,2630 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+var AnnotatorUI = (function($, window, undefined) {
+    var AnnotatorUI = function(dispatcher, svg) {
+      var that = this;
+      var arcDragOrigin = null;
+      var arcDragOriginBox = null;
+      var arcDragOriginGroup = null;
+      var arcDragArc = null;
+      var arcDragJustStarted = false;
+      var sourceData = null;
+      var data = null;
+      var searchConfig = null;
+      var spanOptions = null;
+      var rapidSpanOptions = null;
+      var arcOptions = null;
+      var spanKeymap = null;
+      var keymap = null;
+      var coll = null;
+      var doc = null;
+      var reselectedSpan = null;
+      var selectedFragment = null;
+      var editedSpan = null;
+      var editedFragment = null;
+      var repeatingArcTypes = [];
+      var spanTypes = null;
+      var entityAttributeTypes = null;
+      var eventAttributeTypes = null;
+      var allAttributeTypes = null; // TODO: temp workaround, remove
+      var relationTypesHash = null;
+      var showValidAttributes; // callback function
+      var showValidNormalizations; // callback function
+      var dragStartedAt = null;
+      var selRect = null;
+      var lastStartRec = null;
+      var lastEndRec = null;
+
+      var draggedArcHeight = 30;
+      var spanTypesToShowBeforeCollapse = 30;
+      var maxNormSearchHistory = 10;
+
+      // TODO: this is an ugly hack, remove (see comment with assignment)
+      var lastRapidAnnotationEvent = null;
+      // TODO: another avoidable global; try to work without
+      var rapidAnnotationDialogVisible = false;
+
+      // amount by which to lighten (adjust "L" in HSL space) span
+      // colors for type selection box BG display. 0=no lightening,
+      // 1=white BG (no color)
+      var spanBoxTextBgColorLighten = 0.4;
+
+      // for double-click selection simulation hack
+      var lastDoubleClickedChunkId = null;
+
+      // for normalization: URLs bases by norm DB name
+      var normDbUrlByDbName = {};
+      var normDbUrlBaseByDbName = {};
+      // for normalization: appropriate DBs per type
+      var normDbsByType = {};
+      // for normalization
+      var oldSpanNormIdValue = '';
+      var lastNormSearches = [];
+
+      that.user = null;
+      var svgElement = $(svg._svg);
+      var svgId = svgElement.parent().attr('id');
+
+      var stripNumericSuffix = function(s) {
+        // utility function, originally for stripping numerix suffixes
+        // from arc types (e.g. "Theme2" -> "Theme"). For values
+        // without suffixes (including non-strings), returns given value.
+        if (typeof(s) != "string") {          
+          return s; // can't strip
+        }
+        var m = s.match(/^(.*?)(\d*)$/);
+        return m[1]; // always matches
+      }
+
+      var hideForm = function() {
+        keymap = null;
+        rapidAnnotationDialogVisible = false;
+      };
+
+      var clearSelection = function() {
+        window.getSelection().removeAllRanges();
+        if (selRect != null) {
+          for(var s=0; s != selRect.length; s++) {
+            selRect[s].parentNode.removeChild(selRect[s]);
+          }
+          selRect = null;
+          lastStartRec = null;
+          lastEndRec = null;
+        }
+      };
+
+      var makeSelRect = function(rx, ry, rw, rh, col) {
+        var selRect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
+        selRect.setAttributeNS(null, "width", rw);
+        selRect.setAttributeNS(null, "height", rh);
+        selRect.setAttributeNS(null, "x", rx);
+        selRect.setAttributeNS(null, "y", ry);
+        selRect.setAttributeNS(null, "fill", col == undefined ? "lightblue" : col);
+        return selRect;
+      };
+
+      var onKeyDown = function(evt) {
+        var code = evt.which;
+
+        if (code === $.ui.keyCode.ESCAPE) {
+          stopArcDrag();
+          if (reselectedSpan) {
+            $(reselectedSpan.rect).removeClass('reselect');
+            reselectedSpan = null;
+            svgElement.removeClass('reselect');
+          }
+          return;
+        }
+
+        // in rapid annotation mode, prioritize the keys 0..9 for the
+        // ordered choices in the quick annotation dialog.
+        if (Configuration.rapidModeOn && rapidAnnotationDialogVisible && 
+            "0".charCodeAt() <= code && code <= "9".charCodeAt()) {
+          var idx = String.fromCharCode(code);
+          var $input = $('#rapid_span_'+idx);
+          if ($input.length) {
+            $input.click();
+          }
+        }
+
+        if (!keymap) return;
+
+        // disable shortcuts when working with elements that you could
+        // conceivably type in
+        var target = evt.target;
+        var nodeName = target.nodeName.toLowerCase();
+        var nodeType = target.type && target.type.toLowerCase();
+        if (nodeName == 'input' && (nodeType == 'text' || nodeType == 'password')) return;
+        if (nodeName == 'textarea' || nodeName == 'select') return;
+
+        var prefix = '';
+        if (evt.altKey) {
+          prefix = "A-";
+        }
+        if (evt.ctrlKey) {
+          prefix = "C-";
+        }
+        if (evt.shiftKey) {
+          prefix = "S-";
+        }
+        var binding = keymap[prefix + code];
+        if (!binding) binding = keymap[prefix + String.fromCharCode(code)];
+        if (binding) {
+          var boundInput = $('#' + binding)[0];
+          if (boundInput && !boundInput.disabled) {
+            boundInput.click();
+            evt.preventDefault();
+            return false;
+          }
+        }
+      };
+
+      var onDblClick = function(evt) {
+        // must be logged in
+        if (that.user === null) return;
+        // must not be reselecting a span or an arc
+        if (reselectedSpan || arcDragOrigin) return;
+
+        var target = $(evt.target);
+        var id;
+
+        // do we edit an arc?
+        if (id = target.attr('data-arc-role')) {
+          // TODO
+          clearSelection();
+          var originSpanId = target.attr('data-arc-origin');
+          var targetSpanId = target.attr('data-arc-target');
+          var type = target.attr('data-arc-role');
+          var originSpan = data.spans[originSpanId];
+          var targetSpan = data.spans[targetSpanId];
+          arcOptions = {
+            action: 'createArc',
+            origin: originSpanId,
+            target: targetSpanId,
+            old_target: targetSpanId,
+            type: type,
+            old_type: type,
+            collection: coll,
+            'document': doc
+          };
+          var eventDescId = target.attr('data-arc-ed');
+          if (eventDescId) {
+            var eventDesc = data.eventDescs[eventDescId];
+            if (eventDesc.equiv) {
+              arcOptions['left'] = eventDesc.leftSpans.join(',');
+              arcOptions['right'] = eventDesc.rightSpans.join(',');
+            }
+          }
+          $('#arc_origin').text(Util.spanDisplayForm(spanTypes, originSpan.type) + ' ("' + originSpan.text + '")');
+          $('#arc_target').text(Util.spanDisplayForm(spanTypes, targetSpan.type) + ' ("' + targetSpan.text + '")');
+          var arcId = eventDescId || [originSpanId, type, targetSpanId];
+          fillArcTypesAndDisplayForm(evt, originSpan.type, targetSpan.type, type, arcId);
+          // for precise timing, log dialog display to user.
+          dispatcher.post('logAction', ['arcEditSelected']);
+
+        // if not an arc, then do we edit a span?
+        } else if (id = target.attr('data-span-id')) {
+          clearSelection();
+          editedSpan = data.spans[id];
+          editedFragment = target.attr('data-fragment-id');
+          var offsets = [];
+          $.each(editedSpan.fragments, function(fragmentNo, fragment) {
+            offsets.push([fragment.from, fragment.to]);
+          });
+          spanOptions = {
+            action: 'createSpan',
+            offsets: offsets,
+            type: editedSpan.type,
+            id: id,
+          };
+          fillSpanTypesAndDisplayForm(evt, editedSpan.text, editedSpan);
+          // for precise timing, log annotation display to user.
+          dispatcher.post('logAction', ['spanEditSelected']);
+        }
+
+        // if not an arc or a span, is this a double-click on text?
+        else if (id = target.attr('data-chunk-id')) {
+          // remember what was clicked (this is in preparation for
+          // simulating double-click selection on browsers that do
+          // not support it.
+          lastDoubleClickedChunkId = id;
+        }
+      };
+
+      var startArcDrag = function(originId) {
+        clearSelection();
+        svgElement.addClass('unselectable');
+        svgPosition = svgElement.offset();
+        arcDragOrigin = originId;
+        arcDragArc = svg.path(svg.createPath(), {
+          markerEnd: 'url(#drag_arrow)',
+          'class': 'drag_stroke',
+          fill: 'none',
+        });
+        arcDragOriginGroup = $(data.spans[arcDragOrigin].group);
+        arcDragOriginGroup.addClass('highlight');
+        arcDragOriginBox = Util.realBBox(data.spans[arcDragOrigin].headFragment);
+        arcDragOriginBox.center = arcDragOriginBox.x + arcDragOriginBox.width / 2;
+
+        arcDragJustStarted = true;
+      };
+
+      var getValidArcTypesForDrag = function(targetId, targetType) {
+        var arcType = stripNumericSuffix(arcOptions && arcOptions.type);
+        if (!arcDragOrigin || targetId == arcDragOrigin) return null;
+
+        var originType = data.spans[arcDragOrigin].type;
+        var spanType = spanTypes[originType];
+        var result = [];
+        if (spanType && spanType.arcs) {
+          $.each(spanType.arcs, function(arcNo, arc) {
+            if (arcType && arcType != arc.type) return;
+
+            if ($.inArray(targetType, arc.targets) != -1) {
+              result.push(arc.type);
+            }
+          });
+        }
+        return result;
+      };
+
+      var onMouseDown = function(evt) {
+        dragStartedAt = evt; // XXX do we really need the whole evt?
+        if (!that.user || arcDragOrigin) return;
+        var target = $(evt.target);
+        var id;
+        // is it arc drag start?
+        if (id = target.attr('data-span-id')) {
+          arcOptions = null;
+          startArcDrag(id);
+          return false;
+        }
+      };
+
+      var onMouseMove = function(evt) {
+        if (arcDragOrigin) {
+          if (arcDragJustStarted) {
+            // show the possible targets
+            var span = data.spans[arcDragOrigin] || {};
+            var spanDesc = spanTypes[span.type] || {};
+
+            // separate out possible numeric suffix from type for highight
+            // (instead of e.g. "Theme3", need to look for "Theme")
+            var noNumArcType = stripNumericSuffix(arcOptions && arcOptions.type);
+            // var targetClasses = [];
+            var $targets = $();
+            $.each(spanDesc.arcs || [], function(possibleArcNo, possibleArc) {
+              if ((arcOptions && possibleArc.type == noNumArcType) || !(arcOptions && arcOptions.old_target)) {
+                $.each(possibleArc.targets || [], function(possibleTargetNo, possibleTarget) {
+                  // speedup for #642: relevant browsers should support
+                  // this function: http://www.quirksmode.org/dom/w3c_core.html#t11
+                  // so we get off jQuery and get down to the metal:
+                  // targetClasses.push('.span_' + possibleTarget);
+                  $targets = $targets.add(svgElement[0].getElementsByClassName('span_' + possibleTarget));
+                });
+              }
+            });
+            // $(targetClasses.join(',')).not('[data-span-id="' + arcDragOrigin + '"]').addClass('reselectTarget');
+            $targets.not('[data-span-id="' + arcDragOrigin + '"]').addClass('reselectTarget');
+          }
+          clearSelection();
+          var mx = evt.pageX - svgPosition.left;
+          var my = evt.pageY - svgPosition.top + 5; // TODO FIXME why +5?!?
+          var y = Math.min(arcDragOriginBox.y, my) - draggedArcHeight;
+          var dx = (arcDragOriginBox.center - mx) / 4;
+          var path = svg.createPath().
+            move(arcDragOriginBox.center, arcDragOriginBox.y).
+            curveC(arcDragOriginBox.center - dx, y,
+                mx + dx, y,
+                mx, my);
+          arcDragArc.setAttribute('d', path.path());
+        } else {
+          // A. Scerri FireFox chunk
+
+          // if not, then is it span selection? (ctrl key cancels)
+          var sel = window.getSelection();
+          var chunkIndexFrom = sel.anchorNode && $(sel.anchorNode.parentNode).attr('data-chunk-id');
+          var chunkIndexTo = sel.focusNode && $(sel.focusNode.parentNode).attr('data-chunk-id');
+          // fallback for firefox (at least):
+          // it's unclear why, but for firefox the anchor and focus
+          // node parents are always undefined, the the anchor and
+          // focus nodes themselves do (often) have the necessary
+          // chunk ID. However, anchor offsets are almost always
+          // wrong, so we'll just make a guess at what the user might
+          // be interested in tagging instead of using what's given.
+          var anchorOffset = null;
+          var focusOffset = null;
+          if (chunkIndexFrom === undefined && chunkIndexTo === undefined &&
+              $(sel.anchorNode).attr('data-chunk-id') &&
+              $(sel.focusNode).attr('data-chunk-id')) {
+            // Lets take the actual selection range and work with that
+            // Note for visual line up and more accurate positions a vertical offset of 8 and horizontal of 2 has been used!
+            var range = sel.getRangeAt(0);
+            var svgOffset = $(svg._svg).offset();
+            var flip = false;
+            var tries = 0;
+            // First try and match the start offset with a position, if not try it against the other end
+            while (tries < 2) {
+              var sp = svg._svg.createSVGPoint();
+              sp.x = (flip ? evt.pageX : dragStartedAt.pageX) - svgOffset.left;
+              sp.y = (flip ? evt.pageY : dragStartedAt.pageY) - (svgOffset.top + 8);
+              var startsAt = range.startContainer;
+              anchorOffset = startsAt.getCharNumAtPosition(sp);
+              chunkIndexFrom = startsAt && $(startsAt).attr('data-chunk-id');
+              if (anchorOffset != -1) {
+                break;
+              }
+              flip = true;
+              tries++;
+            }
+
+            // Now grab the end offset
+            sp.x = (flip ? dragStartedAt.pageX : evt.pageX) - svgOffset.left;
+            sp.y = (flip ? dragStartedAt.pageY : evt.pageY) - (svgOffset.top + 8);
+            var endsAt = range.endContainer;
+            focusOffset = endsAt.getCharNumAtPosition(sp);
+
+            // If we cannot get a start and end offset stop here
+            if (anchorOffset == -1 || focusOffset == -1) {
+              return;
+            }
+            // If we are in the same container it does the selection back to front when dragged right to left, across different containers the start is the start and the end if the end!
+            if(range.startContainer == range.endContainer && anchorOffset > focusOffset) {
+              var t = anchorOffset;
+              anchorOffset = focusOffset;
+              focusOffset = t;
+              flip = false;
+            }
+            chunkIndexTo = endsAt && $(endsAt).attr('data-chunk-id');
+
+            // Now take the start and end character rectangles
+            startRec = startsAt.getExtentOfChar(anchorOffset);
+            startRec.y += 2;
+            endRec = endsAt.getExtentOfChar(focusOffset);
+            endRec.y += 2;
+
+            // If nothing has changed then stop here
+            if (lastStartRec != null && lastStartRec.x == startRec.x && lastStartRec.y == startRec.y && lastEndRec != null && lastEndRec.x == endRec.x && lastEndRec.y == endRec.y) {
+              return;
+            }
+
+            if (selRect == null) {
+              var rx = startRec.x;
+              var ry = startRec.y;
+              var rw = (endRec.x + endRec.width) - startRec.x;
+              if (rw < 0) {
+                rx += rw;
+                rw = -rw;
+              }
+              var rh = Math.max(startRec.height, endRec.height);
+
+              selRect = new Array();
+              var activeSelRect = makeSelRect(rx, ry, rw, rh);
+              selRect.push(activeSelRect);
+              startsAt.parentNode.parentNode.parentNode.insertBefore(activeSelRect, startsAt.parentNode.parentNode);
+            } else {
+              if (startRec.x != lastStartRec.x && endRec.x != lastEndRec.x && (startRec.y != lastStartRec.y || endRec.y != lastEndRec.y)) {
+                if (startRec.y < lastStartRec.y) {
+                  selRect[0].setAttributeNS(null, "width", lastStartRec.width);
+                  lastEndRec = lastStartRec;
+                } else if (endRec.y > lastEndRec.y) {
+                  selRect[selRect.length - 1].setAttributeNS(null, "x",
+                      parseFloat(selRect[selRect.length - 1].getAttributeNS(null, "x"))
+                      + parseFloat(selRect[selRect.length - 1].getAttributeNS(null, "width"))
+                      - lastEndRec.width);
+                  selRect[selRect.length - 1].setAttributeNS(null, "width", 0);
+                  lastStartRec=lastEndRec;
+                }
+              }
+
+              // Start has moved
+              var flip = !(startRec.x == lastStartRec.x && startRec.y == lastStartRec.y);
+              // If the height of the start or end changed we need to check whether
+              // to remove multi line highlights no longer needed if the user went back towards their start line
+              // and whether to create new ones if we moved to a newline
+              if (((endRec.y != lastEndRec.y)) || ((startRec.y != lastStartRec.y))) {
+                // First check if we have to remove the first highlights because we are moving towards the end on a different line
+                var ss = 0;
+                for (; ss != selRect.length; ss++) {
+                  if (startRec.y <= parseFloat(selRect[ss].getAttributeNS(null, "y"))) {
+                    break;
+                  }
+                }
+                // Next check for any end highlights if we are moving towards the start on a different line
+                var es = selRect.length - 1;
+                for (; es != -1; es--) {
+                  if (endRec.y >= parseFloat(selRect[es].getAttributeNS(null, "y"))) {
+                    break;
+                  }
+                }
+                // TODO put this in loops above, for efficiency the array slicing could be done separate still in single call
+                var trunc = false;
+                if (ss < selRect.length) {
+                  for (var s2 = 0; s2 != ss; s2++) {
+                    selRect[s2].parentNode.removeChild(selRect[s2]);
+                    es--;
+                    trunc = true;
+                  }
+                  selRect = selRect.slice(ss);
+                }
+                if (es > -1) {
+                  for (var s2 = selRect.length - 1; s2 != es; s2--) {
+                    selRect[s2].parentNode.removeChild(selRect[s2]);
+                    trunc = true;
+                  }
+                  selRect = selRect.slice(0, es + 1);
+                }
+
+                // If we have truncated the highlights we need to readjust the last one
+                if (trunc) {
+                  var activeSelRect = flip ? selRect[0] : selRect[selRect.length - 1];
+                  if (flip) {
+                    var rw = 0;
+                    if (startRec.y == endRec.y) {
+                      rw = (endRec.x + endRec.width) - startRec.x;
+                    } else {
+                      rw = (parseFloat(activeSelRect.getAttributeNS(null, "x"))
+                          + parseFloat(activeSelRect.getAttributeNS(null, "width")))
+                          - startRec.x;
+                    }
+                    activeSelRect.setAttributeNS(null, "x", startRec.x);
+                    activeSelRect.setAttributeNS(null, "y", startRec.y);
+                    activeSelRect.setAttributeNS(null, "width", rw);
+                  } else {
+                    var rw = (endRec.x + endRec.width) - parseFloat(activeSelRect.getAttributeNS(null, "x"));
+                    activeSelRect.setAttributeNS(null, "width", rw);
+                  }
+                } else {
+                  // We didnt truncate anything but we have moved to a new line so we need to create a new highlight
+                  var lastSel = flip ? selRect[0] : selRect[selRect.length - 1];
+                  var startBox = startsAt.parentNode.getBBox();
+                  var endBox = endsAt.parentNode.getBBox();
+
+                  if (flip) {
+                    lastSel.setAttributeNS(null, "width",
+                        (parseFloat(lastSel.getAttributeNS(null, "x"))
+                        + parseFloat(lastSel.getAttributeNS(null, "width")))
+                        - endBox.x);
+                    lastSel.setAttributeNS(null, "x", endBox.x);
+                  } else {
+                    lastSel.setAttributeNS(null, "width",
+                        (startBox.x + startBox.width)
+                        - parseFloat(lastSel.getAttributeNS(null, "x")));
+                  }
+                  var rx = 0;
+                  var ry = 0;
+                  var rw = 0;
+                  var rh = 0;
+                  if (flip) {
+                    rx = startRec.x;
+                    ry = startRec.y;
+                    rw = $(svg._svg).width() - startRec.x;
+                    rh = startRec.height;
+                  } else {
+                    rx = endBox.x;
+                    ry = endRec.y;
+                    rw = (endRec.x + endRec.width) - endBox.x;
+                    rh = endRec.height;
+                  }
+                  var newRect = makeSelRect(rx, ry, rw, rh);
+                  if (flip) {
+                    selRect.unshift(newRect);
+                  } else {
+                    selRect.push(newRect);
+                  }
+
+                  // Place new highlight in appropriate slot in SVG graph
+                  startsAt.parentNode.parentNode.parentNode.insertBefore(newRect, startsAt.parentNode.parentNode);
+                }
+              } else {
+                // The user simply moved left or right along the same line so just adjust the current highlight
+                var activeSelRect = flip ? selRect[0] : selRect[selRect.length - 1];
+                // If the start moved shift the highlight and adjust width
+                if (flip) {
+                  var rw = (parseFloat(activeSelRect.getAttributeNS(null, "x"))
+                      + parseFloat(activeSelRect.getAttributeNS(null, "width")))
+                      - startRec.x;
+                  activeSelRect.setAttributeNS(null, "x", startRec.x);
+                  activeSelRect.setAttributeNS(null, "y", startRec.y);
+                  activeSelRect.setAttributeNS(null, "width", rw);
+                } else {
+                  // If the end moved then simple change the width
+                  var rw = (endRec.x + endRec.width)
+                      - parseFloat(activeSelRect.getAttributeNS(null, "x"));
+                  activeSelRect.setAttributeNS(null, "width", rw);
+                }
+              }
+            }
+            lastStartRec = startRec;
+            lastEndRec = endRec;
+          }
+        }
+        arcDragJustStarted = false;
+      };
+
+      var adjustToCursor = function(evt, element, centerX, centerY) {
+        var screenHeight = $(window).height() - 8; // TODO HACK - no idea why -8 is needed
+        var screenWidth = $(window).width() - 8;
+        var elementHeight = element.height();
+        var elementWidth = element.width();
+        var cssSettings = {};
+        var eLeft;
+        var eTop;
+        if (centerX) {
+            eLeft = evt.clientX - elementWidth/2;
+        } else {
+            eLeft = evt.clientX;
+        }
+        if (centerY) {
+            eTop = evt.clientY - elementHeight/2;
+        } else {
+            eTop = evt.clientY;
+        }
+        // Try to make sure the element doesn't go off-screen.
+        // If this isn't possible (the element is larger than the screen),
+        // alight top-left corner of screen and dialog as a compromise.
+        if (screenWidth > elementWidth) {
+            eLeft = Math.min(Math.max(eLeft,0), screenWidth - elementWidth);
+        } else {
+            eLeft = 0;
+        } 
+        if (screenHeight > elementHeight) {
+            eTop  = Math.min(Math.max(eTop,0), screenHeight - elementHeight);
+        } else {
+            eTop  = 0;
+        }
+        element.css({ top: eTop, left: eLeft });
+      };
+
+      var updateCheckbox = function($input) {
+        var $widget = $input.button('widget');
+        var $textspan = $widget.find('.ui-button-text');
+        $textspan.html(($input[0].checked ? '&#x2611; ' : '&#x2610; ') + $widget.attr('data-bare'));
+      };
+
+      var fillSpanTypesAndDisplayForm = function(evt, spanText, span) {
+        keymap = spanKeymap;
+
+        // Figure out whether we should show or hide one of the two
+        // main halves of the selection frame (entities / events).
+        // This depends on the type of the current span, if any, and
+        // the availability of types to select.
+        var hideFrame;
+        if (span) {
+          // existing span; only show relevant half
+          if (span.generalType == 'entity') {
+            hideFrame = 'event';
+          } else {
+            hideFrame = 'entity';
+          }
+          spanForm.dialog('option', { title: 'Edit Annotation' });
+        } else {
+          // new span; show everything that's available
+          if ($('#event_types').find('input').length == 0) {
+            hideFrame = 'event';
+          } else if ($('#entity_types').find('input').length == 0) {
+            hideFrame = 'entity';
+          } else {
+            hideFrame = 'none';
+          }
+          spanForm.dialog('option', { title: 'New Annotation' });
+        }
+        if (hideFrame == 'event') {
+          $('#span_event_section').hide()
+          $('#span_entity_section').show().
+            removeClass('wrapper_half_left').
+            addClass('wrapper_full_width');
+        } else if (hideFrame == 'entity') {
+          $('#span_entity_section').hide()
+          $('#span_event_section').show().
+            removeClass('wrapper_half_right').
+            addClass('wrapper_full_width');
+        } else {
+          // show both entity and event halves
+          $('#span_entity_section').show().
+            removeClass('wrapper_full_width').
+            addClass('wrapper_half_left');
+          $('#span_event_section').show().
+            removeClass('wrapper_full_width').
+            addClass('wrapper_half_right');
+        }
+
+        // only show "delete" button if there's an existing annotation to delete
+        if (span) {
+          $('#del_span_button').show();
+        } else {
+          $('#del_span_button').hide();
+        }
+
+        $('#span_selected').text(spanText);
+        var encodedText = encodeURIComponent(spanText);       
+        $.each(searchConfig, function(searchNo, search) {
+          $('#span_'+search[0]).attr('href', search[1].replace('%s', encodedText));
+        });
+
+        // enable all inputs by default (see setSpanTypeSelectability)
+        $('#span_form input:not([unused])').removeAttr('disabled');
+
+        // close span types if there's over spanTypesToShowBeforeCollapse
+        if ($('#entity_types .item').length > spanTypesToShowBeforeCollapse) {
+          $('#entity_types .open').removeClass('open');
+        }
+        if ($('#event_types .item').length > spanTypesToShowBeforeCollapse) {
+          $('#event_types .open').removeClass('open');
+        }
+
+        var showAllAttributes = false;
+        if (span) {
+          var hash = new URLHash(coll, doc, { focus: [[span.id]] }).getHash();
+          $('#span_highlight_link').attr('href', hash).show();
+          var el = $('#span_' + span.type);
+          if (el.length) {
+            el[0].checked = true;
+          } else {
+            $('#span_form input:radio:checked').each(function (radioNo, radio) {
+              radio.checked = false;
+            });
+          }
+
+          // open the span type
+          $('#span_' + span.type).parents('.collapsible').each(function() {
+            toggleCollapsible($(this).parent().prev(), true);
+          });
+
+          // count the repeating arc types
+          var arcTypeCount = {};
+          repeatingArcTypes = [];
+          $.each(span.outgoing, function(arcNo, arc) {
+            // parse out possible number suffixes to allow e.g. splitting
+            // on "Theme" for args ("Theme1", "Theme2").
+            var splitArcType = arc.type.match(/^(.*?)(\d*)$/);
+            var noNumArcType = splitArcType[1];
+            if ((arcTypeCount[noNumArcType] = (arcTypeCount[noNumArcType] || 0) + 1) == 2) {
+              repeatingArcTypes.push(noNumArcType);
+            }
+          });
+          if (repeatingArcTypes.length) {
+            $('#span_form_split').show();
+          } else {
+            $('#span_form_split').hide();
+          }
+        } else {
+          $('#span_highlight_link').hide();
+          var firstRadio = $('#span_form input:radio:not([unused]):first')[0];
+          if (firstRadio) {
+            firstRadio.checked = true;
+          } else {
+            dispatcher.post('hideForm');
+            dispatcher.post('messages', [[['No valid span types defined', 'error']]]);
+            return;
+          }
+          $('#span_form_split').hide();
+          $('#span_notes').val('');
+          showAllAttributes = true;
+        }
+        if (span && !reselectedSpan) {
+          $('#span_form_reselect, #span_form_delete, #span_form_add_fragment').show();
+          keymap[$.ui.keyCode.DELETE] = 'span_form_delete';
+          keymap[$.ui.keyCode.INSERT] = 'span_form_reselect';
+          keymap['S-' + $.ui.keyCode.ENTER] = 'span_form_add_fragment';
+          $('#span_notes').val(span.annotatorNotes || '');
+        } else {
+          $('#span_form_reselect, #span_form_delete, #span_form_add_fragment').hide();
+          keymap[$.ui.keyCode.DELETE] = null;
+          keymap[$.ui.keyCode.INSERT] = null;
+          keymap['S-' + $.ui.keyCode.ENTER] = null;
+        }
+        if (span && !reselectedSpan && span.offsets.length > 1) {
+          $('#span_form_reselect_fragment, #span_form_delete_fragment').show();
+          keymap['S-' + $.ui.keyCode.DELETE] = 'span_form_delete_fragment';
+          keymap['S-' + $.ui.keyCode.INSERT] = 'span_form_reselect_fragment';
+        } else {
+          $('#span_form_reselect_fragment, #span_form_delete_fragment').hide();
+          keymap['S-' + $.ui.keyCode.DELETE] = null;
+          keymap['S-' + $.ui.keyCode.INSERT] = null;
+        }
+        // TODO: lots of redundancy in the next two blocks, clean up
+        if (!span) {
+          // no existing annotation, reset attributes
+          var attrCategoryAndTypes = [['entity', entityAttributeTypes],
+                                      ['event', eventAttributeTypes]];
+          $.each(attrCategoryAndTypes, function(ctNo, ct) {
+            var category = ct[0];
+            var attributeTypes = ct[1];
+            $.each(attributeTypes, function(attrNo, attr) {
+              $input = $('#'+category+'_attr_'+Util.escapeQuotes(attr.type));
+              if (attr.unused) {
+                $input.val('');
+              } else if (attr.bool) {
+                $input[0].checked = false;
+                updateCheckbox($input);
+                $input.button('refresh');
+              } else {
+                $input.val('').change();
+              }
+            });
+          });
+        } else if (!reselectedSpan) {
+          // existing annotation, fill attribute values from span
+          var attributeTypes;
+          var category;
+          if (span.generalType == 'entity') {
+            attributeTypes = entityAttributeTypes;
+            category = 'entity';
+          } else if (span.generalType == 'trigger') {
+            attributeTypes = eventAttributeTypes;
+            // TODO: unify category/generalType values ('trigger' vs. 'event')
+            category = 'event';
+          } else {
+            console.error('Unrecognized generalType:', span.generalType);
+          }
+          $.each(attributeTypes, function(attrNo, attr) {
+            $input = $('#'+category+'_attr_'+Util.escapeQuotes(attr.type));
+            var val = span.attributes[attr.type];
+            if (attr.unused) {
+              $input.val(val || '');
+            } else if (attr.bool) {
+              $input[0].checked = val;
+              updateCheckbox($input);
+              $input.button('refresh');
+            } else {
+              $input.val(val || '').change();
+            }
+          });
+        }
+
+        var showValidNormalizationsFor = function(type) {
+          // set DB selector to the first appropriate for the type.
+          // TODO: actually disable inappropriate ones.
+          // TODO: support specific IDs, not just DB specifiers
+          var firstDb = type && normDbsByType[type] ? normDbsByType[type][0] : null;
+          if (firstDb) {
+            $('#span_norm_db').val(firstDb);
+          }
+        }
+
+        showValidNormalizations = function() {
+          // set norm DB selector according to the first selected type
+          var firstSelected = $('#entity_and_event_wrapper input:radio:checked')[0];
+          var selectedType = firstSelected ? firstSelected.value : null;
+          showValidNormalizationsFor(selectedType);
+        }
+
+        // fill normalizations (if any)
+        if (!reselectedSpan) {
+          // clear first
+          clearNormalizationUI();
+
+          var $normDb = $('#span_norm_db');
+          var $normId = $('#span_norm_id');
+          var $normText = $('#span_norm_txt');
+
+          // fill if found (NOTE: only shows last on multiple)
+          var normFilled = false;
+          $.each(span ? span.normalizations : [], function(normNo, norm) {
+            var refDb = norm[0], refId = norm[1], refText = norm[2];
+            $normDb.val(refDb);
+            // could the DB selector be set? (i.e. is refDb configured?)
+            if ($normDb.val() == refDb) {
+              // DB is OK, set the rest also
+              $normId.val(refId);
+              oldSpanNormIdValue = refId;
+              $normText.val(refText);
+              // TODO: check if ID is valid
+              $normId.addClass('valid_value')
+              normFilled = true;
+            } else {
+              // can't set the DB selector; assume DB is not configured,
+              // warn and leave blank (will remove norm when dialog is OK'd)
+              dispatcher.post('messages', [[['Warning: '+refDb+' not configured, removing normalization.', 'warning']]]);
+            }
+          });
+
+          // if there is no existing normalization, show valid ones
+          if (!normFilled) {
+            showValidNormalizations();
+          }
+
+          // update links
+          updateNormalizationRefLink();
+          updateNormalizationDbLink();
+        }
+
+        var showAttributesFor = function(attrTypes, category, type) {
+          var validAttrs = type ? spanTypes[type].attributes : [];
+          var shownCount = 0;
+          $.each(attrTypes, function(attrNo, attr) {
+            var $input = $('#'+category+'_attr_'+Util.escapeQuotes(attr.type));
+            var showAttr = showAllAttributes || $.inArray(attr.type, validAttrs) != -1;
+            if (showAttr) {
+              $input.button('widget').show();
+              shownCount++;
+            } else {
+              $input.button('widget').hide();
+            }
+          });
+          return shownCount;
+        }
+
+        showValidAttributes = function() {
+          var type = $('#span_form input:radio:checked').val();
+          var entityAttrCount = showAttributesFor(entityAttributeTypes, 'entity', type);
+          var eventAttrCount = showAttributesFor(eventAttributeTypes, 'event', type);
+          
+          showAllAttributes = false;
+          // show attribute frames only if at least one attribute is
+          // shown, and set size classes appropriately
+          if (eventAttrCount > 0) {
+            $('#event_attributes').show();
+            $('#event_attribute_label').show();
+            $('#event_types').
+              removeClass('scroll_wrapper_full').
+              addClass('scroll_wrapper_upper');
+          } else {
+            $('#event_attributes').hide();
+            $('#event_attribute_label').hide();
+            $('#event_types').
+              removeClass('scroll_wrapper_upper').
+              addClass('scroll_wrapper_full');
+          }
+          if (entityAttrCount > 0) {
+            $('#entity_attributes').show();
+            $('#entity_attribute_label').show();
+            $('#entity_types').
+              removeClass('scroll_wrapper_full').
+              addClass('scroll_wrapper_upper');
+          } else {
+            $('#entity_attributes').hide();
+            $('#entity_attribute_label').hide();
+            $('#entity_types').
+              removeClass('scroll_wrapper_upper').
+              addClass('scroll_wrapper_full');
+          }
+        }
+        showValidAttributes();
+
+        // TODO XXX: if seemed quite unexpected/unintuitive that the
+        // form was re-displayed while the document still shows the
+        // annotation in its old location in the background (check it).
+        // The fix of skipping confirm is not really good either, though.
+        if (reselectedSpan) { // && !Configuration.confirmModeOn) {
+          submitReselect();
+        } else {
+          dispatcher.post('showForm', [spanForm]);
+          $('#span_form-ok').focus();
+          adjustToCursor(evt, spanForm.parent());
+        }
+      };
+
+      var submitReselect = function() {
+        $(reselectedSpan.rect).removeClass('reselect');
+        reselectedSpan = null;
+        spanForm.submit();
+      };
+
+      var rapidFillSpanTypesAndDisplayForm = function(start, end, text, types) {
+        // variant of fillSpanTypesAndDisplayForm for rapid annotation mode
+        keymap = spanKeymap;
+        $('#rapid_span_selected').text(text);
+
+        // fill types
+        var $spanTypeDiv = $('#rapid_span_types_div');
+        // remove previously filled, if any
+        $spanTypeDiv.empty();
+        $.each(types, function(typeNo, typeAndProb) {
+          // TODO: this duplicates a part of addSpanTypesToDivInner, unify
+          var type = typeAndProb[0];
+          var prob = typeAndProb[1];
+          var $numlabel = $('<span class="accesskey">'+(typeNo+1)+'</span><span>:</span>');
+          var $input = $('<input type="radio" name="rapid_span_type"/>').
+              attr('id', 'rapid_span_' + (typeNo+1)).
+              attr('value', type);
+          var spanBgColor = spanTypes[type] && spanTypes[type].bgColor || '#ffffff';
+          spanBgColor = Util.adjustColorLightness(spanBgColor, spanBoxTextBgColorLighten);
+          // use preferred label instead of type name if available
+          var name = spanTypes[type] && spanTypes[type].name || type;
+          var $label = $('<label class="span_type_label"/>').
+            attr('for', 'rapid_span_' + (typeNo+1)).
+            text(name+' (' + (100.0 * prob).toFixed(1) + '%)');
+          $label.css('background-color', spanBgColor);          
+          // TODO: check for unnecessary extra wrapping here
+          var $content = $('<div class="item_content"/>').
+            append($numlabel).
+            append($input).
+            append($label);
+          $spanTypeDiv.append($content);
+          // highlight configured hotkey (if any) in text.
+          // NOTE: this bit doesn't actually set up the hotkey.
+          var hotkeyType = 'span_' + type;
+          // TODO: this is clumsy; there should be a better way
+          var typeHotkey = null;
+          $.each(keymap, function(key, keyType) {
+            if (keyType == hotkeyType) {
+              typeHotkey = key;
+              return false;
+            }
+          });
+          if (typeHotkey) {
+            var name = $label.html();
+            var replace = true;
+            name = name.replace(new RegExp("(&[^;]*?)?(" + typeHotkey + ")", 'gi'),
+              function(all, entity, letter) {
+                if (replace && !entity) {
+                  replace = false;
+                  var hotkey = typeHotkey.toLowerCase() == letter
+                      ? typeHotkey.toLowerCase()
+                      : typeHotkey.toUpperCase();
+                  return '<span class="accesskey">' + Util.escapeHTML(hotkey) + '</span>';
+                }
+                return all;
+              });
+            $label.html(name);
+          }
+          // Limit the number of suggestions to the number of numeric keys
+          if (typeNo >= 8) {
+            return false;
+          }
+        });
+        // fill in some space and the special "Other" option, with key "0" (zero)
+        $spanTypeDiv.append($('<div class="item_content">&#160;</div>')); // non-breaking space
+        var $numlabel = $('<span class="accesskey">0</span><span>:</span>');        
+        var $input = $('<input type="radio" name="rapid_span_type" id="rapid_span_0" value=""/>');
+        var $label = $('<label class="span_type_label" for="rapid_span_0" style="background-color:lightgray">Other...</label>');
+        var $content = $('<div class="item_content"/>').
+          append($numlabel).
+          append($input).
+          append($label);
+        $spanTypeDiv.append($content);
+
+        // set up click event handlers
+        rapidSpanForm.find('#rapid_span_types input:radio').click(rapidSpanFormSubmitRadio);
+
+        var firstRadio = $('#rapid_span_form input:radio:first')[0];
+        if (firstRadio) {
+          firstRadio.checked = true;
+        } else {
+          dispatcher.post('hideForm');
+          dispatcher.post('messages', [[['No valid span types defined', 'error']]]);
+          return;
+        }
+        dispatcher.post('showForm', [rapidSpanForm]);
+        rapidAnnotationDialogVisible = true;
+        $('#rapid_span_form-ok').focus();
+        // TODO: avoid using global for stored click event
+//         adjustToCursor(lastRapidAnnotationEvent, rapidSpanForm.parent(),
+//                        true, true);
+        // TODO: avoid coordinate hack to position roughly at first
+        // available selection
+        lastRapidAnnotationEvent.clientX -= 55;
+        lastRapidAnnotationEvent.clientY -= 115;
+        adjustToCursor(lastRapidAnnotationEvent, rapidSpanForm.parent(),
+                       false, false);
+      };
+
+      var clearSpanNotes = function(evt) {
+        $('#span_notes').val('');
+      }
+      $('#clear_notes_button').button();
+      $('#clear_notes_button').click(clearSpanNotes);
+
+      var clearSpanNorm = function(evt) {
+        clearNormalizationUI();
+      }
+      $('#clear_norm_button').button();
+      $('#clear_norm_button').click(clearSpanNorm);
+
+      // invoked on response to ajax request for id lookup
+      var setSpanNormText = function(response) {
+        if (response.exception) {
+          // TODO: better response to failure
+          dispatcher.post('messages', [[['Lookup error', 'warning', -1]]]);
+          return false;
+        }        
+        // set input style according to whether we have a valid value
+        var $idinput = $('#span_norm_id');
+        // TODO: make sure the key echo in the response matches the
+        // current value of the $idinput
+        $idinput.removeClass('valid_value').removeClass('invalid_value');
+        if (response.value === null) {
+          $idinput.addClass('invalid_value');
+          hideNormalizationRefLink();
+        } else {
+          $idinput.addClass('valid_value');
+          updateNormalizationRefLink();
+        }
+        $('#span_norm_txt').val(response.value);
+      }
+
+      // on any change to the normalization DB, clear everything and
+      // update link
+      var spanNormDbUpdate = function(evt) {
+        clearNormalizationUI();
+        updateNormalizationDbLink();
+      }
+      $('#span_norm_db').change(spanNormDbUpdate);
+
+      // on any change to the normalization ID, update the text of the
+      // reference
+      var spanNormIdUpdate = function(evt) {
+        var key = $(this).val();
+        var db = $('#span_norm_db').val();
+        if (key != oldSpanNormIdValue) {
+          if (key.match(/^\s*$/)) {
+            // don't query empties, just clear instead
+            clearNormalizationUI();
+          } else {
+            dispatcher.post('ajax', [ {
+                            action: 'normGetName',
+                            database: db,
+                            key: key,
+                            collection: coll}, 'normGetNameResult']);
+          }
+          oldSpanNormIdValue = key;
+        }
+      }
+      // see http://stackoverflow.com/questions/1948332/detect-all-changes-to-a-input-type-text-immediately-using-jquery
+      $('#span_norm_id').bind('propertychange keyup input paste', spanNormIdUpdate);
+      // nice-looking select for normalization
+      $('#span_norm_db').addClass('ui-widget ui-state-default ui-button-text');
+
+      var normSearchDialog = $('#norm_search_dialog');
+      initForm(normSearchDialog, {
+          width: 800,
+          width: 600,
+          resizable: true,
+          alsoResize: '#norm_search_result_select',
+          open: function(evt) {
+            keymap = {};
+          },
+          close: function(evt) {
+            // assume that we always want to return to the span dialog
+            // on normalization dialog close
+            dispatcher.post('showForm', [spanForm]);
+          },
+      });
+      $('#norm_search_query').autocomplete({
+        source: function(request, callback) {
+          var query = $.ui.autocomplete.escapeRegex(request.term);
+          var pattern = new RegExp('\\b' + query, 'i');
+          callback($.grep(lastNormSearches, function(search) {
+            return pattern.test(search.value) || pattern.test(search.id);
+          }));
+        },
+        minLength: 0,
+        select: function(evt, ui) {
+          evt.stopPropagation();
+          normSubmit(ui.item.id, ui.item.value);
+        },
+        focus: function(evt, ui) {
+          // do nothing
+        },
+      }).data('autocomplete')._renderItem = function($ul, item) {
+        return $('<li></li>').
+          data('item.autocomplete', item).
+          append('<a>' + Util.escapeHTML(item.value) + '<div class="autocomplete-id">' + Util.escapeHTML(item.id) + "</div></a>").
+          appendTo($ul);
+      };
+      var normSubmit = function(selectedId, selectedTxt) {
+        // we got a value; act if it was a submit
+        $('#span_norm_id').val(selectedId);
+        // don't forget to update this reference value
+        oldSpanNormIdValue = selectedId;
+        $('#span_norm_txt').val(selectedTxt);
+        updateNormalizationRefLink();
+        // update history
+        var nextLastNormSearches = [
+          {
+            value: selectedTxt,
+            id: selectedId,
+          },
+        ];
+        $.each(lastNormSearches, function(searchNo, search) {
+          if (search.id != selectedId || search.value != selectedTxt) {
+            nextLastNormSearches.push(search);
+          }
+        });
+        lastNormSearches = nextLastNormSearches;
+        lastNormSearches.slice(0, maxNormSearchHistory);
+        // Switch dialogs. NOTE: assuming we closed the spanForm when
+        // bringing up the normSearchDialog.
+        normSearchDialog.dialog('close');
+      };
+      var normSearchSubmit = function(evt) {
+        if (normSearchSubmittable) {
+          var selectedId = $('#norm_search_id').val(); 
+          var selectedTxt = $('#norm_search_query').val();
+
+          normSubmit(selectedId, selectedTxt);
+        } else {
+          performNormSearch();
+        }
+        return false;
+      }
+      var normSearchSubmittable = false;
+      var setNormSearchSubmit = function(enable) {
+        $('#norm_search_dialog-ok').button(enable ? 'enable' : 'disable');
+        normSearchSubmittable = enable;
+      };
+      normSearchDialog.submit(normSearchSubmit);
+      var chooseNormId = function(evt) {
+        var $element = $(evt.target).closest('tr');
+        $('#norm_search_result_select tr').removeClass('selected');
+        $element.addClass('selected');
+        $('#norm_search_query').val($element.attr('data-txt'));
+        $('#norm_search_id').val($element.attr('data-id'));
+        setNormSearchSubmit(true);
+      }
+      var chooseNormIdAndSubmit = function(evt) {
+        chooseNormId(evt);
+        normSearchSubmit(evt);
+      }
+      var setSpanNormSearchResults = function(response) {
+        if (response.exception) {
+          // TODO: better response to failure
+          dispatcher.post('messages', [[['Lookup error', 'warning', -1]]]);
+          return false;
+        }
+
+        if (response.items.length == 0) {
+          // no results
+          $('#norm_search_result_select thead').empty();
+          $('#norm_search_result_select tbody').empty();
+          dispatcher.post('messages', [[['No matches to search.', 'comment']]]);
+          return false;
+        }
+
+        // TODO: avoid code duplication with showFileBrowser()
+
+        var html = ['<tr>'];
+        $.each(response.header, function(headNo, head) {
+          html.push('<th>' + Util.escapeHTML(head[0]) + '</th>');
+        });
+        html.push('</tr>');
+        $('#norm_search_result_select thead').html(html.join(''));
+
+        html = [];
+        var len = response.header.length;
+        $.each(response.items, function(itemNo, item) {
+          // NOTE: assuming ID is always the first datum in the item
+          // and that the preferred text is always the second
+          // TODO: Util.escapeQuotes would be expected to be
+          // sufficient here, but that appears to give "DOM Exception
+          // 11" in cases (try e.g. $x.html('<p a="A&B"/>'). Why? Is
+          // this workaround OK?
+          html.push('<tr'+
+                    ' data-id="'+Util.escapeHTMLandQuotes(item[0])+'"'+
+                    ' data-txt="'+Util.escapeHTMLandQuotes(item[1])+'"'+
+                    '>');
+          for (var i=0; i<len; i++) {
+            html.push('<td>' + Util.escapeHTML(item[i]) + '</td>');
+          }
+          html.push('</tr>');
+        });
+        $('#norm_search_result_select tbody').html(html.join(''));
+
+        $('#norm_search_result_select tbody').find('tr').
+            click(chooseNormId).
+            dblclick(chooseNormIdAndSubmit);
+
+        // TODO: sorting on click on header (see showFileBrowser())
+      }
+      var performNormSearch = function() {
+        var val = $('#norm_search_query').val();
+        var db = $('#span_norm_db').val();
+        dispatcher.post('ajax', [ {
+                        action: 'normSearch',
+                        database: db,
+                        name: val,
+                        collection: coll}, 'normSearchResult']);
+      }
+      $('#norm_search_button').click(performNormSearch);
+      $('#norm_search_query').focus(function() {
+        setNormSearchSubmit(false);
+      });
+      var showNormSearchDialog = function() {
+        // if we already have non-empty ID and normalized string,
+        // use these as default; otherwise take default search string
+        // from annotated span and clear ID entry
+        if (!$('#span_norm_id').val().match(/^\s*$/) &&
+            !$('#span_norm_txt').val().match(/^\s*$/)) {
+          $('#norm_search_id').val($('#span_norm_id').val());
+          $('#norm_search_query').val($('#span_norm_txt').val());
+        } else {
+          $('#norm_search_id').val('');
+          $('#norm_search_query').val($('#span_selected').text());
+        }
+        // blank the table
+        $('#norm_search_result_select thead').empty();
+        $('#norm_search_result_select tbody').empty();        
+        // TODO: support for two (or more) dialogs open at the same time
+        // so we don't need to hide this before showing normSearchDialog
+        dispatcher.post('hideForm');
+        $('#norm_search_button').val('Search ' + $('#span_norm_db').val());
+        setNormSearchSubmit(false);
+        dispatcher.post('showForm', [normSearchDialog]);
+        $('#norm_search_query').focus().select();
+      }
+      $('#span_norm_txt').click(showNormSearchDialog);
+      $('#norm_search_button').button();
+
+      var arcFormSubmitRadio = function(evt) {
+        // TODO: check for confirm_mode?
+        arcFormSubmit(evt, $(evt.target));
+      }
+
+      var arcFormSubmit = function(evt, typeRadio) {
+        typeRadio = typeRadio || $('#arc_form input:radio:checked');
+        var type = typeRadio.val();
+        dispatcher.post('hideForm', [arcForm]);
+
+        arcOptions.type = type;
+        arcOptions.comment = $('#arc_notes').val();
+        dispatcher.post('ajax', [arcOptions, 'edited']);
+        return false;
+      };
+
+      var fillArcTypesAndDisplayForm = function(evt, originType, targetType, arcType, arcId) {
+        var noArcs = true;
+        keymap = {};
+
+        // separate out possible numeric suffix from type
+        var noNumArcType;
+        if (arcType) {
+            var splitType = arcType.match(/^(.*?)(\d*)$/);
+            noNumArcType = splitType[1];
+        }
+
+        var isEquiv =
+          relationTypesHash &&
+          relationTypesHash[noNumArcType] &&
+          relationTypesHash[noNumArcType].properties &&
+          relationTypesHash[noNumArcType].properties.symmetric &&
+          relationTypesHash[noNumArcType].properties.transitive;
+
+        var $scroller = $();
+        if (spanTypes[originType]) {
+          var arcTypes = spanTypes[originType].arcs;
+          $scroller = $('#arc_roles .scroller').empty();
+
+          // lay them out into the form
+          $.each(arcTypes || [], function(arcTypeNo, arcDesc) {
+            if (arcDesc.targets && arcDesc.targets.indexOf(targetType) != -1) {
+              var arcTypeName = arcDesc.type;
+
+              var isThisEquiv =
+                relationTypesHash &&
+                relationTypesHash[arcTypeName] &&
+                relationTypesHash[arcTypeName].properties &&
+                relationTypesHash[arcTypeName].properties.symmetric &&
+                relationTypesHash[arcTypeName].properties.transitive;
+
+              // do not allow equiv<->non-equiv change options
+              if (arcType && isEquiv != isThisEquiv) return;
+
+              var displayName = ((arcDesc.labels && arcDesc.labels[0]) || 
+                                 arcTypeName);
+              var $checkbox = $('<input id="arc_' + arcTypeName + '" type="radio" name="arc_type" value="' + arcTypeName + '"/>');
+              var $label = $('<label class="arc_type_label" for="arc_' + arcTypeName + '"/>').text(displayName);
+              var $div = $('<div/>').append($checkbox).append($label);
+              $scroller.append($div);
+              if (arcDesc.hotkey) {
+                keymap[arcDesc.hotkey] = '#arc_' + arcTypeName;
+                var name = $label.html();
+                var replace = true;
+                name = name.replace(new RegExp("(&[^;]*?)?(" + arcDesc.hotkey + ")", 'gi'),
+                  function(all, entity, letter) {
+                    if (replace && !entity) {
+                      replace = false;
+                      var hotkey = arcDesc.hotkey.toLowerCase() == letter
+                          ? arcDesc.hotkey.toLowerCase()
+                          : arcDesc.hotkey.toUpperCase();
+                      return '<span class="accesskey">' + Util.escapeHTML(hotkey) + '</span>';
+                    }
+                    return all;
+                  });
+                $label.html(name);
+              }
+
+              noArcs = false;
+            }
+          });
+        }
+
+        if (noArcs) {
+          if (arcId) {
+            // let the user delete or whatever, even on bad config
+            // (note that what's shown to the user is w/o possible num suffix)
+            var $checkbox = $('<input id="arc_' + arcType + '" type="hidden" name="arc_type" value="' + noNumArcType + '"/>');
+            $scroller.append($checkbox);
+          } else {
+            // can't make a new arc
+            dispatcher.post('messages',
+              [[["No choices for " +
+                 Util.spanDisplayForm(spanTypes, originType) +
+                 " -> " +
+                 Util.spanDisplayForm(spanTypes, targetType),
+                 'warning']]]);
+            return;
+          }
+        }
+
+        var reversalPossible = false;
+        if (arcId) {
+          // something was selected
+          var focus = arcId instanceof Array ? arcId : [arcId];
+          var hash = new URLHash(coll, doc, { focus: [focus] }).getHash();
+          $('#arc_highlight_link').attr('href', hash).show(); // TODO incorrect
+          var el = $('#arc_' + arcType)[0];
+          if (el) {
+            el.checked = true;
+          } else {
+              // try w/o numeric suffix
+              el = $('#arc_' + noNumArcType)[0];
+              if (el) {
+                  el.checked = true;
+              }
+          }
+
+          $('#arc_form_reselect, #arc_form_delete').show();
+          keymap[$.ui.keyCode.DELETE] = 'arc_form_delete';
+          keymap[$.ui.keyCode.INSERT] = 'arc_form_reselect';
+
+          var backTargetType = spanTypes[targetType];
+          if (backTargetType) {
+            $.each(backTargetType.arcs || [], function(backArcTypeNo, backArcDesc) {
+              if ($.inArray(originType, backArcDesc.targets || []) != -1) {
+                reversalPossible = true;
+                return false; // terminate the loop
+              }
+            });
+          }
+
+          arcForm.dialog('option', { title: 'Edit Annotation' });
+        } else {
+          // new arc
+          $('#arc_highlight_link').hide();
+          el = $('#arc_form input:radio:first')[0];
+          if (el) {
+            el.checked = true;
+          }
+
+          $('#arc_form_reselect, #arc_form_delete, #arc_form_reverse').hide();
+
+          arcForm.dialog('option', { title: 'New Annotation' });
+        }
+        if (reversalPossible) {
+          $('#arc_form_reverse').show();
+          keymap['S-' + $.ui.keyCode.INSERT] = 'arc_form_reverse';
+        } else {
+          $('#arc_form_reverse').hide();
+        }
+
+        if (!Configuration.confirmModeOn) {
+          arcForm.find('#arc_roles input:radio').click(arcFormSubmitRadio);
+        }
+
+        var arcAnnotatorNotes;
+        var isBinaryRelation = arcId && !(arcId instanceof Array);
+        if (isBinaryRelation) {
+          // only for relation arcs
+          var ed = data.eventDescs[arcId];
+          arcAnnotatorNotes = ed && ed.annotatorNotes;
+        }
+        if (arcAnnotatorNotes) {
+          $('#arc_notes').val(arcAnnotatorNotes);
+        } else {
+          $('#arc_notes').val('');
+        }
+
+        // disable notes for arc types that don't support storage (#945)
+        if(!isBinaryRelation || isEquiv) {
+          // disable the actual input
+          $('#arc_notes').attr('disabled', 'disabled');
+          // add to fieldset for style
+          $('#arc_notes_fieldset').attr('disabled', 'disabled');
+        } else {
+          $('#arc_notes').removeAttr('disabled')
+          $('#arc_notes_fieldset').removeAttr('disabled')
+        }
+
+        dispatcher.post('showForm', [arcForm]);
+        $('#arc_form-ok').focus();
+        adjustToCursor(evt, arcForm.parent());
+      };
+
+      var reverseArc = function(evt) {
+        var eventDataId = $(evt.target).attr('data-arc-ed');
+        dispatcher.post('hideForm');
+        arcOptions.action = 'reverseArc';
+        delete arcOptions.old_target;
+        delete arcOptions.old_type;
+        dispatcher.post('ajax', [arcOptions, 'edited']);
+      };
+
+      var deleteArc = function(evt) {
+        if (Configuration.confirmModeOn && !confirm("Are you sure you want to delete this annotation?")) {
+          return;
+        }
+        var eventDataId = $(evt.target).attr('data-arc-ed');
+        dispatcher.post('hideForm');
+        arcOptions.action = 'deleteArc';
+        dispatcher.post('ajax', [arcOptions, 'edited']);
+      };
+
+      var reselectArc = function(evt) {
+        dispatcher.post('hideForm');
+        svgElement.addClass('reselect');
+        $('g[data-from="' + arcOptions.origin + '"][data-to="' + arcOptions.target + '"]').addClass('reselect');
+        startArcDrag(arcOptions.origin);
+      };
+
+      var arcForm = $('#arc_form');
+      dispatcher.post('initForm', [arcForm, {
+          width: 500,
+          buttons: [{
+              id: 'arc_form_reverse',
+              text: "Reverse",
+              click: reverseArc
+            }, {
+              id: 'arc_form_delete',
+              text: "Delete",
+              click: deleteArc
+            }, {
+              id: 'arc_form_reselect',
+              text: 'Reselect',
+              click: reselectArc
+            }],
+          alsoResize: '#arc_roles',
+          close: function(evt) {
+            keymap = null;
+          }
+        }]);
+      arcForm.submit(arcFormSubmit);
+      // set button tooltips (@amadanmath: can this be done in init?)
+      $('#arc_form_reselect').attr('title', 'Re-select the annotation this connects into.');
+      $('#arc_form_delete').attr('title', 'Delete this annotation.');
+
+      var stopArcDrag = function(target) {
+        if (arcDragOrigin) {
+          if (!target) {
+            target = $('.badTarget');
+          }
+          target.removeClass('badTarget');
+          arcDragOriginGroup.removeClass('highlight');
+          if (target) {
+            target.parent().removeClass('highlight');
+          }
+          if (arcDragArc) {
+            svg.remove(arcDragArc);
+            arcDrag = null;
+          }
+          arcDragOrigin = null;
+          if (arcOptions) {
+              $('g[data-from="' + arcOptions.origin + '"][data-to="' + arcOptions.target + '"]').removeClass('reselect');
+          }
+          svgElement.removeClass('reselect');
+        }
+        svgElement.removeClass('unselectable');
+        $('.reselectTarget').removeClass('reselectTarget');
+      };
+
+      var onMouseUp = function(evt) {
+        if (that.user === null) return;
+
+        var target = $(evt.target);
+
+        // three things that are clickable in SVG
+        var targetSpanId = target.data('span-id');
+        var targetChunkId = target.data('chunk-id');
+        var targetArcRole = target.data('arc-role');
+        if (!(targetSpanId !== undefined || targetChunkId !== undefined || targetArcRole !== undefined)) {
+          // misclick
+          clearSelection();
+          stopArcDrag(target);
+          return;
+        }
+
+        // is it arc drag end?
+        if (arcDragOrigin) {
+          var origin = arcDragOrigin;
+          var targetValid = target.hasClass('reselectTarget');
+          stopArcDrag(target);
+          if ((id = target.attr('data-span-id')) && origin != id && targetValid) {
+            var originSpan = data.spans[origin];
+            var targetSpan = data.spans[id];
+            if (arcOptions && arcOptions.old_target) {
+              arcOptions.target = targetSpan.id;
+              dispatcher.post('ajax', [arcOptions, 'edited']);
+            } else {
+              arcOptions = {
+                action: 'createArc',
+                origin: originSpan.id,
+                target: targetSpan.id,
+                collection: coll,
+                'document': doc
+              };
+              $('#arc_origin').text(Util.spanDisplayForm(spanTypes, originSpan.type)+' ("'+originSpan.text+'")');
+              $('#arc_target').text(Util.spanDisplayForm(spanTypes, targetSpan.type)+' ("'+targetSpan.text+'")');
+              fillArcTypesAndDisplayForm(evt, originSpan.type, targetSpan.type);
+              // for precise timing, log dialog display to user.
+              dispatcher.post('logAction', ['arcSelected']);
+            }
+          }
+        } else if (!evt.ctrlKey) {
+          // if not, then is it span selection? (ctrl key cancels)
+          var sel = window.getSelection();
+          var chunkIndexFrom = sel.anchorNode && $(sel.anchorNode.parentNode).attr('data-chunk-id');
+          var chunkIndexTo = sel.focusNode && $(sel.focusNode.parentNode).attr('data-chunk-id');
+
+          // fallback for firefox (at least):
+          // it's unclear why, but for firefox the anchor and focus
+          // node parents are always undefined, the the anchor and
+          // focus nodes themselves do (often) have the necessary
+          // chunk ID. However, anchor offsets are almost always
+          // wrong, so we'll just make a guess at what the user might
+          // be interested in tagging instead of using what's given.
+          var anchorOffset = null;
+          var focusOffset = null;
+          if (chunkIndexFrom === undefined && chunkIndexTo === undefined &&
+              $(sel.anchorNode).attr('data-chunk-id') &&
+              $(sel.focusNode).attr('data-chunk-id')) {
+            // A. Scerri FireFox chunk
+
+            var range = sel.getRangeAt(0);
+            var svgOffset = $(svg._svg).offset();
+            var flip = false;
+            var tries = 0;
+            while (tries < 2) {
+              var sp = svg._svg.createSVGPoint();
+              sp.x = (flip ? evt.pageX : dragStartedAt.pageX) - svgOffset.left;
+              sp.y = (flip ? evt.pageY : dragStartedAt.pageY) - (svgOffset.top + 8);
+              var startsAt = range.startContainer;
+              anchorOffset = startsAt.getCharNumAtPosition(sp);
+              chunkIndexFrom = startsAt && $(startsAt).attr('data-chunk-id');
+              if (anchorOffset != -1) {
+                break;
+              }
+              flip = true;
+              tries++;
+            }
+            sp.x = (flip ? dragStartedAt.pageX : evt.pageX) - svgOffset.left;
+            sp.y = (flip ? dragStartedAt.pageY : evt.pageY) - (svgOffset.top + 8);
+            var endsAt = range.endContainer;
+            focusOffset = endsAt.getCharNumAtPosition(sp);
+
+            if (range.startContainer == range.endContainer && anchorOffset > focusOffset) {
+              var t = anchorOffset;
+              anchorOffset = focusOffset;
+              focusOffset = t;
+              flip = false;
+            }
+            if (focusOffset != -1) {
+              focusOffset++;
+            }
+            chunkIndexTo = endsAt && $(endsAt).attr('data-chunk-id');
+
+            //console.log('fallback from', data.chunks[chunkIndexFrom], anchorOffset);
+            //console.log('fallback to', data.chunks[chunkIndexTo], focusOffset);
+          } else {
+            // normal case, assume the exact offsets are usable
+            anchorOffset = sel.anchorOffset;
+            focusOffset = sel.focusOffset;
+          }
+
+          if (chunkIndexFrom !== undefined && chunkIndexTo !== undefined) {
+            var chunkFrom = data.chunks[chunkIndexFrom];
+            var chunkTo = data.chunks[chunkIndexTo];
+            var selectedFrom = chunkFrom.from + anchorOffset;
+            var selectedTo = chunkTo.from + focusOffset;
+            sel.removeAllRanges();
+
+            if (selectedFrom > selectedTo) {
+              var tmp = selectedFrom; selectedFrom = selectedTo; selectedTo = tmp;
+            }
+            // trim
+            while (selectedFrom < selectedTo && " \n\t".indexOf(data.text.substr(selectedFrom, 1)) !== -1) selectedFrom++;
+            while (selectedFrom < selectedTo && " \n\t".indexOf(data.text.substr(selectedTo - 1, 1)) !== -1) selectedTo--;
+
+            // shift+click allows zero-width spans
+            if (selectedFrom === selectedTo && !evt.shiftKey) {
+              // simple click (zero-width span)
+              return;
+            }
+
+            var newOffset = [selectedFrom, selectedTo];
+            if (reselectedSpan) {
+              var newOffsets = reselectedSpan.offsets.slice(0); // clone
+              spanOptions.old_offsets = JSON.stringify(reselectedSpan.offsets);
+              if (selectedFragment !== null) {
+                if (selectedFragment !== false) {
+                  newOffsets.splice(selectedFragment, 1);
+                }
+                newOffsets.push(newOffset);
+                newOffsets.sort(Util.cmpArrayOnFirstElement);
+                spanOptions.offsets = newOffsets;
+              } else {
+                spanOptions.offsets = [newOffset];
+              }
+            } else {
+              spanOptions = {
+                action: 'createSpan',
+                offsets: [newOffset]
+              }
+            }
+
+/* In relation to #786, removed the cross-sentence checking code
+            var crossSentence = true;
+            $.each(sourceData.sentence_offsets, function(sentNo, startEnd) {
+              if (selectedTo <= startEnd[1]) {
+                // this is the sentence
+
+                if (selectedFrom >= startEnd[0]) {
+                  crossSentence = false;
+                }
+                return false;
+              }
+            });
+
+            if (crossSentence) {
+              // attempt to annotate across sentence boundaries; not supported
+              dispatcher.post('messages', [[['Error: cannot annotate across a sentence break', 'error']]]);
+              if (reselectedSpan) {
+                $(reselectedSpan.rect).removeClass('reselect');
+              }
+              reselectedSpan = null;
+              svgElement.removeClass('reselect');
+            } else
+*/
+            if (!Configuration.rapidModeOn || reselectedSpan != null) {
+              // normal span select in standard annotation mode
+              // or reselect: show selector
+              var spanText = data.text.substring(selectedFrom, selectedTo);
+              fillSpanTypesAndDisplayForm(evt, spanText, reselectedSpan);
+              // for precise timing, log annotation display to user.
+              dispatcher.post('logAction', ['spanSelected']);
+            } else {
+              // normal span select in rapid annotation mode: call
+              // server for span type candidates
+              var spanText = data.text.substring(selectedFrom, selectedTo);
+              // TODO: we're currently storing the event to position the
+              // span form using adjustToCursor() (which takes an event),
+              // but this is clumsy and suboptimal (user may have scrolled
+              // during the ajax invocation); think of a better way.
+              lastRapidAnnotationEvent = evt;
+              dispatcher.post('ajax', [ { 
+                              action: 'suggestSpanTypes',
+                              collection: coll,
+                              'document': doc,
+                              start: selectedFrom,
+                              end: selectedTo,
+                              text: spanText,
+                              model: $('#rapid_model').val(),
+                              }, 'suggestedSpanTypes']);
+            }
+          }
+        }
+      };
+
+      var receivedSuggestedSpanTypes = function(sugg) {
+        if (sugg.exception) {
+          // failed in one way or another; assume rapid mode cannot be
+          // used.
+          dispatcher.post('messages', [[['Rapid annotation mode error; returning to normal mode.', 'warning', -1]]]);
+          setAnnotationSpeed(2);
+          dispatcher.post('configurationUpdated');
+          return false;
+        }
+
+        // make sure the suggestions are for the current collection and document
+        if (sugg.collection != coll || sugg.document != doc) {
+          dispatcher.post('messages', [[['Error: collection/document mismatch for span suggestions', 'error']]]);
+          return false;
+        }
+        // initialize for submission
+        // TODO: is this a reasonable place to do this?
+        rapidSpanOptions = {
+          offsets: [[sugg.start, sugg.end]],
+        };
+        rapidFillSpanTypesAndDisplayForm(sugg.start, sugg.end, sugg.text, sugg.types);
+      };
+
+      var toggleCollapsible = function($el, state) {
+        var opening = state !== undefined ? state : !$el.hasClass('open');
+        var $collapsible = $el.parent().find('.collapsible:first');
+        if (opening) {
+          $collapsible.addClass('open');
+          $el.addClass('open');
+        } else {
+          $collapsible.removeClass('open');
+          $el.removeClass('open');
+        }
+      };
+
+      var collapseHandler = function(evt) {
+        toggleCollapsible($(evt.target));
+      }
+
+      var spanFormSubmitRadio = function(evt) {
+        if (Configuration.confirmModeOn) {
+          showValidAttributes();
+          showValidNormalizations();
+          $('#span_form-ok').focus();
+        } else {
+          spanFormSubmit(evt, $(evt.target));
+        }
+      }
+
+      var rapidSpanFormSubmitRadio = function(evt) {
+        rapidSpanFormSubmit(evt, $(evt.target));
+      }
+
+      var rememberData = function(_data) {
+        if (_data && !_data.exception) {
+          data = _data;
+        }
+      };
+
+      var addSpanTypesToDivInner = function($parent, types, category) {
+        if (!types) return;
+
+        $.each(types, function(typeNo, type) {
+          if (type === null) {
+            $parent.append('<hr/>');
+          } else {
+            var name = type.name;
+            var $input = $('<input type="radio" name="span_type"/>').
+              attr('id', 'span_' + type.type).
+              attr('value', type.type);
+            if (category) {
+              $input.attr('category', category);
+            }
+            // use a light version of the span color as BG
+            var spanBgColor = spanTypes[type.type] && spanTypes[type.type].bgColor || '#ffffff';
+            spanBgColor = Util.adjustColorLightness(spanBgColor, spanBoxTextBgColorLighten);
+            var $label = $('<label class="span_type_label"/>').
+              attr('for', 'span_' + type.type).
+              text(name);
+            if (type.unused) {
+              $input.attr({
+                disabled: 'disabled',
+                unused: 'unused'
+              });
+              $label.css('font-weight', 'bold');
+            } else {
+              $label.css('background-color', spanBgColor);
+            }
+            var $collapsible = $('<div class="collapsible open"/>');
+            var $content = $('<div class="item_content"/>').
+              append($input).
+              append($label).
+              append($collapsible);
+            var $collapser = $('<div class="collapser open"/>');
+            var $div = $('<div class="item"/>');
+            if (type.children.length) {
+              $div.append($collapser)
+            }
+            $div.append($content);
+            addSpanTypesToDivInner($collapsible, type.children, category);
+            $parent.append($div);
+            if (type.hotkey) {
+              spanKeymap[type.hotkey] = 'span_' + type.type;
+              var name = $label.html();
+              var replace = true;
+              name = name.replace(new RegExp("(&[^;]*?)?(" + type.hotkey + ")", 'gi'),
+                function(all, entity, letter) {
+                  if (replace && !entity) {
+                    replace = false;
+                    var hotkey = type.hotkey.toLowerCase() == letter
+                        ? type.hotkey.toLowerCase()
+                        : type.hotkey.toUpperCase();
+                    return '<span class="accesskey">' + Util.escapeHTML(hotkey) + '</span>';
+                  }
+                  return all;
+                });
+              $label.html(name);
+            }
+          }
+        });
+      };
+      var addSpanTypesToDiv = function($top, types, heading) {
+        $scroller = $('<div class="scroller"/>');
+        $legend = $('<legend/>').text(heading);
+        $fieldset = $('<fieldset/>').append($legend).append($scroller);
+        $top.append($fieldset);
+        addSpanTypesToDivInner($scroller, types);
+      };
+      var addAttributeTypesToDiv = function($top, types, category) {
+        $.each(types, function(attrNo, attr) {
+          var escapedType = Util.escapeQuotes(attr.type);
+          var attrId = category+'_attr_'+escapedType;
+          if (attr.unused) {
+            var $input = $('<input type="hidden" id="'+attrId+'" value=""/>');
+            $top.append($input);
+          } else if (attr.bool) {
+            var escapedName = Util.escapeQuotes(attr.name);
+            var $input = $('<input type="checkbox" id="'+attrId+
+                           '" value="' + escapedType + 
+                           '" category="' + category + '"/>');
+            var $label = $('<label class="attribute_type_label" for="'+attrId+
+                           '" data-bare="' + escapedName + '">&#x2610; ' + 
+                           escapedName + '</label>');
+            $top.append($input).append($label);
+            $input.button();
+            $input.change(onBooleanAttrChange);
+          } else {
+            var $div = $('<div class="ui-button ui-button-text-only attribute_type_label"/>');
+            var $select = $('<select id="'+attrId+'" class="ui-widget ui-state-default ui-button-text" category="' + category + '"/>');
+            var $option = $('<option class="ui-state-default" value=""/>').text(attr.name + ': ?');
+            $select.append($option);
+            $.each(attr.values, function(valType, value) {
+              $option = $('<option class="ui-state-active" value="' + Util.escapeQuotes(valType) + '"/>').text(attr.name + ': ' + (value.name || valType));
+              $select.append($option);
+            });
+            $div.append($select);
+            $top.append($div);
+            $select.change(onMultiAttrChange);
+          }
+        });
+      }
+
+      var setSpanTypeSelectability = function(category) {
+        // TODO: this implementation is incomplete: we should ideally
+        // disable not only categories of types (events or entities),
+        // but the specific set of types that are incompatible with
+        // the current attribute settings.
+        
+        // just assume all attributes are event attributes
+        // TODO: support for entity attributes
+        // TODO2: the above comment is almost certainly false, check and remove
+        $('#span_form input:not([unused])').removeAttr('disabled');
+        var $toDisable;
+        if (category == "event") {
+          $toDisable = $('#span_form input[category="entity"]');
+        } else if (category == "entity") {
+          $toDisable = $('#span_form input[category="event"]');
+        } else {
+          console.error('Unrecognized attribute category:', category);
+          $toDisable = $();
+        }
+        var $checkedToDisable = $toDisable.filter(':checked');
+        $toDisable.attr('disabled', true);
+        // the disable may leave the dialog in a state where nothing
+        // is checked, which would cause error on "OK". In this case,
+        // check the first valid choice.
+        if ($checkedToDisable.length) {
+          var $toCheck = $('#span_form input[category="' + category + '"]:first');
+          // so weird, attr('checked', 'checked') fails sometimes, so
+          // replaced with more "metal" version
+          $toCheck[0].checked = true
+        }
+      }
+
+      var onMultiAttrChange = function(evt) {
+        if ($(this).val() == '') {
+          $('#span_form input:not([unused])').removeAttr('disabled');
+        } else {
+          var attrCategory = evt.target.getAttribute('category');
+          setSpanTypeSelectability(attrCategory);
+          if (evt.target.selectedIndex) {
+            $(evt.target).addClass('ui-state-active');
+          } else {
+            $(evt.target).removeClass('ui-state-active');
+          }
+        }
+      }
+
+      var onBooleanAttrChange = function(evt) {
+        var attrCategory = evt.target.getAttribute('category');
+        setSpanTypeSelectability(attrCategory);
+        updateCheckbox($(evt.target));
+      };
+
+      var rememberSpanSettings = function(response) {
+        spanKeymap = {};
+
+        // TODO: check for exceptions in response
+
+        // fill in entity and event types
+        var $entityScroller = $('#entity_types div.scroller').empty();
+        addSpanTypesToDivInner($entityScroller, response.entity_types, 'entity');
+        var $eventScroller = $('#event_types div.scroller').empty();
+        addSpanTypesToDivInner($eventScroller, response.event_types, 'event');
+
+        // fill in attributes
+        var $entattrs = $('#entity_attributes div.scroller').empty();
+        addAttributeTypesToDiv($entattrs, entityAttributeTypes, 'entity');
+
+        var $eveattrs = $('#event_attributes div.scroller').empty();
+        addAttributeTypesToDiv($eveattrs, eventAttributeTypes, 'event');
+
+        // fill search options in span dialog
+        searchConfig = response.search_config;
+        var $searchlinks  = $('#span_search_links').empty();
+        var $searchlinks2 = $('#viewspan_search_links').empty();
+        var firstLink=true;
+        var linkFilled=false;
+        if (searchConfig) {
+          $.each(searchConfig, function(searchNo, search) {
+            if (!firstLink) {
+              $searchlinks.append(',\n')
+              $searchlinks2.append(',\n')
+            }
+            firstLink=false;
+            $searchlinks.append('<a target="_blank" id="span_'+search[0]+'" href="#">'+search[0]+'</a>');
+            $searchlinks2.append('<a target="_blank" id="viewspan_'+search[0]+'" href="#">'+search[0]+'</a>');
+            linkFilled=true;
+          });
+        }
+        if (linkFilled) {
+          $('#span_search_fieldset').show();
+          $('#viewspan_search_fieldset').show();
+        } else {
+          $('#span_search_fieldset').hide();
+          $('#viewspan_search_fieldset').hide();
+        }
+
+        spanForm.find('#entity_types input:radio').click(spanFormSubmitRadio);
+        spanForm.find('#event_types input:radio').click(spanFormSubmitRadio);
+        spanForm.find('.collapser').click(collapseHandler);
+      };
+
+      var tagCurrentDocument = function(taggerId) {
+        var tagOptions = {
+          action: 'tag',
+          collection: coll,
+          'document': doc,
+          tagger: taggerId,
+        };
+        dispatcher.post('ajax', [tagOptions, 'edited']);
+      }
+
+      var setupTaggerUI = function(response) {
+        var taggers = response.ner_taggers || [];
+        $taggerButtons = $('#tagger_buttons').empty();
+        $.each(taggers, function(taggerNo, tagger) {
+          // expect a tuple with ID, name, model, and URL
+          var taggerId = tagger[0];
+          var taggerName = tagger[1];
+          var taggerModel = tagger[2];
+          if (!taggerId || !taggerName || !taggerModel) {
+            dispatcher.post('messages', [[['Invalid tagger specification received from server', 'error']]]);
+            return true; // continue
+          }
+          var $row = $('<div class="optionRow"/>');
+          var $label = $('<span class="optionLabel">'+Util.escapeHTML(taggerName)+'</span>');
+          var $button = $('<input id="tag_'+Util.escapeHTML(taggerId)+'_button" type="button" value="'+Util.escapeHTML(taggerModel)+'" tabindex="-1" title="Automatically tag the current document."/>');
+          $row.append($label).append($button);
+          $taggerButtons.append($row);
+          $button.click(function(evt) {
+            tagCurrentDocument(taggerId);
+          });
+        });
+        $taggerButtons.find('input').button();
+        // if nothing was set up, hide the whole fieldset and show
+        // a message to this effect, else the other way around
+        if ($taggerButtons.find('input').length == 0) {
+          $('#auto_tagging_fieldset').hide();
+          $('#no_tagger_message').show();
+        } else {
+          $('#auto_tagging_fieldset').show();
+          $('#no_tagger_message').hide();
+        }
+      }
+
+      // recursively traverses type hierarchy (entity_types or
+      // event_types) and stores normalizations in normDbsByType.
+      var rememberNormDbsForType = function(types) {
+        if (!types) return;
+
+        $.each(types, function(typeNo, type) {
+          if (type === null) {
+            // spacer, no-op
+          } else {
+            normDbsByType[type.type] = type.normalizations || [];
+            if (type.children.length) {
+              rememberNormDbsForType(type.children);
+            }
+          }
+        });
+      };
+
+      var setupNormalizationUI = function(response) {
+        var norm_resources = response.normalization_config || [];
+        var $norm_select = $('#span_norm_db');
+        // clear possible existing
+        $norm_select.empty();
+        // fill in new
+        html = [];
+        $.each(norm_resources, function(normNo, norm) {
+          var normName = norm[0], normUrl = norm[1], normUrlBase = norm[2];
+          var serverDb = norm[3];
+          html.push('<option value="'+Util.escapeHTML(normName)+'">'+
+                    Util.escapeHTML(normName)+'</option>');
+          // remember the urls for updates
+          normDbUrlByDbName[normName] = normUrl;
+          normDbUrlBaseByDbName[normName] = normUrlBase;
+        });
+        // remember per-type appropriate DBs
+        normDbsByType = {};
+        rememberNormDbsForType(response.entity_types);
+        rememberNormDbsForType(response.event_types);
+        // set up HTML
+        $norm_select.html(html.join(''));
+        // if we have nothing, just hide the whole thing
+        if (!norm_resources.length) {
+          $('#norm_fieldset').hide();
+        } else {
+          $('#norm_fieldset').show();
+        }
+      }
+
+      // hides the reference link in the normalization UI
+      var hideNormalizationRefLink = function() {
+        $('#span_norm_ref_link').hide();
+      }
+
+      // updates the reference link in the normalization UI according
+      // to the current value of the normalization DB and ID.
+      var updateNormalizationRefLink = function() {
+        var $normId = $('#span_norm_id');
+        var $normLink = $('#span_norm_ref_link');
+        var normId = $normId.val();
+        var $normDb = $('#span_norm_db');
+        var normDb = $normDb.val();
+        if (!normId || !normDb || normId.match(/^\s*$/)) {
+          $normLink.hide();
+        } else {
+          var base = normDbUrlBaseByDbName[normDb];
+          // assume hidden unless everything goes through
+          $normLink.hide();
+          if (!base) {
+            // base URL is now optional, just skip link generation if not set
+            ;
+          } else if (base.indexOf('%s') == -1) {
+            dispatcher.post('messages', [[['Base URL "'+base+'" for '+normDb+' does not contain "%s"', 'error']]]);
+          } else {
+            // TODO: protect against strange chars in ID
+            link = base.replace('%s', normId);
+            $normLink.attr('href', link);
+            $normLink.show();
+          }
+        }
+      }
+
+      // updates the DB search link in the normalization UI according
+      // to the current value of the normalization DB.
+      var updateNormalizationDbLink = function() {
+        var $dbLink = $('#span_norm_db_link');
+        var $normDb = $('#span_norm_db');
+        var normDb = $normDb.val();
+        if (!normDb) return; // no normalisation configured
+        var link = normDbUrlByDbName[normDb];
+        if (!link || link.match(/^\s*$/)) {
+          dispatcher.post('messages', [[['No URL for '+normDb, 'error']]]);
+          $dbLink.hide();
+        } else {
+          // TODO: protect against weirdness in DB link
+          $dbLink.attr('href', link);
+          $dbLink.show();
+        }
+      }
+
+      // resets user-settable normalization-related UI elements to a
+      // blank state (does not blank #span_norm_db <select>).
+      var clearNormalizationUI = function() {
+        var $normId = $('#span_norm_id');
+        var $normText = $('#span_norm_txt');
+        $normId.val('');
+        oldSpanNormIdValue = '';
+        $normId.removeClass('valid_value').removeClass('invalid_value');
+        $normText.val('');
+        updateNormalizationRefLink();
+      }
+
+      // returns the normalizations currently filled in the span
+      // dialog, or empty list if there are none
+      var spanNormalizations = function() {
+        // Note that only no or one normalization is supported in the
+        // UI at the moment.
+        var normalizations = [];
+        var normDb = $('#span_norm_db').val();
+        var normId = $('#span_norm_id').val();
+        var normText = $('#span_norm_txt').val();
+        // empty ID -> no normalization
+        if (!normId.match(/^\s*$/)) {
+          normalizations.push([normDb, normId, normText]);
+        }
+        return normalizations;
+      }
+
+      // returns attributes that are valid for the selected type in
+      // the span dialog
+      var spanAttributes = function(typeRadio) {
+        typeRadio = typeRadio || $('#span_form input:radio:checked');
+        var attributes = {};
+        var attributeTypes;
+        var category = typeRadio.attr('category');
+        if (category == 'entity') {
+          attributeTypes = entityAttributeTypes;
+        } else if (category == 'event') {
+          attributeTypes = eventAttributeTypes;
+        } else {
+          console.error('Unrecognized type category:', category);
+        }
+        $.each(attributeTypes, function(attrNo, attr) {
+          var $input = $('#'+category+'_attr_'+Util.escapeQuotes(attr.type));
+          if (attr.bool) {
+            attributes[attr.type] = $input[0].checked;
+          } else if ($input[0].selectedIndex) {
+            attributes[attr.type] = $input.val();
+          }
+        });
+        return attributes;
+      }
+
+      var spanAndAttributeTypesLoaded = function(_spanTypes, 
+                                                 _entityAttributeTypes,
+                                                 _eventAttributeTypes,
+                                                 _relationTypesHash) {
+        spanTypes = _spanTypes;
+        entityAttributeTypes = _entityAttributeTypes;
+        eventAttributeTypes = _eventAttributeTypes;
+        relationTypesHash = _relationTypesHash;
+        // for easier access
+        allAttributeTypes = $.extend({}, 
+                                     entityAttributeTypes, 
+                                     eventAttributeTypes);
+      };
+
+      var gotCurrent = function(_coll, _doc, _args) {
+        coll = _coll;
+        doc = _doc;
+        args = _args;
+      };
+
+      var undoStack = [];
+      var edited = function(response) {
+        var x = response.exception;
+        if (x) {
+          if (x == 'annotationIsReadOnly') {
+            dispatcher.post('messages', [[["This document is read-only and can't be edited.", 'error']]]);
+          } else if (x == 'spanOffsetOverlapError') {
+            // createSpan with overlapping frag offsets; reset offsets
+            // @amadanmath: who holds the list of offsets for a span?
+            // how to reset this?
+          } else {
+            dispatcher.post('messages', [[['Unknown error '+x, 'error']]]);
+          }
+          if (reselectedSpan) {
+            $(reselectedSpan.rect).removeClass('reselect');
+            reselectedSpan = null;
+          }
+          svgElement.removeClass('reselect');
+          $('#waiter').dialog('close');
+        } else {
+          if (response.edited == undefined) {
+            console.warn('Warning: server response to edit has', response.edited, 'value for "edited"');
+          } else {
+            args.edited = response.edited;
+          }
+          var sourceData = response.annotations;
+          sourceData.document = doc;
+          sourceData.collection = coll;
+          // this "prevent" is to protect against reloading (from the
+          // server) the very data that we just received as part of the
+          // response to the edit.
+          if (response.undo != undefined) {
+            undoStack.push([coll, sourceData.document, response.undo]);
+          }
+          dispatcher.post('preventReloadByURL');
+          dispatcher.post('setArguments', [args]);
+          dispatcher.post('renderData', [sourceData]);
+        }
+      };
+
+
+      // TODO: why are these globals defined here instead of at the top?
+      var spanForm = $('#span_form');
+      var rapidSpanForm = $('#rapid_span_form');
+    
+      var deleteSpan = function() {
+        if (Configuration.confirmModeOn && !confirm("Are you sure you want to delete this annotation?")) {
+          return;
+        }
+        $.extend(spanOptions, {
+          action: 'deleteSpan',
+          collection: coll,
+          'document': doc,
+        });
+        spanOptions.offsets = JSON.stringify(spanOptions.offsets);
+        dispatcher.post('ajax', [spanOptions, 'edited']);
+        dispatcher.post('hideForm');
+        $('#waiter').dialog('open');
+      };
+
+      var reselectSpan = function() {
+        dispatcher.post('hideForm');
+        svgElement.addClass('reselect');
+        $(editedSpan.rect).addClass('reselect');
+        reselectedSpan = editedSpan;
+        selectedFragment = null;
+      };
+
+      var splitForm = $('#split_form');
+      splitForm.submit(function(evt) {
+        var splitRoles = [];
+        $('#split_roles input:checked').each(function() {
+          splitRoles.push($(this).val());
+        });
+        $.extend(spanOptions, {
+            action: 'splitSpan',
+            'args': $.toJSON(splitRoles),
+            collection: coll,
+            'document': doc,
+          });
+        spanOptions.offsets = JSON.stringify(spanOptions.offsets);
+        dispatcher.post('hideForm');
+        dispatcher.post('ajax', [spanOptions, 'edited']);
+        return false;
+      });
+      dispatcher.post('initForm', [splitForm, {
+          alsoResize: '.scroll_fset',
+          width: 400
+        }]);
+      var splitSpan = function() {
+        dispatcher.post('hideForm');
+        var $roles = $('#split_roles').empty();
+        var numRoles = repeatingArcTypes.length;
+        var roles = $.each(repeatingArcTypes, function() {
+          var $role = $('<input id="split_on_' + Util.escapeQuotes(this) +
+            '" type="checkbox" name="' + Util.escapeQuotes(this) +
+            '" value="' + Util.escapeQuotes(this) + '"/>');
+          if (numRoles == 1) {
+            // a single role will be selected automatically
+            $role.click();
+          }
+          var $label = $('<label for="split_on_' + Util.escapeQuotes(this) +
+            '">' + Util.escapeQuotes(this) + '</label>');
+          $roles.append($role).append($label);
+        });
+        var $roleButtons = $roles.find('input').button();
+        
+        dispatcher.post('showForm', [splitForm]);
+      };
+
+      var addFragment = function() {
+        dispatcher.post('hideForm');
+        svgElement.addClass('reselect');
+        $(editedSpan.rect).addClass('reselect');
+        reselectedSpan = editedSpan;
+        selectedFragment = false;
+      };
+
+      var reselectFragment = function() {
+        addFragment();
+        selectedFragment = editedFragment;
+      };
+
+      var deleteFragment = function() {
+        if (Configuration.confirmModeOn && !confirm("Are you sure you want to delete this fragment?")) {
+          return;
+        }
+        var offsets = editedSpan.offsets;
+        spanOptions.old_offsets = JSON.stringify(offsets);
+        offsets.splice(editedFragment, 1);
+
+        $.extend(spanOptions, {
+          collection: coll,
+          'document': doc,
+          offsets: JSON.stringify(offsets),
+        });
+
+        spanOptions.attributes = $.toJSON(spanAttributes());
+
+        spanOptions.normalizations = $.toJSON(spanNormalizations());
+
+        dispatcher.post('ajax', [spanOptions, 'edited']);
+        dispatcher.post('hideForm');
+        $('#waiter').dialog('open');
+      };
+
+      dispatcher.post('initForm', [spanForm, {
+          alsoResize: '#entity_and_event_wrapper',
+          width: 760,
+          buttons: [{
+              id: 'span_form_add_fragment',
+              text: "Add Frag.",
+              click: addFragment
+            }, {
+              id: 'span_form_delete',
+              text: "Delete",
+              click: deleteSpan
+            }, {
+              id: 'span_form_delete_fragment',
+              text: "Delete Frag.",
+              click: deleteFragment
+            }, {
+              id: 'span_form_reselect',
+              text: 'Move',
+              click: reselectSpan
+            }, {
+              id: 'span_form_reselect_fragment',
+              text: 'Move Frag.',
+              click: reselectFragment
+            }, {
+              id: 'span_form_split',
+              text: 'Split',
+              click: splitSpan
+            }
+          ],
+          close: function(evt) {
+            keymap = null;
+            if (reselectedSpan) {
+              $(reselectedSpan.rect).removeClass('reselect');
+              reselectedSpan = null;
+              svgElement.removeClass('reselect');
+            }
+          }
+        }]);
+      // set button tooltips (@amadanmath: can this be done in init?)
+      $('#span_form_reselect').attr('title', 'Re-select the text span that this annotation marks.');
+      $('#span_form_delete').attr('title', 'Delete this annotation.');
+      $('#span_form_split').attr('title', 'Split this annotation into multiple similar annotations, distributing its arguments.');
+
+      dispatcher.post('initForm', [rapidSpanForm, {
+          alsoResize: '#rapid_span_types',
+          width: 400,             
+          close: function(evt) {
+            keymap = null;
+          }
+        }]);
+
+      var spanFormSubmit = function(evt, typeRadio) {
+        typeRadio = typeRadio || $('#span_form input:radio:checked');
+        var type = typeRadio.val();
+        $('#span_form-ok').blur();
+        dispatcher.post('hideForm');
+        $.extend(spanOptions, {
+          action: 'createSpan',
+          collection: coll,
+          'document': doc,
+          type: type,
+          comment: $('#span_notes').val()
+        });
+
+        spanOptions.attributes = $.toJSON(spanAttributes());
+
+        spanOptions.normalizations = $.toJSON(spanNormalizations());
+
+        if (spanOptions.offsets) {
+          spanOptions.offsets = $.toJSON(spanOptions.offsets);
+        }
+
+        // unfocus all elements to prevent focus being kept after
+        // hiding them
+        spanForm.parent().find('*').blur();
+
+        $('#waiter').dialog('open');
+        dispatcher.post('ajax', [spanOptions, 'edited']);
+        return false;
+      };
+      $('#span_notes').focus(function () {
+          keymap = null;
+        }).blur(function () {
+          keymap = spanKeymap;
+        });
+      spanForm.submit(spanFormSubmit);
+
+      var rapidSpanFormSubmit = function(evt, typeRadio) {
+        typeRadio = typeRadio || $('#rapid_span_form input:radio:checked');
+        var type = typeRadio.val();
+
+        // unfocus all elements to prevent focus being kept after
+        // hiding them
+        rapidSpanForm.parent().find('*').blur();
+        dispatcher.post('hideForm');
+
+        if (type == "") {
+          // empty type value signals the special case where the user
+          // selected "none of the above" of the proposed types and
+          // the normal dialog should be brought up for the same span.
+          spanOptions = {
+            action: 'createSpan',
+            offsets: rapidSpanOptions.offsets,
+          };
+          // TODO: avoid using the stored mouse event
+          fillSpanTypesAndDisplayForm(lastRapidAnnotationEvent,
+                                      $('#rapid_span_selected').text());
+          dispatcher.post('logAction', ['normalSpanSelected']);
+        } else {
+          // normal type selection; submit createSpan with the selected type.
+          $.extend(rapidSpanOptions, {
+            action: 'createSpan',
+            collection: coll,
+            'document': doc,
+            type: type,
+          });
+          $('#waiter').dialog('open');
+          rapidSpanOptions.offsets = JSON.stringify(rapidSpanOptions.offsets);
+          dispatcher.post('ajax', [rapidSpanOptions, 'edited']);
+        }
+        return false;
+      };
+      rapidSpanForm.submit(rapidSpanFormSubmit);
+
+      var importForm = $('#import_form');
+      var importFormSubmit = function(evt) {
+        var _docid = $('#import_docid').val();
+        var _doctitle = $('#import_title').val();
+        var _doctext = $('#import_text').val();
+        var opts = {
+          action : 'importDocument',
+          collection : coll,
+          docid  : _docid,
+          title : _doctitle,
+          text  : _doctext,
+        };
+        dispatcher.post('ajax', [opts, function(response) {
+          var x = response.exception;
+          if (x) {
+            if (x == 'fileExistsError') {
+              dispatcher.post('messages', [[["A file with the given name exists. Please give a different name to the file to import.", 'error']]]);
+            } else {
+              dispatcher.post('messages', [[['Unknown error: ' + response.exception, 'error']]]);
+            }
+          } else {
+            dispatcher.post('hideForm');
+            dispatcher.post('setDocument', [response.document]);
+          }
+        }]);
+        return false;
+      };
+      importForm.submit(importFormSubmit);
+      dispatcher.post('initForm', [importForm, {
+          width: 500,
+          alsoResize: '#import_text',
+          open: function(evt) {
+            keymap = {};
+          },
+        }]);
+      $('#import_button').click(function() {
+        dispatcher.post('hideForm');
+        dispatcher.post('showForm', [importForm]);
+        importForm.find('input, textarea').val('');
+      });
+
+      /* BEGIN delete button - related */
+
+      $('#delete_document_button').click(function() {
+        if (!doc) {
+          dispatcher.post('messages', [[['No document selected', 'error']]]);
+          return false;
+        }
+        if (!confirm('Are you sure you want to permanently remove this document and its annotations from the collection? This action cannot be undone.')) {
+          return;
+        }
+        var delOptions = {
+          action: 'deleteDocument',
+          collection: coll,
+          'document': doc
+        }
+        dispatcher.post('ajax', [delOptions, 'docDeleted']);
+      });
+
+      $('#delete_collection_button').click(function() {
+        if (!coll) {
+          dispatcher.post('messages', [[['No collection selected', 'error']]]);
+          return false;
+        }
+        if (!confirm('Are you sure you want to permanently REMOVE the ENTIRE COLLECTION '+coll+', including all its documents and their annotations?  This action CANNOT BE UNDONE.')) {
+          return;
+        }
+        var delOptions = {
+          action: 'deleteCollection',
+          collection: coll,
+        }
+        dispatcher.post('ajax', [delOptions, 'collDeleted']);
+      });
+
+      /* END delete button - related */
+
+      $('#undo_button').click(function() {
+        if (coll && doc) {
+          if (undoStack.length > 0) {
+            var storedUndo = undoStack.pop();
+            var collection = storedUndo[0];
+            var dok = storedUndo[1];
+            var token = storedUndo[2];
+            var options = {
+              'action': 'undo',
+              'collection': collection,
+              'document': dok,
+              'token': token
+            }
+            dispatcher.post('ajax', [options, 'edited']);
+          } else {
+            dispatcher.post('messages', [[['No action to be undone', 'error']]]);
+          }
+        } else {
+          dispatcher.post('messages', [[['No document loaded, can not undo changes', 'error']]]);
+        }
+      });
+
+
+      var preventDefault = function(evt) {
+        evt.preventDefault();
+      }
+
+      var $waiter = $('#waiter');
+      $waiter.dialog({
+        closeOnEscape: false,
+        buttons: {},
+        modal: true,
+        open: function(evt, ui) {
+          $(evt.target).parent().find(".ui-dialog-titlebar-close").hide();
+        }
+      });
+      // hide the waiter (Sampo said it's annoying)
+      // we don't elliminate it altogether because it still provides the
+      // overlay to prevent interaction
+      $waiter.parent().css('opacity', '0');
+
+      var isReloadOkay = function() {
+        // do not reload while the user is in the middle of editing
+        return arcDragOrigin == null && reselectedSpan == null;
+      };
+
+      var userReceived = function(_user) {
+        that.user = _user;
+      }
+
+      var setAnnotationSpeed = function(speed) {
+        if (speed == 1) {
+          Configuration.confirmModeOn = true;
+        } else {
+          Configuration.confirmModeOn = false;
+        }
+        if (speed == 3) {
+          Configuration.rapidModeOn = true;
+        } else {
+          Configuration.rapidModeOn = false;
+        }
+        dispatcher.post('configurationChanged');
+      };
+
+      var onNewSourceData = function(_sourceData) {
+        sourceData = _sourceData;
+      }
+
+      var init = function() {
+        dispatcher.post('annotationIsAvailable');
+      };
+
+      dispatcher.
+          on('init', init).
+          on('getValidArcTypesForDrag', getValidArcTypesForDrag).
+          on('dataReady', rememberData).
+          on('collectionLoaded', rememberSpanSettings).
+          on('collectionLoaded', setupTaggerUI).
+          on('collectionLoaded', setupNormalizationUI).
+          on('spanAndAttributeTypesLoaded', spanAndAttributeTypesLoaded).
+          on('newSourceData', onNewSourceData).
+          on('hideForm', hideForm).
+          on('user', userReceived).
+          on('edited', edited).
+          on('current', gotCurrent).
+          on('isReloadOkay', isReloadOkay).
+          on('keydown', onKeyDown).
+          on('dblclick', onDblClick).
+          on('dragstart', preventDefault).
+          on('mousedown', onMouseDown).
+          on('mouseup', onMouseUp).
+          on('mousemove', onMouseMove).
+          on('annotationSpeed', setAnnotationSpeed).
+          on('suggestedSpanTypes', receivedSuggestedSpanTypes).
+          on('normGetNameResult', setSpanNormText).
+          on('normSearchResult', setSpanNormSearchResults);
+    };
+
+    return AnnotatorUI;
+})(jQuery, window);
Index: .idea/libraries/Maven__org_apache_httpcomponents_httpclient_4_5_3.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/libraries/Maven__org_apache_httpcomponents_httpclient_4_5_3.xml	(date 1594749401092)
+++ .idea/libraries/Maven__org_apache_httpcomponents_httpclient_4_5_3.xml	(date 1594749401092)
@@ -0,0 +1,13 @@
+<component name="libraryTable">
+  <library name="Maven: org.apache.httpcomponents:httpclient:4.5.3">
+    <CLASSES>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/httpcomponents/httpclient/4.5.3/httpclient-4.5.3.jar!/" />
+    </CLASSES>
+    <JAVADOC>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/httpcomponents/httpclient/4.5.3/httpclient-4.5.3-javadoc.jar!/" />
+    </JAVADOC>
+    <SOURCES>
+      <root url="jar://$MAVEN_REPOSITORY$/org/apache/httpcomponents/httpclient/4.5.3/httpclient-4.5.3-sources.jar!/" />
+    </SOURCES>
+  </library>
+</component>
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/src/annotation_log.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/src/annotation_log.js	(date 1594749336097)
+++ src/main/resources/static/static/lib/brat/src/annotation_log.js	(date 1594749336097)
@@ -0,0 +1,42 @@
+// -*- Mode: JavaScript; tab-width: 2; indent-tabs-mode: nil; -*-
+// vim:set ft=javascript ts=2 sw=2 sts=2 cindent:
+
+var AnnotationLog = (function(window, undefined) {
+    var AnnotationLog = function(dispatcher) {
+      var annotationLoggingOn = false;
+      var currentCollection = null;
+      var currentDocument = null;
+      var currentArguments = null;
+
+      var rememberLoggingState = function(response) {
+        annotationLoggingOn = response.annotation_logging;
+      };
+
+      var rememberCurrent = function(_collection, _document, _arguments) {
+        currentCollection = _collection;
+        currentDocument = _document;
+        currentArguments = _arguments;
+      };
+
+      var logAction = function(_action) {
+        if (!annotationLoggingOn) {
+          // logging not requested for current collection
+          return false;
+        } else {
+          dispatcher.post('ajax', [ {
+            action: 'logAnnotatorAction',
+            collection: currentCollection,
+            'document': currentDocument,
+            log: _action,
+          }, null]);
+        }
+      }
+
+      dispatcher.
+          on('collectionLoaded', rememberLoggingState).
+          on('current', rememberCurrent).
+          on('logAction', logAction);
+    }
+
+    return AnnotationLog;
+})(window);
Index: src/main/resources/static/static/lib/brat/css/fonts/Liberation_Sans-Regular.svg
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/css/fonts/Liberation_Sans-Regular.svg	(date 1594749336075)
+++ src/main/resources/static/static/lib/brat/css/fonts/Liberation_Sans-Regular.svg	(date 1594749336075)
@@ -0,0 +1,171 @@
+<font id="Liberation Sans" horiz-adv-x="1194" ><font-face
+    font-family="Liberation Sans"
+    units-per-em="2048"
+    panose-1="2 11 6 4 2 2 2 2 2 4"
+    ascent="1854"
+    descent="-434"
+    alphabetic="0" />
+<missing-glyph horiz-adv-x="1536" d="M205 1409H1330V0H205V1409ZM281 1333V76H1254V1333H281Z" />
+<glyph unicode=" " glyph-name="space" horiz-adv-x="569" />
+<glyph unicode="!" glyph-name="exclam" horiz-adv-x="569" d="M359 397H211L187 1409H383L359 397ZM185 0V201H379V0H185Z" />
+<glyph unicode="&quot;" glyph-name="quotedbl" horiz-adv-x="727" d="M618 966H476L456 1409H640L618 966ZM249 966H108L87 1409H271L249 966Z" />
+<glyph unicode="#" glyph-name="numbersign" horiz-adv-x="1139" d="M896 885L818 516H1078V408H795L707 0H597L683 408H320L236 0H126L210 408H9V516H234L312 885H60V993H334L423 1401H533L445 993H808L896 1401H1006L918 993H1129V885H896ZM425 885L345 516H707L785
+885H425Z" />
+<glyph unicode="$" glyph-name="dollar" horiz-adv-x="1139" d="M518 20Q301 29 179 121T22 379L192 416Q203 363 226 320T288 244T383 193T518 168V664L498 669Q421 687 347 712T215 778T122 884T86 1046Q86 1130 118 1192T207 1295T344 1359T518 1385V1516H642V1385Q742
+1380 814 1358T938 1295T1022 1198T1075 1065L901 1032Q881 1126 820 1178T642 1242V797Q701 783 758 768T866 733T962 684T1038 617T1088 523T1106 396Q1106 319 1078 254T993 138T849 57T642 20V-142H518V20ZM934 394Q934 457 911 497T847 562T753 604T642 635V167Q707
+171 761 186T853 230T913 298T934 394ZM258 1048Q258 994 278 957T333 895T415 854T518 823V1244Q446 1240 396 1224T316 1181T272 1121T258 1048Z" />
+<glyph unicode="%" glyph-name="percent" horiz-adv-x="1821" d="M1748 434Q1748 309 1723 224T1654 86T1552 11T1428 -12Q1362 -12 1305 10T1205 85T1138 222T1113 434Q1113 567 1137 654T1204 792T1305 864T1432 885Q1498 885 1555 865T1655 793T1723 654T1748
+434ZM527 0H372L1294 1409H1451L527 0ZM394 1421Q458 1421 515 1401T615 1329T682 1192T707 975Q707 849 682 763T615 624T514 547T390 524Q323 524 265 547T165 623T98 762T73 975Q73 1106 97 1192T165 1329T267 1400T394 1421ZM1600 434Q1600 533 1589 598T1557
+703T1504 758T1432 774Q1390 774 1358 758T1304 702T1271 598T1260 434Q1260 339 1271 275T1304 172T1357 115T1430 98Q1469 98 1500 115T1554 171T1588 275T1600 434ZM560 975Q560 1073 549 1138T517 1242T465 1297T394 1313Q351 1313 319 1297T264 1241T231 1137T220
+975Q220 880 231 815T264 711T318 654T392 637Q430 637 461 654T514 710T548 815T560 975Z" />
+<glyph unicode="&amp;" glyph-name="ampersand" horiz-adv-x="1366" d="M1193 -12Q1097 -12 1025 21T895 115Q865 89 827 65T743 22T642 -8T523 -20Q406 -20 321 10T180 92T99 216T72 371Q72 450 97 514T168 631T277 725T415 800Q397 834 383 872T357 950T340
+1028T334 1102Q334 1168 354 1225T416 1325T525 1392T685 1417Q758 1417 819 1398T926 1343T996 1254T1021 1133Q1021 1058 988 1000T899 895T769 812T612 741Q674 627 747 527T905 329Q966 419 1006 518T1076 739L1221 696Q1186 557 1133 444T1009 227Q1062 173
+1115 151T1217 129Q1249 129 1278 132T1334 145V10Q1306 -1 1269 -6T1193 -12ZM869 1133Q869 1170 856 1200T818 1251T760 1284T683 1296Q587 1296 537 1245T487 1102Q487 1043 505 979T552 858Q617 884 675 911T776 971T844 1043T869 1133ZM795 217Q706 322 624
+437T476 674Q363 626 302 552T240 373Q240 318 257 271T311 188T401 132T529 111Q573 111 612 120T686 145T747 179T795 217Z" />
+<glyph unicode="&apos;" glyph-name="quotesingle" horiz-adv-x="391" d="M266 966H125L104 1409H288L266 966Z" />
+<glyph unicode="(" glyph-name="parenleft" horiz-adv-x="682" d="M127 532Q127 671 148 798T214 1042T329 1269T496 1484H670Q576 1379 508 1269T395 1041T330 796T308 530Q308 391 329 264T395 19T507 -209T670 -424H496Q399 -319 329 -209T214 18T148 261T127
+528V532Z" />
+<glyph unicode=")" glyph-name="parenright" horiz-adv-x="682" d="M555 528Q555 388 534 262T468 18T353 -209T186 -424H12Q106 -319 174 -209T287 19T352 264T374 530Q374 669 353 796T287 1040T175 1268T12 1484H186Q283 1379 353 1269T468 1042T534 798T555 532V528Z" />
+<glyph unicode="*" glyph-name="asterisk" horiz-adv-x="797" d="M456 1114L720 1217L765 1085L483 1012L668 762L549 690L399 948L243 692L124 764L313 1012L33 1085L78 1219L345 1112L333 1409H469L456 1114Z" />
+<glyph unicode="+" glyph-name="plus" horiz-adv-x="1196" d="M671 608V180H524V608H100V754H524V1182H671V754H1095V608H671Z" />
+<glyph unicode="," glyph-name="comma" horiz-adv-x="569" d="M385 219V51Q385 -2 381 -45T366 -126T342 -197T307 -262H184Q229 -197 253 -131T278 0H190V219H385Z" />
+<glyph unicode="-" glyph-name="hyphen" horiz-adv-x="682" d="M91 464V624H591V464H91Z" />
+<glyph unicode="." glyph-name="period" horiz-adv-x="569" d="M187 0V219H382V0H187Z" />
+<glyph unicode="/" glyph-name="slash" horiz-adv-x="569" d="M0 -20L411 1484H569L162 -20H0Z" />
+<glyph unicode="0" glyph-name="zero" horiz-adv-x="1139" d="M1059 705Q1059 502 1021 364T916 140T759 17T567 -20Q464 -20 375 17T221 139T118 362T80 705Q80 918 117 1057T221 1280T377 1396T573 1430Q674 1430 762 1397T917 1280T1021 1058T1059 705ZM876
+705Q876 873 856 984T797 1162T702 1256T573 1284Q497 1284 439 1256T342 1162T282 984T262 705Q262 543 282 432T342 254T439 157T569 127Q640 127 697 156T793 253T854 432T876 705Z" />
+<glyph unicode="1" glyph-name="one" horiz-adv-x="1139" d="M156 0V153H515V1237L197 1010V1180L530 1409H696V153H1039V0H156Z" />
+<glyph unicode="2" glyph-name="two" horiz-adv-x="1139" d="M103 0V127Q154 244 227 333T382 495T542 630T686 754T789 884T829 1038Q829 1098 811 1143T759 1220T678 1266T572 1282Q518 1282 471 1267T386 1222T326 1148T295 1044L111 1061Q120 1137 153 1204T244
+1321T383 1401T572 1430Q677 1430 759 1405T897 1331T984 1210T1014 1044Q1014 973 989 909T921 787T822 675T705 570T582 468T466 366T368 263T301 153H1036V0H103Z" />
+<glyph unicode="3" glyph-name="three" horiz-adv-x="1139" d="M1049 389Q1049 292 1018 216T926 88T776 8T571 -20Q440 -20 351 12T203 98T116 220T78 362L264 379Q272 323 293 277T352 198T443 147T571 129Q707 129 784 196T862 395Q862 473 828 520T742 594T630
+630T518 639H416V795H514Q565 795 620 805T720 843T795 918T825 1038Q825 1151 759 1216T561 1282Q442 1282 369 1221T283 1049L102 1063Q113 1156 153 1225T254 1339T395 1407T563 1430Q681 1430 766 1401T905 1321T984 1202T1010 1057Q1010 995 993 941T940 844T849
+770T715 723V719Q800 710 863 681T967 607T1028 507T1049 389Z" />
+<glyph unicode="4" glyph-name="four" horiz-adv-x="1139" d="M881 319V0H711V319H47V459L692 1409H881V461H1079V319H881ZM711 1206Q709 1201 701 1187T683 1154T663 1118T644 1087L283 555Q278 547 269 534T249 508T229 481T213 461H711V1206Z" />
+<glyph unicode="5" glyph-name="five" horiz-adv-x="1139" d="M1053 459Q1053 353 1021 265T926 114T770 15T553 -20Q442 -20 360 6T220 77T130 184T82 315L264 336Q275 296 295 259T349 192T434 145T557 127Q627 127 684 148T781 212T844 315T866 455Q866 520
+845 574T785 668T690 730T561 752Q516 752 478 744T408 722T349 690T299 651H123L170 1409H971V1256H334L307 809Q355 846 427 872T598 899Q703 899 787 867T930 777T1021 637T1053 459Z" />
+<glyph unicode="6" glyph-name="six" horiz-adv-x="1139" d="M1049 461Q1049 355 1020 267T933 115T790 16T594 -20Q471 -20 379 27T226 162T135 379T104 672Q104 860 138 1002T238 1239T396 1382T608 1430Q680 1430 743 1415T857 1367T948 1278T1010 1143L838
+1112Q810 1203 749 1243T606 1284Q532 1284 472 1249T370 1145T306 970T283 725Q332 816 421 863T625 911Q721 911 799 880T932 791T1018 649T1049 461ZM866 453Q866 526 848 585T794 685T705 749T582 772Q533 772 483 758T393 711T327 625T301 496Q301 418 321
+351T378 233T469 154T588 125Q653 125 704 147T792 212T847 316T866 453Z" />
+<glyph unicode="7" glyph-name="seven" horiz-adv-x="1139" d="M1036 1263Q930 1101 841 952T688 651T589 340T553 0H365Q365 169 405 331T513 650T671 958T862 1256H105V1409H1036V1263Z" />
+<glyph unicode="8" glyph-name="eight" horiz-adv-x="1139" d="M1050 393Q1050 303 1022 228T935 97T785 11T570 -20Q446 -20 356 11T206 96T118 226T89 391Q89 468 112 528T175 631T265 701T370 737V741Q311 755 265 786T187 860T139 957T122 1069Q122 1143 150
+1208T235 1323T374 1401T566 1430Q681 1430 765 1401T905 1323T988 1207T1015 1067Q1015 1009 999 956T951 860T873 786T765 743V739Q826 729 878 703T968 633T1028 529T1050 393ZM828 1057Q828 1110 815 1154T770 1229T689 1278T566 1296Q495 1296 446 1279T366
+1230T320 1154T306 1057Q306 1015 317 971T357 891T437 832T568 809Q653 809 704 832T783 891T819 971T828 1057ZM863 410Q863 461 849 508T801 592T710 651T566 674Q487 674 432 652T342 592T291 507T275 406Q275 341 291 288T342 196T434 136T572 115Q654 115
+710 136T800 195T848 288T863 410Z" />
+<glyph unicode="9" glyph-name="nine" horiz-adv-x="1139" d="M1042 733Q1042 545 1007 404T905 168T745 27T532 -20Q451 -20 386 -4T270 48T183 139T125 274L297 301Q325 210 384 168T535 125Q608 125 668 159T771 263T838 436T864 680Q843 633 807 596T724 534T623
+495T514 481Q418 481 341 515T209 612T126 761T96 956Q96 1065 127 1153T219 1302T366 1397T565 1430Q800 1430 921 1256T1042 733ZM846 907Q846 985 828 1054T773 1174T683 1254T559 1284Q494 1284 442 1261T354 1196T299 1092T279 956Q279 885 296 824T349 719T436
+649T557 623Q607 623 658 640T751 692T819 780T846 907Z" />
+<glyph unicode=":" glyph-name="colon" horiz-adv-x="569" d="M187 875V1082H382V875H187ZM187 0V207H382V0H187Z" />
+<glyph unicode=";" glyph-name="semicolon" horiz-adv-x="569" d="M385 207V51Q385 -2 381 -45T366 -126T342 -197T307 -262H184Q229 -197 253 -131T278 0H190V207H385ZM190 875V1082H385V875H190Z" />
+<glyph unicode="&lt;" glyph-name="less" horiz-adv-x="1196" d="M101 571V776L1096 1194V1040L238 674L1096 307V154L101 571Z" />
+<glyph unicode="=" glyph-name="equal" horiz-adv-x="1196" d="M100 856V1004H1095V856H100ZM100 344V492H1095V344H100Z" />
+<glyph unicode="&gt;" glyph-name="greater" horiz-adv-x="1196" d="M101 154V307L959 674L101 1040V1194L1096 776V571L101 154Z" />
+<glyph unicode="?" glyph-name="question" horiz-adv-x="1139" d="M1063 1032Q1063 961 1045 907T995 811T925 735T844 671T764 612T693 549T642 474T621 377H446Q448 446 467 498T518 590T588 661T667 721T745 778T814 842T862 921T881 1024Q881 1083 860 1129T801
+1206T708 1254T586 1270Q446 1270 364 1200T268 1008L84 1020Q95 1104 128 1178T222 1309T372 1397T584 1430Q698 1430 787 1402T937 1323T1031 1197T1063 1032ZM438 0V201H633V0H438Z" />
+<glyph unicode="@" glyph-name="at" horiz-adv-x="2079" d="M1902 755Q1902 611 1869 492T1776 286T1635 152T1455 104Q1399 104 1360 117T1295 154T1259 210T1248 280Q1248 295 1249 316T1251 350H1245Q1221 305 1187 261T1106 182T1001 126T871 104Q787 104
+725 133T622 213T561 335T541 489Q541 609 576 719T678 914T836 1050T1043 1101Q1103 1101 1151 1088T1235 1050T1299 993T1344 919H1350L1389 1079H1545L1429 573Q1410 489 1401 429T1392 320Q1392 272 1413 249T1473 226Q1535 226 1588 266T1681 378T1743 545T1766
+753Q1766 882 1725 993T1603 1185T1403 1312T1128 1358Q994 1358 881 1326T675 1236T514 1098T397 921T326 716T302 491Q302 350 345 231T470 27T674 -107T954 -155Q1059 -155 1150 -139T1317 -98T1453 -46T1557 7L1612 -105Q1562 -135 1495 -166T1344 -224T1163
+-266T954 -283Q764 -283 617 -226T368 -65T214 180T161 491Q161 630 192 758T283 996T427 1196T619 1350T854 1449T1126 1484Q1327 1484 1473 1425T1714 1266T1856 1034T1902 755ZM1296 747Q1296 797 1279 839T1231 911T1155 957T1054 974Q968 974 903 932T795
+820T729 665T706 491Q706 371 753 303T900 235Q969 235 1029 266T1137 348T1220 465T1273 602Q1282 638 1289 678T1296 747Z" />
+<glyph unicode="A" glyph-name="A" horiz-adv-x="1366" d="M1167 0L1006 412H364L202 0H4L579 1409H796L1362 0H1167ZM768 1026Q752 1066 738 1107T712 1181T694 1237T685 1265Q683 1260 676 1237T658 1180T632 1105T602 1024L422 561H949L768 1026Z" />
+<glyph unicode="B" glyph-name="B" horiz-adv-x="1366" d="M1258 397Q1258 290 1216 215T1103 92T938 22T740 0H168V1409H680Q797 1409 889 1390T1045 1328T1142 1222T1176 1067Q1176 1008 1160 956T1110 862T1026 789T908 743Q993 733 1058 704T1168 630T1235
+526T1258 397ZM984 1044Q984 1158 906 1207T680 1256H359V810H680Q764 810 822 826T916 873T968 947T984 1044ZM1065 412Q1065 479 1041 526T970 603T860 647T715 661H359V153H730Q803 153 864 165T970 207T1040 287T1065 412Z" />
+<glyph unicode="C" glyph-name="C" horiz-adv-x="1479" d="M792 1274Q672 1274 580 1234T425 1120T330 942T298 711Q298 584 332 479T431 297T589 179T800 137Q882 137 949 158T1071 219T1169 311T1245 430L1401 352Q1363 273 1307 205T1176 87T1005 9T791 -20Q620
+-20 492 34T277 186T147 418T104 711Q104 876 149 1009T282 1235T498 1379T790 1430Q1015 1430 1166 1342T1388 1081L1207 1021Q1187 1071 1153 1116T1068 1197T949 1253T792 1274Z" />
+<glyph unicode="D" glyph-name="D" horiz-adv-x="1479" d="M1381 719Q1381 543 1328 409T1183 184T966 47T695 0H168V1409H634Q797 1409 934 1369T1171 1244T1325 1029T1381 719ZM1189 719Q1189 862 1148 963T1033 1130T856 1225T630 1256H359V153H673Q784 153
+878 189T1042 296T1150 473T1189 719Z" />
+<glyph unicode="E" glyph-name="E" horiz-adv-x="1366" d="M168 0V1409H1237V1253H359V801H1177V647H359V156H1278V0H168Z" />
+<glyph unicode="F" glyph-name="F" horiz-adv-x="1251" d="M359 1253V729H1145V571H359V0H168V1409H1169V1253H359Z" />
+<glyph unicode="G" glyph-name="G" horiz-adv-x="1593" d="M103 711Q103 876 147 1009T280 1235T500 1379T804 1430Q934 1430 1032 1407T1202 1341T1324 1237T1409 1098L1227 1044Q1201 1096 1165 1138T1076 1211T956 1257T799 1274Q671 1274 577 1234T420 1120T328
+942T297 711Q297 584 330 479T428 297T589 178T813 135Q896 135 966 149T1092 185T1192 235T1264 291V545H843V705H1440V219Q1393 171 1330 128T1187 51T1014 -1T813 -20Q635 -20 502 34T281 186T148 418T103 711Z" />
+<glyph unicode="H" glyph-name="H" horiz-adv-x="1479" d="M1121 0V653H359V0H168V1409H359V813H1121V1409H1312V0H1121Z" />
+<glyph unicode="I" glyph-name="I" horiz-adv-x="569" d="M189 0V1409H380V0H189Z" />
+<glyph unicode="J" glyph-name="J" horiz-adv-x="1024" d="M457 -20Q286 -20 177 69T32 350L219 381Q229 316 252 270T307 193T378 149T458 135Q562 135 622 206T682 416V1253H411V1409H872V420Q872 319 844 238T763 100T632 11T457 -20Z" />
+<glyph unicode="K" glyph-name="K" horiz-adv-x="1366" d="M1106 0L543 680L359 540V0H168V1409H359V703L1038 1409H1263L663 797L1343 0H1106Z" />
+<glyph unicode="L" glyph-name="L" horiz-adv-x="1139" d="M168 0V1409H359V156H1071V0H168Z" />
+<glyph unicode="M" glyph-name="M" horiz-adv-x="1706" d="M1366 0V940Q1366 991 1367 1044T1370 1141Q1372 1192 1375 1240Q1361 1189 1346 1139Q1333 1096 1318 1048T1287 960L923 0H789L420 960Q414 975 408 995T394 1037T379 1083T364 1130Q347 1183 331 1240Q332
+1184 334 1129Q336 1082 337 1031T338 940V0H168V1409H419L794 432Q801 412 811 381T830 316T846 254T857 208Q860 224 868 254T886 317T907 381T925 432L1293 1409H1538V0H1366Z" />
+<glyph unicode="N" glyph-name="N" horiz-adv-x="1479" d="M1082 0L328 1200Q330 1151 333 1103Q335 1062 336 1017T338 936V0H168V1409H390L1152 201Q1149 250 1146 299Q1144 341 1142 390T1140 485V1409H1312V0H1082Z" />
+<glyph unicode="O" glyph-name="O" horiz-adv-x="1593" d="M1495 711Q1495 546 1448 411T1310 180T1090 32T795 -20Q621 -20 490 34T272 186T141 418T97 711Q97 876 143 1009T278 1235T497 1379T797 1430Q965 1430 1095 1379T1314 1234T1449 1007T1495 711ZM1300
+711Q1300 838 1268 942T1172 1120T1014 1234T797 1274Q671 1274 576 1234T418 1120T323 942T291 711Q291 584 323 479T419 297T577 178T795 135Q927 135 1022 178T1179 297T1270 480T1300 711Z" />
+<glyph unicode="P" glyph-name="P" horiz-adv-x="1366" d="M1258 985Q1258 893 1228 814T1137 676T985 583T773 549H359V0H168V1409H761Q886 1409 979 1379T1134 1293T1227 1159T1258 985ZM1066 983Q1066 1117 984 1186T738 1256H359V700H746Q911 700 988 773T1066 983Z" />
+<glyph unicode="Q" glyph-name="Q" horiz-adv-x="1593" d="M1495 711Q1495 562 1457 439T1346 222T1168 71T928 -6Q949 -70 975 -115T1036 -188T1111 -230T1204 -244Q1232 -244 1264 -240T1319 -231V-365Q1281 -374 1236 -380T1141 -387Q1055 -387 991 -362T879
+-289T795 -172T733 -16Q575 -8 456 49T257 203T137 429T97 711Q97 876 143 1009T278 1235T497 1379T797 1430Q965 1430 1095 1379T1314 1234T1449 1007T1495 711ZM1300 711Q1300 838 1268 942T1172 1120T1014 1234T797 1274Q671 1274 576 1234T418 1120T323 942T291
+711Q291 584 323 479T419 297T577 178T795 135Q927 135 1022 178T1179 297T1270 480T1300 711Z" />
+<glyph unicode="R" glyph-name="R" horiz-adv-x="1479" d="M1164 0L798 585H359V0H168V1409H831Q951 1409 1043 1382T1199 1302T1295 1175T1328 1006Q1328 939 1309 874T1247 755T1140 662T984 607L1384 0H1164ZM1136 1004Q1136 1068 1114 1115T1050 1193T948
+1240T812 1256H359V736H820Q902 736 962 756T1060 813T1117 898T1136 1004Z" />
+<glyph unicode="S" glyph-name="S" horiz-adv-x="1366" d="M1272 389Q1272 300 1238 225T1131 96T950 11T690 -20Q427 -20 280 72T93 338L278 375Q292 320 321 275T399 198T522 147T697 129Q782 129 853 143T975 188T1054 265T1083 379Q1083 448 1052 491T963
+562T827 609T652 650Q593 663 534 678T420 715T317 766T234 835T179 929T159 1053Q159 1153 199 1224T312 1342T482 1409T694 1430Q825 1430 918 1410T1075 1348T1177 1247T1239 1106L1051 1073Q1037 1124 1011 1164T941 1231T837 1272T692 1286Q594 1286 528 1269T421
+1221T363 1151T345 1063Q345 1000 376 960T462 892T587 847T738 811Q803 796 867 781T991 744T1101 693T1191 622T1250 523T1272 389Z" />
+<glyph unicode="T" glyph-name="T" horiz-adv-x="1251" d="M720 1253V0H530V1253H46V1409H1204V1253H720Z" />
+<glyph unicode="U" glyph-name="U" horiz-adv-x="1479" d="M731 -20Q615 -20 511 11T329 107T204 273T158 512V1409H349V528Q349 421 377 347T457 225T577 157T730 135Q812 135 885 157T1013 227T1099 352T1131 541V1409H1321V530Q1321 389 1275 286T1148 114T961
+13T731 -20Z" />
+<glyph unicode="V" glyph-name="V" horiz-adv-x="1366" d="M782 0H584L9 1409H210L600 417Q615 372 630 328T657 248Q671 207 684 168Q696 205 710 246Q722 281 736 325T768 417L1156 1409H1357L782 0Z" />
+<glyph unicode="W" glyph-name="W" horiz-adv-x="1933" d="M1511 0H1283L1039 895Q1028 933 1016 985T993 1084Q981 1139 969 1196Q956 1138 944 1083Q933 1035 921 984T898 895L652 0H424L9 1409H208L461 514Q478 451 493 389T520 278Q533 220 544 168Q559 237
+575 304Q582 332 589 363T603 424T618 481T632 532L877 1409H1060L1305 532Q1311 509 1318 482T1333 425T1348 364T1362 305Q1378 238 1393 168Q1394 168 1402 202T1422 289T1448 401T1478 514L1727 1409H1926L1511 0Z" />
+<glyph unicode="X" glyph-name="X" horiz-adv-x="1366" d="M1112 0L689 616L257 0H46L582 732L87 1409H298L690 856L1071 1409H1282L800 739L1323 0H1112Z" />
+<glyph unicode="Y" glyph-name="Y" horiz-adv-x="1366" d="M777 584V0H587V584L45 1409H255L684 738L1111 1409H1321L777 584Z" />
+<glyph unicode="Z" glyph-name="Z" horiz-adv-x="1251" d="M1187 0H65V143L923 1253H138V1409H1140V1270L282 156H1187V0Z" />
+<glyph unicode="[" glyph-name="bracketleft" horiz-adv-x="569" d="M146 -425V1484H553V1355H320V-296H553V-425H146Z" />
+<glyph unicode="\" glyph-name="backslash" horiz-adv-x="569" d="M407 -20L0 1484H158L569 -20H407Z" />
+<glyph unicode="]" glyph-name="bracketright" horiz-adv-x="569" d="M16 -425V-296H249V1355H16V1484H423V-425H16Z" />
+<glyph unicode="^" glyph-name="asciicircum" horiz-adv-x="961" d="M787 673L478 1306L172 673H10L378 1409H581L951 673H787Z" />
+<glyph unicode="_" glyph-name="underscore" horiz-adv-x="1139" d="M-31 -407V-277H1162V-407H-31Z" />
+<glyph unicode="`" glyph-name="grave" horiz-adv-x="682" d="M436 1201L106 1479V1508H313L530 1221V1201H436Z" />
+<glyph unicode="a" glyph-name="a" horiz-adv-x="1139" d="M414 -20Q251 -20 169 66T87 302Q87 409 127 477T233 585T383 639T554 656L797 660V719Q797 786 783 833T740 909T668 951T565 965Q513 965 471 958T398 931T348 878T323 793L135 810Q145 874 173 927T252
+1020T381 1080T569 1102Q773 1102 876 1009T979 738V272Q979 192 1000 152T1080 111Q1095 111 1110 113T1139 118V6Q1105 -2 1072 -6T1000 -10Q949 -10 913 3T853 44T818 112T803 207H797Q768 155 734 113T653 42T549 -4T414 -20ZM455 115Q541 115 605 146T712
+227T776 334T797 445V534L600 530Q534 529 475 521T370 487T299 417T272 299Q272 211 319 163T455 115Z" />
+<glyph unicode="b" glyph-name="b" horiz-adv-x="1139" d="M1053 546Q1053 -20 655 -20Q532 -20 451 24T318 168H316Q316 142 315 114T312 62T309 21T306 0H132Q133 9 134 30T136 82T137 148T138 223V1484H318V1061Q318 1031 318 1004T316 955Q315 930 314 908H318Q368
+1012 450 1057T655 1102Q860 1102 956 964T1053 546ZM864 540Q864 652 850 732T805 863T726 939T609 963Q538 963 484 940T393 866T337 732T318 529Q318 413 337 334T392 206T483 135T607 113Q673 113 721 136T801 210T848 342T864 540Z" />
+<glyph unicode="c" glyph-name="c" horiz-adv-x="1024" d="M275 546Q275 453 288 375T334 241T418 153T548 122Q644 122 708 174T788 334L970 322Q961 255 931 193T850 84T724 9T553 -20Q426 -20 337 23T193 141T112 319T87 542Q87 651 105 734T155 880T232 985T327
+1053T436 1090T551 1102Q642 1102 713 1077T835 1009T919 906T964 779L779 765Q765 855 708 908T546 961Q469 961 418 936T334 859T289 729T275 546Z" />
+<glyph unicode="d" glyph-name="d" horiz-adv-x="1139" d="M821 174Q771 70 689 25T484 -20Q279 -20 183 118T86 536Q86 1102 484 1102Q607 1102 689 1057T821 914H823Q823 924 823 945T822 990T821 1035T821 1065V1484H1001V223Q1001 184 1001 148T1003 82T1005
+31T1007 0H835Q833 10 832 28T829 71T826 121T825 174H821ZM275 542Q275 430 289 350T334 219T413 143T530 119Q601 119 655 142T746 216T802 351T821 554Q821 669 802 748T746 877T656 947T532 969Q466 969 418 946T338 872T291 740T275 542Z" />
+<glyph unicode="e" glyph-name="e" horiz-adv-x="1139" d="M276 503Q276 418 293 347T347 224T441 144T578 115Q695 115 765 162T861 281L1019 236Q1002 191 972 146T890 64T763 4T578 -20Q338 -20 213 123T87 548Q87 700 125 805T229 977T383 1072T571 1102Q707
+1102 798 1058T945 937T1024 754T1048 527V503H276ZM862 641Q847 812 775 890T568 969Q523 969 474 955T382 903T311 803T278 641H862Z" />
+<glyph unicode="f" glyph-name="f" horiz-adv-x="569" d="M361 951V0H181V951H29V1082H181V1204Q181 1263 192 1313T232 1401T313 1460T445 1482Q477 1482 511 1479T572 1470V1333Q555 1336 533 1338T492 1341Q452 1341 427 1330T387 1299T367 1248T361 1179V1082H572V951H361Z"
+/>
+<glyph unicode="g" glyph-name="g" horiz-adv-x="1139" d="M548 -425Q455 -425 383 -406T260 -352T177 -267T131 -158L312 -132Q330 -207 391 -247T553 -288Q614 -288 664 -271T749 -217T803 -119T822 27V201H820Q800 160 771 123T699 56T600 10T472 -8Q369 -8
+296 26T176 130T108 301T86 539Q86 669 107 773T177 949T303 1060T492 1099Q607 1099 691 1047T822 897H824Q824 922 825 953T828 1011T832 1059T836 1082H1007Q1006 1073 1005 1052T1003 1000T1002 934T1001 858V31Q1001 -196 890 -310T548 -425ZM822 541Q822
+654 798 734T733 866T642 941T536 965Q467 965 418 941T336 866T288 734T272 541Q272 424 287 345T335 216T416 146T533 125Q587 125 638 148T731 221T797 350T822 541Z" />
+<glyph unicode="h" glyph-name="h" horiz-adv-x="1139" d="M317 897Q347 952 382 990T459 1054T551 1090T663 1102Q767 1102 833 1074T938 996T991 875T1006 721V0H825V686Q825 755 817 807T784 893T716 945T602 963Q538 963 487 940T399 875T342 773T322 638V0H142V1484H322V1098Q322
+1065 321 1032T319 971T316 924T314 897H317Z" />
+<glyph unicode="i" glyph-name="i" horiz-adv-x="455" d="M137 1312V1484H317V1312H137ZM137 0V1082H317V0H137Z" />
+<glyph unicode="j" glyph-name="j" horiz-adv-x="455" d="M137 1312V1484H317V1312H137ZM317 -134Q317 -196 307 -249T269 -341T196 -402T77 -425Q43 -425 11 -423T-50 -416V-277Q-37 -279 -19 -281T12 -283Q50 -283 74 -273T113 -242T132 -187T137 -107V1082H317V-134Z" />
+<glyph unicode="k" glyph-name="k" horiz-adv-x="1024" d="M816 0L450 494L318 385V0H138V1484H318V557L793 1082H1004L565 617L1027 0H816Z" />
+<glyph unicode="l" glyph-name="l" horiz-adv-x="455" d="M138 0V1484H318V0H138Z" />
+<glyph unicode="m" glyph-name="m" horiz-adv-x="1706" d="M768 0V686Q768 765 758 818T725 903T663 949T570 963Q513 963 467 941T389 876T339 771T321 627V0H142V851Q142 885 142 922T140 993T138 1051T136 1082H306Q307 1077 308 1055T310 1005T313 947T314
+897H317Q341 944 369 982T434 1046T520 1087T633 1102Q756 1102 827 1053T927 897H930Q954 944 984 982T1054 1046T1144 1087T1258 1102Q1340 1102 1399 1080T1497 1012T1553 894T1571 721V0H1393V686Q1393 765 1383 818T1350 903T1288 949T1195 963Q1138 963 1092
+942T1014 878T964 773T946 627V0H768Z" />
+<glyph unicode="n" glyph-name="n" horiz-adv-x="1139" d="M825 0V686Q825 765 814 818T776 903T708 949T602 963Q538 963 487 941T399 876T342 771T322 627V0H142V851Q142 885 142 922T140 993T138 1051T136 1082H306Q307 1077 308 1055T310 1005T313 947T314
+897H317Q343 944 374 982T446 1046T540 1087T663 1102Q753 1102 818 1080T925 1012T986 894T1006 721V0H825Z" />
+<glyph unicode="o" glyph-name="o" horiz-adv-x="1139" d="M1053 542Q1053 258 928 119T565 -20Q452 -20 363 14T213 118T119 293T86 542Q86 1102 571 1102Q697 1102 788 1067T938 962T1025 787T1053 542ZM864 542Q864 668 845 750T788 881T696 949T574 969Q505
+969 450 949T355 879T296 747T275 542Q275 416 297 334T357 202T448 133T563 113Q632 113 688 132T783 201T843 333T864 542Z" />
+<glyph unicode="p" glyph-name="p" horiz-adv-x="1139" d="M1053 546Q1053 423 1033 319T967 140T844 23T655 -20Q539 -20 452 24T319 168H314Q315 166 315 150T316 110T317 57T318 -2V-425H138V861Q138 900 138 936T136 1001T134 1052T132 1082H306Q307 1079
+308 1061T311 1018T314 963T316 908H320Q345 960 377 996T450 1056T541 1090T655 1101Q767 1101 843 1061T966 949T1033 774T1053 546ZM864 542Q864 642 852 720T811 852T732 934T609 962Q549 962 496 945T404 880T341 748T318 528Q318 413 337 334T392 205T483
+135T607 113Q682 113 731 142T810 226T852 360T864 542Z" />
+<glyph unicode="q" glyph-name="q" horiz-adv-x="1139" d="M484 -20Q278 -20 182 119T86 536Q86 818 184 960T484 1102Q551 1102 602 1090T694 1055T765 996T821 914H823Q823 939 824 969T827 1027T831 1073T835 1096H1008Q1006 1079 1004 1007T1001 801V-425H821V14Q821
+40 821 68T823 121Q824 149 825 178H823Q797 127 766 90T693 28T601 -8T484 -20ZM821 554Q821 672 801 752T743 880T652 948T532 969Q463 969 414 944T335 866T290 733T275 542Q275 434 288 354T332 222T411 145T530 119Q590 119 643 137T735 204T798 337T821 554Z"
+/>
+<glyph unicode="r" glyph-name="r" horiz-adv-x="682" d="M142 0V830Q142 864 142 899T140 968T138 1030T136 1082H306Q307 1059 308 1030T311 969T313 910T314 861H318Q337 923 358 968T409 1043T478 1087T575 1102Q597 1102 617 1099T648 1092V927Q630 932 606
+934T552 937Q490 937 447 909T376 832T335 714T322 564V0H142Z" />
+<glyph unicode="s" glyph-name="s" horiz-adv-x="1024" d="M950 299Q950 223 921 164T835 64T698 2T511 -20Q417 -20 342 -6T209 41T114 125T57 254L216 285Q239 198 311 158T511 117Q569 117 617 125T701 152T755 204T775 285Q775 334 752 365T688 418T589 454T460
+489Q395 506 331 527T216 582T132 668T100 796Q100 944 205 1021T513 1099Q692 1099 797 1036T931 834L769 814Q760 856 736 884T678 930T602 955T513 963Q391 963 333 926T275 814Q275 770 296 742T356 694T449 660T568 629Q611 618 656 606T743 576T823 535T889
+478T933 401T950 299Z" />
+<glyph unicode="t" glyph-name="t" horiz-adv-x="569" d="M554 8Q513 -3 471 -9T372 -16Q156 -16 156 229V951H31V1082H163L216 1324H336V1082H536V951H336V268Q336 190 361 159T450 127Q476 127 500 131T554 141V8Z" />
+<glyph unicode="u" glyph-name="u" horiz-adv-x="1139" d="M314 1082V396Q314 317 325 264T363 179T431 133T537 119Q601 119 652 141T740 206T797 311T817 455V1082H997V231Q997 197 997 160T999 89T1001 31T1003 0H833Q832 5 831 27T829 77T826 135T825 185H822Q796
+138 765 100T693 36T599 -5T476 -20Q386 -20 321 2T214 70T153 188T133 361V1082H314Z" />
+<glyph unicode="v" glyph-name="v" horiz-adv-x="1024" d="M613 0H400L7 1082H199L437 378Q444 356 453 325T473 259T491 194T506 141Q512 162 521 193T541 258T561 322T580 376L826 1082H1017L613 0Z" />
+<glyph unicode="w" glyph-name="w" horiz-adv-x="1479" d="M1174 0H965L792 698Q784 725 776 765T759 843Q749 887 740 934Q731 889 721 845Q713 807 704 766T686 694L508 0H300L-3 1082H175L358 347Q365 324 372 291T386 225Q393 188 401 149Q409 187 418 223Q426
+254 434 286T448 339L644 1082H837L1026 339Q1033 313 1041 280T1056 218Q1064 184 1072 149Q1080 187 1088 223Q1095 254 1102 287T1117 347L1308 1082H1484L1174 0Z" />
+<glyph unicode="x" glyph-name="x" horiz-adv-x="1024" d="M801 0L510 444L217 0H23L408 556L41 1082H240L510 661L778 1082H979L612 558L1002 0H801Z" />
+<glyph unicode="y" glyph-name="y" horiz-adv-x="1024" d="M604 0Q566 -98 527 -176T438 -310T329 -395T191 -425Q157 -425 128 -423T67 -414V-279Q86 -282 110 -283T151 -285Q230 -285 298 -226T417 -38L434 5L5 1082H197L425 484Q435 457 450 412T481 322T509
+241T523 196Q526 207 537 239T563 312T593 393T618 464L830 1082H1020L604 0Z" />
+<glyph unicode="z" glyph-name="z" horiz-adv-x="1024" d="M49 0V137L710 943H89V1082H913V945L251 139H950V0H49Z" />
+<glyph unicode="{" glyph-name="braceleft" horiz-adv-x="684" d="M513 -425Q448 -425 399 -405T316 -346T266 -254T249 -132V229Q249 292 235 336T193 408T125 450T34 466V593Q85 595 125 609T192 651T234 723T249 829V1191Q249 1332 315 1408T513 1484H648V1355H585Q494
+1355 456 1302T417 1140V784Q417 734 402 692T361 618T300 564T223 532V530Q266 520 301 498T362 444T402 369T417 276V-81Q417 -187 455 -241T585 -296H648V-425H513Z" />
+<glyph unicode="|" glyph-name="bar" horiz-adv-x="532" d="M183 -434V1484H349V-434H183Z" />
+<glyph unicode="}" glyph-name="braceright" horiz-adv-x="684" d="M94 -296Q185 -296 224 -242T264 -81V276Q264 327 278 369T317 443T378 498T457 530V532Q415 542 380 564T319 618T279 692T264 784V1140Q264 1248 225 1301T94 1355H34V1484H166Q297 1484 363
+1408T430 1191V829Q430 767 444 723T486 651T554 609T647 593V466Q595 464 555 450T487 408T445 336T430 229V-132Q430 -200 413 -254T363 -346T281 -404T166 -425H34V-296H94Z" />
+<glyph unicode="~" glyph-name="asciitilde" horiz-adv-x="1196" d="M844 553Q775 553 703 575T557 623Q428 668 340 668Q302 668 270 662T207 645T149 617T92 580V723Q142 761 208 784T355 807Q395 807 435 801T513 784T589 761T664 735Q685 727 710 720T760
+705T811 694T860 690Q929 690 990 715T1104 782V633Q1072 610 1043 595T983 571T918 557T844 553Z" />
+</font>
Index: src/main/resources/templates/dict_builder.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/templates/dict_builder.html	(date 1594749336114)
+++ src/main/resources/templates/dict_builder.html	(date 1594749336114)
@@ -0,0 +1,239 @@
+<!DOCTYPE html>
+<html lang="en">
+
+<head>
+    <meta charset="UTF-8">
+    <meta name="viewport" content="width=device-width, initial-scale=1.0">
+    <link rel="stylesheet" href="https://cdn.metroui.org.ua/v4.3.2/css/metro-all.min.css">
+    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
+    <script src="https://kit.fontawesome.com/cb45cc91b0.js" crossorigin="anonymous"></script>
+    <title>Dictionary Builder | MedTagger Web</title>
+    <link href="/static/img/favicon.ico" rel="shortcut icon" type="image/x-icon" />
+    <style>
+        .current {
+            font-weight: bold;
+        }
+    </style>
+    </head>
+
+<body>
+    
+    <div class="container-fluid bg-darkCyan fg-white mb-1">
+        <div class="row">
+            <div class="cell">
+                <p>
+                    <i class="fa fa-book-medical"></i>
+                    Dictionary Builder
+                </p>
+            </div>
+        </div>
+    </div>
+
+    <nav data-role="ribbonmenu">
+        <ul class="tabs-holder">
+            <li><a href="#section-1-1">Main</a></li>
+        </ul>
+
+        <div class="content-holder">
+            <div class="section" id="section-1-1">
+
+                <div class="group">
+                    <div class="form-group">
+                        <label>Ontology</label>
+                        
+                        <select id="acronym" style="width: 150px;" data-role="select">
+                            <option value="CIDO">CIDO</option>
+                            <option value="MONDO">MONDO</option>
+                        </select>
+
+                    </div>
+                    <button class="ribbon-button"
+                        onclick="jarvis.load_ontology_csv();">
+                        <span class="icon">
+                            <i class="fa fa-envelope-open-text"></i>
+                        </span>
+                        <span class="caption">Load Data</span>
+                    </button>
+
+                    <span class="title">Ontology Database</span>
+                </div>
+
+                <div class="group">
+
+                    <button class="ribbon-button">
+                        <span class="icon">
+                            <i class="fa fa-file-archive"></i>
+                        </span>
+                        <span class="caption">Save as CSV</span>
+                    </button>
+
+                    <span class="title">Download</span>
+                </div>
+
+                <div class="group">
+                    
+                    <button class="ribbon-button">
+                        <span class="icon">
+                            <i class="fa fa-upload"></i>
+                        </span>
+                        <span class="caption">Upload to Server</span>
+                    </button>
+                    
+                    <span class="title">Deployment</span>
+                </div>
+
+            </div>
+
+        </div>
+    </nav>
+
+    <div class="container-fluid">
+
+        <div class="row">
+
+            <div class="cell">
+
+                <div data-role="panel"
+                    data-title-caption="Ontology Tree"
+                    data-title-icon="<span class='mif-tree'></span>">
+                    
+                    <ul data-role="treeview" id="tv_1"></ul>
+
+                </div>
+            </div>
+
+
+
+            <div class="cell">
+
+                <div data-role="panel"
+                    data-title-caption="Term List"
+                    data-title-icon="<span class='mif-list'></span>">
+                    
+                    <ul data-role="treeview" id="tv_1"></ul>
+
+                </div>
+            </div>
+
+        </div>
+
+    
+    </div>
+    
+
+    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
+        integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
+        crossorigin="anonymous"></script>
+    <script src="https://cdn.metroui.org.ua/v4.3.2/js/metro.min.js"></script>
+    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
+    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
+    
+    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.2.0/papaparse.min.js"></script>
+
+    <script>
+
+        var vw_treemap = {
+            vpp: null,
+            vpp_id: '#vw_treemap',
+
+            acronym: null,
+
+            init: function() {
+                this.vpp = new Vue({
+                    el: this.vpp_id,
+                    data: {
+
+                    },
+                    methods: {
+
+                    },
+                    mounted: function() {
+                        Metro.init();
+                    }
+                })
+            }
+        };
+
+        var vw_termeditor = {
+            vpp: null,
+            vpp_id: '#vw_termeditor',
+
+            acronym: null,
+
+            init: function() {
+                this.vpp = new Vue({
+                    el: this.vpp_id,
+                    data: {
+
+                    },
+                    methods: {
+
+                    },
+                    mounted: function() {
+                        Metro.init();
+                    }
+                })
+            }
+
+        };
+
+        var jarvis = {
+            
+            api_url: {
+                get_ontology_csv: 'get_ontology_csv',
+                get_ontology_root: '/get_ontology_root',
+                get_ontology_children: '/get_ontology_children'
+            },
+
+            init: function() { 
+
+            },
+
+            load_ontology_csv: function() {
+                var acronym = $('#acronym').val();
+                
+                $.get(
+                    this.api_url.get_ontology_csv,
+                    {acronym: acronym, ver: Math.random()},
+                    function(data) {
+                        jarvis.data = data;
+                        jarvis.csvtb = Papa.parse(data, {
+                            header: true
+                        });
+                        console.log('* done!');
+                    }, 'text'
+                )
+            },
+
+            load_ontology_root: function() {
+                var acronym = $('#acronym').val();
+                
+                $.get(
+                    this.api_url.get_ontology_root,
+                    {acronym: acronym, ver: Math.random()},
+                    function(data) {
+
+                    }, 'json'
+                )
+            },
+
+            load_ontology_children: function() {
+                var acronym = $('#acronym').val();
+                
+                $.get(
+                    this.api_url.get_ontology_children,
+                    {acronym: acronym, ver: Math.random()},
+                    function(data) {
+
+                    }, 'json'
+                )
+            }
+        };
+
+        $(document).ready(function() {
+
+        });
+    </script>
+</body>
+
+</html>
\ No newline at end of file
Index: src/main/resources/static/static/lib/brat/css/fonts/PT_Sans-Caption-Web-Regular.svg
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/static/static/lib/brat/css/fonts/PT_Sans-Caption-Web-Regular.svg	(date 1594749336079)
+++ src/main/resources/static/static/lib/brat/css/fonts/PT_Sans-Caption-Web-Regular.svg	(date 1594749336079)
@@ -0,0 +1,163 @@
+<font id="PT Sans Caption" horiz-adv-x="592" ><font-face
+    font-family="PT Sans Caption"
+    units-per-em="1000"
+    panose-1="2 11 6 3 2 2 3 2 2 4"
+    ascent="1018"
+    descent="-276"
+    alphabetic="0" />
+<missing-glyph horiz-adv-x="750" d="M50 700H700V0H50V700ZM570 620L375 403L180 620L130 570L327 350L130 130L180 80L375 297L570 80L620 130L422 350L620 570L570 620ZM129 27H137V39H141Q147 39 152 41T157 51Q157 59 152 61T140 63H129V27ZM141 57Q149 57
+149 52Q149 47 147 47T140 46H137V57H141ZM189 63H158V57H170V27H177V57H189V63ZM222 37Q222 33 215 33Q208 33 206 35L203 28Q205 28 208 27T216 26Q230 26 230 38Q230 47 221 48T212 54Q212 57 218 57Q223 57 227 55L229 62Q223 64 218 64Q204 64 204 53Q204
+48 207 46T213 43T219 40T222 37ZM237 47Q241 49 246 49Q251 49 251 45V43Q250 43 249 43T246 44Q234 44 234 34Q234 26 242 26Q248 26 251 31L253 27H259Q258 29 258 34V45Q258 55 248 55Q244 55 241 54T235 52L237 47ZM245 32Q241 32 241 36Q241 40 246 40Q248
+40 249 40T251 39V36Q249 32 245 32ZM292 27V43Q292 55 283 55Q276 55 273 50L271 54H266V27H273V44Q275 48 279 48Q284 48 284 42V27H292ZM297 28Q301 26 307 26Q318 26 318 35Q318 40 316 41T310 44Q305 46 305 47Q305 49 308 49Q312 49 316 47L318 53Q314 55
+308 55Q298 55 298 46Q298 41 301 40T306 37Q311 37 311 34Q311 32 308 32Q303 32 299 34L297 28ZM338 42Q338 21 358 21Q378 21 378 42Q378 62 358 62Q350 62 344 57T338 42ZM344 42Q344 57 358 57Q372 57 372 42Q372 27 358 27Q344 27 344 42ZM364 38Q362 37
+360 37Q356 37 356 42Q356 46 360 46H363L365 50Q361 52 358 52Q349 52 349 42Q349 31 358 31Q363 31 365 33L364 38ZM399 27H407V39H411Q417 39 422 41T427 51Q427 59 422 61T410 63H399V27ZM411 57Q419 57 419 52Q419 47 417 47T410 46H407V57H411ZM432 47Q436
+49 441 49Q446 49 446 45V43Q445 43 444 43T441 44Q428 44 428 34Q428 26 437 26Q443 26 446 31L448 27H454Q453 29 453 34V45Q453 55 443 55Q439 55 436 54T430 52L432 47ZM440 32Q436 32 436 36Q436 40 441 40Q443 40 444 40T446 39V36Q444 32 440 32ZM478 54Q477
+55 474 55Q470 55 468 50H467L466 54H460V27H468V44Q468 48 474 48H475Q476 48 476 48T477 47L478 54ZM483 47Q489 49 492 49Q497 49 497 45V43Q496 43 495 43T492 44Q479 44 479 34Q479 26 488 26Q495 26 497 31H498L499 27H505Q504 29 504 34V45Q504 55 494 55Q490
+55 487 54T482 52L483 47ZM491 32Q487 32 487 36Q487 40 492 40Q494 40 495 40T497 39V36Q495 32 491 32ZM533 63H502V57H513V27H521V57H533V63ZM541 54H533L545 27Q544 22 540 22L539 23L537 17Q539 16 542 16Q547 16 552 29L562 54H554L549 39V34H548L547 39L541
+54ZM565 16H573V28Q574 26 578 26Q592 26 592 41Q592 55 581 55Q576 55 572 51H571L570 54H565V16ZM579 49Q584 49 584 41Q584 32 577 32Q575 32 573 34V44Q573 49 579 49ZM618 34Q616 32 611 32Q604 32 603 38H622V44Q622 50 619 52T610 55Q596 55 596 40Q596
+26 610 26Q613 26 616 27T621 29L618 34ZM610 49Q616 49 615 43H604Q604 49 610 49Z" />
+<glyph unicode=" " glyph-name="space" horiz-adv-x="291" />
+<glyph unicode="!" glyph-name="exclam" horiz-adv-x="331" d="M133 700H233V357L213 184H153L133 357V700ZM115 51Q115 80 133 97T182 114Q212 114 230 97T249 51Q249 24 231 6T182 -12Q152 -12 134 6T115 51Z" />
+<glyph unicode="&quot;" glyph-name="quotedbl" horiz-adv-x="375" d="M98 700H190L155 502H98V700ZM228 700H320L285 502H228V700Z" />
+<glyph unicode="#" glyph-name="numbersign" horiz-adv-x="594" d="M305 221H192L150 57H69L111 221H26L43 293H130L162 417H81L98 489H181L221 643H302L262 489H375L415 643H496L456 489H539L520 417H437L405 293H484L465 221H386L343 57H263L305 221ZM211 293H324L356
+417H243L211 293Z" />
+<glyph unicode="$" glyph-name="dollar" horiz-adv-x="594" d="M263 -13Q202 -11 155 -2T80 22L111 106Q134 94 171 84T263 71V321Q230 335 198 351T140 391T99 447T83 526Q83 604 128 651T263 710V800H342V712Q397 710 433 702T498 681L469 599Q449 609 418 617T342
+628V399Q376 384 410 367T471 325T514 269T531 192Q531 109 483 58T342 -8V-100H263V-13ZM320 73Q371 79 402 105T433 182Q433 204 424 221T400 251T364 276T320 297V73ZM285 628Q227 623 204 597T181 533Q181 493 211 469T285 424V628Z" />
+<glyph unicode="%" glyph-name="percent" horiz-adv-x="854" d="M74 542Q74 586 87 618T123 671T177 702T246 712Q283 712 314 703T369 673T406 621T419 542Q419 496 406 464T370 411T315 382T246 372Q209 372 178 381T123 411T87 463T74 542ZM162 542Q162 488
+183 463T246 437Q286 437 308 460T331 542Q331 602 309 624T246 647Q206 647 184 625T162 542ZM473 170Q473 214 486 246T522 299T576 330T645 340Q682 340 713 331T768 301T805 249T818 170Q818 124 805 92T769 39T714 10T645 0Q608 0 577 9T522 39T486 91T473
+170ZM561 170Q561 116 582 91T645 65Q685 65 707 88T730 170Q730 230 708 252T645 275Q605 275 583 253T561 170ZM704 713L762 665L190 -13L133 36L704 713Z" />
+<glyph unicode="&amp;" glyph-name="ampersand" horiz-adv-x="891" d="M125 189Q125 229 140 264T180 331T239 389T310 435Q284 470 266 505T247 582Q247 606 256 629T284 671T335 701T410 713Q456 713 487 702T538 674T565 634T573 590Q573 549 539 504T427 420Q465
+362 516 304T620 196Q632 208 644 226T668 265T689 307T706 349L778 312Q772 295 760 272T734 226T704 181T676 144Q698 125 715 112T748 88T778 70T807 55L751 -13Q723 1 690 24T621 79Q601 61 578 45T525 16T459 -5T380 -13Q328 -13 282 0T201 40T146 103T125
+189ZM563 136Q533 164 503 197T445 262T395 325T354 378Q295 338 258 295T220 193Q220 164 234 141T271 101T326 76T393 67Q419 67 444 73T492 88T533 110T563 136ZM342 580Q342 552 354 525T388 468Q444 500 466 526T489 572Q489 604 473 622T414 641Q376 641
+359 625T342 580Z" />
+<glyph unicode="&apos;" glyph-name="quotesingle" horiz-adv-x="244" d="M98 700H190L155 502H98V700Z" />
+<glyph unicode="(" glyph-name="parenleft" horiz-adv-x="314" d="M249 -220Q198 -172 164 -115T107 3T76 125T66 243Q66 298 75 359T107 481T164 602T252 712L310 669Q267 619 238 566T192 458T168 349T160 243Q160 195 168 140T195 30T242 -79T311 -175L249 -220Z" />
+<glyph unicode=")" glyph-name="parenright" horiz-adv-x="314" d="M3 -175Q43 -132 71 -79T118 29T145 140T154 243Q154 294 147 348T122 457T76 565T4 669L62 712Q114 661 149 602T207 482T238 359T248 243Q248 187 239 126T207 4T151 -114T65 -220L3 -175Z" />
+<glyph unicode="*" glyph-name="asterisk" horiz-adv-x="387" d="M144 724L172 680L191 621L212 679L239 724L293 694L264 647L214 598L288 612H341V549H290L221 563L271 513L296 472L243 441L215 486L190 549L171 489L144 444L87 475L117 520L163 563L100 549H45V612H100L168
+598L118 645L89 693L144 724Z" />
+<glyph unicode="+" glyph-name="plus" horiz-adv-x="554" d="M43 379H234V569H320V379H511V295H320V104H234V295H43V379Z" />
+<glyph unicode="," glyph-name="comma" horiz-adv-x="225" d="M59 47Q59 73 78 89T124 106Q159 106 181 83T203 17Q203 -22 192 -50T162 -99T123 -132T80 -150L52 -104Q90 -91 109 -63T128 -5Q101 -13 80 1T59 47Z" />
+<glyph unicode="-" glyph-name="hyphen" horiz-adv-x="394" d="M64 332H330V246H64V332Z" />
+<glyph unicode="." glyph-name="period" horiz-adv-x="238" d="M52 51Q52 80 70 97T119 114Q149 114 167 97T186 51Q186 24 168 6T119 -12Q89 -12 71 6T52 51Z" />
+<glyph unicode="/" glyph-name="slash" horiz-adv-x="396" d="M360 712L434 678L35 -140L-38 -104L360 712Z" />
+<glyph unicode="0" glyph-name="zero" horiz-adv-x="594" d="M44 350Q44 525 108 619T297 713Q429 713 490 620T551 350Q551 176 486 82T296 -13Q230 -13 183 13T105 86T59 201T44 350ZM142 350Q142 289 151 238T178 148T226 89T297 67Q378 67 415 137T453 350Q453
+411 445 462T419 552T370 611T297 633Q216 633 179 562T142 350Z" />
+<glyph unicode="1" glyph-name="one" horiz-adv-x="594" d="M113 84H265V549L277 610L233 560L114 480L72 539L313 712H357V84H507V0H113V84Z" />
+<glyph unicode="2" glyph-name="two" horiz-adv-x="594" d="M489 536Q489 485 468 432T414 325T339 220T255 120L201 77V73L273 84H506V0H65V36Q89 59 122 92T192 166T264 252T328 343T373 435T391 520Q391 567 362 598T273 629Q231 629 192 613T125 574L84 641Q125
+674 177 693T292 713Q385 713 437 665T489 536Z" />
+<glyph unicode="3" glyph-name="three" horiz-adv-x="594" d="M255 69Q292 69 323 79T376 107T410 150T423 205Q423 271 379 303T254 335H173V373L326 581L378 625L304 616H94V700H489V661L320 434L280 405V402L318 409Q361 408 397 394T461 355T503 294T518 214Q518
+158 497 116T440 45T356 2T253 -13Q204 -13 163 -6T92 15L117 97Q143 85 177 77T255 69Z" />
+<glyph unicode="4" glyph-name="four" horiz-adv-x="594" d="M576 211H448V0H356V211H19V253L381 710H448V289H576V211ZM356 492L365 572H362L325 507L177 328L124 281L199 289H356V492Z" />
+<glyph unicode="5" glyph-name="five" horiz-adv-x="594" d="M106 90Q131 81 159 76T232 71Q307 71 355 107T403 215Q403 284 355 318T220 353L129 349V700H476V612H217V431L264 433Q318 433 361 418T434 376T481 310T498 220Q498 163 477 120T420 47T334 2T229
+-13Q181 -13 146 -7T80 10L106 90V90Z" />
+<glyph unicode="6" glyph-name="six" horiz-adv-x="594" d="M540 212Q540 168 524 128T478 56T404 6T304 -13Q250 -13 206 4T129 53T80 132T62 239Q62 335 90 417T167 563T284 665T432 713L451 637Q391 629 342 602T255 535T193 447T161 348Q170 361 184 374T219
+397T264 413T318 419Q369 419 410 405T480 363T524 298T540 212ZM445 205Q445 271 409 305T299 339Q246 339 209 316T156 264Q154 251 154 244T154 226Q154 197 163 169T191 118T238 81T305 67Q336 67 361 78T405 108T434 152T445 205Z" />
+<glyph unicode="7" glyph-name="seven" horiz-adv-x="594" d="M115 0L385 573L433 622L368 612H62V700H526V671L211 0H115Z" />
+<glyph unicode="8" glyph-name="eight" horiz-adv-x="594" d="M217 360Q190 375 167 391T126 429T98 476T88 535Q88 573 103 605T146 662T214 699T304 713Q350 713 387 701T451 667T492 616T507 551Q507 494 479 451T386 368Q415 352 440 335T484 295T513 246T524
+185Q524 142 509 106T463 44T390 2T291 -13Q238 -13 198 1T129 40T86 98T71 170Q71 233 107 278T217 360ZM279 329Q215 297 188 258T161 183Q161 160 170 139T196 102T238 77T296 67Q323 67 348 74T391 96T421 131T432 181Q432 208 419 229T385 268T336 300T279
+329ZM324 395Q370 428 393 461T416 532Q416 556 407 574T382 606T345 626T301 633Q272 633 250 625T213 603T189 572T181 537Q181 510 193 489T224 452T270 422T324 395Z" />
+<glyph unicode="9" glyph-name="nine" horiz-adv-x="594" d="M53 487Q53 534 68 575T114 647T189 695T293 713Q349 713 393 695T469 644T516 564T533 458Q533 345 505 260T426 117T308 26T162 -13L142 62Q205 69 255 92T341 152T400 235T432 336Q417 320 402 309T368
+292T327 283T275 280Q231 280 191 294T120 334T71 398T53 487ZM149 494Q149 427 190 393T296 358Q349 358 385 375T439 416Q441 428 441 437T441 457Q441 490 432 522T405 579T357 619T288 635Q222 635 186 598T149 494Z" />
+<glyph unicode=":" glyph-name="colon" horiz-adv-x="273" d="M99 445Q99 474 117 491T166 508Q196 508 214 491T233 445Q233 418 215 400T166 382Q136 382 118 400T99 445ZM99 51Q99 80 117 97T166 114Q196 114 214 97T233 51Q233 24 215 6T166 -12Q136 -12 118
+6T99 51Z" />
+<glyph unicode=";" glyph-name="semicolon" horiz-adv-x="277" d="M93 47Q93 73 112 89T158 106Q193 106 215 83T237 17Q237 -22 226 -50T196 -99T157 -132T114 -150L86 -104Q124 -91 143 -63T162 -5Q135 -13 114 1T93 47ZM98 445Q98 474 116 491T165 508Q195
+508 213 491T232 445Q232 418 214 400T165 382Q135 382 117 400T98 445Z" />
+<glyph unicode="&lt;" glyph-name="less" horiz-adv-x="554" d="M44 300V338L463 574L505 502L249 358L149 321L248 289L510 146L469 76L44 300Z" />
+<glyph unicode="=" glyph-name="equal" horiz-adv-x="554" d="M43 465H511V381H43V465ZM43 293H511V209H43V293Z" />
+<glyph unicode="&gt;" glyph-name="greater" horiz-adv-x="554" d="M510 348V310L90 75L49 147L305 291L405 328L306 360L44 503L84 574L510 348Z" />
+<glyph unicode="?" glyph-name="question" horiz-adv-x="479" d="M160 184Q156 234 167 270T199 334T243 384T289 428T325 475T340 533Q340 577 314 605T221 633Q181 633 140 618T69 586L37 658Q79 684 126 698T242 713Q291 713 328 700T390 665T427 612T440 546Q440
+499 425 466T388 406T340 358T292 312T255 257T240 184H160ZM138 51Q138 80 156 97T205 114Q235 114 253 97T272 51Q272 24 254 6T205 -12Q175 -12 157 6T138 51Z" />
+<glyph unicode="@" glyph-name="at" horiz-adv-x="1163" d="M770 490H812L756 208Q744 145 748 115T788 85Q824 85 859 102T922 150T967 226T985 326Q985 405 956 465T876 567T755 629T602 650Q513 650 436 619T302 534T212 405T179 242Q179 155 208 85T291 -35T423
+-111T597 -138Q629 -138 668 -131T741 -109L764 -184Q716 -204 674 -211T582 -218Q478 -218 389 -188T234 -99T131 43T93 236Q93 348 134 439T245 594T409 694T607 730Q705 730 789 702T936 621T1034 494T1070 326Q1070 264 1046 207T981 105T884 34T767 7Q739
+7 718 13T683 35T665 77T668 142H664Q648 118 627 94T581 51T527 19T464 7Q438 7 415 18T375 49T347 98T337 160Q337 220 359 280T421 388T511 466T620 496Q660 496 685 485T733 457L770 490ZM706 383Q688 402 670 410T624 418Q582 418 547 395T485 337T444 259T429
+176Q429 140 445 113T507 85Q528 85 551 99T596 136T639 188T676 247L706 383Z" />
+<glyph unicode="A" glyph-name="A" horiz-adv-x="645" d="M457 183H180L106 0H8L296 710H348L637 0H533L457 183ZM210 267H428L347 466L320 573H318L291 464L210 267Z" />
+<glyph unicode="B" glyph-name="B" horiz-adv-x="641" d="M559 538Q559 512 551 487T525 439T480 399T416 374V370Q448 366 478 354T531 321T568 270T582 199Q582 145 557 106T491 41T399 3T295 -9Q277 -9 251 -9T197 -7T140 -3T89 5V694Q130 701 185 705T303
+709Q346 709 391 702T474 675T535 623T559 538ZM187 82Q194 80 208 79T238 77T271 76T302 75Q336 75 367 82T423 104T461 142T476 197Q476 237 459 260T413 296T350 312T281 316H187V82ZM242 394Q261 394 286 395T328 399Q353 406 375 416T415 441T442 475T452
+520Q452 554 439 574T403 606T353 621T296 625Q261 625 232 624T187 620V394H242Z" />
+<glyph unicode="C" glyph-name="C" horiz-adv-x="624" d="M584 30Q551 6 500 -3T392 -13Q325 -13 265 8T158 74T85 187T58 350Q58 448 88 517T166 629T274 693T393 713Q459 713 501 706T572 688L550 602Q501 625 401 625Q356 625 314 611T238 564T184 479T164
+350Q164 282 183 231T235 145T314 93T414 75Q463 75 499 84T560 107L584 30Z" />
+<glyph unicode="D" glyph-name="D" horiz-adv-x="715" d="M89 700Q109 703 135 704T190 707T246 708T297 709Q389 709 456 683T568 609T635 497T657 355Q657 285 637 220T571 103T456 21T285 -10Q268 -10 240 -9T181 -7T126 -5T89 -1V700ZM300 621Q286 621 270
+621T238 620T209 618T189 616V82Q194 81 208 81T239 80T269 79T289 78Q364 78 414 101T495 164T538 252T551 355Q551 400 539 447T498 532T421 596T300 621Z" />
+<glyph unicode="E" glyph-name="E" horiz-adv-x="585" d="M89 700H512V614H189V401H484V315H189V86H517V0H89V700Z" />
+<glyph unicode="F" glyph-name="F" horiz-adv-x="565" d="M89 700H512V614H189V391H489V305H189V0H89V700Z" />
+<glyph unicode="G" glyph-name="G" horiz-adv-x="668" d="M348 353H610V44Q592 30 567 20T514 2T455 -9T396 -13Q324 -13 263 8T156 75T84 188T58 350Q58 447 89 516T171 629T282 693T405 713Q471 713 514 706T587 687L563 602Q511 625 413 625Q368 625 324 611T244
+565T186 480T164 350Q164 279 182 227T234 141T312 91T410 75Q443 75 473 81T527 100V277L348 295V353Z" />
+<glyph unicode="H" glyph-name="H" horiz-adv-x="733" d="M544 313H189V0H89V700H189V401H544V700H644V0H544V313Z" />
+<glyph unicode="I" glyph-name="I" horiz-adv-x="398" d="M149 634H69V700H329V634H249V66H329V0H69V66H149V634Z" />
+<glyph unicode="J" glyph-name="J" horiz-adv-x="325" d="M125 700H225V160Q225 82 185 36T65 -10Q55 -10 42 -9T14 -6T-13 0T-35 7L-16 90Q12 78 51 78Q96 78 110 107T125 187V700Z" />
+<glyph unicode="K" glyph-name="K" horiz-adv-x="669" d="M238 318H189V0H89V700H189V378L235 392L487 700H601L349 400L302 366L357 326L635 0H509L238 318Z" />
+<glyph unicode="L" glyph-name="L" horiz-adv-x="566" d="M547 0H89V700H189V88H547V0Z" />
+<glyph unicode="M" glyph-name="M" horiz-adv-x="868" d="M679 451L690 563H686L643 466L448 156H418L213 467L172 562H167L183 452V0H89V700H164L401 343L438 267H440L475 345L700 700H779V0H679V451Z" />
+<glyph unicode="N" glyph-name="N" horiz-adv-x="735" d="M235 445L175 543H171L183 445V0H89V710H145L502 256L559 163H564L552 256V700H646V-10H590L235 445Z" />
+<glyph unicode="O" glyph-name="O" horiz-adv-x="747" d="M58 350Q58 436 79 503T141 617T240 688T373 713Q452 713 511 687T610 613T669 498T689 350Q689 264 668 197T605 83T506 12T373 -13Q293 -13 234 13T136 87T78 202T58 350ZM164 350Q164 293 176 243T214
+155T279 95T373 73Q470 73 526 140T583 350Q583 406 571 456T533 544T468 604T373 627Q277 627 221 559T164 350Z" />
+<glyph unicode="P" glyph-name="P" horiz-adv-x="614" d="M89 693Q131 702 180 705T278 709Q329 709 381 700T477 667T547 601T575 491Q575 428 550 384T484 311T389 270T278 257Q272 257 260 257T234 258T208 260T189 262V0H89V693ZM281 623Q254 623 229 622T189
+617V348Q194 346 205 346T229 344T253 343T271 343Q307 343 342 348T405 370T451 415T469 490Q469 530 452 556T408 597T348 617T281 623Z" />
+<glyph unicode="Q" glyph-name="Q" horiz-adv-x="747" d="M771 -181Q745 -188 719 -190T667 -193Q612 -193 560 -183T459 -160T365 -137T280 -126Q255 -126 231 -132V-46Q261 -40 291 -40Q336 -40 381 -50T473 -73T569 -95T673 -106Q696 -106 720 -104T771 -95V-181ZM58
+350Q58 436 79 503T141 617T240 688T373 713Q452 713 511 687T610 613T669 498T689 350Q689 264 668 197T605 83T506 12T373 -13Q293 -13 234 13T136 87T78 202T58 350ZM164 350Q164 293 176 243T214 155T279 95T373 73Q470 73 526 140T583 350Q583 406 571 456T533
+544T468 604T373 627Q277 627 221 559T164 350Z" />
+<glyph unicode="R" glyph-name="R" horiz-adv-x="653" d="M89 693Q110 697 135 700T187 705T239 708T288 709Q338 709 384 699T466 666T523 606T545 515Q545 473 532 439T496 379T442 336T373 309L425 274L613 0H498L290 295L189 309V0H89V693ZM291 623Q277 623
+263 623T234 622T208 620T189 617V375H271Q307 375 337 382T390 405T426 446T439 507Q439 561 401 592T291 623Z" />
+<glyph unicode="S" glyph-name="S" horiz-adv-x="581" d="M433 184Q433 225 406 249T338 290T250 323T162 363T94 425T67 524Q67 609 129 661T308 713Q375 713 431 703T519 677L488 593Q463 606 413 616T303 627Q235 627 201 598T167 531Q167 492 194 468T262
+426T350 390T438 348T506 287T533 193Q533 146 515 108T463 43T381 2T272 -13Q190 -13 134 -1T48 26L81 113Q106 100 156 87T268 73Q303 73 333 79T385 99T420 134T433 184Z" />
+<glyph unicode="T" glyph-name="T" horiz-adv-x="610" d="M591 612H355V0H255V612H19V700H591V612Z" />
+<glyph unicode="U" glyph-name="U" horiz-adv-x="710" d="M527 700H621V243Q621 178 603 131T550 53T470 6T366 -9Q231 -9 160 49T89 223V700H189V261Q189 159 233 119T365 79Q449 79 488 123T527 264V700Z" />
+<glyph unicode="V" glyph-name="V" horiz-adv-x="628" d="M296 234L322 125H324L351 236L531 700H631L341 -10H291L-3 700H107L296 234Z" />
+<glyph unicode="W" glyph-name="W" horiz-adv-x="913" d="M247 246L263 129H265L283 248L438 700H488L644 246L662 129H664L683 248L807 700H905L692 -10H635L482 445L461 551H456L436 444L283 -10H225L8 700H113L247 246Z" />
+<glyph unicode="X" glyph-name="X" horiz-adv-x="678" d="M280 356L49 700H168L319 470L346 412L372 470L530 700H640L402 363L651 0H534L367 244L336 305L308 244L137 0H27L280 356Z" />
+<glyph unicode="Y" glyph-name="Y" horiz-adv-x="617" d="M261 274L7 700H124L299 403L316 339H318L337 405L504 700H610L361 275V0H261V274Z" />
+<glyph unicode="Z" glyph-name="Z" horiz-adv-x="596" d="M39 88L416 572L465 612H39V700H557V612L177 125L130 88H557V0H39V88Z" />
+<glyph unicode="[" glyph-name="bracketleft" horiz-adv-x="336" d="M89 700H295V620H181V-150H295V-230H89V700Z" />
+<glyph unicode="\" glyph-name="backslash" horiz-adv-x="421" d="M442 -103L366 -140L-36 676L40 712L442 -103Z" />
+<glyph unicode="]" glyph-name="bracketright" horiz-adv-x="336" d="M247 -230H41V-150H155V620H41V700H247V-230Z" />
+<glyph unicode="^" glyph-name="asciicircum" horiz-adv-x="554" d="M266 710H304L492 430H394L309 562L283 631L251 561L151 430H61L266 710Z" />
+<glyph unicode="_" glyph-name="underscore" horiz-adv-x="452" d="M0 -131H452V-209H0V-131Z" />
+<glyph unicode="`" glyph-name="grave" horiz-adv-x="301" d="M241 570H187L60 697V720H170L241 570Z" />
+<glyph unicode="a" glyph-name="a" horiz-adv-x="582" d="M82 492Q172 535 305 535Q365 535 401 520T458 480T484 427T491 368Q491 313 487 258T483 137Q483 99 486 64T498 -2H431L406 78H396Q385 63 369 48T331 20T281 0T215 -8Q178 -8 147 2T94 32T58 78T45
+140Q45 185 64 218T115 272T185 303T264 313Q295 313 316 312T352 310T377 307T395 304Q397 319 398 330T399 358Q399 386 393 405T374 435T337 452T281 457Q262 457 239 454T193 446T148 432T107 415L82 492ZM395 238Q387 239 378 241T356 244T324 246T278 247Q216
+247 180 225T143 150Q143 110 171 90T245 70Q278 70 303 78T347 99T377 127T395 158V238Z" />
+<glyph unicode="b" glyph-name="b" horiz-adv-x="629" d="M88 700H180V460H190Q213 500 256 519T347 539Q456 539 512 473T569 272Q569 135 495 63T287 -9Q221 -9 168 2T88 28V700ZM334 461Q302 461 278 451T234 424T202 384T180 337V88Q229 69 299 69Q378 69
+424 117T471 273Q471 313 463 347T438 407T396 446T334 461Z" />
+<glyph unicode="c" glyph-name="c" horiz-adv-x="529" d="M484 36Q449 11 402 -1T303 -14Q237 -14 191 6T115 62T73 149T60 262Q60 395 124 467T310 540Q363 540 402 531T472 507L448 432Q421 446 390 454T321 462Q158 462 158 262Q158 224 167 189T196 126T248
+81T328 64Q370 64 401 75T454 103L484 36Z" />
+<glyph unicode="d" glyph-name="d" horiz-adv-x="629" d="M538 181Q538 130 539 86T549 -2H488L465 78H455Q432 38 388 12T284 -14Q171 -14 116 53T60 259Q60 393 128 464T321 536Q342 536 358 535T389 531T417 525T446 517V700H538V181ZM446 428Q423 445 397
+451T326 458Q245 458 201 411T156 258Q156 216 164 181T189 119T234 79T303 64Q364 64 398 94T446 185V428Z" />
+<glyph unicode="e" glyph-name="e" horiz-adv-x="598" d="M515 43Q480 17 428 2T315 -14Q249 -14 201 5T121 61T75 148T60 262Q60 397 126 468T316 540Q355 540 394 532T464 500T514 435T534 328Q534 312 533 291T529 250H154Q156 158 198 111T341 64Q383 64 421
+78T480 113L515 43ZM446 316Q448 396 414 429T317 462Q247 462 206 429T158 316H446Z" />
+<glyph unicode="f" glyph-name="f" horiz-adv-x="364" d="M24 525H113V539Q113 588 122 621T150 675T201 705T278 714Q316 714 344 710T404 694L384 619Q358 630 336 633T292 636Q264 636 247 631T221 614T208 580T205 525H359V447H205V0H113V447H24V525Z" />
+<glyph unicode="g" glyph-name="g" horiz-adv-x="627" d="M537 -3Q537 -106 477 -156T299 -207Q231 -207 189 -199T117 -177L139 -94Q152 -100 169 -106T205 -118T243 -126T281 -129Q330 -129 362 -121T413 -94T439 -48T446 19V56H435Q419 30 379 14T282 -2Q168
+-2 114 59T60 258Q60 393 130 466T338 539Q404 539 451 531T537 510V-3ZM302 76Q363 76 397 107T445 188V446Q422 453 392 457T324 461Q246 461 202 412T158 260Q158 172 190 124T302 76Z" />
+<glyph unicode="h" glyph-name="h" horiz-adv-x="641" d="M461 0V290Q461 333 456 364T436 417T397 448T335 458Q309 458 284 449T238 424T202 386T180 335V0H88V700H180V460H191Q221 496 263 518T367 540Q415 540 450 530T508 493T542 422T553 310V0H461Z" />
+<glyph unicode="i" glyph-name="i" horiz-adv-x="317" d="M114 525H206V0H114V525ZM95 650Q95 673 113 691T160 710Q189 710 208 692T227 650Q227 627 208 610T160 592Q131 592 113 609T95 650Z" />
+<glyph unicode="j" glyph-name="j" horiz-adv-x="312" d="M112 525H204V-18Q204 -115 168 -162T50 -210Q42 -210 33 -210T12 -208V-132Q45 -133 64 -124T94 -97T108 -51T112 15V525ZM91 650Q91 673 109 691T156 710Q185 710 204 692T223 650Q223 627 204 610T156
+592Q127 592 109 609T91 650Z" />
+<glyph unicode="k" glyph-name="k" horiz-adv-x="557" d="M237 236H180V0H88V700H180V286L232 303L406 525H514L347 322H348L293 282L356 237L541 0H425L237 236Z" />
+<glyph unicode="l" glyph-name="l" horiz-adv-x="336" d="M192 139Q192 98 207 81T249 64Q265 64 280 66T316 74L328 6Q318 2 304 -1T275 -8T245 -12T218 -14Q164 -14 132 13T100 105V700H192V139Z" />
+<glyph unicode="m" glyph-name="m" horiz-adv-x="948" d="M428 0V288Q428 330 424 362T408 415T375 447T319 458Q266 458 231 429T180 353V0H88V525H151L169 455H179Q211 491 252 515T358 540Q412 540 448 517T504 440Q534 486 580 513T683 540Q731 540 764 529T819
+491T850 418T860 302V0H768V302Q768 342 764 371T747 419T714 448T657 458Q600 458 567 428T520 338V0H428Z" />
+<glyph unicode="n" glyph-name="n" horiz-adv-x="641" d="M461 0V290Q461 374 434 416T338 458Q277 458 237 427T180 346V0H88V525H152L170 455H179Q208 491 254 515T366 540Q412 540 447 530T505 493T541 422T553 309V0H461Z" />
+<glyph unicode="o" glyph-name="o" horiz-adv-x="631" d="M60 262Q60 327 77 378T127 466T207 521T316 540Q380 540 428 519T508 461T555 373T571 262Q571 198 554 147T504 60T424 5T316 -14Q250 -14 202 7T123 65T76 152T60 262ZM158 262Q158 225 166 190T194
+126T243 81T317 64Q473 64 473 262Q473 301 465 337T438 400T389 445T317 462Q239 462 199 413T158 262Z" />
+<glyph unicode="p" glyph-name="p" horiz-adv-x="630" d="M88 525H150L168 458H177Q204 497 247 518T344 540Q458 540 514 477T570 274Q570 208 552 155T499 64T415 6T304 -14Q284 -14 268 -13T237 -8T209 0T180 11V-200H88V525ZM323 462Q263 462 229 432T180
+340V98Q203 82 230 73T299 64Q380 64 426 117T472 275Q472 360 438 411T323 462Z" />
+<glyph unicode="q" glyph-name="q" horiz-adv-x="625" d="M537 -200H446L445 57H434Q411 23 376 5T283 -14Q60 -14 60 258Q60 395 131 465T342 536Q372 536 401 533T456 526T502 516T537 504V-200ZM445 438Q399 458 325 458Q244 458 201 409T158 260Q158 216 165
+180T190 119T235 79T303 64Q363 64 396 94T445 184V438Z" />
+<glyph unicode="r" glyph-name="r" horiz-adv-x="380" d="M362 438Q345 443 329 447T299 451Q246 451 217 424T180 356V0H88V525H152L170 455H179Q202 494 232 515T309 537Q323 537 342 535T380 526L362 438Z" />
+<glyph unicode="s" glyph-name="s" horiz-adv-x="499" d="M353 147Q353 167 344 180T318 203T281 220T237 234Q208 242 179 251T126 277T87 320T72 386Q72 464 118 502T249 540Q312 540 355 528T430 502L408 424Q381 437 344 449T261 462Q212 462 188 446T164
+388Q164 371 173 360T197 340T232 325T274 312Q304 304 334 294T389 266T429 221T445 153Q445 79 395 33T245 -14Q181 -14 134 -1T54 29L80 109Q108 94 152 79T241 64Q290 64 321 81T353 147Z" />
+<glyph unicode="t" glyph-name="t" horiz-adv-x="405" d="M24 525H113V631L205 655V525H363V447H205V179Q205 116 221 90T276 64Q301 64 321 69T368 84L389 19Q357 5 321 -4T242 -14Q172 -14 143 24T113 148V447H24V525Z" />
+<glyph unicode="u" glyph-name="u" horiz-adv-x="644" d="M180 525V236Q180 194 185 162T203 109T238 76T296 64Q356 64 394 98T452 182V525H544V149Q544 111 547 72T556 0H494L470 87H460Q434 42 388 14T273 -14Q227 -14 193 -3T135 34T100 105T88 215V525H180Z" />
+<glyph unicode="v" glyph-name="v" horiz-adv-x="535" d="M242 223L277 115L310 225L435 525H535L290 -11H250L0 525H108L242 223Z" />
+<glyph unicode="w" glyph-name="w" horiz-adv-x="840" d="M468 525L554 326L597 225L624 124H631L654 228L752 525H840L649 -11H599L452 328V327L426 424L396 326V327L255 -11H207L8 525H109L220 228L239 123H248L276 230L397 525H468Z" />
+<glyph unicode="x" glyph-name="x" d="M233 269L44 525H161L263 391L298 320L339 391L445 525H549L358 273Q408 206 460 137T562 0H448L333 149L293 224L252 149L136 0H30L233 269Z" />
+<glyph unicode="y" glyph-name="y" horiz-adv-x="531" d="M251 193L282 92H295L320 194L429 525H523L351 50Q332 1 313 -45T270 -126T218 -183T152 -205Q112 -205 84 -196L99 -118Q114 -123 129 -123Q149 -123 165 -118T196 -100T221 -64T243 -3L8 525H117L251 193Z" />
+<glyph unicode="z" glyph-name="z" horiz-adv-x="515" d="M48 79L307 395L377 447H48V525H461V446L199 127L129 78H461V0H48V79Z" />
+<glyph unicode="{" glyph-name="braceleft" horiz-adv-x="383" d="M146 108Q146 159 124 178T59 197V273Q101 273 123 293T146 358V591Q146 639 172 670T251 701H351V621H295Q238 621 238 559V335Q238 291 215 269T161 241V233Q190 229 214 203T238 135V-88Q238
+-119 251 -134T296 -150H351V-230H251Q202 -230 174 -202T146 -121V108Z" />
+<glyph unicode="|" glyph-name="bar" horiz-adv-x="258" d="M89 700H169V-130H89V700Z" />
+<glyph unicode="}" glyph-name="braceright" horiz-adv-x="383" d="M263 363Q263 312 286 293T351 274V198Q309 198 286 178T263 113V-120Q263 -168 237 -199T156 -230H59V-150H114Q171 -150 171 -88V136Q171 180 194 202T247 230V238Q218 242 195 268T171 336V559Q171
+621 113 621H59V701H157Q206 701 234 673T263 592V363Z" />
+<glyph unicode="~" glyph-name="asciitilde" horiz-adv-x="554" d="M34 365Q82 399 120 412T190 425Q221 425 247 417T297 398T345 380T393 371Q413 371 435 378T483 406L520 335Q479 309 447 299T388 288Q359 288 335 296T287 315T240 335T190 344Q165 344 136
+333T70 295L34 365Z" />
+</font>
Index: src/main/resources/templates/parse.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/templates/parse.html	(date 1594749336118)
+++ src/main/resources/templates/parse.html	(date 1594749336118)
@@ -0,0 +1,283 @@
+{
+    "data": {
+      "attributes": [
+        [
+          "A1", 
+          "norm", 
+          "T1", 
+          "DRY_COUGH"
+        ], 
+        [
+          "A2", 
+          "certainty", 
+          "T1", 
+          "Positive"
+        ], 
+        [
+          "A3", 
+          "status", 
+          "T1", 
+          "Present"
+        ], 
+        [
+          "A4", 
+          "experiencer", 
+          "T1", 
+          "Patient"
+        ], 
+        [
+          "A5", 
+          "norm", 
+          "T2", 
+          "FEVER"
+        ], 
+        [
+          "A6", 
+          "certainty", 
+          "T2", 
+          "Positive"
+        ], 
+        [
+          "A7", 
+          "status", 
+          "T2", 
+          "Present"
+        ], 
+        [
+          "A8", 
+          "experiencer", 
+          "T2", 
+          "Patient"
+        ], 
+        [
+          "A9", 
+          "norm", 
+          "T3", 
+          "DYSPNEA"
+        ], 
+        [
+          "A10", 
+          "certainty", 
+          "T3", 
+          "Positive"
+        ], 
+        [
+          "A11", 
+          "status", 
+          "T3", 
+          "Present"
+        ], 
+        [
+          "A12", 
+          "experiencer", 
+          "T3", 
+          "Patient"
+        ], 
+        [
+          "A13", 
+          "norm", 
+          "T4", 
+          "FATIGUE"
+        ], 
+        [
+          "A14", 
+          "certainty", 
+          "T4", 
+          "Positive"
+        ], 
+        [
+          "A15", 
+          "status", 
+          "T4", 
+          "Present"
+        ], 
+        [
+          "A16", 
+          "experiencer", 
+          "T4", 
+          "Patient"
+        ], 
+        [
+          "A17", 
+          "norm", 
+          "T5", 
+          "DIARRHEA"
+        ], 
+        [
+          "A18", 
+          "certainty", 
+          "T5", 
+          "Positive"
+        ], 
+        [
+          "A19", 
+          "status", 
+          "T5", 
+          "Present"
+        ], 
+        [
+          "A20", 
+          "experiencer", 
+          "T5", 
+          "Patient"
+        ], 
+        [
+          "A21", 
+          "norm", 
+          "T6", 
+          "HEADACHE"
+        ], 
+        [
+          "A22", 
+          "certainty", 
+          "T6", 
+          "Positive"
+        ], 
+        [
+          "A23", 
+          "status", 
+          "T6", 
+          "Present"
+        ], 
+        [
+          "A24", 
+          "experiencer", 
+          "T6", 
+          "Patient"
+        ], 
+        [
+          "A25", 
+          "norm", 
+          "T7", 
+          "SORE_THROAT"
+        ], 
+        [
+          "A26", 
+          "certainty", 
+          "T7", 
+          "Positive"
+        ], 
+        [
+          "A27", 
+          "status", 
+          "T7", 
+          "Present"
+        ], 
+        [
+          "A28", 
+          "experiencer", 
+          "T7", 
+          "Patient"
+        ], 
+        [
+          "A29", 
+          "norm", 
+          "T8", 
+          "NASAL_CONGESTION"
+        ], 
+        [
+          "A30", 
+          "certainty", 
+          "T8", 
+          "Positive"
+        ], 
+        [
+          "A31", 
+          "status", 
+          "T8", 
+          "Present"
+        ], 
+        [
+          "A32", 
+          "experiencer", 
+          "T8", 
+          "Patient"
+        ]
+      ], 
+      "entities": [
+        [
+          "T1", 
+          "Condition", 
+          [
+            [
+              9, 
+              18
+            ]
+          ]
+        ], 
+        [
+          "T2", 
+          "Condition", 
+          [
+            [
+              23, 
+              28
+            ]
+          ]
+        ], 
+        [
+          "T3", 
+          "Condition", 
+          [
+            [
+              59, 
+              78
+            ]
+          ]
+        ], 
+        [
+          "T4", 
+          "Condition", 
+          [
+            [
+              104, 
+              111
+            ]
+          ]
+        ], 
+        [
+          "T5", 
+          "Condition", 
+          [
+            [
+              135, 
+              143
+            ]
+          ]
+        ], 
+        [
+          "T6", 
+          "Condition", 
+          [
+            [
+              144, 
+              152
+            ]
+          ]
+        ], 
+        [
+          "T7", 
+          "Condition", 
+          [
+            [
+              181, 
+              192
+            ]
+          ]
+        ], 
+        [
+          "T8", 
+          "Condition", 
+          [
+            [
+              208, 
+              218
+            ]
+          ]
+        ]
+      ], 
+      "text": "I have a dry cough and fever or chills. And the following:\nShortness of breath or difficulty breathing.\nFatigue, Muscle or body aches, diarrhea\nHeadache, new loss of taste or smell\nSore throat, congestion or runny nose, nausea or vomiting"
+    }, 
+    "msg": "Failed", 
+    "success": true
+  }  
\ No newline at end of file
Index: src/main/resources/templates/index.v2.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/templates/index.v2.html	(date 1594749336117)
+++ src/main/resources/templates/index.v2.html	(date 1594749336117)
@@ -0,0 +1,133 @@
+<!DOCTYPE html>
+<html lang="en">
+<head>
+    <meta charset="UTF-8">
+    <meta name="viewport" content="width=device-width, initial-scale=1.0">
+    <link rel="stylesheet" href="https://cdn.metroui.org.ua/v4.3.2/css/metro-all.min.css">
+    <script src="https://kit.fontawesome.com/cb45cc91b0.js" crossorigin="anonymous"></script>
+    <title>MedTagger Web</title>
+    <link href="./static/img/favicon.ico" rel="shortcut icon" type="image/x-icon" />
+</head>
+<body>
+    <div data-role="appbar" data-expand-point="md">
+        <a href="#" class="brand no-hover">
+            <img style="height: 65px;" src="./static/img/medtaggerweb_logo.png" alt="medtaggerweb_logo.png">
+        </a>
+    
+        <ul class="app-bar-menu">
+            <li><a href="#">HOME</a></li>
+            <li><a href="#">ABOUT</a></li>
+            <li>
+                <a href="#" class="dropdown-toggle">DEMO</a>
+                <ul class="d-menu" data-role="dropdown">
+                    <li><a href="/demo">
+                        <i class="fa fa-head-side-mask"></i> 
+                        COVID-19 Term Detector
+                    </a></li>
+                    <li><a href="/dict_builder">
+                        <i class="fa fa-book-medical"></i>
+                        Ontology Dictionary Builder
+                    </a></li>
+                    <li><a href="/ie_editor">
+                        <i class="fa fa-edit"></i>
+                        IE Engine Editor
+                    </a></li>
+                </ul>
+            </li>
+            <li><a href="#">CONTACTS</a></li>
+        </ul>
+    </div>
+    
+<div class="container-fluid mt-4 mb-10">
+    <div data-role="carousel"
+        data-controls-on-mouse="true" data-cls-controls="fg-white">
+        <div class="slide p-2 pl-10 pr-10">
+            <div class="row flex-align-center h-100">
+                <div class="cell-md-12 text-center">
+                    <img style="max-width: 80%;" src="./static/img/medtaggerweb_logo.png" alt="medtaggerweb_logo.png">
+                    <p class="display2">Now avaliable.</p>
+                    <p><a href="#">Learn more &gt;</a></p>
+                </div>
+            </div>
+        </div>
+    </div>
+</div>
+
+<div class="container-fluid bg-lightGray pt-10 pb-10">
+    <div class="container">
+        <div class="row">
+            <div class="cell text-center">
+                <h1>MedTagger: Towards a semantic lexicon for clinical NLP</h1>
+                <p>A semantic lexicon which associates words and phrases in text to concepts is critical for extracting and encoding clinical information in free text and therefore achieving semantic interoperability between structured and unstructured data in Electronic Health Records (EHRs). Directly using existing standard terminologies may have limited coverage with respect to concepts and their corresponding mentions in text. With MedTagger, we analyze how tokens and phrases in a large corpus distribute and how well the UMLS captures the semantics. A corpus-driven semantic lexicon, MedLex, has been constructed where the semantics is based on the UMLS assisted with variants mined and usage information gathered from clinical text. The detailed corpus analysis of tokens, chunks, and concept mentions shows the UMLS is an invaluable source for natural language processing. Increasing the semantic coverage of tokens provides a good foundation in capturing clinical information comprehensively. The study also yields some insights in developing practical NLP systems.</p>
+                <p>
+                    <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3540492/">Learn more &gt;</a>
+                </p>
+            </div>
+        </div>
+    </div>
+</div>
+
+<div class="container-fluid pt-10 pb-10">
+    <div class="container">
+        <div class="row">
+            <div class="cell text-center" style="margin-bottom: -120px; z-index: 10;">
+                <h1>
+                    COVID-19 Term Detector
+                </h1>
+                <p class="display1">Powered by MedTagger IE Engine</p>
+                <p>
+                    <a href="#">Learn more &gt;</a>&nbsp;&nbsp;
+                    <a href="/demo">Demo &gt;</a>
+                </p>
+            </div>
+            <div class="img-container">
+                <img src="./static/img/demo1.png" alt="">
+            </div>
+        </div>
+    </div>
+</div>
+
+
+<div class="container mt-10 pt-10 pb-10">
+    <div class="row" style="padding-bottom: 100px;">
+        <div class="cell text-center">
+            <h1>Dictionary Builder</h1>
+            <p class="display1">From ontology to dictionary.</p>
+            <p>
+                <a href="#">Learn more &gt;</a>&nbsp;&nbsp;
+                <a href="/dict_builder">Try &gt;</a>
+            </p>
+        </div>
+
+        <div class="cell text-center">
+            <h1>IE Engine Editor</h1>
+            <p class="display1">The expert knowledge.</p>
+            <p>
+                <a href="#">Learn more &gt;</a>&nbsp;&nbsp;
+                <a href="/ie_editor">Try &gt;</a>
+            </p>
+        </div>
+    </div>
+</div>
+
+
+<div class="container-fluid bg-lightGray mt-10 pt-10 pb-10">
+    <div class="container">
+        <div class="row">
+            <div class="cell-4">
+                <p>MedTagger &copy; 2020</p>
+            </div>
+            <div class="cell-4">
+            </div>
+            <div class="cell-4">
+            </div>
+        </div>
+    </div>
+</div>
+
+<script src="https://cdn.metroui.org.ua/v4.3.2/js/metro.min.js"></script>
+<script>
+
+</script>
+</body>
+</html>
\ No newline at end of file
Index: src/main/resources/templates/ie_editor.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/templates/ie_editor.html	(date 1594749336115)
+++ src/main/resources/templates/ie_editor.html	(date 1594749336115)
@@ -0,0 +1,750 @@
+<!DOCTYPE html>
+<html lang="en">
+
+<head>
+    <meta charset="UTF-8">
+    <meta name="viewport" content="width=device-width, initial-scale=1.0">
+    <link rel="stylesheet" href="https://cdn.metroui.org.ua/v4.3.2/css/metro-all.min.css">
+    <script src="https://kit.fontawesome.com/cb45cc91b0.js" crossorigin="anonymous"></script>
+    <title>IE Engine Editor | MedTagger Web</title>
+    <link href="/static/img/favicon.ico" rel="shortcut icon" type="image/x-icon" />
+    <style>
+        .flex-container {
+            display: flex;
+            justify-content: flex-start;
+            width: 100%;
+            height: 100%;
+        }
+
+        .box {
+            display: flex;
+            flex-direction: column;
+        }
+
+        .box-header {
+            width: 100%;
+            padding: 3px 0;
+            display: flex;
+            flex-direction: row;
+        }
+
+        .box-header a {
+            font-size: .8em;
+        }
+
+        .box-header h4 {
+            padding: 0;
+            margin: 0;
+            font-size: .95em;
+            height: 1.6em;
+            line-height: 1.6em;
+            margin: 3px 0;
+        }
+
+        .box-header button,
+        .box-body button,
+        .box-footer button {
+            height: 1.6em;
+            line-height: 1em;
+            font-size: .8em;
+            margin: 4px;
+        }
+
+        .box-header input,
+        .box-body input {
+            height: 1em;
+            line-height: 1em;
+            font-size: 1em;
+            margin: 4px 4px 0 4px;
+        }
+
+        .box-header select {
+            height: 1.6em;
+            line-height: 1.2em;
+            font-size: .8em;
+            margin: 4px;
+        }
+
+        .box-header span {
+            font-size: .9em;
+        }
+
+        .box-header-right {
+            font-size: .95em;
+            height: 1.6em;
+            line-height: 1.6em;
+            margin: 3px 0;
+            text-align: right;
+        }
+
+        .box-body {
+            width: 100%;
+        }
+
+        .box-body-item {
+            padding: 5px 0 2px 0;
+            display: flex;
+            flex-direction: column;
+            border-bottom: 1px dotted #cccccc;
+        }
+
+        .box-body-item-left {
+            width: 73%;
+        }
+
+        .box-body-item-right {
+            width: 24%;
+            display: flex;
+            flex-direction: row;
+        }
+
+        .box-body-item-label {
+            width: 54%;
+            font-size: .9em;
+            line-height: 1.8em;
+        }
+
+        .box-body-item-value {
+            width: 45%;
+        }
+
+        .box-body-item select {
+            width: 100%;
+        }
+
+        .box-body h5 {
+            padding: 0;
+            margin: 0;
+            font-size: .95em;
+            height: 1.6em;
+            line-height: 1.6em;
+            margin: 3px 0;
+        }
+
+        .box-p {
+            width: 100%;
+            padding: 0;
+            margin: 0;
+            font-size: .9em;
+        }
+
+        .box-p-fixlen {
+            white-space: nowrap;
+            text-overflow: ellipsis;
+            overflow: hidden;
+        }
+
+        .box-footer {
+            width: 100%;
+            min-height: 20px;
+            padding: 5px 0 5px 0;
+        }
+
+        /* this page  */
+
+        #rule-editor {
+            font-size: 12px;
+            height: 100%;
+            font-family: Arial, Helvetica, sans-serif;
+        }
+
+        #navi {
+            width: 120px;
+            height: 100%;
+            padding: 5px;
+            margin: 0 5px 0 0;
+            background-color: whitesmoke;
+            border-right: 1px solid #efefef;
+        }
+
+        #rule-pane {
+            width: 500px;
+            height: 100%;
+            padding: 5px;
+            margin: 0 5px 0 0;
+            border-right: 1px dotted whitesmoke;
+            overflow-y: auto;
+        }
+
+        #rsregexp-pane {
+            width: calc(100% - 500px);
+            height: 100%;
+            padding: 5px;
+            overflow-y: auto;
+            flex-direction: row;
+            align-content: flex-start;
+            flex-wrap: wrap;
+        }
+
+        .rsregexp-file {
+            width: 280px;
+            margin: 0 15px 5px 0;
+        }
+
+        .rsregexp-text {
+            width: calc(100% - 10px);
+            margin: 5px 0 5px 0;
+            padding: 5px;
+            border: 1px solid #CCCCCC;
+        }
+
+        .rule-input {
+            font-size: 12px;
+            /* padding: 0 0 2px 0; */
+            border: 0 !important;
+            width: 190px;
+            border-bottom: 1px solid lightgrey !important;
+        }
+
+        .matchrule {
+            margin: 0 0 5px 0;
+            border: 0 !important;
+        }
+
+        .matchrule label {
+            color: #999999;
+        }
+
+        #drop_zone {
+            width: calc(100% - 10px);
+            border: 2px dashed #bbb;
+            border-radius: 5px;
+            padding: 30px 0;
+            text-align: center;
+            cursor: pointer;
+            color: #666666;
+        }
+
+        #drop_zone:hover {
+            background: #EAEAEA;
+            color: #000000;
+        }
+    </style>
+</head>
+
+<body>
+    <div id="fm_chfila">
+        <div class="container-fluid bg-cyan fg-white mb-1">
+            <div class="row">
+                <div class="cell">
+                    <p>
+                        <i class="fa fa-edit"></i>
+                        IE Engine Editor
+                    </p>
+                </div>
+            </div>
+        </div>
+
+        <nav data-role="ribbonmenu">
+            <ul class="tabs-holder">
+                <li><a href="#section-1-1">Rule Package</a></li>
+            </ul>
+
+            <div class="content-holder">
+                <div class="section" id="section-1-1">
+                    <div class="group">
+
+                        <button class="ribbon-button"
+                            v-on:click="create_pack">
+                            <span class="icon">
+                                <i class="far fa-file"></i>
+                            </span>
+                            <span class="caption">New</span>
+                        </button>
+
+                        <button class="ribbon-button">
+                            <span class="icon">
+                                <i class="far fa-folder-open"></i>
+                            </span>
+                            <span class="caption">Open</span>
+                        </button>
+
+                        <button class="ribbon-button" v-on:click="open_sample">
+                            <span class="icon">
+                                <i class="far fa-file-alt"></i>
+                            </span>
+                            <span class="caption">Sample</span>
+                        </button>
+
+                        <span class="title">IE Rule Package</span>
+                    </div>
+
+                    <div class="group">
+                        <div class="form-group">
+                            <label>Package Name</label>
+                            <input type="text" placeholder="RULESET_10" v-model="rulepack.name">
+                        </div>
+                        <button class="ribbon-button">
+                            <span class="icon">
+                                <i class="far fa-save"></i>
+                            </span>
+                            <span class="caption">Save</span>
+                        </button>
+
+                        <span class="title">Current Package</span>
+                    </div>
+
+                    <div class="group">
+                        <button class="ribbon-button"
+                            v-on:click="download_pack">
+                            <span class="icon">
+                                <i class="fa fa-file-code"></i>
+                            </span>
+                            <span class="caption">Save as JSON</span>
+                        </button>
+                        <a id="downloadAnchorElem" style="display:none"></a>
+
+                        <button class="ribbon-button"
+                            v-on:click="download_mtrs">
+                            <span class="icon">
+                                <i class="fa fa-file-archive"></i>
+                            </span>
+                            <span class="caption">Save as ZIP</span>
+                        </button>
+
+                        <span class="title">Download</span>
+                    </div>
+
+                    <div class="group">
+                        
+                        <button class="ribbon-button">
+                            <span class="icon">
+                                <i class="fa fa-upload"></i>
+                            </span>
+                            <span class="caption">Upload to Server</span>
+                        </button>
+                        
+                        <span class="title">Deployment</span>
+                    </div>
+
+                </div>
+
+            </div>
+        </nav>
+
+        <div id="rule-editor" class="container-fluid">
+            <div class="row">
+                <div class="cell d-flex flex-row">
+
+
+                    <div id="rule-pane">
+
+                        <div class="box">
+                            <div class="box-header">
+                                <h4>
+                                    <i class="fa fa-pencil-ruler"></i>
+                                    Match Rules
+                                </h4>
+                                <div>
+                                    <button class="btn" v-on:click="add_rule">
+                                        <i class="fa fa-plus-circle"></i>
+                                        Add Rule
+                                    </button>
+                                </div>
+                            </div><!-- box-header -->
+
+                            <div class="box-body">
+                                <div class="box-body-item matchrule" v-for="matchrule in rulepack.matchrules">
+                                    <div class="d-flex flex-row">
+                                        <label for="rule_name">
+                                            <i class="far fa-credit-card"></i>
+                                        </label>
+                                        <input class="rule-input" style="width:100px;" name="rule_name"
+                                            v-model="matchrule.rule_name"> &nbsp;
+
+                                        <label for="location">
+                                            <i class="far fa-map"></i>
+                                        </label>
+                                        <select class="rule-input" style="width:50px; height: 20px; line-height: 20px;" type="text" name="location"
+                                            v-model="matchrule.location">
+                                            <option v-for="loc in ui.locations" v-bind:value="loc">
+                                                {{ loc }}
+                                            </option>
+                                        </select> &nbsp;
+
+                                        <label for="norm">
+                                            <i class="fa fa-key"></i>
+                                            NORM:
+                                        </label>
+                                        <input class="rule-input" style="width:170px;" type="text" name="norm"
+                                            v-model="matchrule.norm">
+
+                                        <button v-on:click="del_rule(matchrule.rule_name)">
+                                            <i class="far fa-trash-alt"></i>
+                                        </button>
+                                    </div>
+
+                                    <div class="d-flex flex-row">
+                                        <label for="regexp">
+                                            <i class="far fa-keyboard"></i>
+                                            RE:
+                                        </label>
+                                        <input class="rule-input" style="width:430px; font-family: monospace;"
+                                            type="text" name="regexp" v-model=matchrule.regexp>
+                                    </div>
+                                </div>
+                            </div>
+                        </div><!-- /.box -->
+
+                    </div><!-- /#rule-pane -->
+
+                    <div id="rsregexp-pane" class="flex-container">
+                        <div class="box-header">
+                            <h4>
+                                <i class="far fa-folder"></i>
+                                Regular Expression Files
+                            </h4>&nbsp;&nbsp;
+                            <button class="btn" v-on:click="add_rsregexp">
+                                <i class="far fa-file-alt"></i>
+                                Add Regexp File
+                            </button>
+                        </div>
+
+                        <div class="d-flex flex-row flex-content-start flex-wrap">
+                            <div v-for="rsregexp in rulepack.rsregexps" class="box rsregexp-file">
+                                <div class="box-header">
+                                    <h4>
+                                        <i class="far fa-file"></i>
+                                        <input class="rule-input" v-model="rsregexp.name">
+                                        &nbsp;
+                                        {{ count_lines(rsregexp.text) }}
+                                    </h4>&nbsp;&nbsp;
+                                    <button v-on:click="del_rsregexp(rsregexp.name)">
+                                        <i class="far fa-trash-alt"></i>
+                                    </button>
+                                </div><!-- /.box-header -->
+    
+                                <div class="box-body">
+                                    <textarea class="rsregexp-text" rows="12" v-model="rsregexp.text"></textarea>
+                                </div><!-- /.box-body -->
+                            </div>
+
+                        </div>
+
+                    </div><!-- /#regexp-pane -->
+
+
+
+                </div>
+            </div>
+        </div>
+    </div>
+
+    <script src="https://cdn.metroui.org.ua/v4.3.2/js/metro.min.js"></script>
+    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
+        integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
+        crossorigin="anonymous"></script>
+    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
+
+    <script src="/static/lib/jszip/jszip-3.1.5.min.js"></script>
+    <script src="/static/lib/jszip/FileSaver.js"></script>
+
+    <script>
+        var fm_chfila = {
+            vpp: null,
+            vpp_id: '#fm_chfila',
+
+            pack_blank: {
+                name: 'Pack_Name',
+                matchrules: [],
+                rsregexps: [],
+                fns: {
+                    used_resources: 'used_resources.txt',
+                    resources_rules_matchrules: 'resources_rules_matchrules.txt'
+                }
+            },
+
+            pack_sample: {
+                name: 'Rule_Pack_Name',
+                matchrules: [{
+                    rule_name: 'rule_r1a',
+                    regexp: '\\b(rule|pack|name)\\b',
+                    location: 'NA',
+                    norm: 'ANT:group(1)'
+                }, {
+                    rule_name: 'rule_r2a',
+                    regexp: '\\b(rule|pack|name)\\b',
+                    location: 'UC',
+                    norm: 'NAT:group(1)'
+                }],
+                rsregexps: [{
+                    name: 'reBURG',
+                    text: 'pattern(s)?\nnextline\n3rd line'
+                }, {
+                    name: 'reBURGAlone',
+                    text: 'pattern(s)?\nnextline\n3rd line'
+                }],
+                fns: {
+                    used_resources: 'used_resources.txt',
+                    resources_rules_matchrules: 'resources_rules_matchrules.txt'
+                }
+            },
+
+            init: function () {
+                this.vpp = new Vue({
+                    el: this.vpp_id,
+                    data: {
+                        rulepack: Object.assign({}, this.sample),
+                        ui: {
+                            locations: ['NA', 'UC']
+                        }
+                    },
+                    methods: {
+                        open_sample: function () {
+                            fm_chfila.open_sample();
+                        },
+
+                        create_pack: function () {
+                            this.rulepack = Object.assign({}, fm_chfila.pack_blank);
+                        },
+
+                        download_pack: function () {
+                            fm_chfila.download_pack();
+                        },
+
+                        download_mtrs: function () {
+                            fm_chfila.download_mtrs();
+                        },
+
+                        add_rule: function () {
+                            rulepack.matchrules.push(fm_chfila.create_new_matchrule());
+                        },
+
+                        del_rule: function (rule_name) {
+                            var ret = window.confirm('Are you sure?');
+                            if (ret) {
+                                fm_chfila.del_rule(rule_name);
+                                console.log('* deleted match rule' + rule_name);
+                            } else {
+                            }
+                        },
+
+                        add_rsregexp: function () {
+                            rulepack.rsregexps.push(fm_chfila.create_new_rsregexp());
+                        },
+
+                        del_rsregexp: function (name) {
+                            var ret = window.confirm('Are you sure?');
+                            if (ret) {
+                                fm_chfila.del_rsregexp(name);
+                                console.log('* deleted rsregexp' + name);
+                            } else {
+                            }
+                        },
+
+                        count_lines: function (text) {
+                            return text.split('\n').length;
+                        },
+
+                        valid_pack_name: function (name) {
+                            var re = /^[a-zA-z0-9_]+$/;
+                            return re.test(name);
+                        }
+                    },
+                    
+                    mounted: function () {
+                        Metro.init();
+                    }
+                });
+            },
+
+            show: function (pack) {
+                this.vpp.rulepack = pack;
+                rulepack = pack;
+            },
+
+            create_new_pack: function () {
+                return {
+                    name: 'Pack_Name',
+                    matchrules: [],
+                    rsregexps: [],
+                    fns: {
+                        used_resources: 'used_resources.txt',
+                        resources_rules_matchrules: 'resources_rules_matchrules.txt'
+                    }
+                };
+            },
+
+            create_new_matchrule: function () {
+                return {
+                    rule_name: 'cm_r00',
+                    regexp: '\\b(%reNAME )\\b',
+                    location: 'NA',
+                    norm: 'NAME:group(1)'
+                };
+            },
+
+            create_new_rsregexp: function () {
+                return {
+                    name: 'reNAME',
+                    text: ''
+                };
+            },
+
+            del_rule: function (rule_name) {
+                var new_matchrules = [];
+                for (let i = 0; i < rulepack.matchrules.length; i++) {
+                    const matchrule = rulepack.matchrules[i];
+                    if (matchrule.rule_name == rule_name) {
+
+                    } else {
+                        new_matchrules.push(matchrule);
+                    }
+                }
+                rulepack.matchrules = new_matchrules;
+            },
+
+            del_rsregexp: function (name) {
+                var new_rsregexps = [];
+                for (let i = 0; i < rulepack.rsregexps.length; i++) {
+                    const rsregexp = rulepack.rsregexps[i];
+                    if (rsregexp.name == name) {
+
+                    } else {
+                        new_rsregexps.push(rsregexp);
+                    }
+                }
+                rulepack.rsregexps = new_rsregexps;
+            },
+
+            open_sample: function () {
+                $.get(
+                    './static/data/sample_pack.json',
+                    {},
+                    function (data) {
+                        fm_chfila.vpp.rulepack = data;
+                        rulepack = data;
+                    }, 'json'
+                )
+            },
+
+            save_pack: function () {
+                $.post(
+                    './save_rulepack',
+                    { rulepack: rulepack },
+                    function (data) {
+
+                    }, 'json'
+                );
+            },
+
+            download_pack: function () {
+                var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(rulepack, null, 2));
+                var dlAnchorElem = document.getElementById('downloadAnchorElem');
+                dlAnchorElem.setAttribute("href", dataStr);
+                dlAnchorElem.setAttribute("download", rulepack.name + ".json");
+                dlAnchorElem.click();
+            },
+
+            download_mtrs: function () {
+                var zip = new JSZip();
+
+                // create the file list of regexp
+                var txt_fns = '';
+                for (let i = 0; i < rulepack.rsregexps.length; i++) {
+                    const rsregexp = rulepack.rsregexps[i];
+                    var ffn = 'regexp/resources_regexp_' + rsregexp.name + '.txt';
+                    var txt = rsregexp.text;
+                    txt_fns += './' + ffn + '\n';
+
+                    zip.file(ffn, txt);
+                    console.log('* add ' + ffn);
+                }
+
+                // create the rule file
+                var rules = '// ' + rulepack.name + '\n';
+                for (let i = 0; i < rulepack.matchrules.length; i++) {
+                    const matchrule = rulepack.matchrules[i];
+                    rules += 'RULENAME="' + matchrule.rule_name + '",';
+                    rules += 'REGEXP="' + matchrule.regexp + '",';
+                    rules += 'LOCATION="' + matchrule.location + '",';
+                    rules += 'NORM="' + matchrule.norm + '"\n';
+                }
+                var rule_fn = 'rules/' + rulepack.fns.resources_rules_matchrules;
+                txt_fns += './' + rule_fn + '\n';
+
+                zip.file(rule_fn, rules);
+                console.log('* add ' + rule_fn);
+
+                // create the used_resources.txt
+                txt_fns += './' + rulepack.fns.used_resources + '\n';
+                zip.file(rulepack.fns.used_resources, txt_fns)
+
+                // download this zip
+                zip.generateAsync({ type: "blob" }).then(function (content) {
+                    saveAs(content, rulepack.name + ".zip");
+                });
+            }
+        };
+
+        // var fm_dropzn = {
+        //     dropzone: null,
+        //     dropzone_id: 'drop_zone',
+
+        //     fileinput: null,
+        //     fileinput_id: 'drop_file',
+
+        //     init: function() {
+        //         this.dropzone = document.getElementById(this.dropzone_id);
+        //         this.dropzone.addEventListener('drop', this.handleFileSelect, false);
+        //         this.dropzone.addEventListener('dragover', this.handleDragOver, false);
+
+        //         this.fileinput = document.getElementById(this.fileinput_id);
+        //         this.fileinput.addEventListener('change', this.handleFileSelect, false);
+        //     },
+
+        //     handleFileSelect: function(evt) {
+        //         evt.stopPropagation();
+        //         evt.preventDefault();
+
+        //         // FileList object.
+        //         var files = evt.target.files || evt.dataTransfer.files;
+
+        //         // files is a FileList of File objects. List some properties.
+        //         var output = [];
+        //         for (var i = 0, f; f = files[i]; i++) {
+        //             output.push(
+        //                 '<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
+        //                 f.size, ' bytes, last modified: ',
+        //                 f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
+        //                 '</li>'
+        //             );
+        //             console.log('* found ' + f.name);
+
+        //             fm_dropzn.read_json(f);
+        //         }
+        //     },
+
+        //     handleDragOver: function(evt) {
+        //         evt.stopPropagation();
+        //         evt.preventDefault();
+        //         // Explicitly show this is a copy.
+        //         evt.dataTransfer.dropEffect = 'copy'; 
+        //     },
+
+        //     read_json: function(f) {
+        //         var reader = new FileReader();
+        //         reader.onload = function(e) {
+        //             var text = e.target.result;
+        //             var j = JSON.parse(text);
+        //             console.log(j);
+        //             fm_chfila.show(j);
+        //         };
+        //         reader.readAsText(f);
+        //     }
+        // }
+
+
+        function init() {
+            fm_chfila.init();
+            // fm_dropzn.init();
+        }
+
+        $(document).ready(function () {
+            init();
+        })
+
+    </script>
+</body>
+
+</html>
\ No newline at end of file
Index: src/main/resources/templates/demo.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/templates/demo.html	(date 1594839243812)
+++ src/main/resources/templates/demo.html	(date 1594839243812)
@@ -0,0 +1,347 @@
+<!DOCTYPE html>
+<html lang="en">
+
+<head>
+    <meta charset="UTF-8">
+    <meta name="viewport" content="width=device-width, initial-scale=1.0">
+    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
+    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet"
+        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
+    <link rel="stylesheet" type="text/css" href="./static/lib/brat/css/style.css"/>
+    <script src="https://kit.fontawesome.com/cb45cc91b0.js" crossorigin="anonymous"></script>
+    <script src="https://www.google.com/recaptcha/api.js"></script>
+    <title>COVID-19 Term Detector</title>
+    <link href="./static/img/favicon.ico" rel="shortcut icon" type="image/x-icon" />
+    <style>
+        /* global setting */
+        html,
+        body {
+            width: 100%;
+            height: 100%;
+            padding: 0;
+            margin: 0;
+            overflow: hidden;
+            font-family: Arial, Helvetica, sans-serif;
+        }
+
+        /* for bootstrap */
+
+
+        /* fix vuetify.js default style */
+        .v-treeview--dense .v-treeview-node__root {
+            min-height: 24px;
+        }
+
+        .container {
+            padding: 0;
+        }
+
+        /* for this page */
+        #output-json {
+            font-size: 10px;
+            line-height: 12px;
+            max-height: 200px;
+            height: 200px;
+            border: 1px solid #dddddd;
+            overflow-y: auto;
+            padding: 5px;
+            background: #eeeeee;
+        }
+    </style>
+
+</head>
+
+<body>
+    <header>
+        <!-- Fixed navbar -->
+        <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
+            <a class="navbar-brand" href="#"><i class="fa fa-chalkboard"></i> COVID-19 Term Detector</a>
+            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
+                aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
+                <span class="navbar-toggler-icon"></span>
+            </button>
+            <div class="collapse navbar-collapse" id="navbarCollapse">
+                <ul class="navbar-nav mr-auto">
+                    <li class="nav-item active">
+                        <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
+                    </li>
+                    <li class="nav-item">
+                        <a class="nav-link" href="/dict_builder">Dictionary Builder</a>
+                    </li>
+                    <li class="nav-item">
+                        <a class="nav-link" href="/ie_editor">IE Engine Editor</a>
+                    </li>
+                </ul>
+
+                <div class="my-2 my-lg-0">
+                    <ul class="navbar-nav mr-auto">
+                        <li class="nav-item">
+                            <a class="nav-link" href="#"><i class="fa fa-github"></i> GitHub</a>
+                        </li>
+                    </ul>
+                </div>
+            </div>
+        </nav>
+    </header>
+
+    <div class="container-fluid" style="margin-top: 70px; height: calc(100% - 70px);">
+
+        <div class="row" style="height: 100%;">
+
+            <div class="col-md-5">
+                <h5>Input Text <small>Maximum length: 3,000 characters</small></h5>
+                <div class="form-group">
+                    <textarea id="text" maxlength="3000" width="100%" class="form-control"
+                        rows="10">The patient had a dry cough and fever or chills. And the following:
+Shortness of breath or difficulty breathing.
+Fatigue, Muscle or body aches, diarrhea
+Headache, new loss of taste or smell
+Sore throat, congestion or runny nose, nausea or vomiting.</textarea>
+                </div>
+                <div class="form-group">
+                    <button class="btn btn-primary btn-sm" onclick="jarvis.parse();">
+                        <i class="fa fa-pencil-alt"></i>
+                        Run MedTagger
+                    </button>
+                </div>
+            </div>
+
+
+            <div class="col-md-7">
+                <h5>Output</h5>
+                <p id="output-msg">The server response:</p>
+                <div id="output" style="width: 100%;">
+                    <pre id="output-json"></pre>
+
+                    <p>The BRAT visualization</p>
+                    <div id="fig_bratvis">
+                        
+                    </div>
+                </div>
+            </div>
+
+        </div>
+        <!-- /.row -->
+
+    </div>
+
+    <div id="toastmsg" class="toast" data-delay="8000" style="position: absolute; top: 20px; right: 20px;">
+        <div class="toast-header">
+            <i class="fa fa-info-circle"></i>&nbsp;&nbsp;
+            <strong class="mr-auto">System Message</strong>
+            <!-- <small>11 mins ago</small> -->
+            <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
+                <span aria-hidden="true">&times;</span>
+            </button>
+        </div>
+        <div id="toastmsg-body" class="toast-body">
+            &nbsp;
+        </div>
+    </div>
+
+    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
+
+    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
+        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
+        crossorigin="anonymous"></script>
+    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"
+        integrity="sha384-1CmrxMRARb6aLqgBO7yyAxTOQE2AKb9GfXnEo760AUcUmFx3ibVJJAzGytlQcNXd"
+        crossorigin="anonymous"></script>
+    <script type="text/javascript" src="./static/lib/brat/lib/head.load.min.js"></script>
+
+    <script>
+        var collData = {
+            entity_types: [{
+                type: 'Condition',
+                labels: ['Condition'],
+                bgColor: '#7fa2ff',
+                borderColor: 'darken'
+            }],
+            entity_attribute_types: [{
+                type: 'norm',
+                /* brat supports multi-valued attributes, but in our case we will only
+                    use a single value and add a glyph to the visualisation to indicate
+                    that the entity carries that attribute */
+                values: {
+                    'DRY_COUGH': { "glyph": "[DRY_COUGH]", },
+                    'FEVER': { "glyph": "[FEVER]", },
+                    'LYMPHOPENIA': { "glyph": "[LYMPHOPENIA]", },
+                    'SORE_THROAT': { "glyph": "[SORE_THROAT]", },
+                    'GROUND_GLASS_INFILTRATES': { "glyph": "[GROUND_GLASS_INFILTRATES]", },
+                    'ELEVATED_LDH': { "glyph": "[ELEVATED_LDH]", },
+                    'DIARRHEA': { "glyph": "[DIARRHEA]", },
+                    'NASAL_CONGESTION': { "glyph": "[NASAL_CONGESTION]", },
+                    'FATIGUE': { "glyph": "[FATIGUE]", },
+                    'DYSPNEA': { "glyph": "[DYSPNEA]", },
+                    'HEADACHE': { "glyph": "[HEADACHE]", },
+                    'MYALGIA': { "glyph": "[MYALGIA]", },
+                    'ABDOMINAL_PAIN': { "glyph": "[ABDOMINAL_PAIN]", },
+                    'PATCHY_INFILTRATES': { "glyph": "[PATCHY_INFILTRATES]", },
+                    'ELEVATED_PT_TIME': { "glyph": "[ELEVATED_PT_TIME]", },
+                    'INFLUENZA_EXPL': { "glyph": "[INFLUENZA_EXPL]", },
+                    'LOSS_OF_APPETITE': { "glyph": "[LOSS_OF_APPETITE]", },
+                    'REMOVE': { "glyph": "[FLU_SHOT]", },
+                }
+            },
+            {
+                "values": {
+                    "Positive": {
+                        // "box": "none",
+                        "glyph": "[Positive]",
+                        // "dashArray": "1,2" //Incertitude
+                    },
+                    "Negated": {
+                        // "box": "crossed",
+                        "glyph": "[Negated]",
+                        // "dashArray": "3,4" //Incertitude
+                    }
+                },
+                "type": "certainty",
+                "name": "certainty"
+            },
+            {
+                "values": {
+                    "Present": {
+                        "glyph": "[Present]",
+                    },
+                    "HistoryOf": {
+                        "glyph": "[HistoryOf]",
+                    }
+                },
+                "type": "status",
+                "name": "status"
+            },
+            {
+                "values": {
+                    "Patient": {
+                        "glyph": "[Patient]",
+                    },
+                    "Others": {
+                        "glyph": "[Others]",
+                    }
+                },
+                "type": "experiencer",
+                "name": "experiencer"
+            },
+            ]
+        };
+
+        var fig_bratvis = {
+            plot_id: 'fig_bratvis',
+            bratLocation: '/static/lib/brat',
+
+            init: function() {
+
+                head.js(
+                    // External libraries
+                    this.bratLocation + '/lib/jquery.min.js',
+                    this.bratLocation + '/lib/jquery.svg.min.js',
+                    this.bratLocation + '/lib/jquery.svgdom.min.js',
+
+                    // brat helper modules
+                    this.bratLocation + '/src/configuration.js',
+                    this.bratLocation + '/src/util.js',
+                    this.bratLocation + '/src/annotation_log.js',
+                    this.bratLocation + '/lib/webfont.js',
+
+                    // brat modules
+                    this.bratLocation + '/src/dispatcher.js',
+                    this.bratLocation + '/src/url_monitor.js',
+                    this.bratLocation + '/src/visualizer.js'
+                );
+
+                head.ready(function() {
+                    // bind to local variable
+                    fig_bratvis.Util = Util;
+
+                    //
+                    jarvis.msg('inited Brat lib');
+                });
+            },
+
+            draw: function(data) {
+                // $('#' + this.plot_id).html('');
+                // create a new div
+                var new_div_id = this.plot_id + '_' + (Math.random()*100000).toFixed(0);
+                
+                $('#' + this.plot_id).html(`
+                <div id="${new_div_id}" style="width:100%;">
+                </div>
+                `);
+
+                this.Util.embed(
+                    new_div_id,
+                    $.extend({}, collData),
+                    $.extend({}, data),
+                    webFontURLs
+                )
+            }
+        };
+
+
+        var webFontURLs = [
+            fig_bratvis.bratLocation + '/css/fonts/Astloch-Bold.ttf',
+            fig_bratvis.bratLocation + '/css/fonts/PT_Sans-Caption-Web-Regular.ttf',
+            fig_bratvis.bratLocation + '/css/fonts/Liberation_Sans-Regular.ttf'
+        ];
+
+
+
+        var jarvis = {
+            url: {
+                parse: '/parse'
+            },
+
+            init: function () {
+                fig_bratvis.init();
+            },
+
+            parse: function () {
+                var text = $('#text').val().trim();
+                if (text == '') { return }
+
+                // clear the output
+                $('#output-json').html('');
+
+                // send to backend
+                $.post(
+                    this.url.parse,
+                    { docText: text },
+                    function (data) {
+                        console.log(data);
+                        jarvis.msg('Parse result: ' + data.success);
+                        if (data.success) {
+                            jarvis.show(data);
+                        } else {
+                            $('#output').html(data.msg);
+                        }
+                    }, 'json'
+                )
+            },
+
+            show: function (data) {
+                // show text
+                $('#output-json').html(JSON.stringify(data.data, null, 2));
+
+                // draw plot
+                fig_bratvis.draw(data.data);
+            },
+
+            msg: function (s) {
+                console.log('* ' + s);
+                toast(s);
+            }
+        };
+
+        function toast(msg) {
+            // $('#toastmsg-body').html(msg);
+            // $('#toastmsg').toast('show');
+        }
+
+        $(document).ready(function () {
+            jarvis.init();
+        });
+    </script>
+</body>
+
+</html>
\ No newline at end of file
Index: src/main/resources/templates/index.v1.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/templates/index.v1.html	(date 1594749336116)
+++ src/main/resources/templates/index.v1.html	(date 1594749336116)
@@ -0,0 +1,280 @@
+<!doctype html>
+<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
+<head>
+    <meta charset="utf-8">
+    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
+    <meta name="description" content="">
+    <meta name="author" content="Sijia Liu">
+    <title>OHNLP MedTagger Demo</title>
+
+    <!-- Bootstrap core CSS -->
+    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet"
+          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
+    <link rel="stylesheet" type="text/css" href="/css/style-vis.css">
+    <script type="text/javascript" src="/js/head.js"></script>
+
+
+    <style>
+        .bd-placeholder-img {
+            font-size: 1.125rem;
+            text-anchor: middle;
+            -webkit-user-select: none;
+            -moz-user-select: none;
+            -ms-user-select: none;
+            user-select: none;
+        }
+
+        @media (min-width: 768px) {
+            .bd-placeholder-img-lg {
+                font-size: 3.5rem;
+            }
+        }
+    </style>
+</head>
+<body class="bg-light">
+
+<!-- Navbar content -->
+<div class="container">
+    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
+        <a class="navbar-brand" href="#">MedTagger Demo</a>
+
+
+        <ul class="navbar-nav ml-auto">
+            <li class="nav-item ">
+                <a class="nav-link " href="http://ohnlp.org/">OHNLP</a>
+            </li>
+            <li>
+                <a class="navbar-nav  mr-sm-0" href="https://github.com/OHNLP/MedTagger" target="_blank">
+                    <img src="/images/GitHub-Mark-32px.png" alt="Github">
+                </a>
+            </li>
+        </ul>
+
+
+    </nav>
+</div>
+
+
+<script type="text/javascript" src="/js/brat_loader.js"></script>
+
+<script type="text/javascript">
+    var collData = {
+        entity_types: [{
+            type: 'Condition',
+            labels: ['Condition'],
+            bgColor: '#7fa2ff',
+            borderColor: 'darken'
+        }],
+        entity_attribute_types: [{
+            type: 'norm',
+            /* brat supports multi-valued attributes, but in our case we will only
+                use a single value and add a glyph to the visualisation to indicate
+                that the entity carries that attribute */
+            values: {
+                'DRY_COUGH': {"glyph": "[DRY_COUGH]",},
+                'FEVER': {"glyph": "[FEVER]",},
+                'LYMPHOPENIA': {"glyph": "[LYMPHOPENIA]",},
+                'SORE_THROAT': {"glyph": "[SORE_THROAT]",},
+                'GROUND_GLASS_INFILTRATES': {"glyph": "[GROUND_GLASS_INFILTRATES]",},
+                'ELEVATED_LDH': {"glyph": "[ELEVATED_LDH]",},
+                'DIARRHEA': {"glyph": "[DIARRHEA]",},
+                'NASAL_CONGESTION': {"glyph": "[NASAL_CONGESTION]",},
+                'FATIGUE': {"glyph": "[FATIGUE]",},
+                'DYSPNEA': {"glyph": "[DYSPNEA]",},
+                'HEADACHE': {"glyph": "[HEADACHE]",},
+                'MYALGIA': {"glyph": "[MYALGIA]",},
+                'ABDOMINAL_PAIN': {"glyph": "[ABDOMINAL_PAIN]",},
+                'PATCHY_INFILTRATES': {"glyph": "[PATCHY_INFILTRATES]",},
+                'ELEVATED_PT_TIME': {"glyph": "[ELEVATED_PT_TIME]",},
+                'INFLUENZA_EXPL': {"glyph": "[INFLUENZA_EXPL]",},
+                'LOSS_OF_APPETITE': {"glyph": "[LOSS_OF_APPETITE]",},
+                'REMOVE': {"glyph": "[FLU_SHOT]",},
+            }
+        },
+            {
+                "values": {
+                    "Positive": {
+                        // "box": "none",
+                        "glyph": "[Positive]",
+                        // "dashArray": "1,2" //Incertitude
+                    },
+                    "Negated": {
+                        // "box": "crossed",
+                        "glyph": "[Negated]",
+                        // "dashArray": "3,4" //Incertitude
+                    }
+                },
+                "type": "certainty",
+                "name": "certainty"
+            },
+            {
+                "values": {
+                    "Present": {
+                        "glyph": "[Present]",
+                    },
+                    "HistoryOf": {
+                        "glyph": "[HistoryOf]",
+                    }
+                },
+                "type": "status",
+                "name": "status"
+            },
+            {
+                "values": {
+                    "Patient": {
+                        "glyph": "[Patient]",
+                    },
+                    "Others": {
+                        "glyph": "[Others]",
+                    }
+                },
+                "type": "experiencer",
+                "name": "experiencer"
+            },
+        ]
+    };
+</script>
+
+<script th:inline="javascript">
+    var docData = {
+        text: [[${input_text}]],
+        entities:
+            [[${cmList}]],
+        attributes:
+            [[${attribList}]],
+    };
+</script>
+
+<div class="container">
+    <div class="py-5 text-center">
+        <h2>MedTagger COVID 19 Demo</h2>
+        <p class="lead">Extracting symptoms of COVID 19 from clinical texts</p>
+    </div>
+
+    <div class="row">
+        <div class="col-md-12 order-md-1">
+            <h4 class="mb-3">Input text here</h4>
+            <p class="mb-3">Maximum length: 3000 characters</p>
+
+            <form class="needs-validation" novalidate id="textform"
+                  method="POST">
+                <div class="mb-3">
+                    <textarea class="form-control" rows="3" name="docText" form="textform" maxlength="3000"
+                              th:text="${input_text}"></textarea>
+                </div>
+                <div class="row">
+                    <div class="col-md-4  mx-auto">
+                        <input class="btn btn-primary btn-lg btn-block" type="submit" value="Run MedTagger"/>
+                    </div>
+                </div>
+            </form>
+        </div>
+    </div>
+
+    <hr class="mb-3">
+
+    <div class="row">
+
+        <div class="col-md-12 order-md-1">
+            <h4 class="mb-3"><span th:if="${isResult}">Results</span></h4>
+
+            <p><span th:if="${isResult}">The results may take several seconds to load.</span></p>
+
+        </div>
+    </div>
+    <div class="row">
+        <div class="col-md-12 order-md-1">
+
+            <div id="embedding-entity-example"></div>
+
+            <div class="col-md-12 ">
+                <script type="text/javascript">
+                    head.ready(function () {
+                        // Evaluate the code from the example (with ID
+                        // 'embedding-entity-example') and show it to the user
+                        Util.embed('embedding-entity-example', $.extend({}, collData),
+                            $.extend({}, docData), webFontURLs);
+                    });
+                </script>
+            </div>
+            <p><span th:if="${isResult}"><hr class="md-3"></span></p>
+
+        </div>
+    </div>
+    <div class="row">
+        <div class="col-md-8">
+            <h4>Concept/Term List</h4>
+            <div class="row">
+                <div class="col-md-4">
+                    <ul>
+                        <li>Dry cough</li>
+                        <li>Fever</li>
+                        <li>Lymphopenia</li>
+                        <li>Sore Throat</li>
+                        <li>Ground Flass Infiltrates</li>
+                        <li>Elevated LDH</li>
+                        <li>Diarrhea</li>
+                        <li>Nasal Congestion</li>
+                        <li>Loss of Appetite</li>
+                    </ul>
+                    <a class="btn btn-secondary"
+                       href="https://github.com/OHNLP/MedTagger/tree/master/src/main/resources/medtaggerieresources/covid19"
+                       target="_blank" role="button">Ruleset »</a>
+                </div>
+                <div class="col-md-4">
+                    <ul>
+                        <li>Fatigue</li>
+                        <li>Dyspnea</li>
+                        <li>Headache</li>
+                        <li>Myalgia</li>
+                        <li>Abdominal Pain</li>
+                        <li>Patchy Infiltrates</li>
+                        <li>Elevated PT Time</li>
+                        <li>Influenza</li>
+                    </ul>
+
+                </div>
+            </div>
+
+        </div>
+        <div class="col-md-4">
+            <h4>COVID-19 Severe Case </h4>
+            <p>To identify people at higher risk for severe illness using structured
+                and unstructured data according to the
+                <a href="https://www.cdc.gov/coronavirus/2019-ncov/need-extra-precautions/people-at-higher-risk.html"
+                   target="_blank">CDC guideline</a>.</p>
+            <p><a class="btn btn-secondary"
+                  href="https://github.com/OHNLP/MedTagger/wiki/Risk-for-Severe-Illness-of-COVID-19" role="button">Wiki
+                »</a></p>
+        </div>
+    </div>
+
+
+    <footer class="my-5 pt-5 text-muted text-center text-small">
+        <p class="mb-1">&copy; 2020 Open Health Natural Language Processing (OHNLP) Consortium</p>
+        <ul class="list-inline">
+            <li class="list-inline-item"><a href="http://184.73.168.219/index.php/OHNLP:Privacy_policy">Privacy</a></li>
+            <li class="list-inline-item"><a
+                    href="http://184.73.168.219/index.php/OHNLP:General_disclaimer">Disclaimers</a></li>
+            <li class="list-inline-item"><a href="https://github.com/OHNLP/MedTagger/issues">Support</a></li>
+            <li class="list-inline-item"><a href="http://ohnlp.org/">About</a></li>
+        </ul>
+    </footer>
+</div>
+<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
+        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
+        crossorigin="anonymous"></script>
+<script>window.jQuery || document.write('<script src="/docs/4.4/assets/js/vendor/jquery.slim.min.js"><\/script>')</script>
+<script src="/docs/4.4/dist/js/bootstrap.bundle.min.js"
+        integrity="sha384-6khuMg9gaYr5AxOqhkVIODVIvm9ynTT5J4V1cfthmT+emCG6yVmEZsRHdxlotUnm"
+        crossorigin="anonymous"></script>
+<!--<script src="form-validation.js"></script>-->
+<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
+        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
+        crossorigin="anonymous"></script>
+<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
+        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
+        crossorigin="anonymous"></script>
+
+</body>
+</html>
Index: src/main/java/org/ohnlp/util/demo/util/GZFileHelper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/java/org/ohnlp/util/demo/util/GZFileHelper.java	(date 1594749336256)
+++ src/main/java/org/ohnlp/util/demo/util/GZFileHelper.java	(date 1594749336256)
@@ -0,0 +1,43 @@
+package org.ohnlp.medtagger.fit.demo.util;
+
+import java.io.FileInputStream;
+import java.io.FileOutputStream;
+import java.io.IOException;
+import java.util.zip.GZIPInputStream;
+
+public class GZFileHelper {
+    
+    public static String unzip(String filePath) {
+
+        String opFilePath = filePath.substring(0, filePath.lastIndexOf("."));
+        System.out.println("* filePath: " + filePath);
+        System.out.println("* opFilePath: " + opFilePath);
+        byte[] buffer = new byte[1024];
+
+        try {
+            FileInputStream fileIn = new FileInputStream(filePath);
+            GZIPInputStream gZIPInputStream = new GZIPInputStream(fileIn);
+            FileOutputStream fileOutputStream = new FileOutputStream(opFilePath);
+            int bytes_read;
+
+            while ((bytes_read = gZIPInputStream.read(buffer)) > 0) {
+                fileOutputStream.write(buffer, 0, bytes_read);
+            }
+ 
+            gZIPInputStream.close();
+            fileOutputStream.close();
+ 
+            System.out.println("* Decompressed successfully!");
+ 
+        } catch (IOException ex) {
+            ex.printStackTrace();
+        }
+
+        return opFilePath;
+    }
+
+    public static void main(String[] args) {
+        String filePath = args[0];
+        GZFileHelper.unzip(filePath);
+    }
+}
\ No newline at end of file
Index: src/main/java/org/ohnlp/util/demo/util/BioPortalAPI.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/java/org/ohnlp/util/demo/util/BioPortalAPI.java	(date 1594749336258)
+++ src/main/java/org/ohnlp/util/demo/util/BioPortalAPI.java	(date 1594749336258)
@@ -0,0 +1,162 @@
+package org.ohnlp.medtagger.fit.demo.util;
+
+import java.io.File;
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.Reader;
+import java.io.StringWriter;
+import java.net.URL;
+import java.nio.file.Files;
+import java.nio.file.Paths;
+
+import org.apache.commons.csv.CSVFormat;
+import org.apache.commons.csv.CSVParser;
+import org.apache.commons.csv.CSVPrinter;
+import org.apache.commons.csv.CSVRecord;
+import org.apache.commons.io.FileUtils;
+import org.apache.commons.io.IOUtils;
+import org.apache.http.HttpEntity;
+import org.apache.http.HttpResponse;
+import org.apache.http.client.ResponseHandler;
+import org.apache.http.client.methods.CloseableHttpResponse;
+import org.apache.http.client.methods.HttpGet;
+import org.apache.http.impl.client.CloseableHttpClient;
+import org.apache.http.impl.client.HttpClients;
+import org.apache.http.impl.client.LaxRedirectStrategy;
+import org.apache.http.util.EntityUtils;
+
+public class BioPortalAPI {
+
+    public static final String BASE_URL_BIO_PORTAL = "http://data.bioontology.org";
+
+    /**
+     * Download the ontology data CSV file from BioPortal and slice
+     * @param acronym the ontology name
+     * @param apikey the apikey for BioPortal
+     * @return string contains CSV data
+     * @throws Exception
+     */
+    public static String downloadAndExtractOntology(String acronym, String apikey) throws Exception {
+        String ontologyURL = BASE_URL_BIO_PORTAL + "/ontologies/" + acronym + "/download?download_format=csv&apikey="
+                + apikey;
+        URL url = new URL(ontologyURL);
+
+        /*
+         * Get the ontology data gzipped csv file from BioPortal
+         */
+        CloseableHttpClient httpclient = HttpClients.custom().setRedirectStrategy(new LaxRedirectStrategy()).build();
+
+        File dstFile = File.createTempFile(acronym + "-", ".csv.gz");
+        System.out.println("* created temp file " + dstFile.getAbsolutePath());
+        File downloadedFile = null;
+        try {
+            HttpGet request = new HttpGet(url.toURI()); // we're using GET but it could be via POST as well
+            downloadedFile = httpclient.execute(request, new FileDownloadResponseHandler(dstFile));
+
+        } catch (Exception e) {
+            throw new IllegalStateException(e);
+        } finally {
+            IOUtils.closeQuietly(httpclient);
+        }
+
+        // downloaded, unzip the downloaded file
+        String unzippedCSVFilePath = GZFileHelper.unzip(downloadedFile.getAbsolutePath());
+
+        // create a reader for the unzipped CSV file
+        Reader reader = Files.newBufferedReader(Paths.get(unzippedCSVFilePath));
+        CSVParser csvParser = new CSVParser(reader, CSVFormat.DEFAULT
+                    .withFirstRecordAsHeader()
+                    .withIgnoreHeaderCase()
+                    .withTrim());
+
+        // create a writer for the sliced CSV file as string for output
+        StringWriter writer = new StringWriter();
+        CSVPrinter csvPrinter = new CSVPrinter(writer, CSVFormat.DEFAULT
+                    .withHeader("Class ID", "Preferred Label", "Synonyms", "Definitions", "Parents"));
+
+        // slice the original CSV file
+        for (CSVRecord csvRecord : csvParser) {
+            // Accessing values by Header names
+            String class_id = csvRecord.get("Class ID");
+            String preferred_label = csvRecord.get("Preferred Label");
+            String synonyms = csvRecord.get("Synonyms");
+            String definitions = csvRecord.get("Definitions");
+            String parents = csvRecord.get("Parents");
+
+            csvPrinter.printRecord(class_id, preferred_label, synonyms, definitions, parents);
+            csvPrinter.flush();    
+        }
+        csvPrinter.close();
+        csvParser.close();
+
+        return writer.toString();
+    }
+
+    /**
+     * Get the Ontology Root node(s) of a specific ontology acronym
+     * @param acronym the ontology name
+     * @param apikey the apikey for BioPortal
+     * @return the string contains JSON data
+     * @throws Exception
+     */
+    public static String getOntologyRoot(String acronym, String apikey) throws Exception {
+        // create the URL for the ontology
+        String ontologyURL = BASE_URL_BIO_PORTAL + "/ontologies/" + acronym + "/classes/roots?apikey=" + apikey;
+
+        // get content
+        HttpGet request = new HttpGet(ontologyURL);
+
+        CloseableHttpClient httpClient = HttpClients.createDefault();
+        CloseableHttpResponse response = httpClient.execute(request);
+        HttpEntity entity = response.getEntity();
+
+        // return it as a String
+        String result = EntityUtils.toString(entity);
+        return result;
+    }
+
+    /**
+     * Get the children classes information from BioPortal
+     * @param acronym the ontology name
+     * @param classid the class id
+     * @param apikey the apikey for BioPortal
+     * @return the string contains JSON data
+     * @throws Exception
+     */
+    public static String getOntologyChildren(String acronym, String classid, String apikey) throws Exception {
+        // create the URL for the ontology
+        String childrenURL = BASE_URL_BIO_PORTAL + "/ontologies/" + acronym + "/classes/" + classid
+                + "/children?apikey=" + apikey;
+
+        // get content
+        HttpGet request = new HttpGet(childrenURL);
+
+        CloseableHttpClient httpClient = HttpClients.createDefault();
+        CloseableHttpResponse response = httpClient.execute(request);
+        HttpEntity entity = response.getEntity();
+
+        // return it as a String
+        String result = EntityUtils.toString(entity);
+        return result;
+    }
+
+    /**
+     * For downloading file
+     */
+    static class FileDownloadResponseHandler implements ResponseHandler<File> {
+
+        private final File target;
+
+        public FileDownloadResponseHandler(File target) {
+            this.target = target;
+        }
+
+        @Override
+        public File handleResponse(HttpResponse response) throws IOException {
+			InputStream source = response.getEntity().getContent();
+			FileUtils.copyInputStreamToFile(source, this.target);
+			return this.target;
+		}
+		
+	}
+}
\ No newline at end of file
Index: _config.yml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- _config.yml	(date 1594749336025)
+++ _config.yml	(date 1594749336025)
@@ -0,0 +1,1 @@
+theme: jekyll-theme-minimal
\ No newline at end of file
Index: src/main/resources/application.properties
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>server.port=80\nspring.application.name=covid_demo\nspring.resources.add-mappings=true\nspring.main.allow-bean-definition-overriding=true\nlogging.file=/tmp/covid-application-debug.log
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/resources/application.properties	(revision 4dfebf7ad61a5cee7cbd51a3cffca99b77cd5371)
+++ src/main/resources/application.properties	(date 1594749336035)
@@ -1,5 +1,7 @@
-server.port=80
+server.port=8080
 spring.application.name=covid_demo
 spring.resources.add-mappings=true
 spring.main.allow-bean-definition-overriding=true
-logging.file=/tmp/covid-application-debug.log
\ No newline at end of file
+logging.file=/tmp/covid-application-debug.log
+bioportal.apikey=71052efe-e688-4883-8888-3b2e7ddb32a0
+spring.thymeleaf.cache=false
\ No newline at end of file
